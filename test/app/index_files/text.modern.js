!function(e){var t={};function s(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=201)}([function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,s(1);var i=d(s(97)),n=d(s(98)),o=d(s(99)),r=s(14),a=s(9),l=s(100),c=s(21);function d(e){return e&&e.__esModule?e:{default:e}}let u=0;const h=/image/i,p={ar:!0,fa:!0,he:!0,ur:!0,yi:!0},g=navigator.userAgent.toLowerCase(),m=[[223,223],[880,1791],[2304,3711],[4256,4351],[12352,12543],[19968,40879],[44032,55215]],E=[/(\n+)/,/([.!?;\u0964](?:\s+|$))/,/([\-\u2012-\u2015](?:\s+|$))/,/([,:](?:\s+|$))/,/([\u3002\uff01\uff1f\uff1b\u2026])/,/([\uff0c\uff1a])/,/(\s+)/],_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},T=m.length,f={tm:0,val:null},S=Boolean(document.documentElement.classList)&&Boolean(document.createElementNS("http://www.w3.org/2000/svg","svg").classList);let C=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get(){C=!0}}))}catch(e){}const y=document.createElement("link"),A={yandexuid:"yu",_ym_uid:"yum",spravka:"sprvk"},v={mob:/mobi|tablet/.test(g),iOS:function(e){if(/ip(hone|ad|od)/.test(e)){const t=e.match(/os ([0-9_]+)/);return t?parseFloat(t[1].replace(/_/g,".")):1}return 0}(g),android:function(e){const t=e.match(/android ([0-9.]*)/);return t?parseFloat(t[1]||1):0}(g),IE:/msie|trident/.test(g),macOS:/mac os/.test(g),chromeVersion:function(e){const t=e.match(/chrom(e|ium)\/([0-9]+)\./);return!!t&&parseInt(t[2],10)}(g),firefoxVersion:function(e){const t=e.match(/firefox\/([0-9]+)\./);return t?parseInt(t[1]):0}(g),ieVersion:(L=g,L.indexOf("msie ")>0?10:L.indexOf("trident/")>0?11:L.indexOf("edge/")>0?12:0),safariVersion:function(e){if(!e.match(/chrom(e|ium)\/([0-9]+)\./)&&e.indexOf("safari/")>0){const t=e.match(/version\/([0-9]+)/);return t?parseInt(t[1]||1):0}return 0}(g),yaBro:-1!==g.indexOf("yabrowser"),isLinux:-1!==g.indexOf("linux")&&-1===g.indexOf("android"),assertTrue(e,t){if(!e)throw new Error(t)},assertNotEmptyString(e,t){this.assertTrue(e&&this.isString(e),t)},noop(){},trim(e){return this.isString(e)?e.trim():e},bind(e,t,s,i,n=!0){e.addEventListener(t,s,R(t,i,n))},unbind(e,t,s,i,n=!0){e.removeEventListener(t,s,R(t,i,n))},isUrl:e=>e.includes(".")&&!e.includes(" ")&&!/\s/.test(e)&&n.default.test(e)&&RegExp.$4.length>1,getHostname(e){return this.isUrl(e)?e.match(n.default)[2]:""},isEmail:e=>o.default.test(e),isImageFile:e=>e&&h.test(e.type),clone(e){return this.isArray(e)?e.slice():this.isObject(e)?this.extend({},e):e},toObject(e){const t={};for(const s in e)t[s]=e[s];return t},slice:(e,t,s)=>Array.prototype.slice.call(e,t,s),findIndex(e,t,s){return this.isArray(e)&&this.isFunction(e.findIndex)?e.findIndex(t,s):this.findIndexInternal(e,t,s)},findIndexInternal(e,t,s){if(!this.isArray(e))throw new Error("Object should be an array");if(!this.isFunction(t))throw new Error("Predicate should be a function");for(let i=0;i<e.length;i++){const n=e[i];if(t.call(s,n,i,e))return i}return-1},extend:Object.assign||function(e={}){const t=this.slice(arguments,1);for(let s=0;s<t.length;s++){const i=t[s];i&&Object.keys(i).forEach((function(t){e[t]=i[t]}))}return e},capitalizeWord:e=>e.charAt(0).toUpperCase()+e.substr(1),isAlpha(e){if(e.toLowerCase()!==e.toUpperCase())return!0;for(let t=0,s=e.charCodeAt(0);t<T;t++)if(s>=m[t][0]&&s<=m[t][1])return!0;return!1},isDigit(e){const t=e.charCodeAt(0);return t>=48&&t<=57},isEqual:Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t},isEmpty(e){return!e||(this.isArray(e)?0===e.length:!!this.isObject(e)&&0===Object.keys(e).length)},forEach(e,t,s){for(let i=0;i<e.length&&!1!==t.call(s,e[i],i,e);i++);},hasAlpha(e){if(!e)return!1;for(let t=0;t<e.length;t++)if(this.isAlpha(e.charAt(t)))return!0;return!1},hasDigit(e){if(!e)return!1;for(let t=0;t<e.length;t++)if(this.isDigit(e.charAt(t)))return!0;return!1},getEmoji(e){let t=i.default.exec(e);const s=[];for(;t;)s.push({value:t[0],index:t.index}),t=i.default.exec(e);return s},hasEmojiOnly(e){const t=this.getEmoji(e).reduce((e,{value:t})=>e+t.length,0);return t>0&&e.replace(/\s/g,"").length===t},getEmojiCodes(e){let t,s=0;const i=e.length,n=[];for(;s<i;){let i=e.charCodeAt(s++);i>=55296&&i<=56319?t=i:(t&&(i=i-56320+(t-55296<<10)+65536,t=0),n.push(i.toString(16)))}return n},getValueTokens(e,t){return this.trim(e).split(/\s+/,t)},hasAlphaOrDigit(e){return this.hasAlpha(e)||this.hasDigit(e)},getStyle(e,t){const s=window.getComputedStyle(e,null)||e.style;return t?s[t]:s},setStyles(e,t){for(const s in t)t.hasOwnProperty(s)&&(e.style[s]=t[s])},throttle(e,t){let s=!0;const i=this.isNumber(t)?t:50;return function(){s&&(e.apply(this,arguments),s=!1,setTimeout((function(){s=!0}),i))}},throttleWithCallGuarantee(e,t=50){let s,i;return(...n)=>{const o=this.now();clearTimeout(i),!s||o-s>=t?(s=o,e(...n)):i=setTimeout(()=>{s=this.now(),e(...n)},t-o+s)}},debounce(e,t=50){let s;const i=this.isNumber(t)?t:50,n=function(){const t=this,n=arguments;return clearTimeout(s),s=setTimeout((function(){e.apply(t,n)}),i),this};return n.callNow=function(){return clearTimeout(s),e.apply(this,arguments),this},n},hasClass:S?function(e,t){return e.classList&&e.classList.contains(t)}:function(e,t){const s=e.getAttributeNS(null,"class");return!!s&&(" "+s+" ").replace(/\s+/g," ").indexOf(" "+t+" ")>=0},saveFile(e,t,s){if(navigator.msSaveBlob)return navigator.msSaveBlob(new Blob([s],{type:t}),e);const i="data:"+t+";charset="+(document.charset||document.characterSet)+","+encodeURIComponent(s);return this.downloadFile(i,e)},copyText:window.clipboardData?function(e){return window.clipboardData.setData("Text",e)}:function(e){let t=!1;if(!document.queryCommandSupported||!document.queryCommandSupported("copy"))return!1;const s=document.createElement("textarea");s.value=e,s.setAttribute("readonly",""),s.style.position="fixed",document.body.appendChild(s),s.setSelectionRange(0,s.value.length),s.focus();try{t=document.execCommand("copy")}catch(e){}return s.blur(),document.body.removeChild(s),t},isRTLLang(e){return this.hasProperty(p,e)},hasCtrlKey:e=>Boolean(e.metaKey||e.ctrlKey),escapeHTML:e=>String(e).replace(/[&<>"']/g,e=>_[e]),unescapeHTML(e){return this._unescapeTextarea=this._unescapeTextarea||document.createElement("textarea"),this._unescapeTextarea.innerHTML=e,0===this._unescapeTextarea.childNodes.length?"":this._unescapeTextarea.childNodes[0].nodeValue},generateId:(e="")=>e+ ++u,hasProperty(e,t){return this.isObject(e)&&Object.prototype.hasOwnProperty.call(e,t)},parseString:(e,...t)=>e?e.replace(/{([0-9]+)}/g,(function(e,s){return t[s]})):"",activateClass(e,t,s){this.hasClass(e,t)!==Boolean(s)&&this.toggleClass(e,t)},toggleClass:S?function(e,t){return e.classList&&e.classList.toggle(t)}:function(e,t){const s=this.hasClass(e,t);let i=e.getAttributeNS(null,"class")||"";return s?i=(" "+i+" ").replace(/\s+/g," ").replace(" "+t+" "," "):i+=" "+t,e.setAttributeNS(null,"class",this.trim(i)),!s},createEvent(e,t,s){let i;try{i=new Event(e,{bubbles:t,cancelable:s})}catch(n){i=document.createEvent("Event"),i.initEvent(e,t,s)}return i},preventEvent(e){e.cancelable&&e.preventDefault()},shuffleArray(e){let t=e.length;for(;t;){const s=Math.floor(Math.random()*t--),i=e[t];e[t]=e[s],e[s]=i}return e},downloadFile(e,t){const s=document.createElement("a");return s.href=e,"download"in s?s.download=t:s.target="_blank",s.dispatchEvent(new window.MouseEvent("click"))},truncateText(e,t){let s=0;if(e.length<=t)return e;const i=e.slice(0,t);let n=E[s++];for(;n;){if(n.test(i))return i.split(n).slice(0,-1).join("");n=E[s++]}return e},startsWith:String.prototype.startsWith?function(e,t,s=0){return e.startsWith(t,s)}:function(e,t,s){return e.indexOf(t,s)===s},endsWith:String.prototype.endsWith?function(e,t,s){return e.endsWith(t,s)}:function(e,t,s){let i=s;return(void 0===i||i>e.length)&&(i=e.length),e.substring(i-t.length,i)===t},escapeRegExp:e=>String(e).replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),dataURLToBlob(e){const t=e.slice(5).split(",");t[0]=t[0].split(";");const s=t[0][0]||"text/plain",i="base64"===t[0][1]?window.atob(t[1]):t[1],n=i.length,o=new Uint8Array(n);for(let e=0;e<n;e++)o[e]=i.charCodeAt(e);return new Blob([o.buffer],{type:s})},selectElement(e){const t=document.createRange(),s=window.getSelection();return s.rangeCount&&s.removeAllRanges(),t.selectNodeContents(e),s.addRange(t),s},isAlphaOrDigit(e){return this.isAlpha(e)||this.isDigit(e)},isString:e=>"string"==typeof e,isNumber:e=>"number"==typeof e&&window.isFinite(e),isObject:e=>"object"==typeof e&&null!==e,isArray:Array.isArray,isNonEmptyArray(e){return this.isArray(e)&&e.length>0},isFunction:e=>"function"==typeof e,isNullOrUndefined:e=>null==e,toQueryString(e,t){const s=this;return e?Object.keys(e).reduce((function(t,i){let n=e[i];s.isArray(n)||(n=[n]);const o=s.encodeURIComponent(i);return t.concat(n.map((function(e){return s.isNullOrUndefined(e)?o:o+"="+s.encodeURIComponent(e)})))}),[]).join(t||"&"):""},encodeURIComponent(e){try{return window.encodeURIComponent(e)}catch(t){return(0,a.logError)(t,{message:"value="+e,ignoreErrorMessage:!1}),""}},wrapCanvasText({context:e,text:t,x:s,y:i,maxWidth:n,lineHeight:o}){const r=t.split("\n"),a=s;let l=i;for(let t=0;t<r.length;t++){const s=r[t].indexOf(" ")<0?"":" ",i=r[t].split(s);let c=i[0];for(let t=1;t<i.length;t++){const r=c+s+i[t];e.measureText(r).width>n?(e.fillText(c,a,l),c=i[t],l+=o):c=r}e.fillText(c,a,l),l+=o}},copySupported:"clipboardData"in window||function(e){const t=e.match(/(opr|edge)\/(\d+)/)||e.match(/(chrome|firefox)\/(\d+)/)||e.match(/(version)\/(\d+).+?safari/);if(t)switch(t[2]=Number(t[2]),t[1]){case"opr":return t[2]>=29;case"edge":return t[2]>=12;case"chrome":return t[2]>=43;case"firefox":return t[2]>=41;case"version":return t[2]>=10}return!1}(g),fromQueryString(e){const t={};if(!e)return t;const s=e.split("&");for(let e=0;e<s.length;e++){const i=s[e].replace(/\+/g," ").split("=");try{t[window.decodeURIComponent(i[0])]=window.decodeURIComponent(i[1])}catch(e){}}return t},prepareCSVValue:e=>'"'+e.replace(/"/g,'""')+'"',normalizeUrl:e=>(y.href=e||"",y.href),isCrossOriginUrl(e){return this.normalizeUrl(e).indexOf(window.location.protocol+"//"+window.location.host)<0},isSecureUrl(e){return"https://"===this.normalizeUrl(e).substr(0,8)},isYandexUrl(e){const t=this.normalizeUrl(e);return/.*(?:(?:\/\/)|(?:\.))yandex\.(?:com\.)?[a-z]{2,3}(?::\d+)?(?:\/.*)?$/.test(t)},setCookie(e,t,s){const i=new Date((new Date).getTime()+24*(s||100)*3600*1e3);document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+"; expires="+i.toUTCString()},getCookie(e,t=!1){let s=f.val;const i=(new Date).getTime();(t||!f.val||i-f.tm>100)&&(f.tm=i,s=f.val=document.cookie.split("; "));const n=encodeURIComponent(e);for(let e=0;e<s.length;++e){const t=s[e],i=t.indexOf("=");if(t.substr(0,i)===n)return decodeURIComponent(t.substr(i+1))}return null},getUserIdData(){const e={};for(const t in A){if(!A.hasOwnProperty(t))continue;const s=this.getCookie(t);if(s){e[A[t]]=s}}return e},isSelectedElement(e){const t=window.getSelection();if(t.isCollapsed)return!1;const s=document.createRange();s.selectNodeContents(e);for(let e=0;e<t.rangeCount;e++){const i=t.getRangeAt(e);if(i.compareBoundaryPoints(i.END_TO_START,s)<0&&i.compareBoundaryPoints(i.START_TO_END,s)>0)return!0}return!1},getImageOrientation(e){let t,s,i,n,o,r,a;const l=new Uint8Array(e);let c=1;if(255!==l[0]||216!==l[1])return c;i=2;const d=l.length;for(;i<d&&(255!==l[i]||218!==l[i+1]);){if(o=i+256*l[i+2]+l[i+3]+2,255===l[i]&&225===l[i+1]){for(n=l.subarray(i,o),r=77===n[10],a=r?256*n[18]+n[19]:n[18]+256*n[19],t=0;t<a;t++)if(s=n.subarray(20+12*t,32+12*t),r&&18===s[1]||!r&&18===s[0]){c=r?s[9]:s[8];break}break}i=o}return c},extractPastedText(e){const t=e.dataTransfer||e.clipboardData;return t?t.getData("text/plain"):window.clipboardData?window.clipboardData.getData("Text"):""},normalizeRangeBoundsForElement(e,t){t.contains(e.startContainer)||t.contains(e.startContainer.parentNode)||e.setStart(t,0),t.contains(e.endContainer)||t.contains(e.startContainer.parentNode)||e.setEnd(t,t.childNodes.length)},getClosest(e,t){let s=e;for(;s&&s.nodeType===Node.ELEMENT_NODE;){if(t(s))return s;s=s.parentElement}return null},safeParseJSON(e){try{return JSON.parse(e)||{}}catch(e){return{}}},safeStringifyJSON(e){try{return JSON.stringify(e)||""}catch(e){return""}},getEventPath(e){const t=e.path||e.composedPath&&e.composedPath(),s=[];let i=e.target;if(this.isNonEmptyArray(t))return t.slice().reverse();for(;i&&i.parentElement&&"HTML"!==i.tagName;i=i.parentElement)s.push(i);return s.push(i),s.push(document),s.push(window),s.reverse()},getSelectedText(){const e=window.getSelection&&window.getSelection();return e&&e.toString&&e.toString()||""},getSelectedElement:()=>((window.getSelection()||{}).anchorNode||{}).parentNode||null,isEqualDeep(e,t){const s=Object.keys(e),i=Object.keys(t),n=Object.prototype.hasOwnProperty;if(s.length!==i.length)return!1;for(let i,o=0,r=s.length;o<r;o++)if(i=Object.keys(e)[o],n.call(e,i)&&!this.isEqual(e[i],t[i]))return!1;return!0},convertBase64ToArrayBuffer(e){const t=window.atob(e),s=t.length,i=new Uint8Array(s);for(let e=0;e<s;e++)i[e]=t.charCodeAt(e);return i.buffer},getMutableBoundingClientRect(e){const{top:t,right:s,bottom:i,left:n,width:o,height:r,x:a,y:l}=e.getBoundingClientRect();return{top:t,right:s,bottom:i,left:n,width:o,height:r,x:a,y:l}},getFilesFromEvent:e=>(e.dataTransfer?e.dataTransfer.files:e.target.files)||[],getFileName(e){const t=this.getFilesFromEvent(e)[0];return t?t.name:""},getDataAttr:(e,t)=>e&&e.nodeType===Node.ELEMENT_NODE?e.getAttribute("data-"+t):null,getAttribute:(e,t,s="")=>e&&e.getAttribute?e.getAttribute(t)||s:s||null,asyncFilter(e,t,s=(()=>{})){const i=[...e],n=[],o=()=>{if(!i.length)return s(n);const e=i.shift();t(e,t=>{t&&n.push(e),o()})};o()},isElement:e=>e instanceof Element||e instanceof HTMLDocument,elementToString(e,t=50,s=null){if(!e||!v.isElement(e))return null;let i="<"+e.tagName.toLowerCase();if(e.attributes)for(let n=0;n<e.attributes.length;n++){const o=e.attributes[n];s&&!s.includes(o.name)||(i+=` ${o.name}='${String(o.value).slice(0,t)}'`)}return i+">"},round:(e,t=10)=>v.isNumber(e)?Math.round(e/t)*t:null,base64ToDataUrl:(e,t)=>`data:${t};base64,${e}`,isOnline:()=>void 0===navigator.onLine||navigator.onLine,guid:(e="xxxx-xxxx-xxxx-xxxx")=>e.replace(/[xy]/g,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),now:()=>Date.now?Date.now():(new Date).getTime(),bindInit:e=>function(){const t=v.now();try{return v.queueTask(e.bind(this,...arguments)),this}catch(e){return(0,a.logError)(e),this}finally{r.DEBUG&&r.logTime.module(e.name,v.now()-t)}},queueTask(e,t=null){if(window.config.SRV!==c.TOUCH||!window.config.ENABLE_ASYNC_QUEUE)return e.call(t);(0,l.pushTask)({fn:e,ctx:t||this})},callAsync(e,t){(0,l.pushTask)({fn:e,ctx:t||this})},calcMedian(e){if(!e.length)return null;e.sort((e,t)=>e-t);const t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2},imageDataColorToString:({r:e,g:t,b:s,a:i})=>`rgba(${e}, ${t}, ${s}, ${255/i})`,smoothScrollTo(e,t,s=0){e.scrollTo?e.scrollTo({top:t,left:s,behavior:"smooth"}):"scrollTop"in e&&(e.scrollTop=t,e.scrollLeft=s)},preferDarkMode:()=>window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,preferLightMode:()=>window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches,hasCssVarsSupport:()=>window.CSS&&CSS.supports("color","var(--fake-var)"),onThemePreferenceChange(e){const t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)");t&&(t.onchange=e)},normalizeExternalLang(e,t){const s=t.langMismatches||{};return this.hasProperty(s,e)?s[e]:e},get(e,t,s){const i=t.split(".");if(!i.length)return s;let n=e;for(const e of i){if("object"!=typeof n||null===n)return s;n=n[e]}return void 0===n?s:n},removeAllSelections(){try{window.getSelection().removeAllRanges()}catch(e){}},performanceApiSupported:()=>Boolean(window.performance&&window.performance.timing),isIntersectionObserverSupported:()=>"IntersectionObserver"in window,getTapPoint(e){const t=e.changedTouches;return{x:t?t[0].pageX:e.pageX,y:t?t[0].pageY:e.pageY}},getRandomBoolean:()=>Math.random()>=.5,memoize(e){const t={};return function(...s){const i=JSON.stringify(s);return i in t?t[i]:t[i]=e.apply(this,s)}}};var L;function R(e,t,s){const i=Boolean(t);return e in{scroll:!0}&&s&&C?{passive:s,capture:i}:i}window.util=v;var P=v;t.default=P},function(e,t,s){for(var i=s(75),n=s(53),o=s(40),r=s(12),a=s(13),l=s(38),c=s(20),d=c("iterator"),u=c("toStringTag"),h=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},g=n(p),m=0;m<g.length;m++){var E,_=g[m],T=p[_],f=r[_],S=f&&f.prototype;if(S&&(S[d]||a(S,d,h),S[u]||a(S,u,_),l[_]=h,T))for(E in i)S[E]||o(S,E,i[E],!0)}},function(e,t,s){"use strict";t.__esModule=!0,t.TouchView=t.TOUCH_VIEW_EVENTS=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(10),r=s(15);const a={TAP:"tap",TOUCH_START:"touchstart",SELECT:"select"};t.TOUCH_VIEW_EVENTS=a;class l extends r.View{static getPoint(e){return{x:e.pageX,y:e.pageY}}static getPoints(e){return e.touches&&!n.default.isEmpty(e.touches)?Array.prototype.map.call(e.touches,this.getPoint):[this.getPoint(e)]}static getMidpoint(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}static getDistance(e,t){const s=Math.abs(t.x-e.x),i=Math.abs(t.y-e.y);return Math.sqrt(s*s+i*i)}constructor(e={}){let t,s;if(super(e),this.resetCount(),this._tapThreshold=Number(e.tapThreshold)||10,this._ignoreSelection=Boolean(e.ignoreSelection),e.stopDefaultAction&&this.on(l.eventTypes.START,n.default.preventEvent).on(l.eventTypes.END,n.default.preventEvent),e.hideAfterTransition&&this.on("stateSet:hidden",(function(e){e||(this.setState("hidden2",!1),this.getElement().offsetWidth)})).on(l.eventTypes.TRANSITION_END,(function(e){"visibility"===e.propertyName&&e.target===e.currentTarget&&(this.isVisible()?this.setState("transitionEnded",!0):(this.setState("transitionEnded",!1),this.setState("hidden2",!0)))})).bindDOMEvents(l.eventTypes.TRANSITION_END),this.hasState("animatable")&&!e.skipWillChange&&this.onVisibilityChanged((function(){this.setState("animation_in_progress",!0)})).on(l.eventTypes.TRANSITION_END,(function(e){"transform"===e.propertyName&&e.target===e.currentTarget&&this.setState("animation_in_progress",!1)})).bindDOMEvents(l.eventTypes.TRANSITION_END),this.on(l.eventTypes.START,(function(e){const t=e.touches;"button"in e&&0!==e.button||(this._pointCount=Math.min(t?t.length:this._pointCount+1,l.maxPointCount[t?"touch":e.pointType||"mouse"]),this._tapPoint=1!==this._pointCount?null:l.getPoints(e)[0])})).on(l.eventTypes.END,(function(e){const t=e.touches,s=this._tapPoint,i=e.changedTouches;if("button"in e&&0!==e.button)return;if(this._pointCount=t?t.length:Math.max(0,this._pointCount-1),!s)return;const o=i?i[0].pageX:e.pageX,r=i?i[0].pageY:e.pageY;this.isEnabled()&&Math.abs(o-s.x)<=this._tapThreshold&&Math.abs(r-s.y)<=this._tapThreshold&&(this._ignoreSelection||!n.default.isSelectedElement(this.getElement()))&&this.emit(a.TAP,e),this._tapPoint=null})).on(l.eventTypes.CANCEL,this.resetCount).bindDOMEvents([l.eventTypes.END,l.eventTypes.START,l.eventTypes.CANCEL]),e.activateFocus){let t=!1;this.on(l.eventTypes.START,(function(s){t=!e.ignorePreventFocus&&n.default.getClosest(s.target,e=>e.hasAttribute("data-prevent-focus"))})).on("focus",(function(e){t?e.preventDefault():this.setFocus(!0).setState("focused",!0)})).on("blur",(function(){const e=this,t=this.getElement();setTimeout((function(){(document.hasFocus&&!document.hasFocus()||!t.contains(document.activeElement))&&e.setState("focused",!1)}),0),this.setFocus(!1)})).bindDOMEvents("focus blur",!0)}e.delegateActiveState&&(s=function(){t&&(t.setAttribute("data-pressed",!1),t=null)},this.on(l.eventTypes.START,(function(e){let i=e.target;s(),i=this.getClosest(i,(function(e){return e.hasAttribute("data-active-target")})),i&&(t=i,t.setAttribute("data-pressed",!0))})).on(l.eventTypes.END,s).on(l.eventTypes.CANCEL,s))}setFocus(e){return(0,o.getGlobalEmitter)().emit("viewFocusChanged",this,e),this.getContentElement()[e?"focus":"blur"](),this}setTooltipText(e){return this.getElement().setAttribute("data-tooltip",e),this}setTooltipPosition(e){return this.getElement().setAttribute("data-tooltip-position",e),this}scrollTo(e,t){const s=this.getContentElement(),i="rtl"===n.default.getStyle(s,"direction")?s.scrollWidth:0;return this.userScroll=!1,s.scrollTop=n.default.isNumber(e)?e:0,s.scrollLeft=n.default.isNumber(t)?t:i,this}resetCount(){return this._tapPoint=null,this._pointCount=0,this}getClosest(e,t,s){const i=s?this.getContentElement():this.getElement();return i.contains(e)&&e!==i?n.default.getClosest(e,t):null}setLanguage(e){return this.setState("right",n.default.isRTLLang(e)),this.getElement().setAttribute("lang",e),this}getScrollInfo(){const e=this.getContentElement();return{top:e.scrollTop,left:e.scrollLeft,maxTop:e.scrollHeight-e.clientHeight,maxLeft:e.scrollWidth-e.clientWidth,clientHeight:e.clientHeight,clientWidth:e.clientWidth}}onTap(e){return this.on(a.TAP,e)}onTouchStart(e){return this.on(a.TOUCH_START,e)}}t.TouchView=l,l.eventTypes={END:"mouseup",OUT:"mouseout",OVER:"mouseover",MOVE:"mousemove",START:"mousedown",WHEEL:"wheel",CANCEL:"mouseleave",TRANSITION_END:"WebkitTransition"in document.documentElement.style?"webkitTransitionEnd":"transitionend"},l.maxPointCount={pen:1,mouse:1,touch:10},"ontouchstart"in window&&(n.default.mob||n.default.iOS||n.default.android)?l.eventTypes={END:"touchend",MOVE:"touchmove",START:"touchstart",CANCEL:"touchcancel"}:!window.PointerEvent||"pointerEnabled"in navigator&&!navigator.pointerEnabled||(l.eventTypes={END:"pointerup",OUT:"pointerout",OVER:"pointerover",MOVE:"pointermove",START:"pointerdown",CANCEL:"pointercancel"})},function(e,t,s){"use strict";t.__esModule=!0,t.$tracker=void 0,t.getTrackerByNamespace=function(e=null){l.has(e)||l.set(e,new o.Emitter);const t=l.get(e);return{$track(e,...s){try{t.emit(e,...s)}catch(e){(0,i.logError)(e)}},on:(e,s)=>t.on(e,s)}},s(1);var i=s(9),n=s(10),o=s(8);const r=(0,n.getGlobalEmitter)(),a={sendMetric(e,...t){try{r.emit("trackerEvent",e,...t)}catch(e){(0,i.logError)(e)}},onMetricSend:e=>r.on("trackerEvent",e)};t.$tracker=a;const l=new Map},function(e,t,s){"use strict";t.__esModule=!0,t.Model=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(8);const r="change",a="set",l="beforeSet",c="invalid";class d extends o.Emitter{static getCachedInstance(e,...t){return this._cachedInstances=this._cachedInstances||new Map,this._cachedInstances.has(e)||this._cachedInstances.set(e,new this(...t)),this._cachedInstances.get(e)}constructor(e,t={}){super(),this._id=t.id||n.default.generateId("mid"),this._props={},this._invalid=[],this._filters={},this._validators={},t.filters&&this.setFilter(t.filters),t.validators&&this.setValidator(t.validators),this.setProperty(n.default.extend(this.getDefaults(),e),t)}getId(){return this._id}clone(e){return new this.constructor(this._props,e)}clear(e){return this.setProperty(null,e)}reset(e){return this.setProperty(this.getDefaults(),e)}onChange(e,t,s){return this._addPrefixedHandler(r,e,t,s)}onSet(e,t,s){return this._addPrefixedHandler(a,e,t,s)}onBeforeSet(e,t,s){return this._addPrefixedHandler(l,e,t,s)}onInvalid(e,t,s){return this._addPrefixedHandler(c,e,t,s)}offChange(e,t,s){return this._removePrefixedHandler(r,e,t,s)}toJSON(){return n.default.clone(this._props)}cloneProps(){return n.default.clone(this._props)}getProps(){return this._props}isValid(e,t){let s={};const i=[];switch(arguments.length){case 0:s=this.cloneProps();break;case 1:s[e]=this.getProperty(e);break;default:s[e]=t}return Object.keys(s).forEach((function(e){const t=s[e],n=this._validators[e];n&&!n.call(this,t)&&i.push(e)}),this),this._invalid=i,!i.length}getInvalid(){return n.default.clone(this._invalid)}getParams(){return{sid:this._fetchedSid}}getDefaults(){return this.constructor.defaults?n.default.clone(this.constructor.defaults):{}}hasProperty(e){return n.default.hasProperty(this._props,e)}getProperty(e){return this._props[e]}toggleProperty(e){return this.setProperty(e,!this.getProperty(e))}setProperty(e,t,s){const i=this.cloneProps(),o=s||{};let d,u=t;if(null===e||n.default.isObject(e)){const t=u||{};return e?(Object.keys(e).forEach((function(s){this.setProperty(s,e[s],t)}),this),this):(Object.keys(i).forEach((function(e){this.setProperty(e,null,t)}),this),this)}if(this.emit(l,e,u,o).emit(`${l}:${e}`,u,o),n.default.isNullOrUndefined(u)){if(!this.hasProperty(e))return this;u=void 0,d=delete this._props[e]}else{const t=this._filters[e];t&&(u=t.call(this,u)),n.default.isEqual(i[e],u)||(d=!0,this._props[e]=u)}return o.ignoreSetEvent||this.emit(a,e,u,o).emit(`${a}:${e}`,u,o),d&&!o.silent&&(o.invalid=!this.isValid(e,u),o.oldValue=i[e],o.invalid&&this.emit(c,e,u,o).emit(`${c}:${e}`,u,o),this.emit(r,e,u,o).emit(`${r}:${e}`,u,o)),this}setFilter(e,t){return n.default.isObject(e)?(Object.keys(e).forEach((function(t){this.setFilter(t,e[t])}),this),this):null===e?(this._filters={},this):null===t?(delete this._filters[e],this):(e&&n.default.isFunction(t)&&(this._filters[e]=t),this)}setValidator(e,t){return n.default.isObject(e)?(Object.keys(e).forEach((function(t){this.setValidator(t,e[t])}),this),this):null===e?(this._validators={},this):null===t?(delete this._validators[e],this):(e&&n.default.isFunction(t)&&(this._validators[e]=t),this)}}t.Model=d,d.defaults={}},function(e,t,s){"use strict";t.__esModule=!0,t.AppModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(8);class r extends o.Emitter{constructor(e,t){super(),this.app=e,this.appModel=e.getModel(),this.appSettings=e.getSettings(),this.appView=e.getView(),this.appConfig=t,this.moduleId=n.default.generateId("mid")}}t.AppModule=r},function(e,t,s){"use strict";t.__esModule=!0,t.Component=void 0;var i=s(15),n=s(30),o=s(2);class r extends n.PureComponent{constructor(e,t={}){super(e,t),this._DOMEvents={},t.hideAfterTransition&&this.onStateSet("hidden",e=>{e?t.skipFadeoutTransition&&this.setState("hidden2",!0):(this.setState("hidden2",!1),this.getElement().offsetWidth)}).on(o.TouchView.eventTypes.TRANSITION_END,e=>{"visibility"!==e.propertyName||e.target!==e.currentTarget||this.isVisible()||this.setState("hidden2",!0)}).bindDOMEvents(o.TouchView.eventTypes.TRANSITION_END)}getRect(){return i.View.prototype.getRect.apply(this)}hasState(e){return i.View.prototype.hasState.apply(this,arguments)}setState(e,t){return i.View.prototype.setState.apply(this,arguments)}setStyle(e,t){return i.View.prototype.setStyle.apply(this,arguments)}isVisible(){return i.View.prototype.isVisible.apply(this)}isEnabled(){return i.View.prototype.isEnabled.apply(this)}getElement(){return this.getContainer()}getContentElement(e,t){return i.View.prototype.getContentElement.apply(this,arguments)}setPosition(e,t,s){return i.View.prototype.setPosition.apply(this,arguments)}setVisible(e){return i.View.prototype.setVisible.apply(this,arguments)}setEnabled(e){return i.View.prototype.setEnabled.apply(this,arguments)}onShow(e,t){return i.View.prototype.onShow.apply(this,arguments)}onHide(e,t){return i.View.prototype.onHide.apply(this,arguments)}onVisibilityChanged(e,t){return i.View.prototype.onVisibilityChanged.apply(this,arguments)}onEnableChanged(e,t){return i.View.prototype.onEnableChanged.apply(this,arguments)}onStateSet(e,t,s){return i.View.prototype.onStateSet.apply(this,arguments)}onStateChanged(e,t,s){return i.View.prototype.onStateChanged.apply(this,arguments)}handleEvent(e){return i.View.prototype.handleEvent.apply(this,arguments)}bindDOMEvents(e,t){return i.View.prototype.bindDOMEvents.apply(this,arguments)}}t.Component=r},function(e,t,s){"use strict";t.__esModule=!0,t.LANG_PROPS=t.LANG_METRIKAS=t.LANG_EVENTS=t.COMPONENT_EVENTS=void 0;t.LANG_EVENTS={EVENT_OPEN_SRC_LANGUAGES:"openSrcLanguages",EVENT_OPEN_DST_LANGUAGES:"openDstLanguages",EVENT_BACK_PRESSED:"langsBackPressed",EVENT_INPUT:"langsInput",EVENT_SWAP:"swapLang",EVENT_CANCEL_SEARCH:"cancelSearch",EVENT_SEARCH_TAP:"langsSearchTap",EVENT_SELECT_LANG:"selectLang",EVENT_SELECT_LANG_FROM_SEARCH:"langsSearchSelectLang"};t.LANG_METRIKAS={OPEN_SRC_SELECT:"langselect_open_src",OPEN_DST_SELECT:"langselect_open_dst",SELECT_SRC_LANG:"langselect_select_src",SELECT_DST_LANG:"langselect_select_dst",PIN_LANG:"langselect_pin",UNPIN_LANG:"langselect_unpin",SEARCH_TEXT_TYPE:"langselect_search_type",SEARCH_BUTTON_TAP:"langselect_search_button_click",TOGGLE_AUTODETECT:"settings_auto_click"};t.LANG_PROPS={ALL_LANGUAGES:"languages",CURRENT_LANG:"currentLanguage",AUTODETECT:"autodetect",RECENT_LANGUAGES:"recent_languages",SRC_LANG:"srcLang",DST_LANG:"dstLang",SENDER_LANG_SELECT:"langSelect",SENDER_LANG_HISTORY:"langHistory"};t.COMPONENT_EVENTS={EVENT_INPUT:"event_input",EVENT_LANG_CHOOSE:"event_lang_choose"}},function(e,t,s){"use strict";t.__esModule=!0,t.Emitter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i};const o="action";t.Emitter=class{constructor(){this._handlers={}}on(e,t,s){const i=this._handlers;return n.default.isFunction(e)?this.on("*",e):n.default.isArray(e)?(e.forEach(e=>{const i=t.bind(s||this,e);i.sourceHandler=t,this.on(e,i,s)}),this):n.default.isObject(e)?(Object.keys(e).forEach(s=>{this.on(s,e[s],t)}),this):e&&n.default.isFunction(t)?((i[e]=i[e]||[]).push({handler:t,context:s}),this):this}off(e,t,s){const i=arguments.length,o=this._handlers[e];if(!i)return this._handlers={},this;if(n.default.isFunction(e))return this.off("*",e);if(n.default.isArray(e))return e.forEach(e=>{this.off(e,t,s)}),this;if(n.default.isObject(e))return Object.keys(e).forEach(s=>{this.off(s,e[s],t)}),this;if(!o)return this;if(1===i)return delete this._handlers[e],this;for(let e=0;e<o.length;e++){const i=o[e];if(i.context===s&&(i.handler===t||i.handler.sourceHandler===t)){o.splice(e,1);break}}return this}once(e,t,s){const i=this;if(n.default.isFunction(e))return this.once("*",e);if(n.default.isObject(e))return Object.keys(e).forEach((function(s){this.once(s,e[s],t)}),this),this;if(!e||!n.default.isFunction(t))return this;const o=function(){i.off(e,o,s),t.apply(this,arguments)};return o.sourceHandler=t,this.on(e,o,s)}emit(e){const t=n.default.slice(arguments,1);let s=this._handlers[e],i=this._handlers["*"];if(n.default.isObject(e))return Object.keys(e).forEach((function(t){this.emit(t,e[t])}),this),this;if("*"!==e&&s){s=n.default.slice(s);for(let e=0;e<s.length;e++){const i=s[e];i.handler.apply(i.context||this,t)}}if(i){i=n.default.slice(i);for(let e=0;e<i.length;e++){const t=i[e];t.handler.apply(t.context||this,arguments)}}return this}prefixedEmit(e,t,...s){return this.emit(e,t,...s),this.emit(`${e}:${t}`,...s)}onAction(e,t,s){return this._addPrefixedHandler(o,e,t,s)}debounceMethod(e,t=0){return n.default.debounce(e.bind(this),t)}_addPrefixedHandler(e,t,s,i){return n.default.isArray(t)?(t.forEach(t=>{const n=s.bind(i||this,t);n.sourceHandler=s,this.on(`${e}:${t}`,n,i)}),this):n.default.isObject(t)?(Object.keys(t).forEach(i=>{this.on(`${e}:${i}`,t[i],s)}),this):n.default.isFunction(t)?this.on(e,t,s):this.on(`${e}:${t}`,s,i)}_removePrefixedHandler(e,t,s,i){return n.default.isFunction(t)?this.off(e,t,s):this.off(`${e}:${t}`,s,i)}}},function(e,t,s){"use strict";t.__esModule=!0,t.LATEST_TAP_POSITION_WINDOW_KEY=t.LATEST_TAP_EVENT_WINDOW_KEY=void 0,t.getLatestTapEvent=r,t.getLatestTapPosition=a,t.isPrevTapMiss=function(){const e=r(),t=a();return e&&t&&e.prevTarget&&e.target!==e.prevTarget&&e.delayBetweenTaps<700&&t.distanceBetweenTaps<60},t.logError=function(e,t={}){const s=window.Ya&&window.Ya.Rum;o.DEBUG&&console.error(e);if(s&&s.logError)try{let i=e;return e instanceof Error&&(i=e.message),s.logError(t,i)}catch(e){}e&&setTimeout(()=>{throw e},0)},t.setLatestTapEvent=function(e,t,s){const i=Date.now(),o=r(),l=a(),c=o&&o.ts?i-o.ts:null,d={pageX:e.pageX,pageY:e.pageY,distanceBetweenTaps:null},u={eventType:e.type,pageX:null,pageY:null,ts:i,delay:null,target:n.default.elementToString(t,15,["id","class","data-action"]),action:n.default.getDataAttr(s,"action"),prevTarget:o&&o.target,prevAction:o&&o.action,delayBetweenTaps:n.default.round(c,c>100?100:10)};!d.pageX&&!d.pageY&&e.changedTouches&&e.changedTouches.length&&(d.pageX=e.changedTouches[0].pageX,d.pageY=e.changedTouches[0].pageY);u.pageX=n.default.round(d.pageX),u.pageY=n.default.round(d.pageY),l&&(d.distanceBetweenTaps=(h=d,p=l,Math.abs(h.pageX-p.pageX)+Math.abs(h.pageY-p.pageY)));var h,p;window._rumLatestTapEvent=u,window._rumLatestTapPosition=d};var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(14);t.LATEST_TAP_EVENT_WINDOW_KEY="_rumLatestTapEvent";t.LATEST_TAP_POSITION_WINDOW_KEY="_rumLatestTapPosition";function r(){return window._rumLatestTapEvent}function a(){return window._rumLatestTapPosition}},function(e,t,s){"use strict";t.__esModule=!0,t.getGlobalEmitter=function(){null===n&&(n=new i.Emitter);return n};var i=s(8);let n=null},function(e,t,s){"use strict";t.__esModule=!0,t.KEYBOARD_KEYS=t.InputView=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(2);const r={A:65,D:68,E:69,UP:38,DOWN:40,LEFT:37,RIGHT:39,ENTER:13,ESCAPE:27,SPACE:32,TAB:9,BACKSPACE:8};t.KEYBOARD_KEYS=r;const a=function(){const e=document.createElement("div");try{return e.contentEditable="plaintext-only",!0}catch(e){}return!1}();class l extends o.TouchView{static makeFakeArea(e){return n.default.bind(e,"drop",(function(e){this.disabled||(this.focus(),n.default.preventEvent(e))})),n.default.bind(e,"paste",(function(e){this.disabled||(n.default.preventEvent(e),this._insertSelectionText(n.default.extractPastedText(e)))})),n.default.bind(e,"blur",(function(){this.disabled||(this.selectionRange=this.getSelectionRange())})),n.default.bind(e,"focus",(function(){this.disabled||this.selectionRange&&this.selectionRange.start!==this.selectionRange.end&&this.setSelectionRange(this.selectionRange.start,this.selectionRange.end)})),n.default.bind(e,"mouseup",(function(){this.disabled||this._triggerSelectEvent()})),n.default.bind(e,"keydown",(function(e){this.disabled||(e.keyCode!==r.ENTER||e.shiftKey?e.keyCode===r.A&&n.default.hasCtrlKey(e)?(n.default.preventEvent(e),this.setSelectionRange(0,this.value.length),this._triggerSelectEvent()):l.hasKeyCombination(e,r.E,{shiftKey:!0,ctrlKey:!0})&&(n.default.preventEvent(e),this.setSelectionRange(this.getSelectionRange().start,this.value.length),this._triggerSelectEvent()):this.dispatchEvent(n.default.createEvent("enterPressed",!0,!0)))})),n.default.bind(e,"keyup",(function(e){this.disabled||(l.hasKeyCombination(e,r.LEFT,{shiftKey:!0})||l.hasKeyCombination(e,r.RIGHT,{shiftKey:!0}))&&this._triggerSelectEvent()})),n.default.bind(e,"mousedown",(function(){this.disabled||(this._selectionStarted=!0)})),n.default.bind(e,"mouseleave",(function(){this.disabled||this._selectionStarted&&this._triggerSelectEvent()})),e._triggerSelectEvent=function(){const e=this.getSelectionRange();e.start!==e.end&&this.dispatchEvent(n.default.createEvent(o.TOUCH_VIEW_EVENTS.SELECT,!0,!0)),this._selectionStarted=!1},e._insertSelectionText=function(e){const t=window.getSelection();if(0===t.rangeCount)return;const s=t.getRangeAt(0);n.default.normalizeRangeBoundsForElement(s,this),s.deleteContents(),s.insertNode(document.createTextNode(e)),s.collapse(!1),this.dispatchEvent(n.default.createEvent("input",!0,!0))},n.default.IE&&n.default.bind(e,"DOMSubtreeModified",(function(){this.disabled||this.dispatchEvent(n.default.createEvent("input",!0,!0))})),n.default.bind(e,"keypress",(function(){this.disabled||this.dispatchEvent(n.default.createEvent("input",!0,!0))})),e.getRangeData=function(e){let t=e,s=this,i=0;const n=document.createTreeWalker(this,NodeFilter.SHOW_TEXT,null,!1);for(;n.nextNode()&&(s=n.currentNode,i=s.length,t>i);)t-=i;return{node:s,offset:t}},e.getInnerText=function(){let e,t="";const s=document.createTreeWalker(this,NodeFilter.SHOW_TEXT,null,!1);for(;s.nextNode();)e=s.currentNode,t+=e.data;return t},e.getSelectionRange=function(){let e,t;const s={end:0,start:0},i=window.getSelection();return i.rangeCount>0&&(t=i.getRangeAt(0),e=t.cloneRange(),e.selectNodeContents(this),e.setEnd(t.endContainer,t.endOffset),s.end=e.toString().length,e.setEnd(t.startContainer,t.startOffset),s.start=e.toString().length),s},e.setSelectionRange=function(e,t){let s=e,i=t;const o=document.createRange(),r=window.getSelection(),a=this.value.length;i<0&&(i=0),s<0&&(s=0),i>a&&(i=a),s>a&&(s=a),s>i&&(s=i);let l=this.getRangeData(i);return o.setEnd(l.node,l.offset),l=this.getRangeData(s),o.setStart(l.node,l.offset),n.default.removeAllSelections(),r.addRange(o),this},Object.defineProperty(e,"value",{get(){return this.getInnerText()},set(e){const t=e.length;this.textContent="",this.appendChild(document.createTextNode(e)),this.setSelectionRange(t,t)}}),Object.defineProperty(e,"disabled",{get(){return!this.isContentEditable},set(e){if(e)this.contentEditable=!1;else{const e=!a||"plaintext-only";this.contentEditable=e}}}),Object.defineProperty(e,"selectionEnd",{get(){return this.getSelectionRange().end},set(e){this.setSelectionRange(e,e)}}),Object.defineProperty(e,"selectionStart",{get(){return this.getSelectionRange().start},set(e){this.setSelectionRange(e,e)}}),e}static hasKeyCombination(e,t,s){let i,n=!0;const o=!t||e.keyCode===t;for(i in s)if(e[i]!==s[i]){n=!1;break}return e&&o&&n}constructor(e){super(e);const t=this,s=this.getContentElement();let i;s.disabled=this.hasState("disabled"),this.on("stateChanged:disabled",(function(e){s.disabled=e})),this.bindDOMEvents("input keydown"),this.on("keydown",this._bindSelectionCases),9===document.documentMode&&(i=function(){t.emit("input",{target:s})},this.on("stateChanged:focused",(function(e){document[(e?"add":"remove")+"EventListener"]("selectionchange",i,!1)})))}getName(){return this.getContentElement().name}getValue(){return this.getContentElement().value}setValue(e,t={}){const s=this.getContentElement(),i=this.getValue();if(e===i)return this;let o=t.end;const r=t.start;return n.default.isNumber(r)?(o=n.default.isNumber(o)?o:i.length,s.value=i.slice(0,r)+e+i.slice(o)):s.value=e,this.emit("input",{target:s,detail:t})}getSelection(){const e=this.getContentElement();return{end:e.selectionEnd,start:e.selectionStart}}setSelection(e={}){const t=this.getContentElement();return setTimeout((function(){t.focus(),t.setSelectionRange(e.start,e.end||e.start)}),0),this}setPlaceholder(e){return this.getContentElement().placeholder=e,this}onSelect(e){return this.on(o.TOUCH_VIEW_EVENTS.SELECT,e)}getScrollTop(){return this.getContentElement().scrollTop}_bindSelectionCases(e){(l.hasKeyCombination(e,r.UP,{shiftKey:!0})||l.hasKeyCombination(e,r.DOWN,{shiftKey:!0}))&&this.emit(o.TOUCH_VIEW_EVENTS.SELECT,e)}}t.InputView=l,l.keys=r,l.fakeAreaSupported=a},function(e,t){var s=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=s)},function(e,t,s){var i=s(35),n=s(51);e.exports=s(25)?function(e,t,s){return i.f(e,t,n(1,s))}:function(e,t,s){return e[t]=s,e}},function(e,t,s){"use strict";t.__esModule=!0,t.DEBUG=void 0,t.initDebugHelper=m,t.logTime=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(21);const r={debugEnabled:!1,visualLogEnabled:!1},a=window.config&&window.config.SRV===o.TOUCH,l=function(){try{const e=localStorage.getItem("debug_config"),t=e?JSON.parse(e):{};for(const e in r)t.hasOwnProperty(e)||(t[e]=r[e]);return t}catch(e){return console.error(e),r}}(),c=window.config&&window.config.DEBUG_SUPPORTED,d=c&&l.debugEnabled;function u(){const{debugEnabled:e,visualLogEnabled:t}=l,s=e?"color: #5c9b28":"color: #a43535",i="padding: 0 5px; font-family: monospace; background: rgba(100,100,100,.1);";let n=`Debug is %c${e?"enabled":"disabled"}%c. Type %c${e?"disableDebug()":"enableDebug()"}%c to ${e?"disable":"enable"} it`;if(a){n=`${n}. Or use %c${t?"?log=0":"?log=1"}%c to ${t?"disable":"enable"} visual log`,console.info(n,s,"",i,"",i,"")}else console.info(n,s,"",i,"")}function h(){localStorage.setItem("debug_config",JSON.stringify(l))}function p(e,t={}){console.info(e,t),a&&l.visualLogEnabled&&function(e,t={}){const s=(e,t=null)=>{const s=document.createElement("div");return s.classList.add(e),"string"==typeof t?s.appendChild(document.createTextNode(t)):Array.isArray(t)?t.forEach(e=>e&&s.appendChild(e)):t&&s.appendChild(t),s},i=(()=>{let e=document.getElementsByClassName("visual-log")[0];return e||(e=s("visual-log"),document.body.appendChild(e)),e})(),n=s("visual-log-item",[s("visual-log-item-message",e),s("visual-log-item-params",JSON.stringify(t))]);i.firstChild?i.insertBefore(n,i.firstChild):i.appendChild(n),setTimeout(()=>n.classList.add("visual-log-item_showed"),0),setTimeout(()=>{n.classList.add("visual-log-item_hidden"),setTimeout(()=>i.removeChild(n),400)},5e3)}(e,t)}function g(e){l.debugEnabled=e,window.debugEnabled=e,h(),u()}function m(){window.debugEnabled=l.debugEnabled,window.visualLogEnabled=l.visualLogEnabled,window.disableDebug=()=>g(!1),window.enableDebug=()=>g(!0),window.printDebug=p,a&&function(){let e=l.visualLogEnabled;const t=location.search.match(/[&?]log=(\d)/);t&&(e=Boolean(parseInt(t[1]))),l.visualLogEnabled!==e&&(l.visualLogEnabled=e,window.visualLogEnabled=e,h()),e&&!l.debugEnabled&&window.enableDebug()}(),u()}t.DEBUG=d;const E={},_={};function T(e,t,s){d&&(E[e]||(E[e]={}),E[e][t]=E[e][t]?E[e][t]+s:s,clearTimeout(_[e]),_[e]=setTimeout(()=>{const t=Object.entries(E[e]).sort(([,e],[,t])=>t-e);p(`Total ${e} time ${t.reduce((e,[,t])=>e+t,0)}ms`,Object.fromEntries(t)),E[e]={}},1e3))}const f={module(e,t){T("modules",e,t)},render(e,t){T("rendering",e,t)},metrics(e,t){T("metrics",e,t)}};t.logTime=f;(d||c)&&(m(),setTimeout(()=>(()=>{const e=document.querySelector(".YndxBug");if(!e)return;let t=!1;const s=getComputedStyle(e).bottom;document.addEventListener("touchstart",s=>{e.contains(s.target)&&(t=!0)}),document.addEventListener("touchend",()=>{t=!1}),document.addEventListener("touchmove",s=>{if(t){const{y:t}=n.default.getTapPoint(s),i=Math.min(t,document.body.clientHeight-41);e.style.top=i+"px",e.style.bottom="auto"}}),e.addEventListener("click",()=>{e.style.top="",e.style.bottom=s})})(),2e3))},function(e,t,s){"use strict";t.__esModule=!0,t.View=t.VIEW_STATES=t.VIEW_EVENTS=t.STATE_PREFIX=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(10),r=s(8);const a={CONTENT_CHANGED:"contentChanged",DESTROY:"destroy",STATE_SET:"stateSet",STATE_CHANGED:"stateChanged"};t.VIEW_EVENTS=a;const l={HIDDEN:"hidden",DISABLED:"disabled",EXTENDED:"extended",INVALID:"invalid",FOCUSED:"focused"};t.VIEW_STATES=l;t.STATE_PREFIX="state-";class c extends r.Emitter{constructor(e={}){super(e),this.on(a.CONTENT_CHANGED,(function(e){(0,o.getGlobalEmitter)().emit("viewContentChanged",this,e)})),this._DOMEvents={},this.setElement(e.element,e)}setPosition(e,t=!1,s=!1){let i=e.left,n=e.bottom,o=c.positions.BOTTOM;const r=this.getElement(),a=this.getRect(),l=document.documentElement.clientWidth;switch(r.getAttribute("data-align")){case"right":i=e.right-a.width;break;case"center":i=e.left+e.width/2-a.width/2;break;case"predictorRight":e.right+c.TR_PREDICTOR_GAP>l?o=c.positions.LEFT:i=e.right;break;case"top-left":i=e.left-a.width,n=e.bottom-a.height}if(t){const t=document.documentElement.clientHeight;a.width>l&&"left"===r.getAttribute("data-align")?i=r.getAttribute("data-offset")||0:i+a.width>l&&a.width<l&&(i-=i+a.width-l),t-e.bottom<a.height&&e.top>=a.height&&(o=c.positions.TOP,n=e.top-a.height)}return s&&(i+=document.documentElement.scrollLeft,n+=document.documentElement.scrollTop),r.style.top=n+"px",r.style.left=i+"px",r.setAttribute(c.POSITION_ATTR,o),this}getId(){return this._id}destroy(){const e=this._element;return e.parentNode&&e.parentNode.removeChild(e),this.setElement(null),this.emit(a.DESTROY).off()}getRect(){return this._element.getBoundingClientRect()}hasState(e){return n.default.hasClass(this._element,"state-"+e)}setState(e,t){if(n.default.isObject(e))return Object.keys(e).forEach((function(t){this.setState(t,e[t])}),this),this;if(!e)return this;const s=this.hasState(e),i=arguments.length<2?!s:Boolean(t);return i===s||(this.emit(a.STATE_SET,e,i).emit(`${a.STATE_SET}:${e}`,i),n.default.toggleClass(this._element,"state-"+e),this.emit(a.STATE_CHANGED,e,i).emit(`${a.STATE_CHANGED}:${e}`,i)),this}setStyle(e,t){if(n.default.isObject(e))for(const t in e)this._element.style[t]=e[t];else this._element.style[e]=t;return this}setLeftOffset(e){return this.setStyle("left",e+"px")}getOffset(){return this.getRect().left}isVisible(){return!this.hasState(l.HIDDEN)}isEnabled(){return!this.hasState(l.DISABLED)}isValid(){return!this.hasState(l.INVALID)}isFocused(){return this.hasState(l.FOCUSED)}getElement(){return this._element}setElement(e,t={}){let s=n.default.clone(this._DOMEvents);const i=e||document.createElement("div");return this.unbindDOMEvents(s),this._id=i.id||this._id||n.default.generateId("vid"),this._element=i,this._contentElement=t.contentElement||i,(t.rebind||(s=t.DOMEvents))&&this.bindDOMEvents(s),this}setContent(e,t={}){const s=this.getContentElement();return t.append||(s.innerHTML=""),t.asText?s.appendChild(document.createTextNode(e)):s.insertAdjacentHTML("beforeend",e),this.emit(a.CONTENT_CHANGED,e,t)}setVisible(e){const t=[l.HIDDEN];return arguments.length&&t.push(!e),this.setState.apply(this,t)}setEnabled(e){const t=[l.DISABLED];return arguments.length&&t.push(!e),this.setState.apply(this,t)}onShow(e,t){return this.onVisibilityChanged(s=>{s&&e.call(t||this)},t)}onHide(e,t){return this.onVisibilityChanged(s=>{s||e.call(t||this)},t)}onVisibilityChanged(e,t){return this.onStateChanged(l.HIDDEN,s=>{e.call(t||this,!s)},t)}onEnableChanged(e,t){return this.onStateChanged(l.DISABLED,s=>{e.call(t||this,!s)},t)}onStateSet(e,t,s){return this._addPrefixedHandler(a.STATE_SET,e,t,s)}onStateChanged(e,t,s){return this._addPrefixedHandler(a.STATE_CHANGED,e,t,s)}onContentChanged(e){return this.on(a.CONTENT_CHANGED,e)}handleEvent(e){this.emit(e.type,e)}bindDOMEvents(e,t){let s=e;const i=this._DOMEvents;if(!e)return this;if(n.default.isObject(s)&&!n.default.isArray(s))return Object.keys(s).forEach((function(e){this.bindDOMEvents(e,s[e])}),this),this;n.default.isString(s)&&(s=n.default.getValueTokens(s));for(let e=0;e<s.length;e++){const o=s[e];o&&!n.default.hasProperty(i,o)&&(i[o]=Boolean(t),n.default.bind(this._element,o,this,t))}return this}unbindDOMEvents(e){const t=this._DOMEvents;let s=e||t;n.default.isString(s)?s=n.default.getValueTokens(s):n.default.isObject(s)&&!n.default.isArray(s)&&(s=Object.keys(s));for(let e=0;e<s.length;e++){const i=s[e];n.default.hasProperty(t,i)&&(n.default.unbind(this._element,i,this,t[i]),delete t[i])}return this}getContentElement(e,t){let s=this._contentElement;return e&&(s=t?n.default.slice(s.querySelectorAll(e)):s.querySelector(e)),s}}t.View=c,c.POSITION_ATTR="data-position",c.TR_PREDICTOR_GAP=150,c.positions={TOP:"top",LEFT:"left",BOTTOM:"bottom"}},function(e,t,s){"use strict";t.__esModule=!0,t.getIcnHtml=n,t.icn=function(e,t=24){return(0,i.unsafeHTML)(n(e,t))};var i=s(67);function n(e,t=24){return`\n        <svg class="icn icn_${e}" width="${t}px" height="${t}px">\n            <use xlink:href="#icn-${e}"/>\n        </svg>\n    `}},function(e,t,s){"use strict";t.__esModule=!0,t.Presenter=void 0;var i=s(8),n=s(4),o=s(15);class r extends i.Emitter{constructor(e={}){super(),this._view=e.view||new o.View,this._model=e.model||new n.Model}toJSON(){return this._model.toJSON()}cloneProps(){return this._model.cloneProps()}getProps(){return this._model.getProps()}getView(){return this._view}getModel(){return this._model}prepareData(e){return e}}t.Presenter=r},function(e,t,s){"use strict";t.__esModule=!0,t.desktopLocales=void 0;const i=window.locales||{},n=Object.assign({...i},window.desktopLocales||{});t.desktopLocales=n},function(e,t,s){"use strict";t.__esModule=!0,t.HTTPRequest=void 0;var i=l(s(0)),n=s(8),o=s(65),r=s(28),a=l(s(57));function l(e){return e&&e.__esModule?e:{default:e}}s(101);class c extends n.Emitter{static get(e,t,s){const n=new this(e),o=i.default.isFunction(t)?null:t,r=i.default.isFunction(t)?t:s;return n.setParams(o),n.send(r)}static post(e,t,s){const n=new this(e),o=i.default.isFunction(t)?null:t,r=i.default.isFunction(t)?t:s;return n.setType(this.types.FORM).setData(o).setMethod(this.methods.POST),n.send(r)}static serializeData(e,t){switch(t){case c.types.JSON:return JSON.stringify(e);case c.types.FORM:return i.default.toQueryString(e);default:return e}}static createNativeRequest(e){return window.XDomainRequest&&i.default.isCrossOriginUrl(e)&&!("withCredentials"in window.XMLHttpRequest.prototype)?new window.XDomainRequest:new window.XMLHttpRequest}constructor(e){super();const t=this;if(!e)throw new Error("HTTPRequest: invalid url!");const s=c.createNativeRequest(e);s.onreadystatechange=function(){let e;if(t.isDone())if(clearTimeout(t._timer),t._aborted)t.emit("error",new r.HTTPError(t._timedout?r.HTTPError.TIMEOUT:r.HTTPError.ABORT));else{if(e=new o.HTTPResponse(this),e.requestTimestamp=t._timestamp,this.status>=c.codes.OK&&this.status<300)return t.emit("response",e);t.emit("error",e)}},this._xhr=s,this._url=e,this._data=null,this._params=this._getUserIdData(),this._method=c.methods.GET,this._headers={},this._timeout=1e4,this._timestamp=0,this._responseType=null}send(e){const t=this._xhr;let s=this._url;const n=this,o=c.serializeData(this._data,this.getType()),r=i.default.toQueryString(this._params),a=this._headers;return i.default.isFunction(e)&&this.on("error",(function(t){e(t)})).on("response",(function(t){e(null,t)})),r&&(s+=(s.indexOf("?")<0?"?":"&")+r),t.open(this._method,s),Object.keys(a).forEach((function(e){t.setRequestHeader(e,a[e])})),this._responseType&&(t.responseType=this._responseType),this._timeout&&(this._timer=setTimeout((function(){n._timedout=!0,n.abort()}),this._timeout)),this._timestamp=Date.now(),t.send(o),this}abort(){return this._aborted||this.isDone()?this:(this._aborted=!0,this._xhr.abort(),this.emit("abort"))}isDone(){return 4===this._xhr.readyState}getType(){return this.getHeader("Content-Type")}setType(e){return this.setHeader("Content-Type",e)}setCsrfToken(e){return this.setHeader("X-CSRF-Token",e)}setData(e){return this._data=e,this}setMethod(e){return this._method=e,this}setParams(e,t=!1){return this._params=i.default.extend({},e,t?null:this._getUserIdData()),this}getHeader(e){return this._headers[e]}setHeader(e,t){return this._headers[e]=t,this}setTimeout(e){return this._timeout=e,this}setResponseType(e){return this._responseType=e,this}_getUserIdData(){const e=this._url;return i.default.isYandexUrl(e)&&i.default.isSecureUrl(e)?i.default.getUserIdData():{}}}t.HTTPRequest=c,c.types=a.default,c.codes={OK:200,CREATED:201,ACCEPTED:202},c.errors={NOT_FOUND:404},c.methods={GET:"GET",POST:"POST",PUT:"PUT",DELETE:"DELETE"}},function(e,t,s){var i=s(32)("wks"),n=s(34),o=s(12).Symbol,r="function"==typeof o;(e.exports=function(e){return i[e]||(i[e]=r&&o[e]||(r?o:n)("Symbol."+e))}).store=i},function(e,t,s){"use strict";t.__esModule=!0,t.URL=t.TOUCH=t.TEXT=t.IMAGE=t.DOC=void 0;t.TEXT="tr-text";t.TOUCH="tr-touch";t.DOC="tr-doc";t.IMAGE="tr-image";t.URL="tr-url"},function(e,t,s){"use strict";t.__esModule=!0,t.reparentNodes=t.removeNodes=t.isCEPolyfill=void 0;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const i="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback;t.isCEPolyfill=i;t.reparentNodes=(e,t,s=null,i=null)=>{for(;t!==s;){const s=t.nextSibling;e.insertBefore(t,i),t=s}};t.removeNodes=(e,t,s=null)=>{for(;t!==s;){const s=t.nextSibling;e.removeChild(t),t=s}}},function(e,t,s){"use strict";t.__esModule=!0,t.nodeMarker=t.markerRegex=t.marker=t.lastAttributeNameRegex=t.isTemplatePartActive=t.createMarker=t.boundAttributeSuffix=t.Template=void 0,s(1);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const i=`{{lit-${String(Math.random()).slice(2)}}}`;t.marker=i;const n=`\x3c!--${i}--\x3e`;t.nodeMarker=n;const o=new RegExp(`${i}|${n}`);t.markerRegex=o;t.boundAttributeSuffix="$lit$";t.Template=class{constructor(e,t){this.parts=[],this.element=t;const s=[],n=[],c=document.createTreeWalker(t.content,133,null,!1);let d=0,u=-1,h=0;const{strings:p,values:{length:g}}=e;for(;h<g;){const e=c.nextNode();if(null!==e){if(u++,1===e.nodeType){if(e.hasAttributes()){const t=e.attributes,{length:s}=t;let i=0;for(let e=0;e<s;e++)r(t[e].name,"$lit$")&&i++;for(;i-- >0;){const t=p[h],s=l.exec(t)[2],i=s.toLowerCase()+"$lit$",n=e.getAttribute(i);e.removeAttribute(i);const r=n.split(o);this.parts.push({type:"attribute",index:u,name:s,strings:r}),h+=r.length-1}}"TEMPLATE"===e.tagName&&(n.push(e),c.currentNode=e.content)}else if(3===e.nodeType){const t=e.data;if(t.indexOf(i)>=0){const i=e.parentNode,n=t.split(o),c=n.length-1;for(let t=0;t<c;t++){let s,o=n[t];if(""===o)s=a();else{const e=l.exec(o);null!==e&&r(e[2],"$lit$")&&(o=o.slice(0,e.index)+e[1]+e[2].slice(0,-"$lit$".length)+e[3]),s=document.createTextNode(o)}i.insertBefore(s,e),this.parts.push({type:"node",index:++u})}""===n[c]?(i.insertBefore(a(),e),s.push(e)):e.data=n[c],h+=c}}else if(8===e.nodeType)if(e.data===i){const t=e.parentNode;null!==e.previousSibling&&u!==d||(u++,t.insertBefore(a(),e)),d=u,this.parts.push({type:"node",index:u}),null===e.nextSibling?e.data="":(s.push(e),u--),h++}else{let t=-1;for(;-1!==(t=e.data.indexOf(i,t+1));)this.parts.push({type:"node",index:-1}),h++}}else c.currentNode=n.pop()}for(const e of s)e.parentNode.removeChild(e)}};const r=(e,t)=>{const s=e.length-t.length;return s>=0&&e.slice(s)===t};t.isTemplatePartActive=e=>-1!==e.index;const a=()=>document.createComment("");t.createMarker=a;const l=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;t.lastAttributeNameRegex=l},function(e,t,s){"use strict";t.__esModule=!0,t.TemplateView=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(14),r=s(2),a=s(66);class l extends r.TouchView{constructor(e={}){super(e),this._partials=e.partials,this._template=new a.Template(e.template||"",e),e.debounceRendering&&(this.renderData=n.default.debounce(l.prototype.renderData)),e.deferredRendering&&(this.renderData=this.deferredRenderData),e.dontResetScroll||this.on("stateSet:hidden",e=>{e||this.scrollTo()})}deferredRenderData(e,t={}){const s=l.prototype.renderData.bind(this,e,t),i=()=>this.isVisible()&&this.isEnabled();return i()?s():(this._renderStateListener&&this.off("stateChanged",this._renderStateListener),this._renderStateListener=()=>{i()&&(this.off("stateChanged",this._renderStateListener),this._renderStateListener=null,s())},this.onStateChanged(this._renderStateListener)),this}renderData(e,t={}){return this.trackRenderTime(()=>this.setContent(this._template.compileTemplate(e,this._partials),t))}trackRenderTime(e){const t=Date.now(),s=e();return o.logTime.render(this.getComponentName(),Date.now()-t),s}getComponentName(){const e=this._element;return e?e.id||n.default.elementToString(e):this.getId()}}t.TemplateView=l},function(e,t,s){e.exports=!s(49)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t){var s={}.hasOwnProperty;e.exports=function(e,t){return s.call(e,t)}},function(e,t,s){"use strict";t.__esModule=!0,t.isPrimitive=t.isIterable=t.PropertyPart=t.PropertyCommitter=t.NodePart=t.EventPart=t.BooleanAttributePart=t.AttributePart=t.AttributeCommitter=void 0,s(1);var i=s(58),n=s(22),o=s(59),r=s(60),a=s(61),l=s(23);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const c=e=>null===e||!("object"==typeof e||"function"==typeof e);t.isPrimitive=c;const d=e=>Array.isArray(e)||!(!e||!e[Symbol.iterator]);t.isIterable=d;class u{constructor(e,t,s){this.dirty=!0,this.element=e,this.name=t,this.strings=s,this.parts=[];for(let e=0;e<s.length-1;e++)this.parts[e]=this._createPart()}_createPart(){return new h(this)}_getValue(){const e=this.strings,t=e.length-1,s=this.parts;if(1===t&&""===e[0]&&""===e[1]){const e=s[0].value;if("symbol"==typeof e)return String(e);if("string"==typeof e||!d(e))return e}let i="";for(let n=0;n<t;n++){i+=e[n];const t=s[n];if(void 0!==t){const e=t.value;if(c(e)||!d(e))i+="string"==typeof e?e:String(e);else for(const t of e)i+="string"==typeof t?t:String(t)}}return i+=e[t],i}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}t.AttributeCommitter=u;class h{constructor(e){this.value=void 0,this.committer=e}setValue(e){e===o.noChange||c(e)&&e===this.value||(this.value=e,(0,i.isDirective)(e)||(this.committer.dirty=!0))}commit(){for(;(0,i.isDirective)(this.value);){const e=this.value;this.value=o.noChange,e(this)}this.value!==o.noChange&&this.committer.commit()}}t.AttributePart=h;class p{constructor(e){this.value=void 0,this.__pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild((0,l.createMarker)()),this.endNode=e.appendChild((0,l.createMarker)())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e.__insert(this.startNode=(0,l.createMarker)()),e.__insert(this.endNode=(0,l.createMarker)())}insertAfterPart(e){e.__insert(this.startNode=(0,l.createMarker)()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this.__pendingValue=e}commit(){if(null===this.startNode.parentNode)return;for(;(0,i.isDirective)(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=o.noChange,e(this)}const e=this.__pendingValue;e!==o.noChange&&(c(e)?e!==this.value&&this.__commitText(e):e instanceof a.TemplateResult?this.__commitTemplateResult(e):e instanceof Node?this.__commitNode(e):d(e)?this.__commitIterable(e):e===o.nothing?(this.value=o.nothing,this.clear()):this.__commitText(e))}__insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}__commitNode(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}__commitText(e){const t=this.startNode.nextSibling,s="string"==typeof(e=null==e?"":e)?e:String(e);t===this.endNode.previousSibling&&3===t.nodeType?t.data=s:this.__commitNode(document.createTextNode(s)),this.value=e}__commitTemplateResult(e){const t=this.options.templateFactory(e);if(this.value instanceof r.TemplateInstance&&this.value.template===t)this.value.update(e.values);else{const s=new r.TemplateInstance(t,e.processor,this.options),i=s._clone();s.update(e.values),this.__commitNode(i),this.value=s}}__commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());const t=this.value;let s,i=0;for(const n of e)s=t[i],void 0===s&&(s=new p(this.options),t.push(s),0===i?s.appendIntoPart(this):s.insertAfterPart(t[i-1])),s.setValue(n),s.commit(),i++;i<t.length&&(t.length=i,this.clear(s&&s.endNode))}clear(e=this.startNode){(0,n.removeNodes)(this.startNode.parentNode,e.nextSibling,this.endNode)}}t.NodePart=p;t.BooleanAttributePart=class{constructor(e,t,s){if(this.value=void 0,this.__pendingValue=void 0,2!==s.length||""!==s[0]||""!==s[1])throw new Error("Boolean attributes can only contain a single expression");this.element=e,this.name=t,this.strings=s}setValue(e){this.__pendingValue=e}commit(){for(;(0,i.isDirective)(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=o.noChange,e(this)}if(this.__pendingValue===o.noChange)return;const e=!!this.__pendingValue;this.value!==e&&(e?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=e),this.__pendingValue=o.noChange}};t.PropertyCommitter=class extends u{constructor(e,t,s){super(e,t,s),this.single=2===s.length&&""===s[0]&&""===s[1]}_createPart(){return new g(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}};class g extends h{}t.PropertyPart=g;let m=!1;(()=>{try{const e={get capture(){return m=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){}})();t.EventPart=class{constructor(e,t,s){this.value=void 0,this.__pendingValue=void 0,this.element=e,this.eventName=t,this.eventContext=s,this.__boundHandleEvent=e=>this.handleEvent(e)}setValue(e){this.__pendingValue=e}commit(){for(;(0,i.isDirective)(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=o.noChange,e(this)}if(this.__pendingValue===o.noChange)return;const e=this.__pendingValue,t=this.value,s=null==e||null!=t&&(e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive),n=null!=e&&(null==t||s);s&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),n&&(this.__options=E(e),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=e,this.__pendingValue=o.noChange}handleEvent(e){"function"==typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}};const E=e=>e&&(m?{capture:e.capture,passive:e.passive,once:e.once}:e.capture)},function(e,t,s){"use strict";t.__esModule=!0,t.HTTPError=void 0;class i{constructor(e,t){this.code=e||0,this.message=t||""}}t.HTTPError=i,i.ABORT=-1,i.TIMEOUT=-2},function(e,t,s){"use strict";t.__esModule=!0,t.VALUE_ATTR=t.ListboxView=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(2),r=s(24);t.VALUE_ATTR="data-value";class a extends r.TemplateView{constructor(e){super(e);const t=({target:e})=>this.getClosest(e,e=>e.hasAttribute("data-value"),!0);this.on("tap",e=>{const s=t(e);s&&(n.default.preventEvent(e),this.emit("itemSelected",s.getAttribute("data-value"),s))}).on(o.TouchView.eventTypes.OVER,e=>{const s=t(e);s&&(n.default.preventEvent(e),this.emit("itemHovered",s,s.getAttribute("data-value")))})}getValues(){return this.getContentElement("["+a.VALUE_ATTR+"]",!0).map((function(e){return e.getAttribute(a.VALUE_ATTR)}))}hasChild(e){return this.getElement().contains(e)}}t.ListboxView=a,a.VALUE_ATTR="data-value"},function(e,t,s){"use strict";t.__esModule=!0,t.PureComponent=t.COMPONENT_EVENTS=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(47),r=s(115),a=s(4),l=s(24),c=s(2);function d(e,t,s){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return s}const u={RENDERED:"rendered",DIRECTIVE_UPDATED:"directiveUpdated"};t.COMPONENT_EVENTS=u;const h="updateDirective";var p=new WeakSet,g=new WeakSet,m=new WeakSet,E=new WeakSet,_=new WeakSet,T=new WeakSet,f=new WeakSet,S=new WeakSet;class C extends a.Model{trackRenderTime(e){return l.TemplateView.prototype.trackRenderTime.apply(this,arguments)}getComponentName(){return l.TemplateView.prototype.getComponentName.apply(this)}constructor(e,t={}){super(e,t),S.add(this),f.add(this),T.add(this),_.add(this),E.add(this),m.add(this),g.add(this),p.add(this),this._cachedDirectiveProps={},d(this,T,P).call(this,!0),t.container&&this.setContainer(t.container),this.updateAsync=n.default.debounce(C.prototype.update,0),this.updateNow=this.updateAsync.callNow.bind(this)}template(e,t){}getDirective(e={}){return d(this,p,y).call(this,e,!1)}getMemoizedDirective(e={}){return d(this,p,y).call(this,e,!0)}getRenderHelpers(){return{html:o.html,nothing:o.nothing,cn:r.cn}}update(e={}){const t=this.getContainer();return t?d(this,m,v).call(this,t,e):this._directive&&d(this,S,I).call(this,e),this}onRendered(e){return this.on(u.RENDERED,e)}onceRendered(e){return this.once(u.RENDERED,e)}onDirectiveUpdated(e){return this.on(u.DIRECTIVE_UPDATED,e)}setContainer(e){this._element=e}getContainer(){return this._element}getRef(e,t=null){const s=this.getContainer(),i=`[data-ref-id="${e}"]`;if(s)return s.querySelector(i);if(t){let e=t[0];for(;e;){if(e.nodeType===Node.ELEMENT_NODE){const t=e.querySelector(i);if(t)return t}if(e===t[1])break;e=e.nextSibling}}return null}getContainerView(){return this._containerView||(this._containerView=new c.TouchView({element:this._element})),this._containerView}}function y(e,t){return this._directive||(this._directive=d(this,f,O).call(this)),this._directive(e,t)}function A(e={}){return this.template(this.getRenderHelpers(),e)}function v(e,t={}){return this.trackRenderTime(()=>(0,o.render)(d(this,g,A).call(this,t),e)),this.emit(u.RENDERED,t)}function L(e){return this._cachedDirectiveProps={...e},this}function R(e){return!n.default.isEqualDeep(this._cachedDirectiveProps,e)}function P(e){return this._directiveCacheIsValid=e,this}function O(){let e;return this.on(h,t=>{e&&e({...this._cachedDirectiveProps,...t},{forceCommit:!0})}).onChange(()=>d(this,T,P).call(this,!1)),(0,o.directive)((t,s)=>i=>{e=(e,{forceCommit:t}={})=>{const o=!s||!this._directiveCacheIsValid||d(this,_,R).call(this,e);d(this,T,P).call(this,!0),o&&(d(this,E,L).call(this,e),i.setValue(d(this,g,A).call(this,e)),t&&this.trackRenderTime(()=>i.commit()),n.default.callAsync(()=>{this.emit(u.DIRECTIVE_UPDATED,[i.startNode,i.endNode],e)}))},e(t)})}function I(e={}){return this.emit(h,e)}t.PureComponent=C},function(e,t,s){"use strict";t.__esModule=!0,t.SessionModel=void 0;var i=s(44),n=s(4);class o extends n.Model{getSid(){return i.sessionManager.getSid().then(e=>(this.setProperty({sid:e}),e))}}t.SessionModel=o},function(e,t,s){var i=s(33),n=s(12),o=n["__core-js_shared__"]||(n["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:s(48)?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){var s=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=s)},function(e,t){var s=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++s+i).toString(36))}},function(e,t,s){var i=s(36),n=s(77),o=s(78),r=Object.defineProperty;t.f=s(25)?Object.defineProperty:function(e,t,s){if(i(e),t=o(t,!0),i(s),n)try{return r(e,t,s)}catch(e){}if("get"in s||"set"in s)throw TypeError("Accessors not supported!");return"value"in s&&(e[t]=s.value),e}},function(e,t,s){var i=s(37);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){e.exports={}},function(e,t,s){var i=s(80),n=s(52);e.exports=function(e){return i(n(e))}},function(e,t,s){var i=s(12),n=s(13),o=s(26),r=s(34)("src"),a=s(84),l=(""+a).split("toString");s(33).inspectSource=function(e){return a.call(e)},(e.exports=function(e,t,s,a){var c="function"==typeof s;c&&(o(s,"name")||n(s,"name",t)),e[t]!==s&&(c&&(o(s,r)||n(s,r,e[t]?""+e[t]:l.join(String(t)))),e===i?e[t]=s:a?e[t]?e[t]=s:n(e,t,s):(delete e[t],n(e,t,s)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[r]||a.call(this)}))},function(e,t,s){var i=s(32)("keys"),n=s(34);e.exports=function(e){return i[e]||(i[e]=n(e))}},function(e,t,s){"use strict";t.__esModule=!0,t.AutoLangSwitcherComponent=void 0;var i=s(119);class n extends i.AbstractAutoLangSwitcherComponent{setModel(e){super.setModel(e),this.updateAsync()}onClick(){const e=this.model.isAutodetectEnabled();this.model.setAutodetectEnabled(!e),this.updateAsync(),this.trackAutodetectToggle(!e)}template({cn:e,html:t,nothing:s}){if(!this.model)return s;return t`
            <div
                class="${e("switch")({active:this.model.isAutodetectEnabled(),size:"s"})}"
            ></div>
        `}}t.AutoLangSwitcherComponent=n},function(e,t,s){"use strict";t.__esModule=!0,t.TranslateApplication=t.TRANSLATE_APP_EVENTS=t.LANDING_TYPES=t.A11Y_EVENTS=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(102),r=s(71),a=s(10),l=s(44),c=s(105);const d={ACTIVATION:"focusedElementActivation",SELECT_ACTIVATION:"focusedSelectActivation"};t.A11Y_EVENTS=d;const u={INIT_DONE:"initDone"};t.TRANSLATE_APP_EVENTS=u;t.LANDING_TYPES={DICTIONARY:"dictionary",TRANSLATOR:"translator"};class h extends c.BaseApplication{static isHistoryAvailable(){return Boolean(window.history)&&"state"in window.history}constructor(e={}){super(e);const t=this.getModel();t.onChange(["srcLang","dstLang"],(e,s,{oldValue:i})=>{this.getStatisticsModel().setProperty("dir",this.getLangsPair()),this.getSettings().setProperty(e,s);const{srcLang:n,dstLang:o}=t.getProps();"srcLang"===e&&s===o?this.setDstLanguage(i):"dstLang"===e&&s===n&&this.setSrcLanguage(i)}),(0,a.getGlobalEmitter)().on(l.SID_FETCHING_EVENT,({oldSid:e,newSid:t})=>{this.getStatisticsModel().send(l.SID_FETCHING_EVENT,{oldSid:e,newSid:t})}),n.default.firefoxVersion&&this.getView().setState("firefox",!0)}getLangsPair(){const{srcLang:e,dstLang:t}=this.getModel().getProps();return`${e}-${t}`}getDefaultSrcLanguage(){const e=this.getConfig();return e.DEFAULT_SRC_LANG?e.DEFAULT_SRC_LANG:!e.DEFAULT_TEXT&&this.getSettings().getProperty("srcLang")||h.DEFAULT_SRC_LANG}getDefaultDstLanguage(){const e=this.getConfig();return e.DEFAULT_DST_LANG?e.DEFAULT_DST_LANG:!e.DEFAULT_TEXT&&this.getSettings().getProperty("dstLang")||(e.UI_LANG!==h.DEFAULT_SRC_LANG?e.UI_LANG:h.DEFAULT_DST_LANG)}getLink(e={}){const t=this.toJSON();let s,i={},o="/";return e.includePathname&&(o=e.pathname||window.location.pathname),s=e.absolute?window.location.protocol+"//"+window.location.hostname+o:o,e.excludeParams?s:(e.includeSearch&&(i=n.default.fromQueryString(window.location.search.slice(1))),i.lang=t.srcLang+"-"+t.dstLang,t.trText?i.text=t.trText:delete i.text,s+"?"+n.default.toQueryString(i))}setText(e,t={}){const s=this.getModel(),i=n.default.trim(e),o="speller"===t.sender;t.caret=t.caret||0,t.oldValue=t.oldValue||"";const r=e.length-t.oldValue.length,a=Math.abs(r)>1,l=e.charAt(t.caret-1);return t.reason=o?"speller":a?r<0?"cut":"paste":"input",s.setProperty("text",e,t),s.setProperty("leadSpacingsCount",e.search(/\S/)),(!i||a||t.sender||r>0&&!n.default.isAlphaOrDigit(l))&&(a||o||(t.reason="\n"===l?"enter":"auto"),s.setProperty("trText",i,t)),this}updateTrText(e){const t=this.getModel();return t.setProperty("trText",n.default.trim(t.getProperty("text")),{reason:e||"auto"}),this}swapDirection(){return this.setSrcLanguage(this.getModel().getProperty("dstLang")),this}setSrcLanguage(e,t){return this._model.isValid("srcLang",e)&&this._model.setProperty("srcLang",e,t),this}setDstLanguage(e,t){return this._model.isValid("dstLang",e)&&this._model.setProperty("dstLang",e,t),this}trackPerformance(){const e=this.getModel(),t=Boolean(window.config.DEFAULT_TEXT);e.onChange("text",(function s(i,n){"url"!==n.sender&&((0,r.rumSendTimeMark)(t?r.RUM_COUNTERS.FILLED_FIRST_TYPING:r.RUM_COUNTERS.BLANK_FIRST_TYPING),e.offChange("text",s))})).onChange("translation",(function s(){(0,r.rumSendTimeMark)(t?r.RUM_COUNTERS.FILLED_FIRST_TRANSLATION:r.RUM_COUNTERS.BLANK_FIRST_TRANSLATION),e.offChange("translation",s)}))}onInitDone(e){return this.on(u.INIT_DONE,e)}onFocusedElementActivation(e){return this.on(d.ACTIVATION,e)}onFocusedSelectActivation(e){return this.on(d.SELECT_ACTIVATION,e)}bindFocusActivation(e){return this.onFocusedElementActivation(t=>{t===e.getElement()&&e.emit("tap")})}makeStatisticsModel(){const e=this.getConfig();return new o.StatisticsModel({srv:e.SRV,ver:e.VER,uid:e.UID,url:e.CLCK_URL,path:e.CLCK_PATH,loadTs:e.LOAD_TS,dir:this.getLangsPair()})}getStatisticsModel(){return this._statisticsModel||(this._statisticsModel=this.makeStatisticsModel()),this._statisticsModel}setComplaintTarget(e){return this.getModel().setProperty({complaintTarget:e})}getComplaintTarget(){return this.getModel().getProperty("complaintTarget")}onComplaintSend(e){return this.onAction("sendComplaint",e)}isComplaintModeEnabled(){return this.getView().hasState("complaint")}openSiteTranslateUrl(e){const t={view:"compact",url:n.default.trim(e),lang:this.getLangsPair()},s="/translate?"+n.default.toQueryString(t);window.open(s,"_blank")}}t.TranslateApplication=h,h.DEFAULT_SRC_LANG="en",h.DEFAULT_DST_LANG="ru"},function(e,t,s){"use strict";t.__esModule=!0,t.sessionManager=t.SID_FETCHING_EVENT=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(103),r=s(19),a=s(9),l=s(10);const c=window.config||{};t.SID_FETCHING_EVENT="sid_fetched";class d extends Error{constructor(...e){super(...e),this.message="Sid Error: failed to fetch sid"}}const u=new class{constructor(){this.maxAttempts=3,this.sidPromise=null,this.sidReceivingTimestamp=n.default.now(),this.sid=null,this.sidRequestsAttempts=0}isSessionExpired(){if(!c.ENABLE_SID_REQUESTING)return!1;return(n.default.now()-this.sidReceivingTimestamp)/1e3>c.SESSION_MAX_AGE}fetchNewSid(){this.sidPromise=new Promise(e=>{new r.HTTPRequest(c.SESSIONS_PATH).setMethod(r.HTTPRequest.methods.POST).setParams({srv:c.SRV}).send((t,s)=>{t&&(this.sidRequestsAttempts++,this.sidRequestsAttempts===this.maxAttempts?((0,a.logError)(new d),e(c.SID)):this.fetchNewSid());const i=this.sid;this.sidReceivingTimestamp=n.default.now(),this.sid=n.default.get(s,"body.session.id"),this.sidPromise=null,(0,l.getGlobalEmitter)().emit("sid_fetched",{oldSid:i,newSid:this.sid}),e(this.sid)})})}getSid(){return this.sid||(this.sid=c.SID),this.isSessionExpired()?(this.sidPromise||this.fetchNewSid(),this.sidPromise):new o.SyncPromise(e=>{e(this.sid)})}};t.sessionManager=u},function(e,t,s){"use strict";t.__esModule=!0,t.HOT_KEYS_MAP=t.DesktopTranslateApplication=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(21),r=s(64),a=s(3),l=s(11),c=s(18),d=s(43);const u={COPY:"COPY_HOTKEY",FAV:"FAV_HOTKEY",ASR:"ASR_HOTKEY",FOCUS_INPUT:"FOCUS_INPUT_HOTKEY",CLEAR_INPUT:"CLEAR_INPUT_HOTKEY",SWAP_LANGS:"SWAP_LANGS_HOTKEY",SRC_TTS:"SRC_TTS_HOTKEY",DST_TTS:"DST_TTS_HOTKEY"};t.HOT_KEYS_MAP=u;const h={c:67,l:76,m:77,d:68,s:83,v:86,"/":191};var p=new WeakSet;class g extends d.TranslateApplication{static getHotkeysMap(){return{[u.COPY]:{osx:"Option+C",other:"Alt+C"},[u.FAV]:{osx:"Option+L",other:"Alt+L"},[u.ASR]:{osx:"Option+M",other:"Alt+M"},[u.FOCUS_INPUT]:{osx:"/",other:"/"},[u.CLEAR_INPUT]:{osx:"Option+D",other:"Alt+D"},[u.SWAP_LANGS]:{osx:"Option+S",other:"Alt+S"},[u.SRC_TTS]:{osx:"Option+V",other:"Alt+V"},[u.DST_TTS]:{osx:"Option+Shift+V",other:"Alt+Ctrl+V"}}}constructor(e){super(e),p.add(this),this.hotKeysConfig=null}getDesktopSettings(){return this._desktopSettings||(this._desktopSettings=window.config.SRV===o.TEXT&&this._settings?this._settings:new r.AppStorage({},{name:"yTrSettings"})),this._desktopSettings}getHotKeyCombination(e){const t=n.default.macOS?"osx":"other";return g.getHotkeysMap()[e][t]}getHotKeysConfig(){return this.hotKeysConfig}addHotKey(e,{view:t,callback:s,condition:i,getActionName:n}){const o=this.getHotKeyCombination(e),r=o.toLowerCase().split("+"),c=r.find(e=>1===e.length);(function(e,t,s){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return s})(this,p,m).call(this,e);const d=()=>{a.$tracker.sendMetric("hotkey_used",{combination:o,action_name:n(),src:this.getModel().getProperty("text"),dir:this.getLangsPair()})};return t&&t.getElement().setAttribute("data-hotkey",o),this.getView().on("keydown",e=>{if(!this.areHotkeysEnabled())return;const n=!i||i();if(l.InputView.hasKeyCombination(e,h[c],{altKey:r.includes("alt")||r.includes("option"),shiftKey:r.includes("shift"),ctrlKey:r.includes("ctrl")})&&n){if(e.preventDefault(),t&&t.isVisible()&&t.isEnabled()&&t.isValid()){d();const e=t.getElement().getAttribute("data-action");e?this.emit("action:"+e):t.emit("tap")}s&&(d(),s())}}),this}areHotkeysEnabled(){return this.getDesktopSettings().isOptionEnabled("hotkeys")}}function m(e){this.hotKeysConfig||(this.hotKeysConfig={});const t=this.getHotKeyCombination(e);this.hotKeysConfig[t]=c.desktopLocales.hotKeys[e]}t.DesktopTranslateApplication=g},function(e,t,s){"use strict";t.__esModule=!0,t.locales=void 0;const i=window.locales||{};t.locales=i},function(e,t,s){"use strict";t.__esModule=!0,t.templateFactory=t.templateCaches=t.svg=t.reparentNodes=t.render=t.removeNodes=t.parts=t.nothing=t.noChange=t.isTemplatePartActive=t.isPrimitive=t.isIterable=t.isDirective=t.html=t.directive=t.createMarker=t.TemplateInstance=t.Template=t.PropertyPart=t.PropertyCommitter=t.NodePart=t.EventPart=t.DefaultTemplateProcessor=t.BooleanAttributePart=t.AttributePart=t.AttributeCommitter=void 0;var i=s(113);t.defaultTemplateProcessor=i.defaultTemplateProcessor,t.DefaultTemplateProcessor=i.DefaultTemplateProcessor;var n=s(61);t.SVGTemplateResult=n.SVGTemplateResult,t.TemplateResult=n.TemplateResult;var o=s(58);t.directive=o.directive,t.isDirective=o.isDirective;var r=s(22);t.removeNodes=r.removeNodes,t.reparentNodes=r.reparentNodes;var a=s(59);t.noChange=a.noChange,t.nothing=a.nothing;var l=s(27);t.AttributeCommitter=l.AttributeCommitter,t.AttributePart=l.AttributePart,t.BooleanAttributePart=l.BooleanAttributePart,t.EventPart=l.EventPart,t.isIterable=l.isIterable,t.isPrimitive=l.isPrimitive,t.NodePart=l.NodePart,t.PropertyCommitter=l.PropertyCommitter,t.PropertyPart=l.PropertyPart;var c=s(114);t.parts=c.parts,t.render=c.render;var d=s(62);t.templateCaches=d.templateCaches,t.templateFactory=d.templateFactory;var u=s(60);t.TemplateInstance=u.TemplateInstance;var h=s(23);t.createMarker=h.createMarker,t.isTemplatePartActive=h.isTemplatePartActive,t.Template=h.Template,
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.4.1");t.html=(e,...t)=>new n.TemplateResult(e,t,"html",i.defaultTemplateProcessor);t.svg=(e,...t)=>new n.SVGTemplateResult(e,t,"svg",i.defaultTemplateProcessor)},function(e,t){e.exports=!1},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,s){var i=s(37),n=s(12).document,o=i(n)&&i(n.createElement);e.exports=function(e){return o?n.createElement(e):{}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,s){var i=s(90),n=s(55);e.exports=Object.keys||function(e){return i(e,n)}},function(e,t){var s=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:s)(e)}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,s){var i=s(35).f,n=s(26),o=s(20)("toStringTag");e.exports=function(e,t,s){e&&!n(e=s?e:e.prototype,o)&&i(e,o,{configurable:!0,value:t})}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0;t.default={XML:"text/xml",XML2:"application/xml",HTML:"text/html",TEXT:"text/plain",JSON:"application/json",FORM:"application/x-www-form-urlencoded"}},function(e,t,s){"use strict";t.__esModule=!0,t.isDirective=t.directive=void 0,s(1);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const i=new WeakMap;t.directive=e=>(...t)=>{const s=e(...t);return i.set(s,!0),s};t.isDirective=e=>"function"==typeof e&&i.has(e)},function(e,t,s){"use strict";t.__esModule=!0,t.nothing=t.noChange=void 0;t.noChange={};t.nothing={}},function(e,t,s){"use strict";t.__esModule=!0,t.TemplateInstance=void 0,s(1);var i=s(22),n=s(23);t.TemplateInstance=
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class{constructor(e,t,s){this.__parts=[],this.template=e,this.processor=t,this.options=s}update(e){let t=0;for(const s of this.__parts)void 0!==s&&s.setValue(e[t]),t++;for(const e of this.__parts)void 0!==e&&e.commit()}_clone(){const e=i.isCEPolyfill?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),t=[],s=this.template.parts,o=document.createTreeWalker(e,133,null,!1);let r,a=0,l=0,c=o.nextNode();for(;a<s.length;)if(r=s[a],(0,n.isTemplatePartActive)(r)){for(;l<r.index;)l++,"TEMPLATE"===c.nodeName&&(t.push(c),o.currentNode=c.content),null===(c=o.nextNode())&&(o.currentNode=t.pop(),c=o.nextNode());if("node"===r.type){const e=this.processor.handleTextExpression(this.options);e.insertAfterNode(c.previousSibling),this.__parts.push(e)}else this.__parts.push(...this.processor.handleAttributeExpressions(c,r.name,r.strings,this.options));a++}else this.__parts.push(void 0),a++;return i.isCEPolyfill&&(document.adoptNode(e),customElements.upgrade(e)),e}}},function(e,t,s){"use strict";t.__esModule=!0,t.TemplateResult=t.SVGTemplateResult=void 0,s(1);var i=s(22),n=s(23);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const o=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:e=>e}),r=` ${n.marker} `;class a{constructor(e,t,s,i){this.strings=e,this.values=t,this.type=s,this.processor=i}getHTML(){const e=this.strings.length-1;let t="",s=!1;for(let i=0;i<e;i++){const e=this.strings[i],o=e.lastIndexOf("\x3c!--");s=(o>-1||s)&&-1===e.indexOf("--\x3e",o+1);const a=n.lastAttributeNameRegex.exec(e);t+=null===a?e+(s?r:n.nodeMarker):e.substr(0,a.index)+a[1]+a[2]+n.boundAttributeSuffix+a[3]+n.marker}return t+=this.strings[e],t}getTemplateElement(){const e=document.createElement("template");let t=this.getHTML();return void 0!==o&&(t=o.createHTML(t)),e.innerHTML=t,e}}t.TemplateResult=a;t.SVGTemplateResult=class extends a{getHTML(){return`<svg>${super.getHTML()}</svg>`}getTemplateElement(){const e=super.getTemplateElement(),t=e.content,s=t.firstChild;return t.removeChild(s),(0,i.reparentNodes)(t,s.firstChild),e}}},function(e,t,s){"use strict";t.__esModule=!0,t.templateCaches=void 0,t.templateFactory=
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
function(e){let t=n.get(e.type);void 0===t&&(t={stringsArray:new WeakMap,keyString:new Map},n.set(e.type,t));let s=t.stringsArray.get(e.strings);if(void 0!==s)return s;const o=e.strings.join(i.marker);s=t.keyString.get(o),void 0===s&&(s=new i.Template(e,e.getTemplateElement()),t.keyString.set(o,s));return t.stringsArray.set(e.strings,s),s},s(1);var i=s(23);const n=new Map;t.templateCaches=n},function(e,t,s){"use strict";t.__esModule=!0,t.Storage=void 0;var i=s(9),n=s(4);class o extends n.Model{constructor(e,t={}){super(e,t);const s=t.name||"mTr";this._name=s;try{this.setProperty(JSON.parse(localStorage[s]))}catch(e){}this.on("change",(function(){try{localStorage[s]=JSON.stringify(this.getProps())}catch(e){this.emit("error",e),(0,i.logError)(e)}}))}getName(){return this._name}}t.Storage=o},function(e,t,s){"use strict";t.__esModule=!0,t.AppStorage=void 0;var i=s(63);class n extends i.Storage{setAutodetectEnabled(e){return this.setProperty("auto",e)}isAutodetectEnabled(){return this.getProperty("auto")}getSrcLangHistory(){return r(this.getProperty("srcLangHistory"))}getDstLangHistory(){return r(this.getProperty("dstLangHistory"))}setSrcLangHistory(e){return this.setProperty("srcLangHistory",o(e))}setDstLangHistory(e){return this.setProperty("dstLangHistory",o(e))}getDisabledOptions(){return(this.getProperty("disabledOptions")||"").split(";")}isOptionEnabled(e){return-1===this.getDisabledOptions().indexOf(e)}disableOption(e){const t=this.getDisabledOptions();-1===t.indexOf(e)&&(this.setProperty("disabledOptions",[...t,e].join(";")),this.prefixedEmit("storageOptionChanged",e,!1))}enableOption(e){if(-1===this.getDisabledOptions().indexOf(e))return;const t=this.getDisabledOptions();this.setProperty("disabledOptions",t.filter(t=>t!==e).join(";")),this.prefixedEmit("storageOptionChanged",e,!0)}onToggleOption(e,t){return this.on("storageOptionChanged:"+e,t)}}function o(e){return Object.keys(e).map(t=>[t,Number(Boolean(e[t]))].join(":")).join(";")}function r(e){const t={};return(e?e.split(";"):[]).forEach(e=>{const s=e.split(":");t[s[0]]=Boolean(Number(s[1]))}),t}t.AppStorage=n,n.defaults={auto:!0}},function(e,t,s){"use strict";t.__esModule=!0,t.HTTPResponse=t.HEADER_NAMES=void 0,t.parseContentDisposition=function(e){const t=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(e);if(null!=t&&t[1]){const e=t[1].toUpperCase().startsWith("UTF-8''"),s=t[1].slice(e?"UTF-8''".length:0).replace(/['"]/g,"");return e?decodeURIComponent(s):s}return null};var i=o(s(0)),n=o(s(57));function o(e){return e&&e.__esModule?e:{default:e}}t.HEADER_NAMES={CONTENT_DISPOSITION:"content-disposition",CONTENT_TYPE:"content-type"};class r{static parseResponse(e,t){switch(t){case n.default.XML:case n.default.XML2:return e.responseXML;case n.default.TEXT:return e.responseText;case n.default.JSON:return JSON.parse(e.responseText);case n.default.FORM:return i.default.fromQueryString(e.responseText);default:return null}}static parseResponseHeaders(e){const t={};if(!e)return t;return i.default.trim(e).split("\n").forEach((function(e){const s=e.split(":");t[i.default.trim(s[0]).toLowerCase()]=i.default.trim(s[1])})),t}constructor(e){const t=e.getResponseHeader("Content-Type");this.code=e.status,this.type=t?t.split(";")[0]:"",this.text=e.responseType&&e.responseType!==r.types.TEXT?"":e.responseText,this.body=this.text?r.parseResponse(e,this.type):e.response||null,this.message=e.statusText,this.headers=r.parseResponseHeaders(e.getAllResponseHeaders())}}t.HTTPResponse=r,r.types={BLOB:"blob",JSON:"json",TEXT:"text",DOCUMENT:"document",ARRAYBUFFER:"arraybuffer"}},function(e,t,s){"use strict";t.__esModule=!0,t.Template=void 0,t.tpl=function(e,...t){return e.reduce((e,s,i)=>`${e}${s}${t[i]||""}`,"").trim()};var i,n=(i=s(0))&&i.__esModule?i:{default:i};class o{static prepareTags(e){let t=e;return n.default.isString(t)&&(t=n.default.getValueTokens(t,2)),n.default.isArray(t)?t:null}static parseTemplate(e,t){const s=[];let i=[];const o=t||this.defaultTags,r=e.replace(new RegExp("\\}?"+n.default.escapeRegExp(o[1]),"g"),o[0]);return n.default.forEach(r.split(o[0]),(function(e,t){if(!e)return;if(t%2==0)return void i.push({type:"text",value:e});const o=e.charAt(0),r=n.default.trim(e.slice(1));switch(o){case"!":break;case"#":case"@":case"?":case"^":case"*":const t=[];i.push({type:o,name:r,value:t}),s.push({name:r,root:i}),i=t;break;case">":i.push({type:o,name:r});break;case"&":case"{":i.push({type:"&",name:r});break;case"/":const a=s.pop();if(!a)throw new Error('Unopened template section "'+r+'"!');if(r!==a.name)throw new Error('Unclosed template section "'+a.name+'"!');i=a.root;break;default:i.push({type:"name",name:n.default.trim(e)})}})),i}static getContextValue(e,t){let s,i,o,r;if(e.indexOf(".")>0)for(s=0,i=t,o=e.split("."),r=o.length;i&&s<r;)i=i[o[s++]];else i=t[e];return n.default.isFunction(i)&&(i=i.call(t)),i}static renderTokens(e,t={},s={}){const i=this,o=[];return n.default.forEach(e,(function(e){let r;switch(e.type){case"^":r=i.getContextValue(e.name,t),n.default.isEmpty(r)&&o.push(i.renderTokens(e.value,t,s));break;case"#":case"?":case"@":case"*":if(r=i.getContextValue(e.name,t),n.default.isEmpty(r))return;n.default.isArray(r)?n.default.forEach(r,(function(t){const r=n.default.isObject(t)?t:{".":t};o.push(i.renderTokens(e.value,r,s))})):o.push(i.renderTokens(e.value,n.default.isObject(r)?r:t,s));break;case">":if(!n.default.isObject(s.partials))return;if(r=i.getContextValue(e.name,s.partials),!r||!n.default.isString(r))return;o.push(i.renderTokens(i.parseTemplate(r,s.tags),t,s));break;case"&":case"name":if(r=i.getContextValue(e.name,t),n.default.isNullOrUndefined(r))return;r=String(r),o.push("&"===e.type?r:n.default.escapeHTML(r));break;case"text":o.push(e.value)}})),o.join("")}constructor(e,t={}){if(!e||!n.default.isString(e))throw new Error("Bad template!");this._tags=o.prepareTags(t.tags),this._tokens=o.parseTemplate(e,this._tags)}compileTemplate(e,t){return o.renderTokens(this._tokens,e,{tags:this._tags,partials:t})}}t.Template=o,o.cache={},o.defaultTags=["{{","}}"]},function(e,t,s){"use strict";t.__esModule=!0,t.unsafeHTML=void 0,s(1);var i=s(27),n=s(47);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const o=new WeakMap,r=(0,n.directive)(e=>t=>{if(!(t instanceof n.NodePart))throw new Error("unsafeHTML can only be used in text bindings");const s=o.get(t);if(void 0!==s&&(0,i.isPrimitive)(e)&&e===s.value&&t.value===s.fragment)return;const r=document.createElement("template");r.innerHTML=e;const a=document.importNode(r.content,!0);t.setValue(a),o.set(t,{value:e,fragment:a})});t.unsafeHTML=r},function(e,t,s){"use strict";t.__esModule=!0,t.ChoiceGroup=void 0;var i=s(30);class n extends i.PureComponent{constructor(e,t){super(e,t),this.onChange(()=>this.updateAsync()),this.update()}setSelectedElement(e){return this.setProperty({activeIndex:e})}template({html:e,cn:t,nothing:s}){const i={},{activeIndex:n,items:o,wideMode:r}=this.getProps(),a=t("choiceGroup");return r&&(i.wide=!0),e`
            <div class=${a(i)}>
                ${o.map((t,i)=>e`
                    <button class=${a("item",{selected:n===i})}
                        aria-label=${t.ariaLabel}
                        @click=${t.onClick}
                        tabindex="${isNaN(t.tabIndex)?-1:t.tabIndex}"
                        data-default-enter-action="true"
                    >
                        ${t.icon||s}${t.content}
                    </button>
                `)}
            </div>
        `}}t.ChoiceGroup=n,n.defaults={items:[],activeIndex:0,wideMode:!1}},function(e,t,s){"use strict";t.__esModule=!0,t.SyncModel=void 0;var i=s(31);class n extends i.SessionModel{constructor(e,t){super(e,t),this.on("invalid",this.abort)}abort(){return this._activeRequest&&(this._activeRequest.abort(),this._activeRequest=null),this}setRequest(e){return this.abort(),this._activeRequest=e,this}}t.SyncModel=n},function(e,t,s){"use strict";t.__esModule=!0,t.POS_ORDER=t.POS_CODES=t.POS=t.DictionaryPresenter=t.DICT_TYPES=t.DICT_FLAGS=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(17);const r={NONE:0,FAMILY:1,SHORT_POS:2,MORPHO:4,RELIABLE:16,TOOLTIPS:32,LONG_EXAMPLES:64,DEFINITIONS:128,DECLENSIONS:256,IDIOMS:1024,ABBR:2048,DICT_AND_DEF:4096,NEW_DECLENSIONS:8192};t.DICT_FLAGS=r;const a={SYN:"syn",ANT:"ant",DEF:"def",DERIV:"deriv",REGULAR:"regular"};t.DICT_TYPES=a;const l={NOUN:"noun",VERB:"verb",ADJECTIVE:"adjective"};t.POS=l;const c={nn:l.NOUN,vrb:l.VERB,adj:l.ADJECTIVE};t.POS_CODES=c;const d={[l.VERB]:1,[l.NOUN]:2,[l.ADJECTIVE]:3};t.POS_ORDER=d;class u extends o.Presenter{constructor(e){super(e);const{isDisabled:t}=e,s=this,i=this.getView(),o=this.getModel();this.requestData=n.default.debounce(u.prototype.requestData),i.on("itemSelected",(function(e){e&&s.emit("valueSelected",e)})),o.on("change",(function(e,t,i={}){if("selection"!==i.reason)switch(e){case"ui":case"text":case"type":case"flags":s.requestData();break;case"srcLang":case"dstLang":s._handleChangeLang()}})).on("error",(function(e){s.emit("error",e)})).on("invalid",(function(){this.setProperty("data","",{invalid:!0})})).on("set:data",(function(e,i){t&&t()||s._renderData(e,i)}))}setText(e,t){return this.getModel().setProperty("text",e,t),this}hasFlag(e){return(this.getModel().getProperty("flags")&e)===e}setFlag(e,t){const s=this.getModel();let i=s.getProperty("flags");return Boolean(t)===this.hasFlag(e)||(i+=e*(t?1:-1),s.setProperty("flags",i)),this}setType(e,t){const s=this.getModel();let i=s.getProperty("type");i=i?i.split(","):[];const n=i.indexOf(e);return Boolean(t)===n>=0||(t?i.push(e):i.splice(n,1),s.setProperty("type",i.join(","))),this}hasType(e){let t=this.getModel().getProperty("type");return t=t?t.split(","):[],-1!==t.indexOf(e)}requestData(e){return this.getModel().requestData(e),this}setSrcLanguage(e,t){return this.getModel().setProperty("srcLang",e,t),this}setDstLanguage(e,t){return this.getModel().setProperty("dstLang",e,t),this}_renderData(e,t){let s=e;const i=this.getView();e&&(s=this.prepareData(e),s&&i.renderData(s)),this._handleSetData(s,t)}_handleSetData(e){this.getView().setVisible(e)}_handleChangeLang(){this.requestData()}}t.DictionaryPresenter=u,u.flags=r,u.types=a},function(e,t,s){"use strict";t.__esModule=!0,t.RUM_COUNTERS=void 0,t.rumSendTimeMark=function(e){try{window.Ya.Rum.sendTimeMark(e)}catch(e){}},t.rumTimeEnd=function(e){try{i.DEBUG&&console.timeEnd(e),window.Ya.Rum.timeEnd(e)}catch(e){}},t.rumTimeStart=function(e){try{i.DEBUG&&console.time(e),window.Ya.Rum.time(e)}catch(e){}};var i=s(14);t.RUM_COUNTERS={APP_INIT_START:"app-init-start",APP_INIT_DURATION:"app-init-duration",BLANK_FIRST_TYPING:"blank-first-typing",BLANK_FIRST_TRANSLATION:"blank-first-translation",FILLED_FIRST_TYPING:"filled-first-typing",FILLED_FIRST_TRANSLATION:"filled-first-translation"}},function(e,t,s){"use strict";t.__esModule=!0,t.ListboxModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(4);class r extends o.Model{constructor(e,t={}){super(e,t),this._toggleable=Boolean(t.toggleable),this._defaultValue=t.defaultValue||""}isEmpty(e){return n.default.isEmpty(e||this.getItems())}getItems(){let e=this.getProperty("items");try{e=JSON.parse(e)}catch(e){}return e}setProperty(e,t,s){const i=o.Model.prototype.setProperty.bind(this);return this._toggleable&&"value"===e&&t&&this.getProperty(e)===t?(i(e,this._defaultValue,s),this):(i(e,t,s),this)}setItems(e,t){return this.setProperty("items",e&&JSON.stringify(e),t)}getDefaults(){return{value:"",items:""}}}t.ListboxModel=r},function(e,t,s){"use strict";s(74)},function(e,t){!function(e,t){if(!e)throw new Error("Rum: interface is not included");if(!e.enabled)return e.getSetting=function(){return""},e.getVarsList=function(){return[]},void(e.getResourceTimings=e.pushConnectionTypeTo=e.pushTimingTo=e.normalize=e.sendCounter=e.sendDelta=e.sendTimeMark=e.sendResTiming=e.sendTTI=e.makeSubPage=e.sendHeroElement=e.onReady=function(){});e.getVarsList=function(){var t=e._vars;return Object.keys(t).map((function(e){return e+"="+encodeURIComponent(t[e]).replace(/\*/g,"%2A")}))},e.setVars=function(t){Object.keys(t).forEach((function(s){e._vars[s]=t[s]})),y(),A()};var s,i,n={connectEnd:2116,connectStart:2114,decodedBodySize:2886,domComplete:2124,domContentLoadedEventEnd:2131,domContentLoadedEventStart:2123,domInteractive:2770,domLoading:2769,domainLookupEnd:2113,domainLookupStart:2112,duration:2136,encodedBodySize:2887,entryType:2888,fetchStart:2111,initiatorType:2889,loadEventEnd:2126,loadEventStart:2125,nextHopProtocol:2890,redirectCount:1385,redirectEnd:2110,redirectStart:2109,requestStart:2117,responseEnd:2120,responseStart:2119,secureConnectionStart:2115,startTime:2322,transferSize:2323,type:76,unloadEventEnd:2128,unloadEventStart:2127,workerStart:2137},o={visible:1,hidden:2,prerender:3},r={bluetooth:2064,cellular:2065,ethernet:2066,none:1229,wifi:2067,wimax:2068,other:861,unknown:836,0:836,1:2066,2:2067,3:2070,4:2071,5:2768},a={"first-paint":2793,"first-contentful-paint":2794},l=Object.keys(a).length,c=e.getTime,d=window.PerformanceObserver,u=window.performance||{},h=u.timing||{},p=u.navigation||{},g=navigator.connection,m={},E={},_=e._deltaMarks,T=document.createElement("link"),f=document.createElement("a"),S="function"==typeof u.getEntriesByType,C=h.navigationStart;function y(){s=e.getVarsList(),e.getSetting("sendClientUa")&&s.push("1042="+encodeURIComponent(navigator.userAgent))}function A(){i=s.concat(["143.2129="+C])}function v(e){function t(){removeEventListener("DOMContentLoaded",t),removeEventListener("load",t),e()}"loading"===document.readyState?(addEventListener("DOMContentLoaded",t),addEventListener("load",t)):e()}function L(){e.getSetting("disableOnLoadTasks")||(removeEventListener("load",L),function(){var t=e.getSetting("periodicStatsIntervalMs");t||null===t||(t=15e3);t&&(P=setInterval(D,t));addEventListener("beforeunload",D)}(),function(){if(!d)return;H(u.getEntriesByType("navigation")),H(u.getEntriesByType("resource"));try{new d((function(e){H(e.getEntries())})).observe({entryTypes:["resource","navigation"]})}catch(e){}e._periodicTasks.push($)}(),function(){if(!d)return;try{new d((function(e,t){var s=e.getEntries()[0];if(s){var i=s.processingStart,n={duration:s.duration,js:s.processingEnd-i,name:s.name},o=s.target;if(o){var r=(o.tagName||"").toLowerCase(),a=o.className?(" "+o.className).replace(/\s+/g,"."):"";n.target=r+a}M("first-input",i-s.startTime,n),t.disconnect()}})).observe({type:"first-input",buffered:!0})}catch(e){}}(),function(){if(!S)return;var e=u.getEntriesByType("navigation")[0];if(e){var t=[];Q(t,e),j(t),ee("690.2096.2892",s.concat(t))}}(),function(){if(!d)return;var e=new d((function(e){var t=e.getEntries();null==V&&(V=0);for(var s=0;s<t.length;s++){var i=t[s];i.hadRecentInput||(V+=i.value)}}));try{e.observe({type:"layout-shift",buffered:!0})}catch(e){}addEventListener("visibilitychange",(function t(){if("hidden"===document.visibilityState){removeEventListener("visibilitychange",t);try{"function"==typeof e.takeRecords&&e.takeRecords(),e.disconnect()}catch(e){}B()}})),addEventListener("beforeunload",B)}(),function(){if(!d||!e.getSetting("forcePaintTimeSending")&&e.isVisibilityChanged())return;var t=new d((function(e){for(var t=e.getEntries(),s=0;s<t.length;s++){var i=t[s];G=i.renderTime||i.loadTime,F=i}Y||(b("largest-loading-elem-paint",G),Y=!0)}));try{t.observe({type:"largest-contentful-paint",buffered:!0})}catch(e){}addEventListener("visibilitychange",(function e(){if("hidden"===document.visibilityState){removeEventListener("visibilitychange",e);try{"function"==typeof t.takeRecords&&t.takeRecords(),t.disconnect()}catch(e){}W()}})),addEventListener("beforeunload",W)}())}function R(){var t=h.domContentLoadedEventStart,i=h.domContentLoadedEventEnd;if(0!==t||0!==i){var r=0===h.responseStart?C:h.responseStart,a=0===h.domainLookupStart?C:h.domainLookupStart,l=s.concat(["2129="+C,"1036="+(a-C),"1037="+(h.domainLookupEnd-h.domainLookupStart),"1038="+(h.connectEnd-h.connectStart),h.secureConnectionStart&&"1383="+(h.connectEnd-h.secureConnectionStart),"1039="+(h.responseStart-h.connectEnd),"1040="+(h.responseEnd-r),"1040.906="+(h.responseEnd-a),"1310.2084="+(h.domLoading-r),"1310.2085="+(h.domInteractive-r),"1310.1309="+(i-t),"1310.1007="+(t-r),navigator.deviceMemory&&"3140="+navigator.deviceMemory,navigator.hardwareConcurrency&&"3141="+navigator.hardwareConcurrency]);Object.keys(n).forEach((function(e){e in h&&h[e]&&l.push(n[e]+"="+Z(h[e],C))})),e.vsStart?(l.push("1484="+(o[e.vsStart]||2771)),e.vsChanged&&l.push("1484.719=1")):l.push("1484="+o.visible),p&&(p.redirectCount&&l.push("1384.1385="+p.redirectCount),1!==p.type&&2!==p.type||l.push("770.76="+p.type)),j(l),ee("690.1033",l)}else setTimeout(R,50)}y(),A(),e.ajaxStart=0,e.ajaxComplete=0,v((function(){if(!C)return;setTimeout((function(){e.sendTimeMark=b,e.sendResTiming=w,e.timeEnd=N;for(var t=e._defRes;t.length;){var s=t.shift();w(s[0],s[1])}for(var i=e._defTimes;i.length;){var n=i.shift();b(n[0],n[1],!1,n[2])}Object.keys(_).forEach((function(e){M(e)})),R(),function t(){if(!S||!e.getSetting("forcePaintTimeSending")&&e.isVisibilityChanged())return;for(var s=u.getEntriesByType("paint"),i=0;i<s.length;i++){var n=s[i],o=a[n.name];o&&!O[n.name]&&(O[n.name]=!0,I++,b("1926."+o,n.startTime))}if(I<l)try{new d((function(e,s){t(),s&&s.disconnect()})).observe({entryTypes:["paint"]})}catch(e){}}(),e.getSetting("sendAutoElementTiming")&&K(),X(),"complete"===document.readyState?L():addEventListener("load",L)}),0)})),e._getCommonVars=function(){return s};var P,O={},I=0;function b(t,s,i,n){void 0===s&&(s=c()),void 0!==i&&!0!==i||e.mark(t,s);var o=J(t);if(o.push("207="+Z(s)),x(o,n)){ee("690.2096.207",o),m[t]=m[t]||[],m[t].push(s);var r=e._markListeners[t];r&&r.length&&r.forEach((function(e){e(s)}))}}function x(e,t){if(t){if(t.isCanceled&&t.isCanceled())return!1;var s=e.reduce((function(e,t,s){"string"==typeof t&&(e[t.split("=")[0]]=s);return e}),{});Object.keys(t).forEach((function(i){if("function"!=typeof t[i]){var n=s[i],o=i+"="+t[i];void 0===n?e.push(o):e[n]=o}}))}return!0}function N(e,t){var s=_[e];s&&0!==s.length&&(s.push(c(),t),M(e))}function M(t,s,i){var n,o,r,a=_[t];if(void 0!==s?n=(o=e.getTime())-s:a&&(n=a[0],o=a[1],r=a[2]),void 0!==n&&void 0!==o){var l=J(t);l.push("207.2154="+Z(n),"207.1428="+Z(o),"2877="+Z(o-n)),x(l,i)&&x(l,r)&&(ee("690.2096.2877",l),delete _[t])}}function w(t,s){q(s,(function(i){if(i){var n=J(t);e.getSetting("sendUrlInResTiming")&&n.push("13="+encodeURIComponent(s)),Q(n,i[i.length-1]),ee("690.2096.2044",n)}}))}function D(){var t=!1;e._periodicTasks.forEach((function(e){e()&&(t=!0)})),t||clearInterval(P)}e.getTimeMarks=function(){return m},e._periodicTasks=[];var V,k=0;function H(e){if(e&&e.length)for(var t=E,s=0;s<e.length;s++){var i=U(e[s]);if(i){var n=i.domain+"-"+i.extension,o=t[n]=t[n]||{count:0,size:0};o.count++,o.size+=i.size}}}function U(e){var t=e.transferSize;if(null!=t){f.href=e.name;var s=f.pathname;if(0!==s.indexOf("/clck")){var i=s.lastIndexOf("."),n="";return-1!==i&&s.lastIndexOf("/")<i&&s.length-i<=5&&(n=s.slice(i+1)),{size:t,domain:f.hostname,extension:n}}}}function $(){var t=e.getSetting("maxTrafficCounters")||250;if(k>=t)return!1;for(var i=Object.keys(E),n="",o=0;o<i.length;o++){var r=i[o],a=E[r];n+=encodeURIComponent(r)+"!"+a.count+"!"+a.size+";"}n.length&&(k++,ee("690.2096.361",s.concat(["d="+n,"t="+Z(c())])));return E={},k<t}function B(){if(null!=V){var e=Math.round(1e6*V)/1e6;ee("690.2096.4004",s.concat("s="+e)),V=null}}var G=null,F=null,Y=!1;function W(){if(null!=G){var t=e.getLCPAdditionalParams(F);b("largest-contentful-paint",G,!1,t),G=null,F=null}}var K=d?function(){if(e.getSetting("forcePaintTimeSending")||!e.isVisibilityChanged())try{new d((function(e){for(var t=e.getEntries(),s=0;s<t.length;s++){var i=t[s];b("element-timing."+i.identifier,i.startTime)}})).observe({type:"element",buffered:!0})}catch(e){}}:function(){};function X(t,s,i){if(e._tti){var n=c(),o=function(t,o,r){var a={2796.2797:z(r,s),689.2322:Z(n)};i&&Object.keys(i).forEach((function(e){a[e]=i[e]})),b(t||"2795",o,!0,a),e._tti.fired=!0};!function i(){var r,a=s||n,l=c(),d=e._tti.events||[],u=d.length;0!==u&&(r=d[u-1],a=Math.max(a,Math.floor(r.startTime+r.duration))),l-a>=3e3?o(t,a,d):l-a>=2e4?o(t,(s||n)+2e4,d):setTimeout(i,1e3)}()}}function j(e){g&&e.push("2437="+(r[g.type]||2771),void 0!==g.downlinkMax&&"2439="+g.downlinkMax,g.effectiveType&&"2870="+g.effectiveType,void 0!==g.rtt&&"rtt="+g.rtt,void 0!==g.downlink&&"dwl="+g.downlink)}function q(e,t){if(!S)return t(null);T.href=e;var s=T.href,i=0,n=100;setTimeout((function e(){var o=u.getEntriesByName(s);if(o.length)return t(o);i++<10?(setTimeout(e,n),n+=n):t(null)}),0)}function z(e,t){return t=t||0,(e=e||[]).filter((function(e){return e.startTime-t>=-50})).map((function(e){var t=e.name?e.name.split("-").map((function(e){return e[0]})).join(""):"u",s=Math.floor(e.startTime);return t+"-"+s+"-"+Math.floor(s+e.duration)})).join(".")}function J(t){return i.concat(["1701="+t,e.ajaxStart&&"1201.2154="+Z(e.ajaxStart),e.ajaxComplete&&"1201.2052="+Z(e.ajaxComplete)])}function Q(e,t){Object.keys(n).forEach((function(s){if(s in t){var i=t[s];(i||0===i)&&e.push(n[s]+"="+Z(i))}}))}function Z(e,t){return"string"==typeof e?encodeURIComponent(e):Math.round(1e3*(e-(t||0)))/1e3}function ee(t,s){var i=encodeURIComponent(window.YaStaticRegion||"unknown");s.push("-cdn="+i);var n=s.filter(Boolean).join(",");e.send(null,t,n)}e.sendTTI=X,e.sendHeroElement=function(e){b("2876",e)},e._subpages={},e.makeSubPage=function(t,s){var i=e._subpages[t];e._subpages[t]=void 0===i?i=0:++i;var n=!1;return{689.2322:Z(void 0!==s?s:c()),2924:t,2925:i,isCanceled:function(){return n},cancel:function(){n=!0}}},e._getLongtasksStringValue=z,e.getResourceTimings=q,e.pushConnectionTypeTo=j,e.pushTimingTo=Q,e.normalize=Z,e.sendCounter=ee,e.sendDelta=M,e.sendTrafficData=$,e.finalizeLayoutShiftScore=B,e.finalizeLargestContentfulPaint=W,e.onReady=v}(Ya.Rum)},function(e,t,s){"use strict";var i=s(76),n=s(79),o=s(38),r=s(39);e.exports=s(82)(Array,"Array",(function(e,t){this._t=r(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,s=this._i++;return!e||s>=e.length?(this._t=void 0,n(1)):n(0,"keys"==t?s:"values"==t?e[s]:[s,e[s]])}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(e,t,s){var i=s(20)("unscopables"),n=Array.prototype;null==n[i]&&s(13)(n,i,{}),e.exports=function(e){n[i][e]=!0}},function(e,t,s){e.exports=!s(25)&&!s(49)((function(){return 7!=Object.defineProperty(s(50)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,s){var i=s(37);e.exports=function(e,t){if(!i(e))return e;var s,n;if(t&&"function"==typeof(s=e.toString)&&!i(n=s.call(e)))return n;if("function"==typeof(s=e.valueOf)&&!i(n=s.call(e)))return n;if(!t&&"function"==typeof(s=e.toString)&&!i(n=s.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,s){var i=s(81);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},function(e,t){var s={}.toString;e.exports=function(e){return s.call(e).slice(8,-1)}},function(e,t,s){"use strict";var i=s(48),n=s(83),o=s(40),r=s(13),a=s(38),l=s(87),c=s(56),d=s(95),u=s(20)("iterator"),h=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,s,g,m,E,_){l(s,t,g);var T,f,S,C=function(e){if(!h&&e in L)return L[e];switch(e){case"keys":case"values":return function(){return new s(this,e)}}return function(){return new s(this,e)}},y=t+" Iterator",A="values"==m,v=!1,L=e.prototype,R=L[u]||L["@@iterator"]||m&&L[m],P=R||C(m),O=m?A?C("entries"):P:void 0,I="Array"==t&&L.entries||R;if(I&&(S=d(I.call(new e)))!==Object.prototype&&S.next&&(c(S,y,!0),i||"function"==typeof S[u]||r(S,u,p)),A&&R&&"values"!==R.name&&(v=!0,P=function(){return R.call(this)}),i&&!_||!h&&!v&&L[u]||r(L,u,P),a[t]=P,a[y]=p,m)if(T={values:A?P:C("values"),keys:E?P:C("keys"),entries:O},_)for(f in T)f in L||o(L,f,T[f]);else n(n.P+n.F*(h||v),t,T);return T}},function(e,t,s){var i=s(12),n=s(33),o=s(13),r=s(40),a=s(85),l=function(e,t,s){var c,d,u,h,p=e&l.F,g=e&l.G,m=e&l.S,E=e&l.P,_=e&l.B,T=g?i:m?i[t]||(i[t]={}):(i[t]||{}).prototype,f=g?n:n[t]||(n[t]={}),S=f.prototype||(f.prototype={});for(c in g&&(s=t),s)u=((d=!p&&T&&void 0!==T[c])?T:s)[c],h=_&&d?a(u,i):E&&"function"==typeof u?a(Function.call,u):u,T&&r(T,c,u,e&l.U),f[c]!=u&&o(f,c,h),E&&S[c]!=u&&(S[c]=u)};i.core=n,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,s){e.exports=s(32)("native-function-to-string",Function.toString)},function(e,t,s){var i=s(86);e.exports=function(e,t,s){if(i(e),void 0===t)return e;switch(s){case 1:return function(s){return e.call(t,s)};case 2:return function(s,i){return e.call(t,s,i)};case 3:return function(s,i,n){return e.call(t,s,i,n)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,s){"use strict";var i=s(88),n=s(51),o=s(56),r={};s(13)(r,s(20)("iterator"),(function(){return this})),e.exports=function(e,t,s){e.prototype=i(r,{next:n(1,s)}),o(e,t+" Iterator")}},function(e,t,s){var i=s(36),n=s(89),o=s(55),r=s(41)("IE_PROTO"),a=function(){},l=function(){var e,t=s(50)("iframe"),i=o.length;for(t.style.display="none",s(94).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;i--;)delete l.prototype[o[i]];return l()};e.exports=Object.create||function(e,t){var s;return null!==e?(a.prototype=i(e),s=new a,a.prototype=null,s[r]=e):s=l(),void 0===t?s:n(s,t)}},function(e,t,s){var i=s(35),n=s(36),o=s(53);e.exports=s(25)?Object.defineProperties:function(e,t){n(e);for(var s,r=o(t),a=r.length,l=0;a>l;)i.f(e,s=r[l++],t[s]);return e}},function(e,t,s){var i=s(26),n=s(39),o=s(91)(!1),r=s(41)("IE_PROTO");e.exports=function(e,t){var s,a=n(e),l=0,c=[];for(s in a)s!=r&&i(a,s)&&c.push(s);for(;t.length>l;)i(a,s=t[l++])&&(~o(c,s)||c.push(s));return c}},function(e,t,s){var i=s(39),n=s(92),o=s(93);e.exports=function(e){return function(t,s,r){var a,l=i(t),c=n(l.length),d=o(r,c);if(e&&s!=s){for(;c>d;)if((a=l[d++])!=a)return!0}else for(;c>d;d++)if((e||d in l)&&l[d]===s)return e||d||0;return!e&&-1}}},function(e,t,s){var i=s(54),n=Math.min;e.exports=function(e){return e>0?n(i(e),9007199254740991):0}},function(e,t,s){var i=s(54),n=Math.max,o=Math.min;e.exports=function(e,t){return(e=i(e))<0?n(e+t,0):o(e,t)}},function(e,t,s){var i=s(12).document;e.exports=i&&i.documentElement},function(e,t,s){var i=s(26),n=s(96),o=s(41)("IE_PROTO"),r=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=n(e),i(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?r:null}},function(e,t,s){var i=s(52);e.exports=function(e){return Object(i(e))}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0;t.default=/\ud83d[\udc68-\udc69](?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92])|(?:\ud83c[\udfcb\udfcc]|\ud83d\udd75|\u26f9)(?:\ufe0f|\ud83c[\udffb-\udfff])\u200d[\u2640\u2642]\ufe0f|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd37-\udd39\udd3d\udd3e\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f|(?:[\u0023\u002a\u0030-\u0039])\ufe0f?\u20e3|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\uddd1-\udddd]|[\u270a\u270b])(?:\ud83c[\udffb-\udfff]|)|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud800\udc00|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a-\udc6d\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\udeeb\udeec\udef4-\udef8]|\ud83e[\udd10-\udd17\udd1d\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd40-\udd45\udd47-\udd4c\udd50-\udd6b\udd80-\udd97\uddc0\uddd0\uddde-\udde6]|[\u23e9-\u23ec\u23f0\u23f3\u2640\u2642\u2695\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a]|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u00a9\u00ae\u203c\u2049\u2122\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2694\u2696\u2697\u2699\u269b\u269c\u26a0\u26a1\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))/g},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0;t.default=/^(https?:\/\/)?(([\w\-\u0430-\u045f]+\.)+(com|net|org|info|top|xyz|icu|loan|biz|club|site|online|vip|shop|work|app|mobi|pro|asia|trade|dev|review|party|name|accountant|space|tech|store|gov||||[a-z]{2}))(:\d+)?(\/\S*)?$/i},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0;t.default=/^[a-zA-Z0-9\+\.\_\%\-]{1,256}\@[a-zA-Z0-9][a-zA-Z0-9\-]{0,64}(\.[a-zA-Z0-9][a-zA-Z0-9\-]{0,25})+$/},function(e,t,s){"use strict";t.__esModule=!0,t.pushTask=function(e){e.isHighPriority?n.unshift(e):n.push(e);1===n.length&&r(l)};var i=s(9);const n=[],o=[];function r(e){o.push(e),window.postMessage("zero-timeout-message","*")}window.addEventListener("message",(function(e){e.source===window&&"zero-timeout-message"===e.data&&(e.stopPropagation(),o.length>0&&o.shift()())}),!0);let a=0;function l(){if(0===n.length)return;if(a>0)return;a++;let e=Date.now(),t=e;for(;n.length>0&&t-e<35;){const e=n.shift();try{e.fn.call(e.ctx||null)}catch(e){(0,i.logError)(e)}if(t=Date.now(),n.length>0&&n[0].isLongTask)break}n.length>0&&r(l),a--}},function(e,t,s){"use strict";var i,n,o=(i=s(0))&&i.__esModule?i:{default:i};window.XDomainRequest&&((n=window.XDomainRequest.prototype).nativeOpen=n.open,n.nativeSend=n.send,n.nativeAbort=n.abort,n.setRequestHeader=o.default.noop,n.getResponseHeader=function(e){return this.responseText&&"Content-Type"===e?"application/json":null},n.onreadystatechange=o.default.noop,n.getAllResponseHeaders=function(){return""},n.open=function(e,t){this.url=t},n.send=function(e){const t=this;let s=this.url;e&&(s+=(s.indexOf("?")<0?"?":"&")+e);const i=e=>{"load"===e.type&&(this.status=200),this.readyState=4,this.onreadystatechange()};t.onload=i,t.onerror=i,t.ontimeout=o.default.noop,t.onprogress=o.default.noop,t.nativeOpen("GET",s),setTimeout((function(){t.nativeSend()}),0)},n.abort=function(){this.nativeAbort(),this.readyState=4,this.onreadystatechange()},n.status=0,n.readyState=0,n.statusText="")},function(e,t,s){"use strict";t.__esModule=!0,t.StatisticsModel=void 0;var i=a(s(0)),n=s(14),o=s(31),r=a(s(104));function a(e){return e&&e.__esModule?e:{default:e}}class l extends o.SessionModel{static updateDomTrackingData(e,t){const s=i.default.extend(i.default.safeParseJSON(e.getAttribute("data-tracking-data")),t);e.setAttribute("data-tracking-data",JSON.stringify(s))}constructor(e,t){super(e,t);const s=this.constructor;this._sendMetrikaGoal=window.sendMetrikaGoal,this.setProperty("url",e.url+i.default.toQueryString({dtype:s.DTYPE,pid:s.PID},"/")+"/"),window.sendStatisticsEvent=this.send.bind(this)}getDefaults(){return{url:"/",srv:"",ver:"",uid:"",dir:"",path:"",loadTs:"",isSearchApp:!1}}getUiType(){const{isSearchApp:e,srv:t}=this.getProps();return e?"turboapp":"tr-touch"===t?"touch":"desktop"}getLink(e){const t=this.constructor,s=this.getProps(),n={};return e.logged_in=s.uid?1:0,s.sid&&(e.sid=s.sid),s.srv&&(e.srv=s.srv),s.ver&&(e.ver=s.ver),s.loadTs&&(e.load_ts=s.loadTs),s.dir&&(e.dir=s.dir),e.cur_ts=(new Date).getTime(),e.ui_type=this.getUiType(),"74186"===e.cid&&e.counter_name&&(e.key=e.counter_name),Object.keys(e).forEach((function(s){const i="cid"===s?s:t.KEY_PREFIX+"_"+s,o=String(e[s]);n[i]=o.slice(0,"desktop_redesign_vote_send"===e.counter_name?500:t.MAX_DATA_LENGTH)})),n.path=s.path,this.getProperty("url")+i.default.toQueryString(n,"/")+"/*"}sendMetrika(e){this._sendMetrikaGoal&&this._sendMetrikaGoal(e)}logEvent(e,t,s={}){if(t.mid&&this.sendMetrika(t.mid),t.cid){let n={cid:t.cid,counter_name:e};i.default.isEmpty(s)||(n=i.default.extend(n,s));(new Image).src=this.getLink(n)}if(n.DEBUG&&window.debugEnabled&&"hover"!==e){const i=[];t.mid&&i.push("mc/"+t.mid),t.cid&&i.push("clck/"+t.cid),window.printDebug(`Event ${t.mid?"":e+": "}${i.join(", ")}`,s)}}send(e,t){const s=l.targets[e];e&&s&&this.getSid().then(()=>this.logEvent(e,s,t))}isTrackingDom(e){return e.hasAttribute&&e.hasAttribute("data-tracking-data")}getTrackingDomLeafData(e){const t=i.default.safeParseJSON(e.getAttribute("data-tracking-data"));return t.id||(t.id=e.getAttribute("id")),t}getTrackingDomFullData(e){const t=[],s={};let n,o;for(o=e;o.parentElement;o=o.parentElement)this.isTrackingDom(o)&&t.push(o);for(n=t.length-1;n>=0;n-=1)i.default.extend(s,this.getTrackingDomLeafData(t[n]));return s}sendSingleTrackingDom(e,t,s){this.send(t,i.default.extend(this.getTrackingDomFullData(e),s))}sendNestedTrackingDom(e,t,s){const n=i.default.extend({},s);let o=!1;const r=this;i.default.getEventPath(e).forEach((function(e){r.isTrackingDom(e)&&(o&&r.send(t,n),i.default.extend(n,r.getTrackingDomLeafData(e),{asParent:!0}),o=!0)})),o&&this.send(t,i.default.extend(n,{asParent:!1}))}}t.StatisticsModel=l,l.PID="453",l.DTYPE="stred",l.KEY_PREFIX="ytr",l.MAX_DATA_LENGTH=200,l.targets=r.default},function(e,t,s){"use strict";t.__esModule=!0,t.SyncPromise=void 0;class i{constructor(e){this.result=null,e&&e(e=>this.resolveSync(e))}resolveSync(e){this.result=e}then(e){const t=e&&e(this.result);return new i(e=>e(t))}}t.SyncPromise=i},function(e){e.exports=JSON.parse('{"render":{"cid":"73636"},"tap":{"cid":"73602"},"hover":{"cid":"73603"},"select_text_fragment":{"cid":"73604"},"copy_text_selection":{"cid":"73605"},"lang_swap":{"cid":"73192","mid":"LANGSELECT_FLIP"},"touch_fav_toggle":{"cid":"73264","mid":"TOUCH_FAVOURITES_TOGGLE"},"fav_menu_open":{"cid":"73259","mid":"FAVOURITES_MENU_OPEN"},"fav_sort":{"cid":"73257","mid":"FAVOURITES_SORT"},"fav_sync":{"cid":"73258","mid":"FAVOURITES_SYNC"},"cols_sync":{"cid":"73333","mid":"COLLECTIONS_SYNC"},"cols_record_add":{"cid":"73282","mid":"COLLECTIONS_RECORD_ADD"},"cols_record_delete":{"cid":"73283","mid":"COLLECTIONS_RECORD_DELETE"},"cols_record_insert":{"cid":"73287","mid":"COLLECTIONS_RECORD_INSERT"},"cols_records_delete":{"cid":"73284","mid":"COLLECTIONS_RECORDS_DELETE"},"cols_records_move":{"cid":"73285","mid":"COLLECTIONS_RECORDS_MOVE"},"cols_records_copy":{"cid":"73286","mid":"COLLECTIONS_RECORDS_COPY"},"cols_open":{"cid":"73288","mid":"COLLECTIONS_OPEN"},"cols_create":{"cid":"73289","mid":"COLLECTIONS_CREATE"},"cols_create_tap":{"cid":"74056","mid":"COLLECTIONS_CREATE_TAP"},"cols_rename":{"cid":"73290","mid":"COLLECTIONS_RENAME"},"cols_delete":{"cid":"73291","mid":"COLLECTIONS_DELETE"},"cols_clear":{"cid":"73810","mid":"COLLECTIONS_CLEAR"},"cols_public_change":{"cid":"73292","mid":"COLLECTIONS_PUBLIC_CHANGE"},"cols_subscribe":{"cid":"73293","mid":"COLLECTIONS_SUBSCRIBE"},"cols_subscribe_limit":{"cid":"73293"},"cols_unsubscribe":{"cid":"73294","mid":"COLLECTIONS_UNSUBSCRIBE"},"cols_save":{"cid":"73295","mid":"COLLECTIONS_SAVE"},"cols_search_activate":{"cid":"73296","mid":"COLLECTIONS_SEARCH_ACTIVATE"},"cols_menu_open":{"cid":"73297","mid":"COLLECTIONS_MENU_OPEN"},"cols_link_copy":{"cid":"73298","mid":"COLLECTIONS_LINK_COPY"},"cols_link_share":{"cid":"73299","mid":"COLLECTIONS_LINK_SHARE"},"cols_sharing_subscribe":{"cid":"73300","mid":"COLLECTIONS_SHARING_SUBSCRIBE"},"cols_db_error":{"cid":"73301","mid":"COLLECTIONS_DB_ERROR"},"cols_db_error_excp":{"cid":"73306","mid":"COLLECTIONS_DB_ERROR_EXCP"},"cols_db_inactive_tap":{"cid":"74057","mid":"COLLECTIONS_DB_INACTIVE_TAP"},"cols_no_col_for_active_id":{"cid":"73578"},"cols_reseted_ids":{"cid":"73361","mid":"COLLECTIONS_RESETED_IDS"},"cols_db_index_not_found":{"cid":"73954"},"training_open":{"cid":"73302","mid":"TRAINING_OPEN"},"training_settings_open":{"cid":"73303","mid":"TRAINING_SETTINGS_OPEN"},"training_progress_reset":{"cid":"73304","mid":"TRAINING_PROGRESS_RESET"},"training_swipe":{"cid":"73305"},"training_exit":{"cid":"73844","mid":"TRAINING_EXIT"},"training_end":{"cid":"73845","mid":"TRAINING_END"},"training_check_good":{"cid":"73847"},"training_check_bad":{"cid":"73848"},"training_level_changed":{"cid":"73883","mid":"TRAINING_LEVEL_CHANGED"},"training_skip":{"cid":"73882"},"training_started":{"cid":"74082","mid":"TRAINING_STARTED"},"training_revert":{"cid":"74070","mid":"TRAINING_REVERT"},"training_revert_banner_shown":{"cid":"74079","mid":"TRAINING_REVERT_BANNER_SHOWN"},"training_onboarding_shown":{"cid":"74078","mid":"TRAINING_ONBOARDING_SHOWN"},"training_revert_click_onboarding":{"cid":"74080","mid":"TRAINING_REVERT_CLICK_ONBOARDING"},"training_revert_click_banner":{"cid":"74081","mid":"TRAINING_REVERT_CLICK_BANNER"},"yata_init":{"cid":"73462","mid":"YATA_INIT"},"langselect_open_src":{"cid":"73465","mid":"LANGSELECT_OPEN_SRC"},"langselect_open_dst":{"cid":"73465","mid":"LANGSELECT_OPEN_DST"},"touch_langselect_open":{"cid":"73465","mid":"TOUCH_LANGSELECT_OPEN"},"langselect_select_src":{"cid":"73466","mid":"LANGSELECT_SELECT_SRC"},"langselect_select_dst":{"cid":"73466","mid":"LANGSELECT_SELECT_DST"},"langselect_recent_select_src":{"cid":"73466","mid":"LANGSELECT_RECENT_SELECT_SRC"},"langselect_recent_select_dst":{"cid":"73466","mid":"LANGSELECT_RECENT_SELECT_DST"},"touch_langselect_select":{"cid":"73466","mid":"TOUCH_LANGSELECT_SELECT"},"langselect_pin":{"cid":"73467","mid":"LANGSELECT_PIN"},"langselect_unpin":{"cid":"73467","mid":"LANGSELECT_UNPIN"},"text_translate":{"cid":"74058","mid":"TEXT_TRANSLATE"},"text_delete":{"cid":"73468","mid":"TEXT_DELETE"},"text_search":{"cid":"73471","mid":"TEXT_SEARCH"},"text_copy":{"cid":"73469","mid":"TEXT_COPY"},"text_select":{"cid":"73470","mid":"TEXT_SELECT"},"text_paste":{"cid":"73472","mid":"TEXT_PASTE"},"text_download":{"cid":"73473","mid":"TEXT_DOWNLOAD"},"url_translate":{"cid":"73535","mid":"URL_TRANSLATE"},"url_translate_enter":{"cid":"73535","mid":"URL_TRANSLATE_ENTER"},"url_translation_error":{"cid":"73536","mid":"URL_ERROR"},"url_loading_error":{"cid":"74022","mid":"URL_LOADING_ERROR"},"url_delete":{"cid":"73537","mid":"URL_DELETE"},"url_open_orig_in_new_tab":{"cid":"73881","mid":"URL_OPEN_ORIG_IN_NEW_TAB"},"url_loading_time":{"cid":"74095"},"url_translation_time":{"cid":"74096"},"url_dom_not_loaded":{"cid":"74098","mid":"URL_DOM_NOT_LOADED"},"url_error":{"cid":"74099","mid":"URL_FRAME_ERROR"},"touch_url_translate_error":{"cid":"74146","mid":"TOUCH_URL_TRANSLATE_ERROR"},"touch_url_frame_error":{"cid":"74145","mid":"TOUCH_URL_FRAME_ERROR"},"syns_insert":{"cid":"73474","mid":"SYNONYMS_INSERT"},"syns_show":{"cid":"73475","mid":"SYNONYMS_SHOW"},"suggestions_show":{"cid":"73798"},"suggestions_apply":{"cid":"73803"},"suggestions_item_navigate":{"cid":"73805"},"suggestions_item_hover":{"cid":"73800"},"predictor_show":{"cid":"73481"},"predictor_apply":{"cid":"73482","mid":"PREDICTOR_APPLY"},"dst_predictor_show":{"cid":"73585"},"dst_predictor_apply":{"cid":"73586"},"speller_autocorrect":{"cid":"74060","mid":"SPELLER_AUTOCORRECT"},"speller_click":{"cid":"73476","mid":"SPELLER_CLICK"},"speller_apply":{"cid":"73477","mid":"SPELLER_APPLY"},"speller_accept":{"cid":"73478","mid":"SPELLER_ACCEPT"},"speller_decline":{"cid":"73479","mid":"SPELLER_DECLINE"},"speller_switch_on":{"cid":"73480","mid":"SPELLER_SWITCH_ON"},"speller_switch_off":{"cid":"73480","mid":"SPELLER_SWITCH_OFF"},"tts_play":{"cid":"73483","mid":"TTS_PLAY"},"tts_native_play":{"cid":"73483","mid":"TTS_NATIVE_PLAY"},"tts_error":{"cid":"73484","mid":"TTS_ERROR"},"tts_native_error":{"cid":"73484","mid":"TTS_NATIVE_ERROR"},"touch_tts_animated_tap":{"cid":"73580","mid":"TOUCH_TTS_ANIMATED_TAP"},"translation_error":{"cid":"73486"},"translation_complain":{"cid":"73487","mid":"TRANSLATION_COMPLAIN"},"translation_edit":{"cid":"73488","mid":"TRANSLATION_EDIT"},"translation_edit_open":{"cid":"73489","mid":"TRANSLATION_EDIT_OPEN"},"translation_edit_close":{"cid":"73490","mid":"TRANSLATION_EDIT_CLOSE"},"asr_start":{"cid":"73491","mid":"ASR_START"},"asr_stop":{"cid":"73492","mid":"ASR_STOP"},"asr_error":{"cid":"73493","mid":"ASR_ERROR"},"asr_recognize":{"cid":"73494"},"touch_asr_disabled_tap":{"cid":"73495","mid":"TOUCH_ASR_DISABLED_TAP"},"rubber_scrolled":{"cid":"73599"},"dict_complain":{"cid":"73496","mid":"DICT_COMPLAIN"},"dict_complain_open":{"cid":"73497","mid":"DICT_COMPLAIN_OPEN"},"dict_complain_close":{"cid":"73497","mid":"DICT_COMPLAIN_CLOSE"},"dict_complain_error":{"cid":"73498"},"dict_show":{"cid":"73499","mid":"DICT_SHOW"},"dict_popup_show":{"cid":"73499","mid":"DICT_POPUP_SHOW"},"examples_rendered":{"cid":"73568","mid":"EXAMPLES_RENDERED"},"examples_popup_rendered":{"cid":"73568","mid":"EXAMPLES_POPUP_RENDERED"},"examples_complaint":{"cid":"73955","mid":"EXAMPLES_COMPLAINT"},"examples_complaint_start":{"cid":"73956","mid":"EXAMPLES_COMPLAINT_START"},"dict_examples_show":{"cid":"73500","mid":"DICT_EXAMPLES_SHOW"},"dict_examples_hide":{"cid":"73500","mid":"DICT_EXAMPLES_HIDE"},"dict_link_click":{"cid":"73501","mid":"DICT_LINK_CLICK"},"dict_toggle":{"cid":"73502","mid":"DICT_TOGGLE"},"definition_rendered":{"cid":"74186","mid":"DEFINITION_RENDERED"},"abbr_switched":{"cid":"74186","mid":"ABBR_SWITCHED"},"definition_source_click":{"cid":"74186","mid":"DEFINITION_SOURCE_CLICK"},"settings_open":{"cid":"73503","mid":"OPTIONS_OPEN"},"settings_onload":{"cid":"73504"},"settings_auto_click":{"cid":"73505","mid":"OPTIONS_CLICK_AUTO"},"settings_shift_click":{"cid":"73505","mid":"OPTIONS_CLICK_SHIFT"},"settings_enter_click":{"cid":"73505","mid":"OPTIONS_CLICK_SHIFT"},"settings_hotkeys_click":{"cid":"73505","mid":"OPTIONS_CLICK_SHIFT"},"settings_autocorrect_click":{"cid":"73505","mid":"OPTIONS_CLICK_SPELLER"},"settings_theme_change":{"cid":"73505","mid":"THEME_CHANGE"},"keyboard_open":{"cid":"73506","mid":"KEYBOARD_OPEN"},"keyboard_close":{"cid":"73506","mid":"KEYBOARD_CLOSE"},"sharing_open":{"cid":"73507","mid":"SHARING_OPEN"},"sharing_share_vkontakte":{"cid":"73508","mid":"SHARING_SHARE_VKONTAKTE"},"sharing_share_odnoklassniki":{"cid":"73508","mid":"SHARING_SHARE_ODNOKLASSNIKI"},"sharing_share_mail":{"cid":"73508","mid":"SHARING_SHARE_MAIL"},"stat_searchapp":{"cid":"73672"},"sharing_input_click":{"cid":"73509","mid":"SHARING_INPUT_CLICK"},"sharing_copy_click":{"cid":"73509","mid":"SHARING_COPY_CLICK"},"touch_ocr_open":{"cid":"73459","mid":"TOUCH_OCR_OPEN"},"touch_ocr_autoinit":{"cid":"73263","mid":"TOUCH_OCR_AUTOINIT"},"touch_ocr_tap":{"cid":"73687","mid":"TOUCH_OCR_TAP"},"touch_ocr_disabled_tap":{"cid":"73460","mid":"TOUCH_OCR_DISABLED_TAP"},"touch_ocr_langselect_open":{"cid":"73510","mid":"TOUCH_OCR_LANGSELECT_OPEN"},"touch_ocr_langselect_select":{"cid":"73511","mid":"TOUCH_OCR_LANGSELECT_SELECT"},"touch_ocr_langselect_swap":{"cid":"73512","mid":"TOUCH_OCR_FLIP"},"ocr_load_image":{"cid":"73513","mid":"OCR_LOAD_IMAGE"},"ocr_switch_mode":{"cid":"73515","mid":"OCR_SWITCH_MODE"},"ocr_recognize":{"cid":"73514","mid":"OCR_RECOGNIZE"},"ocr_select_area":{"cid":"73516","mid":"OCR_SELECT_AREA"},"ocr_box_tap":{"cid":"73517","mid":"OCR_BOX_TAP"},"ocr_translation_navigate":{"cid":"73518","mid":"OCR_TRANSLATION_NAVIGATE"},"touch_ocr_image_select":{"cid":"73519","mid":"TOUCH_OCR_IMAGE_SELECT"},"touch_ocr_rotation_apply":{"cid":"73521","mid":"TOUCH_OCR_ROTATION_APPLY"},"touch_ocr_download_image":{"cid":"73696","mid":"TOUCH_OCR_DOWNLOAD_IMAGE"},"touch_ocr_card_show":{"cid":"73522","mid":"TOUCH_OCR_CARD_SHOW"},"touch_ocr_card_tts_play":{"cid":"73523","mid":"TOUCH_OCR_CARD_TTS_PLAY"},"touch_ocr_card_tts_error":{"cid":"73524","mid":"TOUCH_OCR_CARD_TTS_ERROR"},"touch_ocr_card_tts_native_play":{"cid":"73523","mid":"TOUCH_OCR_CARD_TTS_NATIVE_PLAY"},"touch_ocr_card_tts_native_error":{"cid":"73524","mid":"TOUCH_OCR_CARD_TTS_NATIVE_ERROR"},"touch_ocr_card_tts_disabled_tap":{"cid":"73525","mid":"TOUCH_OCR_CARD_TTS_DISABLED_TAP"},"ocr_refresh_alert_show":{"cid":"73526","mid":"OCR_REFRESH_ALERT_SHOW"},"ocr_refresh_alert_click":{"cid":"73527","mid":"OCR_REFRESH_ALERT_CLICK"},"ocr_image_zoom_in":{"cid":"73528","mid":"OCR_IMAGE_ZOOM_IN"},"ocr_image_zoom_out":{"cid":"73528","mid":"OCR_IMAGE_ZOOM_OUT"},"ocr_move":{"cid":"73529","mid":"OCR_MOVE"},"ocr_delete":{"cid":"73530","mid":"OCR_DELETE"},"ocr_contrast_enable":{"cid":"74071","mid":"OCR_CONTRAST_ENABLE"},"ocr_contrast_disable":{"cid":"74071","mid":"OCR_CONTRAST_DISABLE"},"ocr_align_change":{"cid":"74072","mid":"OCR_ALIGN_CHANGE"},"ocr_orig_show":{"cid":"74073","mid":"OCR_ORIG_SHOW"},"ocr_orig_hide":{"cid":"74073","mid":"OCR_ORIG_HIDE"},"ocr_rotate":{"cid":"74074","mid":"OCR_ROTATE"},"ocr_download":{"cid":"74075","mid":"OCR_DOWNLOAD"},"resizer_onload":{"cid":"73531"},"resizer_resize":{"cid":"73532","mid":"RESIZER_RESIZE"},"url_page_interaction":{"cid":"73533","mid":"URL_PAGE_INTERACTION"},"sms_error":{"cid":"73534","mid":"SMS_ERROR"},"footer_promo_show":{"cid":"73538","mid":"FOOTER_PROMO_SHOW"},"footer_promo_close":{"cid":"73539","mid":"FOOTER_PROMO_CLOSE"},"url_mode_changed_s":{"cid":"73540","mid":"WINDOW_MODE_ORIGINAL"},"url_mode_changed_t":{"cid":"73540","mid":"WINDOW_MODE_TRANSLATION"},"url_layout_changed_s":{"cid":"73541","mid":"LAYOUT_MODE_OVERLAPPED"},"url_layout_changed_v":{"cid":"73541","mid":"LAYOUT_MODE_VERTICAL"},"url_layout_changed_h":{"cid":"73541","mid":"LAYOUT_MODE_HORIZONTAL"},"url_popup_expand":{"cid":"73542","mid":"TR_POPUP_EXPAND"},"url_popup_send":{"cid":"73543","mid":"TR_POPUP_SEND"},"url_popup_close":{"cid":"73544","mid":"TR_POPUP_CLOSE"},"url_popup_dislike":{"cid":"74151","mid":"TR_POPUP_DISLIKE"},"document_upload_tap":{"cid":"73674","mid":"DOCUMENT_UPLOAD_TAP"},"document_download_tap":{"mid":"DOCUMENT_DOWNLOAD_TAP","cid":"73694"},"document_translate":{"cid":"73675","mid":"DOCUMENT_TRANSLATE"},"size_error":{"cid":"73676","mid":"DOCUMENT_SIZE_ERROR"},"convert_error":{"cid":"73677","mid":"DOCUMENT_CONVERT_ERROR"},"document_error":{"cid":"73677","mid":"DOCUMENT_ERROR"},"document_download_error":{"cid":"73695","mid":"DOCUMENT_DOWNLOAD_ERROR"},"doc_mode_changed_s":{"cid":"73678","mid":"DOCUMENT_MODE_ORIGINAL"},"doc_mode_changed_t":{"cid":"73678","mid":"DOCUMENT_MODE_TRANSLATION"},"doc_layout_changed_s":{"cid":"73682","mid":"DOCUMENT_LAYOUT_OVERLAPPED"},"doc_layout_changed_v":{"cid":"73682","mid":"DOCUMENT_LAYOUT_VERTICAL"},"doc_layout_changed_h":{"cid":"73682","mid":"DOCUMENT_LAYOUT_HORIZONTAL"},"doc_popup_expand":{"cid":"73679","mid":"DOCUMENT_POPUP_EXPAND"},"doc_popup_send":{"cid":"73680","mid":"DOCUMENT_POPUP_SEND"},"doc_popup_close":{"cid":"73681","mid":"DOCUMENT_POPUP_CLOSE"},"refresh_alert_show":{"cid":"73545","mid":"REFRESH_ALERT_SHOW"},"refresh_alert_click":{"cid":"73546","mid":"REFRESH_ALERT_CLICK"},"session_resume":{"cid":"73547"},"visibility_change":{"cid":"73600"},"history_move":{"cid":"73635"},"touch_storage_error":{"cid":"73548"},"alt_translate_google":{"cid":"73549","mid":"ALTERNATIVE_TRANSLATE_GOOGLE"},"alt_translate_bing":{"cid":"73549","mid":"ALTERNATIVE_TRANSLATE_BING"},"translit_button_show":{"cid":"73550","mid":"TRANSLIT_BUTTON_SHOW"},"translit_show":{"cid":"73551","mid":"TRANSLIT_SHOW"},"translit_hide":{"cid":"73551","mid":"TRANSLIT_HIDE"},"translit_error":{"cid":"73552","mid":"TRANSLIT_ERROR"},"translation_vote_good":{"cid":"73553","mid":"TRANSLATION_VOTE_GOOD"},"translation_vote_bad":{"cid":"73553","mid":"TRANSLATION_VOTE_BAD"},"touch_webapp_prompt_show":{"cid":"73554","mid":"TOUCH_WEBAPP_PROMPT_SHOW"},"touch_webapp_prompt_install":{"cid":"73555","mid":"TOUCH_WEBAPP_PROMPT_INSTALL"},"touch_webapp_prompt_dismiss":{"cid":"73556","mid":"TOUCH_WEBAPP_PROMPT_DISMISS"},"corpus_request":{"cid":"73557","mid":"CORPUS_REQUEST"},"page_load":{"cid":"73558"},"landing_lyrics_load":{"cid":"73584"},"landing_lyrics_translate_button_click":{"cid":"73583"},"popup_show":{"cid":"73560","mid":"POPUP_SHOW"},"popup_empty_show":{"cid":"73560","mid":"POPUP_EMPTY_SHOW"},"popup_close":{"cid":"73560","mid":"POPUP_CLOSE"},"more_examples_click":{"cid":"73561","mid":"MORE_EXAMPLES_CLICK"},"examples_show":{"cid":"73562","mid":"EXAMPLES_SHOW"},"examples_hide":{"cid":"73562","mid":"EXAMPLES_HIDE"},"example_tab_click":{"cid":"73563","mid":"EXAMPLE_TAB_CLICK"},"example_sound":{"cid":"73566","mid":"EXAMPLE_SOUND_CLICK"},"example_origin_show":{"cid":"73564","mid":"EXAMPLE_ORIGIN_SHOW"},"custom_examples_close":{"cid":"73693","mid":"CUSTOM_EXAMPLES_CLOSE"},"touch_tab_click":{"cid":"73639","mid":"TOUCH_TAB_CLICK"},"select_tooltip_show":{"cid":"73565","mid":"SELECT_TOOLTIP_SHOW"},"auto_play_text":{"cid":"73593","mid":"AUTO_PLAY_TEXT"},"example_vote_good":{"cid":"73588","mid":"EXAMPLE_VOTE_GOOD"},"example_vote_bad":{"cid":"73588","mid":"EXAMPLE_VOTE_BAD"},"touch_landing_show":{"cid":"73697","mid":"TOUCH_LANDING_SHOW"},"touch_landing_download":{"cid":"73698","mid":"TOUCH_LANDING_DOWNLOAD"},"touch_landing_close":{"cid":"73699","mid":"TOUCH_LANDING_CLOSE"},"touch_landing_close_cross":{"cid":"73708","mid":"TOUCH_LANDING_CLOSE_CROSS"},"touch_dialog_tap":{"cid":"73686","mid":"TOUCH_DIALOG_TAP"},"touch_dialog_disabled_tap":{"cid":"73686","mid":"TOUCH_DIALOG_DISABLED_TAP"},"dist_banner_render":{"cid":"73692","mid":"SHOW_DIST_BANNER"},"dist_banner_hide":{"cid":"73743","mid":"AUTO_HIDE_DIST_BANNER"},"hide_banners_setting_enabled":{"cid":"74061","mid":"HIDE_BANNERS_SETTING_ENABLED"},"hide_banners_setting_disabled":{"cid":"74062","mid":"HIDE_BANNERS_SETTING_DISABLED"},"history_setting_enabled":{"cid":"74063","mid":"HISTORY_SETTING_ENABLED"},"history_setting_disabled":{"cid":"74064","mid":"HISTORY_SETTING_DISABLED"},"tap_miss":{"cid":"73700","mid":"TAP_MISS"},"uniproxy_asr_error":{"cid":"73710","mid":"UNIPROXY_ASR_ERROR"},"uniproxy_tts_error":{"cid":"73711","mid":"UNIPROXY_TTS_ERROR"},"typing_speed_report":{"cid":"73797"},"history_open":{"cid":"73811","mid":"HISTORY_OPEN"},"history_select":{"cid":"73812","mid":"HISTORY_SELECT"},"focused_element_activation":{"cid":"73880","mid":"FOCUSED_ELEMENT_ACTIVATION"},"example_link_click":{"cid":"74065","mid":"EXAMPLE_LINK_CLICK"},"example_tab_word_click":{"cid":"74067","mid":"EXAMPLE_TAB_WORD_CLICK"},"dict_show_more":{"cid":"74068","mid":"DICT_SHOW_MORE"},"touch_header_click":{"cid":"74069","mid":"TOUCH_HEADER_CLICK"},"idioms_info_click":{"cid":"74083","mid":"IDIOMS_INFO_CLICK"},"idioms_complaint_click":{"cid":"74084","mid":"IDIOMS_COMPLAINT_CLICK"},"idioms_complaint_send":{"cid":"74085","mid":"IDIOMS_COMPLAINT_SEND"},"idioms_rendered":{"cid":"74086","mid":"IDIOMS_RENDERED"},"idioms_text_click":{"cid":"74087","mid":"IDIOMS_TEXT_CLICK"},"idiom_example_popup_open":{"cid":"74088","mid":"IDIOM_EXAMPLE_POPUP_OPEN"},"touch_idiom_text_expand":{"cid":"74089","mid":"TOUCH_IDIOM_TEXT_EXPAND"},"related_words_render":{"cid":"74090","mid":"RELATED_WORDS_RENDER"},"related_words_click":{"cid":"74091","mid":"RELATED_WORDS_CLICK"},"related_words_expand":{"cid":"74092","mid":"RELATED_WORDS_EXPAND"},"related_words_complaint_send":{"cid":"74093","mid":"RELATED_WORDS_COMPLAINT_SEND"},"mini_nav_item_click":{"cid":"74186","mid":"MINI_NAV_ITEM_CLICK"},"mini_nav_control_click":{"cid":"74186","mid":"MINI_NAV_CONTROL_CLICK"},"declensions_render":{"cid":"74101","mid":"DECLENSIONS_RENDER"},"declensions_click":{"cid":"74102","mid":"DECLENSIONS_CLICK"},"declensions_complaint_send":{"cid":"74103","mid":"DECLENSIONS_COMPLAINT_SEND"},"declensions_expand":{"cid":"74104","mid":"DECLENSIONS_EXPAND"},"declensions_tab_click":{"cid":"74186","mid":"DECLENSIONS_TAB_CLICK"},"declensions_list_scroll":{"cid":"74186","mid":"DECLENSIONS_LIST_SCROLL"},"langs_search_tap":{"cid":"74138","mid":"TOUCH_LANGSELECT_OPEN_SEARCH"},"langs_search_select_lang":{"cid":"74139","mid":"TOUCH_LANGSELECT_SEARCH_SELECT"},"touch_night_theme_user_activation":{"cid":"74140","mid":"TOUCH_DARK_THEME_USER_ACTIVATION"},"touch_night_theme_auto_activation":{"cid":"74141","mid":"TOUCH_DARK_THEME_AUTO_ACTIVATION"},"touch_night_theme_promo_show":{"cid":"74147","mid":"TOUCH_DARK_THEME_PROMO_SHOW"},"touch_night_theme_promo_close":{"cid":"74148","mid":"TOUCH_DARK_THEME_PROMO_CLOSE"},"touch_navigate_text":{"mid":"TOUCH_NAVIGATE_TRANSLATE"},"touch_navigate_dialog":{"mid":"TOUCH_NAVIGATE_DIALOG"},"touch_navigate_history":{"mid":"TOUCH_NAVIGATE_HISTORY"},"touch_navigate_favorites":{"mid":"TOUCH_NAVIGATE_FAVORITES"},"touch_nav_tab_activation":{"cid":"74184"},"touch_expand_navigation":{"mid":"TOUCH_EXPAND_NAVIGATION","cid":"74185"},"touch_history_collection_open":{"mid":"TOUCH_HISTORY_COLLECTION_OPEN"},"touch_favorites_collection_open":{"mid":"TOUCH_FAVORITES_COLLECTION_OPEN"},"example_scroll_control_click":{"mid":"EXAMPLE_SCROLL_CONTROL_CLICK"},"example_ref_click":{"cid":"74186","mid":"EXAMPLE_REF_CLICK"},"popup_night_theme_activation":{"mid":"POPUP_NIGHT_THEME_ACTIVATION"},"themes_popup_close":{"mid":"THEMES_POPUP_CLOSE"},"themes_popup_show":{"mid":"THEMES_POPUP_SHOW"},"theme_page_open":{"mid":"THEME_PAGE_OPEN"},"desktop_redesign_enable_redesign":{"cid":"74186"},"speller_popup_shown":{"cid":"74186"},"speller_popup_close_click":{"cid":"74186"},"tts_play_src":{"mid":"TTS_PLAY_SRC","cid":"74186"},"tts_play_dst":{"mid":"TTS_PLAY_DST","cid":"74186"},"examples_show_more":{"mid":"EXAMPLES_SHOW_MORE","cid":"74186"},"touch_ocr_langselect_select_src":{"mid":"TOUCH_OCR_LANGSELECT_SELECT_SRC","cid":"74186"},"touch_ocr_langselect_select_dst":{"mid":"TOUCH_OCR_LANGSELECT_SELECT_DST","cid":"74186"},"touch_ocr_langselect_open_src":{"mid":"TOUCH_OCR_LANGSELECT_OPEN_SRC","cid":"74186"},"touch_ocr_langselect_open_dst":{"mid":"TOUCH_OCR_LANGSELECT_OPEN_DST","cid":"74186"},"langselect_search_button_click":{"mid":"LANGSELECT_SEARCH_BUTTON_CLICK","cid":"74186"},"langselect_search_type":{"mid":"LANGSELECT_SEARCH_TYPE","cid":"74186"},"document_reset_doc":{"mid":"DOCUMENT_RESET_DOC","cid":"74186"},"sid_fetched":{"cid":"74186"},"tts_stop_src":{"mid":"TTS_STOP_SRC","cid":"74186"},"tts_stop_dst":{"mid":"TTS_STOP_DST","cid":"74186"},"document_translated":{"mid":"DOCUMENT_TRANSLATED","cid":"74186"},"selection_promo_show":{"mid":"SELECTION_POPUP_SHOW","cid":"74186"},"redirect_to_source":{"cid":"74186"},"first_translation_request":{"cid":"74186"},"first_translation_response":{"cid":"74186"},"selection_sheet_expand":{"cid":"74186"},"selection_sheet_syn_click":{"cid":"74186"},"daily_phrase_activate":{"cid":"74186"},"stories_open":{"cid":"74186"},"stories_activate":{"cid":"74186"},"stories_move":{"cid":"74186"},"stories_close":{"cid":"74186"},"stories_feedback":{"cid":"74186"},"stories_rendered":{"cid":"74186"},"stories_desktop_preview_move":{"cid":"74186"},"stories_touch_preview_visible":{"cid":"74186"},"feedback_show":{"cid":"74186"},"feedback_vote_click":{"cid":"74186"},"feedback_input_focus":{"cid":"74186"},"feedback_send":{"cid":"74186"},"feedback_cancel":{"cid":"74186"},"feedback_close":{"cid":"74186"},"sticky_header_scroll_to_top":{"cid":"74186"},"sticky_header_open_menu":{"cid":"74186"},"backspace_pressed":{"cid":"74186"},"keyboard_closed":{"cid":"74186"},"definition_complaint_send":{"cid":"74186"},"hotkeys_cheat_sheet_open":{"cid":"74186"},"hotkey_used":{"cid":"74186"},"block_visible":{"cid":"74186"},"ocr_complaint_send":{"cid":"74186"},"ocr_complaint_open":{"cid":"74186"}}')},function(e,t,s){"use strict";t.__esModule=!0,t.BaseApplication=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(3),r=s(9),a=s(14),l=s(17);class c extends l.Presenter{constructor(e={}){super(e),this._activeModules=[],this._config=e.config;const t=this,s=this.getView(),i=function(e){if("hidden"in document)return"hidden";for(let t=0;t<e.length;t++){const s=e[t]+"Hidden";if(s in document)return s}return""}(["webkit","moz","ms","o"]),a=n.default.debounce((function(){t.emit("resize")}));document.addEventListener("DOMContentLoaded",(function(){s.setState("unresolved",!1),t.emit("pageReady")}),!1),window.addEventListener("load",(function e(){window.addEventListener("online",t.updateOnlineStatus.bind(t,!1)),window.addEventListener("offline",t.updateOnlineStatus.bind(t,!1)),t.emit("pageLoaded"),this.removeEventListener("load",e,!1)}),!1),window.addEventListener("resize",a,!1),window.addEventListener("orientationchange",a,!1),window.addEventListener("scroll",n.default.throttle((function(){t.emit("bodyScroll")}))),i&&document.addEventListener(i.replace(/hidden/i,"")+"visibilitychange",(function(){o.$tracker.sendMetric("visibility_change",{hidden:document[i]})}),!1),s.on("tap",(function(e){const s=this.getClosest(e.target,(function(e){return e.hasAttribute("data-action")})),i=this.getClosest(e.target,(function(e){return e.hasAttribute("data-tracker-goal")}));try{(0,r.setLatestTapEvent)(e,e.target,s)}catch(e){}if(s){const i=s.getAttribute("data-action");s.hasAttribute("data-no-prevent")||n.default.preventEvent(e),t.emit("action",i,s,{originalEvent:e}).emit("action:"+i,s,{originalEvent:e})}i&&t.emit("track",i.getAttribute("data-tracker-goal")),(0,r.isPrevTapMiss)()&&t.emit("prevTapMiss")})),this.updateOnlineStatus(!0)}getConfig(){return this._config}registerModule(e){return n.default.queueTask(()=>{const t=Date.now(),s=new e(this,this.getConfig());a.logTime.module(s.moduleName||s.moduleId,Date.now()-t),this._activeModules.push(s)}),this}reload(){if(this.getSettings()){const e=this.getModel().getProperty("trText");this.getSettings().setProperty("savedText",e)}window.location.href=window.location.href}reloadIfSessionExpired(){Date.now()-c.SESSION_START>c.SESSION_EXPIRATION_TIME&&this.reload()}updateOnlineStatus(e=!1){this.getModel().setProperty("appOnline",n.default.isOnline(),{silent:e})}getSettings(){return this._settings}}t.BaseApplication=c,c.SESSION_START=Date.now(),c.SESSION_EXPIRATION_TIME=2592e5},function(e,t,s){"use strict";t.__esModule=!0,t.LANG_SELECT_EVENTS=t.HIGHLIGHT_ATTR=t.DesktopLanguagesModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(2),r=s(107),a=s(7),l=s(110);t.LANG_SELECT_EVENTS={LANG_SELECTED:"langSelected",OPEN_LANG_SELECT:"openLangSelect",LANG_SELECT_EXPANDED:"langSelectExpanded"};t.HIGHLIGHT_ATTR="data-highlighted";class c extends r.AbstractLanguagesModule{constructor(e,t){super(e,t),this.srcLangButton=this.makeSrcLangButton(),this.dstLangButton=this.makeDstLangButton(),this.resetText(),this.resetText=n.default.debounce(this.resetText,100),this.debouncedSetInputFocus=this.debounceMethod(()=>this.view.setInputFocus(),100),this.visibilityTimeout=null,this.savedViewportWidth=document.documentElement.clientWidth,this.setupLangButtons(),this.setupAppView(),this.listenApp(),this.listenAppModel(),this.listenAppView()}setupAppView(){this.appView.setState("auto",this.appSettings.isAutodetectEnabled())}setupLangButtons(){const e=(e,t)=>{this.appSettings.setProperty(e,t),this.appModel.setProperty(e,t);(e===a.LANG_PROPS.SRC_LANG?this.srcLangButton:this.dstLangButton).setContent(this.appConfig.TRANSLATOR_LANGS[t],{asText:!0})};e(a.LANG_PROPS.SRC_LANG,this.app.getDefaultSrcLanguage()),e(a.LANG_PROPS.DST_LANG,this.app.getDefaultDstLanguage())}closeView(){this.view&&(this.view.reset(),this.view.setVisible(!1))}openLanguagesView(e){const t=this.view&&e!==this.view.getType(),s=this.view&&this.view.isVisible();clearTimeout(this.visibilityTimeout),this.resetText(),super.openLanguagesView(e),s&&this.closeView(),t&&s?this.visibilityTimeout=setTimeout(()=>{this.activateLanguagesView()},250):s||this.activateLanguagesView()}activateLanguagesView(){this.view.updateAsync.callNow.call(this.view),this.view.setVisible(!0),this.debouncedSetInputFocus()}initInternal(){this.view=this.makeLanguageSelectComponent(),super.initInternal(),this.view.onStateChanged("hidden",e=>{const t=this.view.isSrc();this.appView.setState("langs_opened",!e),this.appView.setState("langs_opened_src",t);const s=t?this.srcLangButton:this.dstLangButton,i=t?this.dstLangButton:this.srcLangButton;s.setState({expanded:!e}),i.setState({expanded:!1})}),this.srcLanguagesModel.onChange("autodetect",e=>{this.appView.setState("auto",e),this.app.emit("action:toggleAuto")})}handleResize(){const e=document.documentElement.clientWidth;e!==this.savedViewportWidth&&(this.savedViewportWidth=e,this.closeView())}listenApp(){this.app.on("resize",()=>this.handleResize()).onAction("swapDirection",()=>this.app.swapDirection())}listenAppModel(){this.appModel.onChange(a.LANG_PROPS.SRC_LANG,e=>{this.srcLangButton.setContent(this.appConfig.TRANSLATOR_LANGS[e],{asText:!0})}).onChange(a.LANG_PROPS.DST_LANG,e=>{this.dstLangButton.setContent(this.appConfig.TRANSLATOR_LANGS[e],{asText:!0})})}listenAppView(){this.appView.onTap(e=>{this.isLangSelectNode(e)||this.closeView()})}isLangButton(e){return e===this.appConfig.ELEMENTS.srcLangButton||e===this.appConfig.ELEMENTS.dstLangButton}isLangSelectNode(e){return!!this.view&&(this.view.getElement().contains(e.target)||this.isLangButton(e.target))}resetText(){return this.view&&this.view.reset()}getTranslatorElement(){return this.appConfig.ELEMENTS.translator}makeLanguageSelectComponent(){return new l.LanguagesComponent({tags:this.appConfig.TRANSLATOR_LANGS_TAGS,langs:this.appConfig.TRANSLATOR_LANGS,srcLang:this.appModel.getProperty(a.LANG_PROPS.SRC_LANG),dstLang:this.appModel.getProperty(a.LANG_PROPS.DST_LANG),translatorElement:this.getTranslatorElement(),appView:this.appView,isImprovedLangSelect:this.appConfig.ENABLE_IMPROVED_LANG_SELECT,isRecentLangsColumnEnabled:this.appConfig.ENABLE_RECENT_LANGS_COLUMN},{container:this.appConfig.ELEMENTS.langSelect,hideAfterTransition:!0})}makeSrcLangButton(){return new o.TouchView({element:this.appConfig.ELEMENTS.srcLangButton,DOMEvents:"keydown keypress",activateFocus:!0})}makeDstLangButton(){return new o.TouchView({element:this.appConfig.ELEMENTS.dstLangButton,DOMEvents:"keydown keypress",activateFocus:!0})}}t.DesktopLanguagesModule=c},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractLanguagesModule=void 0;var i=s(3),n=s(5),o=s(7),r=s(108),a=s(109);class l extends n.AppModule{constructor(e,t){super(e,t),this.moduleName="langs",this.app.onAction(o.LANG_EVENTS.EVENT_OPEN_SRC_LANGUAGES,()=>this.openLanguagesView("src")).onAction(o.LANG_EVENTS.EVENT_OPEN_DST_LANGUAGES,()=>this.openLanguagesView("dst")).onAction(["swapLang","swapDirection"],()=>{const e=this.appModel.getProps();i.$tracker.sendMetric("lang_swap",{dir:e.srcLang+"-"+e.dstLang})}),this.setupLangsHistory()}setupLangsHistory(){const e=this.appSettings.getSrcLangHistory(),t=this.appSettings.getDstLangHistory();Object.keys(e).length||this.appSettings.setSrcLangHistory({[this.appConfig.UI_LANG]:!0}),Object.keys(t).length||this.appSettings.setDstLangHistory({[this.app.getDefaultDstLanguage()]:!0})}openLanguagesView(e){if(this.view||this.initInternal(),!this.view.isVisible()||e!==this.view.getType()){const t="src"===e,s=Date.now();t?(this.srcLanguagesModel.setProperty({languagesOpenAt:s}),this.srcRecentLanguagesModel.setProperty({languagesOpenAt:s})):(this.dstLanguagesModel.setProperty({languagesOpenAt:s}),this.dstRecentLanguagesModel.setProperty({languagesOpenAt:s}));const n=t?o.LANG_METRIKAS.OPEN_SRC_SELECT:o.LANG_METRIKAS.OPEN_DST_SELECT;i.$tracker.sendMetric(n)}this.view.setType(e),"src"===e?this.view.setModel(this.srcLanguagesModel).setRecentLanguagesModel(this.srcRecentLanguagesModel):this.view.setModel(this.dstLanguagesModel).setRecentLanguagesModel(this.dstRecentLanguagesModel)}initInternal(){this.srcLanguagesModel=new r.LanguagesModel({languages:this.appConfig.TRANSLATOR_LANGS,currentLanguage:this.appModel.getProperty(o.LANG_PROPS.SRC_LANG),autodetectAllowed:!0,autodetect:this.appSettings.isAutodetectEnabled()},{filters:this.getSrcLangsModelFilters()}),this.srcLanguagesModel.onChange(o.LANG_PROPS.AUTODETECT,e=>this.appSettings.setAutodetectEnabled(e)).onSet(o.LANG_PROPS.CURRENT_LANG,e=>{this.app.setSrcLanguage(e,{sender:o.LANG_PROPS.SENDER_LANG_SELECT}),this.srcRecentLanguagesModel.setLanguage(e,{silent:!0}),this.closeView()}),this.srcRecentLanguagesModel=new a.RecentLanguagesModel({limit:this.appConfig.MAX_RECENT_LANGUAGES,languages:this.appConfig.TRANSLATOR_LANGS,currentLanguage:this.appModel.getProperty(o.LANG_PROPS.SRC_LANG)},{filters:this.getSrcLangsModelFilters()}),this.srcRecentLanguagesModel.setRecentLanguages(this.appSettings.getSrcLangHistory()),this.srcRecentLanguagesModel.onChange(o.LANG_PROPS.RECENT_LANGUAGES,()=>this.appSettings.setSrcLangHistory(this.srcRecentLanguagesModel.getRecentLanguages())).onChange(o.LANG_PROPS.CURRENT_LANG,e=>{this.app.setSrcLanguage(e,{sender:o.LANG_PROPS.SENDER_LANG_HISTORY}),this.closeView()}),this.dstLanguagesModel=new r.LanguagesModel({languages:this.appConfig.TRANSLATOR_LANGS,currentLanguage:this.appModel.getProperty(o.LANG_PROPS.DST_LANG)}),this.dstLanguagesModel.onSet(o.LANG_PROPS.CURRENT_LANG,e=>{this.app.setDstLanguage(e,{sender:o.LANG_PROPS.SENDER_LANG_SELECT}),this.dstRecentLanguagesModel.setLanguage(e,{silent:!0}),this.closeView()}),this.dstRecentLanguagesModel=new a.RecentLanguagesModel({limit:this.appConfig.MAX_RECENT_LANGUAGES,languages:this.appConfig.TRANSLATOR_LANGS,currentLanguage:this.appModel.getProperty(o.LANG_PROPS.DST_LANG)}),this.dstRecentLanguagesModel.setRecentLanguages(this.appSettings.getDstLangHistory()),this.dstRecentLanguagesModel.onChange(o.LANG_PROPS.RECENT_LANGUAGES,()=>this.appSettings.setDstLangHistory(this.dstRecentLanguagesModel.getRecentLanguages())).onChange(o.LANG_PROPS.CURRENT_LANG,e=>{this.app.setDstLanguage(e,{sender:o.LANG_PROPS.SENDER_LANG_HISTORY}),this.closeView()}),this.view.setModel(this.srcLanguagesModel).setRecentLanguagesModel(this.srcRecentLanguagesModel),this.appModel.onChange(o.LANG_PROPS.SRC_LANG,e=>{this.srcLanguagesModel.setLanguage(e),this.srcRecentLanguagesModel.setLanguage(e)}).onChange(o.LANG_PROPS.DST_LANG,e=>{this.dstLanguagesModel.setLanguage(e),this.dstRecentLanguagesModel.setLanguage(e)}).onSet("translation",e=>{e&&(this.srcRecentLanguagesModel.update(),this.dstRecentLanguagesModel.update())})}getSrcLangsModelFilters(){return{}}}t.AbstractLanguagesModule=l},function(e,t,s){"use strict";t.__esModule=!0,t.LanguagesModel=void 0,s(1);var i=s(4),n=s(7);class o extends i.Model{getLanguages(e){const t=this.getProperty(n.LANG_PROPS.ALL_LANGUAGES);return e?this.findLanguages(t,e):t}getLanguageMatches(e){const t=Object.entries(this.getProperty(n.LANG_PROPS.ALL_LANGUAGES));if(!e)return{goodMatches:t,otherMatches:[]};const s=e.length,i=e.trim().toLowerCase();return t.reduce((e,[t,n])=>{const o=n.toLowerCase().indexOf(i),r=t.indexOf(i);if(o>=0){const i=[t,{name:n,start:o,size:s}];(0===o?e.goodMatches:e.otherMatches).push(i)}else if(r>=0){const s=[t,{name:n,start:0,size:0}];e.otherMatches.push(s)}return e},{goodMatches:[],otherMatches:[]})}getLanguageName(e){return this.getProperty(n.LANG_PROPS.ALL_LANGUAGES)[e]}findLanguages(e,t){const s=t.length,i=t.trim().toLowerCase();return Object.keys(e).reduce((t,n)=>{const o=e[n].toLowerCase().indexOf(i),r=n.indexOf(i);return o>=0?t[n]={code:n,name:e[n],start:o,size:s}:r>=0&&(t[n]={code:n,name:e[n],start:0,size:0}),t},{})}setLanguage(e){return this.setProperty(n.LANG_PROPS.CURRENT_LANG,e)}getCurrentLanguage(){return this.getProperty(n.LANG_PROPS.CURRENT_LANG)}setAutodetectEnabled(e){return this.setProperty(n.LANG_PROPS.AUTODETECT,e)}isAutodetectEnabled(){return this.getProperty(n.LANG_PROPS.AUTODETECT)}isAutodetectAllowed(){return this.getProperty("autodetectAllowed")}}t.LanguagesModel=o,o.defaults={currentLanguage:"",languages:{},autodetectAllowed:!1,autodetect:!1,languagesOpenAt:0}},function(e,t,s){"use strict";t.__esModule=!0,t.RecentLanguagesModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(4),r=s(7);class a extends o.Model{setRecentLanguages(e){return this.setProperty(r.LANG_PROPS.RECENT_LANGUAGES,n.default.safeStringifyJSON(e))}setLanguage(e,t){return this.setProperty(r.LANG_PROPS.CURRENT_LANG,e,t)}getLanguage(){return this.getProperty(r.LANG_PROPS.CURRENT_LANG)}getRecentLanguages(){return n.default.safeParseJSON(this.getProperty(r.LANG_PROPS.RECENT_LANGUAGES))}togglePin(e){const t=this.getRecentLanguages();return t.hasOwnProperty(e)&&(t[e]=!t[e],this.setRecentLanguages(t)),this}getLanguageName(e){return this.getProperty("languages")[e]}update(){let e=this.getProperty("limit");const t=this.getRecentLanguages(),s=this.getLanguage(),i={},n=[],o=[];if(t[s])return;if(Object.keys(t).forEach((function(e){t[e]?n.push(e):o.push(e)})),e-=n.length,e<=0)return;const r=o.indexOf(s);r>=0&&o.splice(r,1),o.unshift(s)>e&&(o.length=e),n.forEach((function(e){i[e]=!0})),o.forEach((function(e){i[e]=!1})),this.setRecentLanguages(i)}}t.RecentLanguagesModel=a,a.defaults={limit:20,language:"",languages:{},currentLanguage:"",languagesOpenAt:0}},function(e,t,s){"use strict";t.__esModule=!0,t.LanguagesComponent=t.HIGHLIGHT_ATTR=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(11),r=s(111),a=s(112),l=s(117),c=s(42),d=s(121),u=s(123);function h(e,t,s){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}t.HIGHLIGHT_ATTR="data-highlighted";class g extends a.AbstractLanguagesComponent{constructor(e,t){super(e,t),this.refs={container:"container"},this.onRendered(()=>{this.setProperty("elements",n.default.slice(this.getElement().querySelectorAll('[data-lang-element="true"]')))}).onStateChanged("hidden",e=>{e||this.resetHighlight()}),this.listenAppView()}listenAppView(){const{appView:e}=this.getProps();e.on("keydown",e=>{if(e.keyCode===o.InputView.keys.ESCAPE&&(this.reset(),this.setVisible(!1)),this.isVisible())switch(e.keyCode){case o.InputView.keys.UP:n.default.preventEvent(e),this.highlightPrev();break;case o.InputView.keys.DOWN:n.default.preventEvent(e),this.highlightNext();break;case o.InputView.keys.ENTER:let t=this.getHighlightedElement();t&&(n.default.preventEvent(e),this.onLanguageTapped(n.default.getAttribute(t,"data-value"),this.isSrc()))}}).on("keypress",e=>{e.which&&this.isVisible()&&!this.isInputFocused()&&(n.default.preventEvent(e),this.highlightByText(String.fromCharCode(e.which)))})}reset(){super.reset(),this.resetSearchQuery()}initChildComponents(){const{translatorElement:e,tags:t,isImprovedLangSelect:s,isRecentLangsColumnEnabled:i}=this.getProps();this.headerComponent=new l.LanguagesHeader({container:this._element,isImprovedLangSelect:s}),this.autoSwitcherComponent=new c.AutoLangSwitcherComponent,this.recentLangsComponent=new d.RecentLanguagesComponent({isImprovedLangSelect:s});this.allLangsComponent=new u.AllLanguagesComponent({translatorElement:e,tags:t,parentElement:this.getContainer(),isImprovedLangSelect:s,isRecentLangsColumnEnabled:i,renderRecentLangsColumn:i?()=>this.recentLangsComponent.getDirective({isColumn:!0}):null})}setModel(e){return super.setModel(e),this.headerComponent.setAutoDetectModel(e),this.recentLangsComponent.setAutoDetectModel(e),this}getElements(){return this.getProperty("elements")}getHighlightedElement(){return this.getElement().querySelector('[data-highlighted="true"]')}resetHighlight(){const e=this.getHighlightedElement();e&&e.setAttribute("data-highlighted","false")}isInputFocused(){return this.headerComponent.isInputFocused()}setInputFocus(){this.headerComponent.setInputFocus()}resetSearchQuery(){this.headerComponent.resetSearchQuery()}onLanguageTapped(e){this.allLangsComponent.onLanguageTapped(e)}highlightElement(){return r.ListboxViewKB.prototype.highlightElement.apply(this,arguments)}highlightPrev(){return r.ListboxViewKB.prototype.highlightPrev.apply(this)}highlightNext(){return r.ListboxViewKB.prototype.highlightNext.apply(this)}highlightByText(e){let t,s;const i=this.getElements();for(this._text+=e.toLowerCase(),t=0,s=i.length;t<s;t++){if(0===n.default.trim(i[t].textContent.toLowerCase()).indexOf(this._text)){this.highlightElement(i[t]);break}}}onMouseOver(e){const t=n.default.getClosest(e.target,e=>e.hasAttribute("data-value"));this.highlightElement(t)}template({html:e,nothing:t,cn:s}){if(!this.model)return t;const{isImprovedLangSelect:i,isRecentLangsColumnEnabled:n}=this.getProps(),o=s("langs");return e`
            ${this.headerComponent.getDirective()}
            <div
                data-ref-id="${this.refs.container}"
                class="${o("content",{improved:i})}"
                @mouseover=${e=>this.onMouseOver(e)}
                @mouseleave=${e=>this.resetHighlight(e)}
            >
                ${n?t:this.recentLangsComponent.getDirective()}
                ${this.allLangsComponent.getDirective()}
            </div>
        `}}t.LanguagesComponent=g,g.defaults={...h(p(g),"defaults",g),elements:[]}},function(e,t,s){"use strict";t.__esModule=!0,t.ListboxViewKB=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(29),r=s(2);class a extends o.ListboxView{constructor(e={}){super(e),this._elements=[],this.resetText(),this.resetText=n.default.debounce(this.resetText,e.textResetDelay||1e3),this.on("contentChanged",(function(){this._elements=this.getContentElement("["+o.ListboxView.VALUE_ATTR+"]",!0)})).on(r.TouchView.eventTypes.OVER,(function(e){const t=this.getClosest(e.target,(function(e){return e.hasAttribute(o.ListboxView.VALUE_ATTR)}),!0);this.highlightElement(t)})).bindDOMEvents(r.TouchView.eventTypes.OVER)}resetText(){return this._text="",this}getElements(){return n.default.slice(this._elements)}highlightPrev(){const e=this.getElements();let t=e.indexOf(this.getHighlightedElement())-1;return t<0&&(t=e.length-1),this.highlightElement(e[t])}highlightNext(){const e=this.getElements(),t=(e.indexOf(this.getHighlightedElement())+1)%e.length;return this.highlightElement(e[t])}highlightByText(e){let t,s;const i=this.getElements();for(this._text+=e.toLowerCase(),t=0,s=i.length;t<s;t++)if(0===i[t].textContent.toLowerCase().indexOf(this._text)){this.highlightElement(i[t]);break}return this.resetText()}highlightByValue(e){let t,s;const i=this.getElements();for(t=0,s=i.length;t<s;t++)if(i[t].getAttribute(o.ListboxView.VALUE_ATTR)===e){this.highlightElement(i[t]);break}return this}highlightElement(e){const t=this.getHighlightedElement();return t&&t.removeAttribute(a.HIGHLIGHT_ATTR),e&&e.setAttribute(a.HIGHLIGHT_ATTR,!0),this}getHighlightedElement(){return this.getContentElement("["+a.HIGHLIGHT_ATTR+"]")}}t.ListboxViewKB=a,a.HIGHLIGHT_ATTR="data-highlighted"},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractLanguagesComponent=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(15),r=s(6),a=s(3),l=s(7);class c extends r.Component{initChildComponents(){}sendTypingMetric(e){a.$tracker.sendMetric(l.LANG_METRIKAS.SEARCH_TEXT_TYPE,{text:e,type:this.getType()})}constructor(e,t){super(e,t);const s=n.default.debounce(e=>this.sendTypingMetric(e),500);this.initChildComponents(),this.id="LanguagesComponent",this.headerComponent.on(l.COMPONENT_EVENTS.EVENT_INPUT,({value:e})=>{this.allLangsComponent.setProperty("searchQuery",e),this.recentLangsComponent.setProperty("searchQuery",e),this.setProperty("stateSearch",Boolean(e)).updateAsync(),e&&s(e)}),this.allLangsComponent.on(l.COMPONENT_EVENTS.EVENT_LANG_CHOOSE,({langCode:e,searchQuery:t})=>{const s=this.isSrc()?l.LANG_METRIKAS.SELECT_SRC_LANG:l.LANG_METRIKAS.SELECT_DST_LANG;a.$tracker.sendMetric(s,{recent:0,fromSearch:t?1:0,duration:Date.now()-this.model.getProperty("languagesOpenAt"),lang:e}),this.reset()})}isSrc(){return"src"===this.getProperty("type")}getId(){return this.id}reset(){this.setProperty("stateSearch",!1).setProperty("searchQuery",""),this.headerComponent.reset(),this.allLangsComponent.reset(),this.recentLangsComponent.reset()}setModel(e){return this.model=e,this.autoSwitcherComponent.setModel(e),this.allLangsComponent.setModel(e),this}setType(e){return this.recentLangsComponent.setType(e),this.setProperty({type:e})}getType(){return this.getProperty("type")}setRecentLanguagesModel(e){return this.recentModel=e,this.recentLangsComponent.setModel(e),this}getComponentName(){return"LanguagesComponent"}shouldToggleVisibility(e){return e===n.default.hasClass(this._element,o.STATE_PREFIX+o.VIEW_STATES.HIDDEN)}template(){}}t.AbstractLanguagesComponent=c,c.defaults={stateSearch:!1,type:""}},function(e,t,s){"use strict";t.__esModule=!0,t.defaultTemplateProcessor=t.DefaultTemplateProcessor=void 0;var i=s(27);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */class n{handleAttributeExpressions(e,t,s,n){const o=t[0];if("."===o){return new i.PropertyCommitter(e,t.slice(1),s).parts}if("@"===o)return[new i.EventPart(e,t.slice(1),n.eventContext)];if("?"===o)return[new i.BooleanAttributePart(e,t.slice(1),s)];return new i.AttributeCommitter(e,t,s).parts}handleTextExpression(e){return new i.NodePart(e)}}t.DefaultTemplateProcessor=n;const o=new n;t.defaultTemplateProcessor=o},function(e,t,s){"use strict";t.__esModule=!0,t.render=t.parts=void 0,s(1);var i=s(22),n=s(27),o=s(62);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const r=new WeakMap;t.parts=r;t.render=(e,t,s)=>{let a=r.get(t);void 0===a&&((0,i.removeNodes)(t,t.firstChild),r.set(t,a=new n.NodePart(Object.assign({templateFactory:o.templateFactory},s))),a.appendInto(t)),a.setValue(e),a.commit()}},function(e,t,s){"use strict";e.exports=s(116)},function(e,t,s){"use strict";function i(e){function t(t,n,o,r){var a=n?s+t+e.e+n:s+t,l=a;if(o){var c=" "+l+e.m;for(var d in o)if(o.hasOwnProperty(d)){var u=o[d];!0===u?l+=c+d:u&&(l+=c+d+i+u)}}if(void 0!==r)for(var h=0,p=r.length;h<p;h++){var g=r[h];if(g&&"string"==typeof g.valueOf())for(var m=g.valueOf().split(" "),E=0;E<m.length;E++){var _=m[E];_!==a&&(l+=" "+_)}}return l}var s=e.n||"",i=e.v||e.m;return function(e,s){return function(i,n,o){return"string"==typeof i?Array.isArray(n)?t(e,i,void 0,n):t(e,i,n,o):t(e,s,i,n)}}}Object.defineProperty(t,"__esModule",{value:!0});var n=i({e:"-",m:"_"});t.cn=n,t.withNaming=i},function(e,t,s){"use strict";t.__esModule=!0,t.LanguagesHeader=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(118),r=s(18),a=s(42);class l extends o.AbstractLanguagesHeader{constructor(e,t){super(e,t),this.debouncedSearchTextHandler=n.default.debounce(this.onSearchTextChanged,100),this.autoLangSwitcher=e.isImprovedLangSelect?new a.AutoLangSwitcherComponent({}):null}setAutoDetectModel(e){this.autoLangSwitcher&&this.autoLangSwitcher.setModel(e)}setInputFocus(){const e=this.getRef(this.refs.searchInput);e&&e.focus()}isInputFocused(){const e=this.getRef(this.refs.searchInput);return e&&document.activeElement===e}resetSearchQuery(){const e=this.getRef(this.refs.searchInput);e&&(e.value="")}renderImprovedHeader(){const{html:e,cn:t}=this.getRenderHelpers(),s=t("langs");return e`
            <div class="${s("searchPanel")}">
                <div class="${s("search")}">
                    <input
                        data-ref-id="${this.refs.searchInput}"
                        type="text"
                        placeholder=${r.desktopLocales.languageSelect.langSearch.trim()}
                        @input=${e=>this.debouncedSearchTextHandler(e.target)}
                    />
                </div>
                <div
                    class=${s("autoLangSwitcher")}
                    @click=${()=>this.autoLangSwitcher.onClick()}
                    tabindex="0"
                    data-default-enter-action="true"
                >
                    ${this.autoLangSwitcher.getDirective()}
                    ${r.desktopLocales.languageSelect.langAutoDetect}
                </div>
            </div>
        `}template({html:e,cn:t}){const{isImprovedLangSelect:s}=this.getProps();if(s)return this.renderImprovedHeader();return e`
            <div class="${t("langs")("search")}">
                <input
                    data-ref-id="${this.refs.searchInput}"
                    type="text"
                    placeholder=${r.desktopLocales.languageSelect.langSearch.trim()}
                    @input=${e=>this.debouncedSearchTextHandler(e.target)}
                />
            </div>
        `}}t.LanguagesHeader=l},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractLanguagesHeader=void 0;var i=s(6),n=s(7);class o extends i.Component{constructor(e,t){super(e,t),this.refs={searchInput:"searchInput"},this.container=e.container}reset(){}onSearchTextChanged(e){this.emit(n.COMPONENT_EVENTS.EVENT_INPUT,{value:e.value.trim()})}getRef(e){return this.container?this.container.querySelector(`[data-ref-id="${e}"]`):null}getComponentName(){return"LanguagesHeader"}template(){}}t.AbstractLanguagesHeader=o,o.defaults={searchIsActive:!1,title:""}},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractAutoLangSwitcherComponent=void 0;var i=s(3),n=s(6),o=s(120),r=s(7);class a extends n.Component{constructor(e,t){super(e,t),this.switcher=new o.SwitchToggler({active:!1,toggleOnTap:!1})}setModel(e){return this.model=e,this.switcher.toggle(e.isAutodetectEnabled()),this}onClick(){}trackAutodetectToggle(e){i.$tracker.sendMetric(r.LANG_METRIKAS.TOGGLE_AUTODETECT,{enabled:e?1:0})}getComponentName(){return"AutoLangSwitcherComponent"}template(){}}t.AbstractAutoLangSwitcherComponent=a,a.defaults={active:!1}},function(e,t,s){"use strict";t.__esModule=!0,t.SwitchToggler=void 0;var i=s(6);class n extends i.Component{constructor(e,t){super(e,t),this.onToggle(this.update),this.update()}onToggle(e){return this.onChange("active",e)}toggle(e=!this.isActive()){return this.setProperty({active:e})}isActive(){return this.getProperty("active")}template({html:e,cn:t}){const{toggleOnTap:s}=this.getProps(),i=t("switch_toggler");return e`
            <div class=${i({active:this.isActive()})}
                @click=${()=>s&&this.toggle()}>
                <div class=${i("tumbler")}></div>
            </div>
        `}}t.SwitchToggler=n,n.defaults={active:!1,toggleOnTap:!0}},function(e,t,s){"use strict";t.__esModule=!0,t.RecentLanguagesComponent=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(122),r=s(18),a=s(16),l=s(42);class c extends o.AbstractRecentLanguagesComponent{constructor(e,t){super(e,t),this.autoLangSwitcher=new l.AutoLangSwitcherComponent({})}setAutoDetectModel(e){this.autoLangSwitcher.setModel(e)}renderImprovedRecentLangs(e){const{html:t,cn:s,nothing:i}=this.getRenderHelpers();if(this.getProperty("searchQuery"))return i;const n=this.model.getRecentLanguages(),o=Object.entries(n);if(!o.length)return i;const r=this.model.getProperty("currentLanguage"),l=o.filter(([e])=>e!==r).slice(0,5);if(e){const e=s("langs"),n=l.map(([s],n)=>{const o=0===n,r={cell:!0,hasLetter:o,hasLetterSpace:!0},l=o?t`<span class="${e("letter",{recent:!0})}">
                        ${(0,a.icn)("recent",16)}
                    </span>`:i;return t`
                    <div
                        class="${e("item",r)}"
                        data-value=${s}
                        data-default-enter-action="true"
                        data-lang-element="true""
                        @click=${()=>this.onRecentLanguageClick(s)}
                        tabindex="0"
                    >
                        ${l}
                        ${this.model.getLanguageName(s)}
                    </div>
            `}),o=s("recentLangsColumn");return t`<div class="${o()}">${n}</div>`}const c=s("recentLangs"),d=l.map(([e])=>t`
                <div
                    class="${c("item")}"
                    data-value=${e}
                    data-default-enter-action="true"
                    @click=${()=>this.onRecentLanguageClick(e)}
                    tabindex="0"
                >
                    ${(0,a.icn)("recent",16)}
                    <span class="${c("itemName")}">
                        ${this.model.getLanguageName(e)}
                    </span>
                </div>
            `);return t`<div class="${c()}">${d}</div>`}template({html:e,nothing:t,cn:s},i){if(!this.model)return t;const{isImprovedLangSelect:o}=this.getProps();if(o){const e=Boolean(n.default.get(i,"isColumn"));return this.renderImprovedRecentLangs(e)}const a="src"===this.getProperty("type"),l=s("langs"),c=this.model.getRecentLanguages();if(!Object.keys(c).length&&this.isDst())return t;const d=Object.entries(c).map(([t])=>e`
                <div
                    class="${l("item")}"
                    data-value=${t}
                    data-default-enter-action="true"
                    @click=${()=>this.onRecentLanguageClick(t)}
                    tabindex="0"
                >
                    ${this.model.getLanguageName(t)}
                </div>
            `);return e`
            <div class="${l("column",{type:"extra"})}">
                ${a?e`
                    <div
                        class=${l("item",{type:"switch"})}
                        @click=${()=>this.autoLangSwitcher.onClick()}
                        tabindex="0"
                        data-default-enter-action="true"
                    >
                        ${this.autoLangSwitcher.getDirective()}
                        ${r.desktopLocales.languageSelect.langAutoDetect}
                    </div>
                `:t}
                <div class="${l("item",{type:"recent"})}">
                    ${r.desktopLocales.languageSelect.recentLanguages}
                </div>
                ${d}
            </div>
        `}}t.RecentLanguagesComponent=c,c.defaults={type:"src"}},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractRecentLanguagesComponent=void 0;var i=s(6),n=s(3),o=s(7);class r extends i.Component{setModel(e){return this.model=e,this}reset(){this.setProperty("searchQuery","")}onRecentLanguageClick(e){this.model.setLanguage(e);const t=this.isSrc()?o.LANG_METRIKAS.SELECT_SRC_LANG:o.LANG_METRIKAS.SELECT_DST_LANG;n.$tracker.sendMetric(t,{recent:1,fromSearch:0,duration:Date.now()-this.model.getProperty("languagesOpenAt"),lang:e})}isSrc(){return"src"===this.getProperty("type")}isDst(){return"dst"===this.getProperty("type")}setType(e){return this.setProperty({type:e})}getComponentName(){return"RecentLanguagesComponent"}template(){}}t.AbstractRecentLanguagesComponent=r,r.defaults={searchQuery:""}},function(e,t,s){"use strict";t.__esModule=!0,t.AllLanguagesComponent=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(124),r=s(16),a=s(18);class l extends o.AbstractAllLanguagesComponent{getImprovedColsAmount(){const e=this.getProperty("translatorElement").clientWidth;switch(!0){case e<400:return 1;case e<600:return 2;case e<800:return 3;case e<1e3:return 4;case e<1200:return 5;default:return 6}}getColsAmount(){const e=this.getProperty("translatorElement").clientWidth;switch(!0){case e<500:return 1;case e<650:return 2;case e<800:return 3;case e<1020:return 4;default:return 5}}wrapName(e){if(n.default.isString(e))return e;const{html:t,cn:s}=this.getRenderHelpers(),i=s("langs"),o=e.start>0?e.name.slice(0,e.start):"",r=e.name.slice(e.start,e.start+e.size),a=e.name.slice(e.start+e.size,e.name.length);return t`
            <span class="${i("text")}">${o}</span>
            <span class="${i("text",{highlighted:!0})}">${r}</span>
            <span class="${i("text")}">${a}</span>
        `}renderLang({code:e,selected:t,tags:s,data:i,hasLetter:n,hasLetterSpace:o}){const{html:a,cn:l,nothing:c}=this.getRenderHelpers(),d=Boolean(e),u=l("langs"),h={selected:t,cell:!0,hasLetter:n,hasLetterSpace:o},p=n?a`<span class="${u("letter")}">${i[0]}</span>`:c;return a`
            <div
                class="${u("item",h)}"
                data-value=${e}
                data-default-enter-action="true"
                data-lang-element="${d}"
                tabindex="0"
            >
                ${p}
                ${this.wrapName(i)}
                ${(s[e]||[]).map(e=>a`
                    <span class="${u("tag",{type:e})}"></span>
                `)}
                ${t?(0,r.icn)("tick",16):c}
            </div>
        `}onLangClick(e){const t=n.default.getClosest(e.target,e=>e.hasAttribute("data-value"));if(!t)return;const{value:s,langElement:i}=t.dataset;"true"===i&&this.onLanguageTapped(s)}renderImprovedAllLangs(){const{html:e,cn:t,nothing:s}=this.getRenderHelpers(),{searchQuery:i,tags:n,renderRecentLangsColumn:o}=this.getProps(),r=t("langs"),l=Boolean(i),c=this.model.getCurrentLanguage(),d=this.getImprovedColsAmount(),{goodMatches:u,otherMatches:h}=this.model.getLanguageMatches(i),p=[...u,...h],g={};let m;if(p.length){l||(g.count=d);let t="";m=p.map(([s,i])=>{const o=s===c,r=t!==i[0];return t=i[0],e`${this.renderLang({code:s,selected:o,tags:n,data:i,isSearching:l,hasLetter:r&&!l,hasLetterSpace:!l})} `})}else m=e`<div class="${r("noMatches")}">${a.desktopLocales.languageSelect.langsNotFound}</div>`;const E=o&&!l?o():s;return e`
            <div class="${r("column",g)}"
                 @click=${e=>this.onLangClick(e)}
            >
                ${E}
                ${m}
            </div>
        `}template({html:e,cn:t}){const{isImprovedLangSelect:s}=this.getProps();if(s)return this.renderImprovedAllLangs();const i=t("langs"),{searchQuery:n,tags:o}=this.getProps(),r=this.model.getCurrentLanguage(),l=this.getColsAmount(),{goodMatches:c,otherMatches:d}=this.model.getLanguageMatches(n);let u=[...c,...d];return u.length||(u=[["",a.desktopLocales.languageSelect.langsNotFound]]),e`
            <div class="${i("column",{type:"main",count:l})}"
                 @click=${e=>this.onLangClick(e)}
            >
                ${u.map(([t,s])=>{const i=t===r;return e`${this.renderLang({code:t,selected:i,tags:o,data:s})} `})}
            </div>
        `}}t.AllLanguagesComponent=l},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractAllLanguagesComponent=void 0;var i=s(6),n=s(7);class o extends i.Component{setModel(e){return this.model=e,this}reset(){this.setProperty("searchQuery",null)}onLanguageTapped(e){const{searchQuery:t}=this.getProps();this.emit(n.COMPONENT_EVENTS.EVENT_LANG_CHOOSE,{langCode:e,searchQuery:t}),this.model.setLanguage(e)}getComponentName(){return"AllLanguagesComponent"}template(){}}t.AbstractAllLanguagesComponent=o,o.defaults={searchQuery:null}},function(e,t,s){"use strict";t.__esModule=!0,t.UserMenuModule=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(21),r=s(5),a=s(11),l=s(2),c=s(3),d=s(68),u=s(16),h=s(126),p=s(46),g=s(127);const m="theme",E="night",_="system",T=_,f=Object.keys(p.locales.themeLabels);class S extends r.AppModule{constructor(e,t){super(e,t),this.themesSupported=!1,this.$elements={themeSwitcher:document.getElementById("themeSwitcher"),settingOptions:document.getElementById("settingOptions"),userButton:document.getElementById("userButton"),userMenu:document.getElementById("userMenu"),collectionsOption:document.getElementById("collectionsOption"),hotKeysCheatSheet:document.getElementById("hotKeysCheatSheet")},this.themesSupported=n.default.hasCssVarsSupport(),this.desktopSettings=this.app.getDesktopSettings(),this.themesSupported&&this.appView.setState("themes_supported",!0),this.makeUserButton(),this.makeThemesSwitcher(),this.makeSettingOptions(),this.setupCollectionsOption(),this.setupHotKeysCheatSheet(),this.listenApp(),this.listenAppView(),this.activateTheme(),n.default.onThemePreferenceChange(()=>{this.getActiveTheme()===_&&this.activateTheme()})}setupCollectionsOption(){this.appConfig.SRV===o.TEXT&&this.$elements.collectionsOption.removeAttribute("href"),this.app.onAction("toggleFav",()=>{this.userMenu.setVisible(!1)})}setupHotKeysCheatSheet(){this.app.onInitDone(()=>{this.cheatSheetShowTimeout=null,this.cheatSheet=new g.CheatSheet({hotkeys:this.app.getHotKeysConfig()},{container:this.$elements.hotKeysCheatSheet,hideAfterTransition:!0});const e=()=>{const e=this.settingOptions.getOptionRef("hotkeys");e&&this.cheatSheet.setPosition(e.getBoundingClientRect())};this.cheatSheet.onceRendered(e),this.app.on("resize",n.default.debounce(e,200))})}getActiveTheme(){return this.desktopSettings.getProperty(m)||T}activateTheme(){this.setTheme(this.getActiveTheme())}handleOptionHover(e,t){this.cheatSheet&&this.cheatSheet.setVisible(!1),clearTimeout(this.cheatSheetShowTimeout),"hotkeys"===t&&e&&(this.cheatSheetShowTimeout=setTimeout(()=>{c.$tracker.sendMetric("hotkeys_cheat_sheet_open"),this.cheatSheet.setVisible(!0)},400))}makeThemesSwitcher(){const e=f.map(e=>({icon:(0,u.icn)("theme-"+e,16),content:p.locales.themeLabels[e],ariaLabel:p.locales.themeLabels[e],onClick:()=>this.setTheme(e,!0),tabIndex:0}));this.themeSwitcher=new d.ChoiceGroup({items:e,wideMode:!0,activeIndex:f.indexOf(this.getActiveTheme())},{container:this.$elements.themeSwitcher})}makeSettingOptions(){const e=["autocorrect","enter","history"];this.app.getHotKeysConfig()&&e.push("hotkeys"),this.settingItems=e.map(e=>({key:e,active:this.desktopSettings.isOptionEnabled(e),title:p.locales.settingOptions[e],description:p.locales.settingOptionDescritions[e],onClick:t=>this.toggleSetting(e,t),onMouseEnter:()=>this.handleOptionHover(!0,e),onMouseLeave:()=>this.handleOptionHover(!1,e),tabIndex:0})),this.settingOptions=new h.SettingOptions({items:this.settingItems},{container:this.$elements.settingOptions})}makeUserButton(){this.userButton=new l.TouchView({element:this.$elements.userButton,activateFocus:!0}),this.userMenu=new l.TouchView({element:this.$elements.userMenu,stopDefaultAction:!0}),this.userButton.on("tap",()=>{this.userButton.setFocus(!0),this.userMenu.setVisible(),c.$tracker.sendMetric("settings_open")}).onStateChanged("focused",e=>{const t=this.$elements.userMenu.contains(document.activeElement);e||t||this.userMenu.setVisible(!1)}),this.app.bindFocusActivation(this.userButton)}toggleSetting(e,t){t.active?this.desktopSettings.disableOption(e):this.desktopSettings.enableOption(e),t.active=!t.active,this.settingOptions.update(),this.app.emit("optionsChanged",e,t.active)}listenAppView(){this.appView.on("keydown",e=>{e.keyCode===a.InputView.keys.ESCAPE&&this.userMenu.isVisible()&&this.userMenu.setVisible(!1)}).onTap(e=>{const t=this.$elements.userMenu.contains(e.target),s=this.$elements.userButton.contains(e.target);t||s||this.userMenu.setVisible(!1)})}setTheme(e,t){const s=this.getActiveTheme(),i=e===E||e===_&&n.default.preferDarkMode();n.default.activateClass(document.documentElement,"theme-night",i),this.desktopSettings.setProperty(m,e),this.themeSwitcher.setSelectedElement(f.indexOf(e)),t&&c.$tracker.sendMetric("settings_theme_change",{theme:e,prevTheme:s})}getSettingItemByKey(e){for(const t of this.settingItems)if(t.key===e)return t;return null}toggleSettingByKey(e,t){const s=this.getSettingItemByKey(e);s.active!==t&&this.toggleSetting(e,s)}listenApp(){this.app.on("interactiveSettingChange",({settingKey:e,enabled:t}={})=>{this.userButton.emit("tap"),setTimeout(()=>this.toggleSettingByKey(e,t),600)})}}t.UserMenuModule=S},function(e,t,s){"use strict";t.__esModule=!0,t.SettingOptions=void 0;var i=s(30);class n extends i.PureComponent{constructor(e,t){super(e,t),this.refs={option:"option"},this.onChange(()=>this.updateAsync()),this.update()}getOptionRef(e){return this.getRef(`${this.refs.option} ${e}`)}template({html:e,cn:t}){const{items:s}=this.getProps(),i=t("userMenu-setting"),n=t("switch");return e`
            ${s.map(t=>e`
                <div
                    class=${i()} @click=${()=>t.onClick(t)}
                    tabIndex="${isNaN(t.tabIndex)?-1:t.tabIndex}"
                    data-default-enter-action="true"
                    @mouseenter=${()=>t.onMouseEnter&&t.onMouseEnter()}
                    @mouseleave=${()=>t.onMouseLeave&&t.onMouseLeave()}
                    data-ref-id="${this.refs.option} ${t.key}"
                >
                    <div class=${i("title")}>
                        ${t.title}
                        <div class=${i("description")}>${t.description}</div>
                    </div>
                    <div class=${i("switch")}>
                        <div class=${n({size:"s",active:Boolean(t.active)})}></div>
                    </div>
                </div>
            `)}
        `}}t.SettingOptions=n},function(e,t,s){"use strict";t.__esModule=!0,t.CheatSheet=void 0,s(1);var i=s(6);class n extends i.Component{constructor(e,t){super(e,t),this.updateAsync()}getHotKeys(){const{hotkeys:e}=this.getProps();return Object.entries(e||{}).sort(([e],[t])=>t>e?-1:1)}template({html:e,cn:t}){const s=t("hotkeys-tooltip"),i=this.getHotKeys();return e`
            <div class="${s("wrapper")}">
                ${i.map(([t,i])=>e`
                    <div class="${s("row")}">
                      <div class="${s("combination")}">${t}</div>
                      <div class="${s("action")}">${i}</div>
                    </div>
                `)}
            </div>
        `}}t.CheatSheet=n},function(e,t,s){"use strict";t.__esModule=!0,t.AccessibilityModule=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(5),r=s(10),a=s(2),l=s(11),c=s(43);class d extends o.AppModule{constructor(e,t){super(e,t),this.hoveredElement=null,this.focusedView=!1,this.listenAppView(),this.listenGlobalEmitter(),this.listenDocument()}isFocusedView(e){return this.focusedView&&this.focusedView.getContentElement()===e}isElementHovered(e){return this.hoveredElement&&n.default.getClosest(this.hoveredElement,t=>t===e)}showElementTooltip(e){const t=n.default.getDataAttr(e,"tooltip")||n.default.getDataAttr(e,"tooltip-focus");t&&this.appModel.setProperty("tooltip",t,{rect:e.getBoundingClientRect(),position:n.default.getDataAttr(e,"tooltip-position")})}hideTooltip(){this.appModel.setProperty("tooltip",null)}listenAppView(){this.appView.on("keydown",e=>{const t=document.activeElement,s=t.getAttribute("data-action"),i="true"===t.getAttribute("data-default-enter-action"),o=t.getAttribute("data-enter-action");t&&"textarea"!==t.tagName.toLowerCase()&&"pre"!==t.tagName.toLowerCase()&&!n.default.hasClass(t,"state-disabled")&&(e.keyCode===l.InputView.keys.ENTER?(s&&this.app.emit("action:"+s,{},{originalEvent:e}),this.app.emit(c.A11Y_EVENTS.ACTIVATION,e.target,e),i?t.click():o&&this.app.emit(o,t,{originalEvent:e}),e.preventDefault()):e.keyCode===l.InputView.keys.SPACE&&n.default.hasClass(t,"button_select")&&this.app.emit(c.A11Y_EVENTS.SELECT_ACTIVATION,e.target,e))})}listenGlobalEmitter(){(0,r.getGlobalEmitter)().on("viewFocusChanged",(e,t)=>{t?this.focusedView=e:e===this.focusedView&&(this.focusedView=null)})}listenDocument(){document.addEventListener(a.TouchView.eventTypes.OVER,e=>{this.hoveredElement=e.target}),document.addEventListener("focus",e=>{this.isElementHovered(e.target)||this.isFocusedView(e.target)||(n.default.toggleClass(e.target,"state-tab-focused"),this.showElementTooltip(e.target))},!0),document.addEventListener("blur",e=>{n.default.hasClass(e.target,"state-tab-focused")&&(n.default.toggleClass(e.target,"state-tab-focused"),this.hideTooltip())},!0)}}t.AccessibilityModule=d},function(e,t,s){"use strict";t.__esModule=!0,t.LangSwitcherModule=void 0;var i=s(5),n=s(2);class o extends i.AppModule{constructor(e,t){super(e,t);const s=new n.TouchView({element:this.appConfig.ELEMENTS.langSwitcherButton,activateFocus:!0}),i=new n.TouchView({element:this.appConfig.ELEMENTS.langSwitcherListbox,stopDefaultAction:!0});s.onTap(()=>{s.setFocus(!0),i.setVisible()}).onStateChanged("focused",e=>{e||i.setVisible(!1)})}}t.LangSwitcherModule=o},function(e,t,s){"use strict";t.__esModule=!0,t.MAX_NON_EXPANDED_DECLENSIONS_LENGTH=t.DECLENSIONS_METRIKAS=t.DECLENSIONS_EVENTS=void 0;t.DECLENSIONS_EVENTS={DECLENSIONS_FETCHED:"declensionsFetched",WORD_CLICK:"declensionClick"};t.DECLENSIONS_METRIKAS={RENDER:"declensions_render",CLICK:"declensions_click",COMPLAINT_SEND:"declensions_complaint_send",EXPAND:"declensions_expand",TAB_CLICK:"declensions_tab_click",LIST_SCROLL:"declensions_list_scroll"};t.MAX_NON_EXPANDED_DECLENSIONS_LENGTH=3},function(e,t,s){"use strict";t.__esModule=!0,t.DEFINITION_TYPES=t.DEFINITION_METRIKAS=t.DEFINITION_EVENTS=void 0;t.DEFINITION_METRIKAS={DEF_RENDERED:"def_render",DEFINITION_RENDERED:"definition_rendered",ABBR_RENDERED:"abbr_render",ABBR_SWITCHED:"abbr_switched",DEFINITION_SOURCE_CLICK:"definition_source_click"};t.DEFINITION_EVENTS={DEF_FETCHED:"def_fetched"};t.DEFINITION_TYPES={WIKI:"wiki",IDIOM:"idiom",ABBR:"abbr"}},function(e,t,s){"use strict";t.__esModule=!0,t.InputPresenter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(17);class r extends o.Presenter{constructor(e){super(e);const t=this,s=this.getView(),i=this.getModel();s.on("input",(function(e){i.setProperty("value",this.getValue(),e.detail)})),i.on("change:value",(function(e,i){s.setState("empty",!e),t.emit("input",e,i)}))}getValue(e={}){let t=this.getModel().getProperty("value");return t=t.slice(e.start,e.end),e.trim?n.default.trim(t):t}setValue(e,t){return this.getView().setValue(e,t),this}getCaret(){return this.getView().getSelection().end}setCaret(e){return e===this.getCaret()&&this.getView().isFocused()?this:(this.getView().setSelection({start:e}),this.emit("navigate",e))}}t.InputPresenter=r},function(e,t,s){"use strict";t.__esModule=!0,t.TooltipModule=void 0;var i=s(5),n=s(134);class o extends i.AppModule{constructor(e,t){super(e,t),this.moduleName="tooltip",this.tooltipView=new n.TooltipView({element:this.appConfig.ELEMENTS.tooltip,targetView:this.appView,timeout:400,areHotkeysEnabled:()=>this.app.areHotkeysEnabled()}),this.appModel.onSet("tooltip",(e,t)=>{this.tooltipView.setTooltip(e,t)})}}t.TooltipModule=o},function(e,t,s){"use strict";t.__esModule=!0,t.TooltipView=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(2);class r extends o.TouchView{constructor(e={}){super(e);const t=this;let s;this.clearTimeout=()=>(s&&clearTimeout(s),this);const i=s=>{const i=parseInt(s.getAttribute("data-tooltip-vetrical-margin"))||0,n=s.getAttribute("data-hotkey"),o=s.getAttribute("data-tooltip"),r=-1===s.className.indexOf("state-invalid")&&-1===s.className.indexOf("state-disabled"),a=e.areHotkeysEnabled(),l=r&&n&&a?`${o} (${n})`:o;t.setTooltip(l,{rect:s.getBoundingClientRect(),position:s.getAttribute("data-tooltip-position"),verticalMargin:i})};return e.targetView instanceof o.TouchView&&e.targetView.on(o.TouchView.eventTypes.OUT,(function(){t.clearTimeout(),t.setVisible(!1)})).on(o.TouchView.eventTypes.OVER,(function(t){const n=this.getClosest(t.target,(function(e){return e.hasAttribute("data-tooltip")}));n&&(s=setTimeout(()=>{i(n)},e.timeout||400))})).on(o.TouchView.eventTypes.START,(function(e){this.getClosest(e.target,(function(e){return e.hasAttribute("data-tooltip-nohide")}))||(t.clearTimeout(),t.setVisible(!1))})).onTap(e=>{const t=n.default.getClosest(e.target,(function(e){return e.hasAttribute("data-tooltip-onclick")}));t&&i(t)}).bindDOMEvents([o.TouchView.eventTypes.OUT,o.TouchView.eventTypes.OVER]),this.on("contentChanged",this.updatePosition),this}setTooltip(e,t={}){if(!e)return this.setVisible(!1);if(this.setVisible(!0).setContent(e,{asText:!0}),t.rect){const e={top:t.rect.top,bottom:t.rect.bottom,right:t.rect.right,left:t.rect.left,width:t.rect.width,height:t.rect.height};t.verticalMargin&&(e.top-=t.verticalMargin,e.bottom-=t.verticalMargin),this.setPosition(e,t.position)}else t.targetElement?this.clearTimeout().setPositionByElement(t.targetElement):t.view&&this.clearTimeout().setPositionByElement(t.view.getElement());return this}setPositionByElement(e){return this.setPosition(e.getBoundingClientRect(),e.getAttribute("data-tooltip-position"))}setPosition(e,t){return this._rect=e,this._position=t,this.updatePosition()}updatePosition(){let e,t;const s=this._rect,i=this._position||"bottom";if(!s)return this;const n=this.getElement(),o=this.getRect();switch(i){case"top":case"bottom":e="top"===i?s.top-o.height:s.bottom,t=s.left-(o.width-s.width)/2;break;case"left":case"right":e=s.top-(o.height-s.height)/2,t="left"===i?s.left-o.width:s.right;break;case"top-right":e=s.top-o.height,t=s.left}return n.style.top=e+"px",n.style.left=t+"px",n.setAttribute("data-position",i),this}}t.TooltipView=r},function(e,t,s){"use strict";t.__esModule=!0,t.SessionStorage=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(4);class r extends o.Model{constructor(e,t){super(e,t),this.on("change",(function(e,t){try{sessionStorage.setItem(e,n.default.safeStringifyJSON(t))}catch(e){if(e.name===r.QUOTA_EXCEEDED_ERROR)return void this.emit("quotaError",e)}this.emit("fileStored")}))}removeItem(e){sessionStorage.removeItem(e)}getItem(e){if(sessionStorage.getItem(e))return n.default.safeParseJSON(sessionStorage.getItem(e))}}t.SessionStorage=r,r.QUOTA_EXCEEDED_ERROR="QuotaExceededError"},function(e,t,s){"use strict";t.__esModule=!0,t.RELATED_WORDS_METRIKAS=t.RELATED_WORDS_EVENTS=t.DEFAULT_ITEMS_AMOUNT=void 0;t.RELATED_WORDS_EVENTS={WORDS_FETCHED:"RELATED_WORDS_FETCHED",WORD_CLICK:"RELATED_WORDS_CLICK"};t.DEFAULT_ITEMS_AMOUNT=10;t.RELATED_WORDS_METRIKAS={RENDER:"related_words_render",WORDS_CLICK:"related_words_click",WORDS_EXPAND:"related_words_expand",WORDS_COMPLAINT_SEND:"related_words_complaint_send"}},function(e,t,s){"use strict";t.__esModule=!0,t.DICTIONARY_METRIKAS=t.DICTIONARY_EVENTS=void 0;t.DICTIONARY_METRIKAS={EXPAND_DICTIONARY:"dict_show_more",DICT_LINK_CLICK:"dict_link_click",DICT_RENDERED:"dict_show"};t.DICTIONARY_EVENTS={SEND_METRIC:"metric",APPLY_ITEM:"applyItem",DICT_FETCHED:"dictFetched"}},function(e,t,s){"use strict";t.__esModule=!0,t.InputModel=void 0;var i=s(4);class n extends i.Model{getDefaults(){return{caret:0,value:""}}}t.InputModel=n},function(e,t,s){"use strict";t.__esModule=!0,t.ListboxPresenter=void 0;var i=s(17);class n extends i.Presenter{constructor(e={}){super(e);const t=this,s=this.getView(),i=this.getModel();s.on("itemSelected",e=>{this.setValue(e);const t=this.getValue();this.emit("itemSelected",this.getValue()),this.emit("itemChanged",e,Array.isArray(t)?t.includes(e):e)});const n=(i={})=>{let n=this.getItems();if(e.renderOnScroll){const t=e.renderBulkSize*this.currentBulksLimit;n=n.slice(0,t)}i.appendingOnScroll?(n=n.slice(-e.renderBulkSize),s.renderData(t.prepareData(n),{...i,append:!0})):s.renderData(t.prepareData(n),i)};i.on("change",(function(i,o,r){switch(i){case"value":case"items":let a;const l=this.getItems();e.renderOnScroll&&(t.currentBulksLimit=1,t.totalBulks=Math.ceil(l.length/e.renderBulkSize)),"items"===i?(s.setState("empty",this.isEmpty(l)),a="itemsChanged"):"value"===i&&(a="valueChanged"),n(r),s.setEnabled(!0),t.emit(a,o,r.oldValue)}})),this.on("updateView",(function(e){n(e)})),e.renderOnScroll&&this._trackScrollRender()}_trackScrollRender(){this.getView().on("scroll",()=>{const e=this.getView().getElement();e.scrollTop>e.scrollHeight-2*e.offsetHeight&&this.currentBulksLimit<this.totalBulks&&(this.currentBulksLimit+=1,this.emit("updateView",{appendingOnScroll:!0}))})}getItems(){return this.getModel().getItems()}setItems(e,t){return this.getModel().setItems(e,t),this}getValue(){return this.getModel().getProperty("value")}setValue(e,t){const s=this.getModel();return s.isValid("value",e)&&s.setProperty("value",e,t),this}getItemById(e){return this.getItems().find((function(t){return t.id===e}))}}t.ListboxPresenter=n,n.currentBulksLimit=1,n.totalBulks=1},function(e,t,s){"use strict";t.__esModule=!0,t.TTSPlayer=t.PLAYER_STATES=t.PLAYER_PRIORITIES=t.PLAYER_ACTIONS=void 0;var i=s(8);t.PLAYER_ACTIONS={LOAD:"load",PLAY:"play",STOP:"stop",ERROR:"error",UPDATE:"update"};t.PLAYER_STATES={OK:"ok",TEXT_NOT_SUPPORTED:"textNotSupported",LANG_NOT_SUPPORTED:"langNotSupported",TEXT_SIZE_EXCEEDED:"textSizeExceeded"};t.PLAYER_PRIORITIES={LOW:1,NORMAL:10,HIGH:100};class n extends i.Emitter{play(){}stop(){}isActive(){}isLangSupported(){}isTextSupported(){}isTextSizeBelowLimit(){}getPriority(){}isValid(e,t,s){this.isTextSupported(e)&&this.isTextSizeBelowLimit(e)?this.isLangSupported(t,(function(e){s(e)})):s(!1)}}t.TTSPlayer=n},function(e,t,s){"use strict";t.__esModule=!0,t.EXAMPLE_METRIKAS=t.EXAMPLES_EVENTS=void 0;t.EXAMPLE_METRIKAS={TAB_WORD_CLICK:"example_tab_word_click",HIGHLIGHTED_CLICK:"example_link_click",EXAMPLES_RENDERED:"examples_rendered",EXPAND_EXAMPLES:"examples_show_more",EXAMPLE_SCROLL_CONTROL_CLICK:"example_scroll_control_click",EXAMPLE_REF_CLICK:"example_ref_click"};t.EXAMPLES_EVENTS={WORD_SELECTED:"wordSelected",SHOW_TAB:"showTab",SET_MAIN_VIEW_STATE:"setMainViewState",SEND_METRIC:"metric",OPEN_IDIOM_POPUP:"openIdiomPopup",BANNED_EXAMPLES_UPDATED:"bannedExamplesUpdated",SHOW_TOOLTIP:"showExampleTooltip",SHOW_EXAMPLE_SHEET:"showExampleSheet"}},function(e,t,s){"use strict";t.__esModule=!0,t.TranslatorModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(9),r=s(31),a=s(28),l=s(19),c=s(151);class d extends r.SessionModel{constructor(e,t={}){super(e,t),this.resetCache(),this._cacheEnabled=Boolean(t.cacheEnabled)}reset(){return this._activeRequest&&(this._activeRequest.abort(),this._activeRequest=null),this}getData(){return{text:this.getText(),options:this.getProperty("options")}}getText(){const e=this.getProperty("text");return e?JSON.parse(e):[]}setText(e,t){return this.setProperty("text",e&&JSON.stringify(e),t)}getTranslationId(){const e=this.getProps();return[e.sid,e.counter-1,0].join("-")}saveLastTranslationId(e){return this.setProperty({translationId:e})}getLastTranslationId(){return this.getProperty("translationId")}getParams(){const e=this.getProps();return{id:this.getTranslationId(),srv:e.srv,lang:e.srcLang+"-"+e.dstLang,reason:e.reason,format:e.format}}resetCache(){return this._cache={},this}getDefaults(){return{srv:"",url:"/",text:"",format:d.formats.TEXT,reason:"",counter:0,options:0,srcLang:"",dstLang:"",translation:"",shouldNotRequest:!1,sid:this.getId()}}_getCacheKey(e){return[this.getProperty("srcLang"),this.getProperty("dstLang"),e].join("-")}_getFromCache(e){return this._cache[this._getCacheKey(e)]||""}increaseCounter(){return this.setProperty("counter",this.getProperty("counter")+1)}validateResponse(e){return e&&n.default.isObject(e.body)&&n.default.isArray(e.body.text)&&e.body.text.length&&e.body.text.every(e=>e.length)}runRequest(){let e;const t=this.getData();this.increaseCounter(),this.saveLastTranslationId(this.getTranslationId());const s=this.getParams(),i=new l.HTTPRequest(this.getProperty("url"));if(this.emit("query",n.default.extend({},t,s)),this._cacheEnabled&&(e=t.text,t.text=e.filter(e=>!this._getFromCache(e)),!t.text.length))return this.setProperty("translation",e.map(this._getFromCache,this).join("\n"));this._activeRequest=i.setType(l.HTTPRequest.types.FORM).setData(t).setParams(s).setMethod(l.HTTPRequest.methods.POST).send((s,i)=>{const n=s?s.code:i.body.code,r=s&&s.code===a.HTTPError.ABORT,d=i&&i.code===l.HTTPRequest.codes.OK;let u;if(this._activeRequest=null,!d||r||this.validateResponse(i)||(0,o.logError)(new c.TranslateApiError),n===l.HTTPRequest.codes.OK)u=i.body.text,this._cacheEnabled&&(t.text.forEach((e,t)=>{this._cache[this._getCacheKey(e)]=u[t]}),u=e.map(this._getFromCache,this)),this.setProperty("translation",u.join("\n"),{align:i.body.align&&i.body.align[0]});else if(n!==a.HTTPError.ABORT)return this.emit("error",s||new a.HTTPError(n,i.body.message))})}requestTranslation(){return this.reset(),this.isValid()?(this.emit("request"),this.getSid().then(()=>this.runRequest()),this):this}onRequest(e){return this.on("request",e)}}t.TranslatorModel=d,d.options={ALIGN:4},d.formats={TEXT:"text",HTML:"html"},d.errorMap={INVALID_SESSION:405,EXPIRED_SESSION:406}},function(e,t,s){"use strict";t.__esModule=!0,t.AVAILABLE_OPTIONS=void 0;t.AVAILABLE_OPTIONS={AUTOCORRECT:"autocorrect",ENTER:"enter",SHIFT:"shift"}},function(e,t,s){"use strict";t.__esModule=!0,t.SpeechRecognizerBase=t.RECOGNITION_PRIORITIES=t.RECOGNITION_EVENTS=t.RECOGNITION_ERRORS=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(8);function r(e,t,s){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return s}const a={LOW:1,NORMAL:10,HIGH:100};t.RECOGNITION_PRIORITIES=a;t.RECOGNITION_ERRORS={ABORTED:"aborted",NETWORK:"network",NOT_ALLOWED:"not-allowed",NO_SPEECH:"no-speech"};const l={END:"end",ACTIVATING:"activating",MIC_DISABLED:"mic-disabled",MIC_ENABLED:"mic-enabled",START:"start",RECOGNIZE:"recognize"};t.RECOGNITION_EVENTS=l;const c="prompt",d="granted",u="denied";var h=new WeakSet,p=new WeakSet,g=new WeakSet;class m extends o.Emitter{static isAvailable(){}constructor(){super(),g.add(this),p.add(this),h.add(this),this.audioPermissionStatus=c,this.permissionsSupported=!1,this.permissionsSupported="permissions"in navigator,this.permissionsSupported&&navigator.permissions.query({name:"microphone"}).then(e=>{this.audioPermissionStatus=e.state,e.state===u&&r(this,p,_).call(this),e.onchange=n.default.debounce(e=>{const t=e.target.state;this.audioPermissionStatus=t,t===d?r(this,g,T).call(this):t===u&&r(this,p,_).call(this)})}).catch(e=>{e instanceof TypeError&&(this.permissionsSupported=!1)})}convertLanguage(){}prepareData(){}getVisualizer(){}startRecognition(e){}startListening(e){return this.audioPermissionStatus===c&&this.permissionsSupported&&r(this,h,E).call(this),this.startRecognition(e),this}getPriority(){return a.NORMAL}}function E(){return this.emit(l.ACTIVATING)}function _(){return this.emit(l.MIC_DISABLED)}function T(){return this.emit(l.MIC_ENABLED)}t.SpeechRecognizerBase=m},function(e,t,s){"use strict";t.__esModule=!0,t.STORY_MOVE_TYPES=t.STORY_FEEDBACK_TYPES=t.STORY_CLOSE_TYPES=void 0;t.STORY_MOVE_TYPES={TIME:"time",STORY_TAP:"story_tap",ARROW_TAP:"arrow_tap",KEYBOARD:"keyboard"};t.STORY_CLOSE_TYPES={END:"end",BUTTON_TAP:"button_tap",ACTIVATION:"story_activation",ESC:"esc",BG_TAP:"bg_tap",HISTORY_BACK:"history_back",SWIPE:"swipe"};t.STORY_FEEDBACK_TYPES={LIKE:"like",DISLIKE:"dislike"}},function(e,t,s){"use strict";t.__esModule=!0,t.synTitles=t.i18n=t.TABS=t.EXAMPLE_TABS=void 0;const i=window.config||{},n=i.LOCALIZATIONS||{};t.i18n=n;const o=i.TABS||{};t.TABS=o;const r=i.SYN_TITLES||{};t.synTitles=r;const a=i.EXAMPLE_TABS||{};t.EXAMPLE_TABS=a},function(e,t,s){"use strict";t.__esModule=!0,t.FileDropModule=t.APP_EVENTS=void 0;var i=s(21),n=s(5),o=s(2),r=s(135),a=s(148);const l={DOC_DROPPED:"documentDropped",IMAGE_DROPPED:"imageDropped"};t.APP_EVENTS=l;class c extends n.AppModule{constructor(e,t){super(e,t),this.moduleName="fileDrop",this.mainContainer=new o.TouchView({element:document.documentElement}),this.storage=new r.SessionStorage,this.dropOverlay=new a.DropAreaView({element:this.appConfig.ELEMENTS.dropOverlay,contentElement:this.appConfig.ELEMENTS.dropContent,hideAfterTransition:!0}),this.app._dropAreaView=this.dropOverlay,this.listenMainContainer(),this.listenStorage(),this.listenDropOverlay()}handleFileUpload(e){const t=this.storage,s=new FileReader;s.onload=function(){t.setProperty("storedFile",this.result),t.setProperty("storedFileName",e.name),t.setProperty("storedFileType",e.type)},s.readAsDataURL(e)}listenMainContainer(){this.mainContainer.on("dragenter",e=>{const t=e.dataTransfer?e.dataTransfer.types[0]:"";/text/.test(t)||this.dropOverlay.setVisible(!0)}).bindDOMEvents("dragenter")}listenStorage(){this.storage.on("fileStored",()=>{this.dropOverlay.getContentElement().submit()}).on("quotaError",()=>{this.appModel.setProperty("toast",this.appConfig.TOAST_MESSAGES.quotaExceeded)})}listenDropOverlay(){this.dropOverlay.onVisibilityChanged(e=>{this.appView.setState("dropping",e)}).on("fileDropped",(e,t,s)=>{this.appConfig.SRV===i.DOC&&t===a.DropAreaView.FILE_FORMAT.DOCUMENT?this.app.emit(l.DOC_DROPPED,e,s):this.appConfig.SRV===i.IMAGE&&t===a.DropAreaView.FILE_FORMAT.IMAGE?this.app.emit(l.IMAGE_DROPPED,e,s):this.handleFileUpload(e)})}}t.FileDropModule=c},function(e,t,s){"use strict";t.__esModule=!0,t.SUPPORTED_DOCS=t.DropAreaView=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(2);const r=/pdf|doc|docx|xls|xlsx|ppt|ppts|pptx/;t.SUPPORTED_DOCS=r;class a extends o.TouchView{static getFileFormat(e){const t=e.name.split(".").pop();return n.default.isImageFile(e)?a.FILE_FORMAT.IMAGE:r.test(t)?a.FILE_FORMAT.DOCUMENT:a.FILE_FORMAT.INVALID}constructor(e){super(e);const{DROP:t,DRAG_ENTER:s,DRAG_OVER:i,DRAG_LEAVE:o}=a.EVENT_NAMES;this.on(t,e=>this._handleDropEvent(e)).on(s,e=>this._handleDragEnterEvent(e)).on(i,e=>n.default.preventEvent(e)).on(o,e=>this._handleDragLeaveEvent(e)).bindDOMEvents(`${t} ${s} ${i} ${o}`)}handleFileUpload(e,t){this._handleFileUpload(e,t)}_handleFileUpload(e,t=null){const s=n.default.getFilesFromEvent(e)[0];if(n.default.preventEvent(e),!s)return;const i=a.getFileFormat(s);this._validateFileFormat(i)&&(s.size>a.MAX_FILE_SIZE?this.emit(a.EVENT_NAMES.SIZE_ERROR):this.emit(a.EVENT_NAMES.FILE_DROPPED,s,i,t))}_validateFileFormat(e){return e!==a.FILE_FORMAT.INVALID?(this._updateContentElement(e),!0):(this.emit(a.EVENT_NAMES.FORMAT_ERROR),!1)}_updateContentElement(e){e===a.FILE_FORMAT.IMAGE&&this.getContentElement().setAttribute(a.ACTION_ATTRIBUTE,a.ACTIONS.OCR),e===a.FILE_FORMAT.DOCUMENT&&this.getContentElement().setAttribute(a.ACTION_ATTRIBUTE,a.ACTIONS.DOC)}_handleDropEvent(e){this._handleFileUpload(e),this.setVisible(!1)}_handleDragEnterEvent(e){this.dragEnterTarget=e.target}_handleDragLeaveEvent(e){e.target===this.dragEnterTarget&&(this.dragEnterTarget=null,this.setVisible(!1))}}t.DropAreaView=a,a.ACTION_ATTRIBUTE="action",a.MAX_FILE_SIZE=5242880,a.EVENT_NAMES={SIZE_ERROR:"sizeError",FORMAT_ERROR:"formatError",FILE_DROPPED:"fileDropped",DROP:"drop",DRAG_OVER:"dragover",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave"},a.FILE_FORMAT={IMAGE:"image",DOCUMENT:"doc",INVALID:"invalid"},a.ACTIONS={OCR:"/ocr",DOC:"/doc"}},function(e,t,s){"use strict";t.__esModule=!0,t.CollectionServerModel=t.COLLECTION_TYPES=t.COLLECTION_STATUSES=t.COLLECTION_ACTIONS=void 0;var i=s(72),n=s(19);const o={FAVORITES:0,COLLECTION:1,SUBSCRIPTION:2,BROKEN_SUBSCRIPTION:3,HISTORY:4};t.COLLECTION_TYPES=o;t.COLLECTION_ACTIONS={NOP:0,ADD:1,DELETE:2,UPDATE:3,REGISTER:4,DROP:5,POSTPONE:6,MERGE:7};const r={UNCHANGED:0,ADDED:1,DELETED:2,UPDATED:3,ABSENT:4};t.COLLECTION_STATUSES=r;class a extends i.ListboxModel{static getTimestamp(){return Date.now()/1e3}static isNotDeleted(e){return e&&e.status!==r.DELETED}static isSubscription(e){return e&&(e.type===o.SUBSCRIPTION||e.type===o.BROKEN_SUBSCRIPTION)}getDefaults(){return{srv:"",uid:"",url:"/",items:"",value:"",xtoken:""}}getParams(){const{srv:e,uid:t}=this.getProps();return{srv:e,uid:t}}_getCollection(e){const{url:t}=this.getProps();return new n.HTTPRequest(t+"collections/"+e).setMethod(n.HTTPRequest.methods.GET).setHeader("X-CSRF-Token",this.getProperty("xtoken")).setParams(this.getParams()).send((e,t)=>{if(e)return this.emit("error",e);this.emit("collectionData",t.body.collection)}),this}_subscribe(e){const{url:t,uid:s}=this.getProps();return new n.HTTPRequest(t+"users/"+s+"/collections").setData(e).setType(n.HTTPRequest.types.JSON).setMethod(n.HTTPRequest.methods.POST).setHeader("X-CSRF-Token",this.getProperty("xtoken")).setParams(this.getParams()).send((e,t)=>{if(e)return this.emit("error",e);this.emit("subscribed",t.body.collection)}),this}_syncCollection(e,t){const{url:s,uid:i}=this.getProps();new n.HTTPRequest(s+"users/"+i+"/collections/"+e+"/sync").setData(t).setType(n.HTTPRequest.types.JSON).setMethod(n.HTTPRequest.methods.POST).setHeader("X-CSRF-Token",this.getProperty("xtoken")).setParams(this.getParams()).send((e,t)=>{if(e)return this.emit("error",e);this.emit("mergeCollection",t.body.collectionAction)})}_presyncCollections(e){const{url:t,uid:s}=this.getProps();return new n.HTTPRequest(t+"users/"+s+"/collections/pre-sync").setData(e).setType(n.HTTPRequest.types.JSON).setMethod(n.HTTPRequest.methods.POST).setHeader("X-CSRF-Token",this.getProperty("xtoken")).setParams(this.getParams()).send((e,t)=>{if(e)return this.emit("error",e);this.emit("processCollections",t.body.collectionsActions)}),this}_getCollections(){const{url:e}=this.getProps();return new n.HTTPRequest(e+"collections").setMethod(n.HTTPRequest.methods.GET).setHeader("X-CSRF-Token",this.getProperty("xtoken")).setParams(this.getParams()).send((e,t)=>{if(e)return this.emit("error",e);this.emit("collections",t.body.collections)}),this}}t.CollectionServerModel=a},function(e,t,s){"use strict";t.__esModule=!0,t.PredictorPresenter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(17);class r extends o.Presenter{static createRange(e,t){const s={};if(t.pos<0)s.end=t.index,s.start=s.end+t.pos;else{if(t.index!==e.length||" "!==e.charAt(t.index-1))return null;s.end=t.index,s.start=t.index}return s}constructor(e){super(e);const t=this,s=this.getView(),i=this.getModel();let o;const a=function(){s.setVisible(!1).setEnabled(!1)};this.detectLanguage=n.default.debounce(r.prototype.detectLanguage,200),this.requestSuggestion=n.default.debounce(r.prototype.requestSuggestion,200),s.on("tap",n.default.preventEvent).on("itemSelected",(function(e){e&&t.setValue(e)})),i.on("set",(function(e,i,n){let r;switch(e){case"items":return i?(r=this.toJSON(),r.items=this.getItems()||[],s.renderData(t.prepareData(r.items)).setEnabled(!0).setVisible(!0),t.emit("ready",r)):a();case"value":return r=this.toJSON(),r.items=this.getItems()||[],t.emit("predict",r,n);case"endOfWord":clearTimeout(o),i?t.emit("endOfWord"):o=setTimeout(()=>t.emit("endOfWord"),1500)}})).on("error",a).on("change",(function(e,i,n){switch(e){case"auto":return t.detectLanguage(),t.emit("auto",i);case"text":case"limit":case"srcLang":return s.setEnabled(!1),n.reason&&this.setProperty("reason",n.reason),"text"===e&&t.detectLanguage(),"srcLang"===e&&n.detected&&t.emit("detect",i,n.kbd),t.requestSuggestion()}})).on("invalid",a)}isAuto(){return this.getModel().getProperty("auto")}setText(e,t){return this.getModel().setProperty("text",e,{reason:t}),this}setIndex(e){return this.getModel().setProperty("index",e),this}setValue(e,t){return this.getModel().setProperty("value",e,t),this}toggleAuto(e){return this.getModel().setProperty("auto",arguments.length?Boolean(e):!this.isAuto()),this}setSrcLanguage(e,t){return this.getModel().setProperty("srcLang",e,t),this}setDstLanguage(e,t){return this.getModel().setProperty("dstLang",e,t),this}detectLanguage(){return this.isAuto()&&this.getModel().detectLanguage(),this}requestSuggestion(){return this.getModel().requestSuggestion(),this}}t.PredictorPresenter=r,r.detectOptions={KBD:1}},function(e,t,s){"use strict";t.__esModule=!0,t.TranslateApiError=void 0;class i extends Error{constructor(...e){super(...e),this.message="Translate Api Error"}}t.TranslateApiError=i},function(e,t,s){"use strict";t.__esModule=!0,t.StoryCard=t.STORY_GLOBAL_EVENTS=t.STORY_CARD_VIEWS=t.MAX_COLOR_TYPES=t.MAX_CARD_TYPES=void 0,t.getStoryBgElement=g;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(46),r=s(10),a=s(30),l=s(3),c=s(145),d=s(16);const u={STORY:"story",PREVIEW_BIG:"preview-big",PREVIEW_SMALL:"preview-small"};t.STORY_CARD_VIEWS=u;const h={RUN_ACTION:"storyRunAction"};t.STORY_GLOBAL_EVENTS=h;const p=n.default.memoize(n.default.hasEmojiOnly.bind(n.default));t.MAX_CARD_TYPES=8;function g(e){const t=document.getElementById("sc"+e);return t?t.cloneNode(!0):null}t.MAX_COLOR_TYPES=10;class m extends a.PureComponent{constructor(e,t){super(e,t),this.refs={bg:"bg"},this.onChange(()=>this.updateAsync()),this.update()}getBgElement(){if(!this.bgElement){const{theme:{cardType:e}}=this.getProperty("story");this.bgElement=g(e)}return this.bgElement}handleStoryAction(e){e.stopPropagation(),(0,r.getGlobalEmitter)().emit(h.RUN_ACTION,this.getProperty("story"))}handleStoryFeedback(e,t){const{feedbackStatus:s,story:i}=this.getProps(),n=s===t?null:t;e.stopPropagation(),n&&l.$tracker.sendMetric("stories_feedback",{type:n,story:i.id}),this.setProperty({feedbackStatus:n})}controlsTemplate(e,t,s){const{html:i,cn:n,nothing:r}=this.getRenderHelpers(),{feedbackStatus:a}=this.getProps();if(!e.controls)return r;const l=a===c.STORY_FEEDBACK_TYPES.LIKE,u=a===c.STORY_FEEDBACK_TYPES.DISLIKE,h=n("button"),p={size:"l",round:!0,icn:!0},g=h({...p,view:l?"primary":"ghost"}),m=h({...p,view:u?"primary":"ghost"}),E=e.controls.customLabel||o.locales.stories.buttons[e.controls.type];return i`
            <div class=${t("controls")}>
                <div class=${t("controls-likes")}>
                    <button
                        @click=${e=>this.handleStoryFeedback(e,c.STORY_FEEDBACK_TYPES.LIKE)}
                        class=${g}>${(0,d.icn)("like")}</button>
                    <button
                        @click=${e=>this.handleStoryFeedback(e,c.STORY_FEEDBACK_TYPES.DISLIKE)}
                        class=${m}>${(0,d.icn)("dislike")}</button>
                </div>
                <div class=${t("controls-button")}>
                    <button
                        @click=${e=>this.handleStoryAction(e)}
                        class=${s}>${E}</button>
                </div>
            </div>
        `}previewControlsTemplate(e,t){const{html:s}=this.getRenderHelpers();return s`
            <div class=${e("controls")}>
                <div class=${e("controls-button")}>
                    <button class=${t}>${o.locales.stories.showMore}</button>
                </div>
            </div>
        `}template({html:e,cn:t,nothing:s},{view:i,showControls:n=!0,storyIndex:o=0,clickHandler:r=null}){const{story:a}=this.getProps(),{theme:l,id:c,index:d}=a;let h=a.preview;i===u.STORY&&(h=a.stories[o]);const g=t("storyCard"),m=t("button")({size:"l",view:"primary",round:!0});let E=s;if(i===u.PREVIEW_BIG&&window.config.DISABLE_STORIES_VIEWER){const e=a.stories[a.stories.length-1];e.controls&&(E=this.controlsTemplate(e,g,m))}else i===u.PREVIEW_BIG?E=this.previewControlsTemplate(g,m):n&&(E=this.controlsTemplate(h,g,m));return e`
            <div class=${g({view:i},["grad_"+l.colorType])}
                 data-story-id=${c}
                 data-story-index=${d}
                 @click=${r}>
                <div class=${g("bgContainer")}
                     data-ref-id=${this.refs.bg}>
                    ${this.getBgElement()}
                </div>

                <div class=${g("content")}>
                    ${h.headers.map(t=>e`
                        <div class=${g("header",{emoji:p(t)})}>${t}</div>
                    `)}
                    ${h.description?e`
                        <div class=${g("description")}>${h.description}</div>
                    `:s}
                </div>

                ${E}
            </div>
        `}}t.StoryCard=m,m.defaults={story:null,feedbackStatus:null}},function(e,t,s){"use strict";t.__esModule=!0,t.SPELLER_EVENTS=t.CHUNK_SHOW_TIMEOUT=void 0;t.SPELLER_EVENTS={TOGGLE_AUTO_CORRECTION:"toggleSpeller",CORRECT_TEXT:"correctText",CHUNK_SELECTED:"spellerChunkSelected",CORRECTED_TEXT_READY:"correctedTextReady",DECLINE_CORRECTION:"declineSpellerCorrection",SAVE_WORD:"saveUserWordToSave"};t.CHUNK_SHOW_TIMEOUT=2e3},,,function(e,t,s){"use strict";t.__esModule=!0,t.MIN_IDIOMS_HEIGHT=t.IDIOMS_TEXT_OFFSET=t.IDIOMS_METRIKAS=t.IDIOMS_EVENTS=t.IDIOMS_ACTIONS=t.AbstractIdiomsModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(3),r=s(5),a=s(211);const l={OPEN_POPUP:"openIdiomPopup",IDIOM_FETCHED:"idiomFetched",CLEAR_IDIOMS:"idiomsClear",SET_COMPLAINT:"setComplaint",SEND_COMPLAINT:"idiomSendComplaint",SEND_METRIC:"sendIdiomsMetric",EXPAND_IDIOM:"expandIdiom"};t.IDIOMS_EVENTS=l;const c={COMPLAINT:"idiomsComplaint",CLOSE_POPUP:"closeIdiomsPopup"};t.IDIOMS_ACTIONS=c;const d={INFO_CLICK:"idioms_info_click",COMPLAINT_CLICK:"idioms_complaint_click",COMPLAINT_SEND:"idioms_complaint_send",RENDER:"idioms_rendered",TEXT_CLICK:"idioms_text_click",IDIOM_EXAMPLE_POPUP_OPEN:"idiom_example_popup_open",TOUCH_IDIOM_TEXT_EXPAND:"touch_idiom_text_expand",COMMON_EVENT:"sendIdiomMetric"};t.IDIOMS_METRIKAS=d;const{$track:u}=(0,o.getTrackerByNamespace)(d);t.IDIOMS_TEXT_OFFSET=20;t.MIN_IDIOMS_HEIGHT=20;class h extends r.AppModule{constructor(e,t){super(e,t),this.moduleName="idioms",this.idiomsComponent=this._makeIdiomsComponent(),this.idiomsPopup=this._makeIdiomsPopup(),this.model=this._makeIdiomsModel(),this.listenApp(),this.listenIdiomsComponent(),this.listenDictionaryModel(),this.appModel.onChange(["text","srcLang","dstLang"],()=>{const{text:e,srcLang:t,dstLang:s}=this.appModel.getProps();this.handlePropsChange({text:e,srcLang:t,dstLang:s})}),this.appView.on("tap",e=>{this.isIdiomNode(e)||this.closePopup(!0)})}reset(){this.idiomsComponent.setProperty("text","").setProperty("popupIsVisible",!1).setVisible(!1).updateAsync(),this.model.setProperty("buttonNumber",null),this.idiomsPopup.setVisible(!1),this.app.emit("idiomsRendered",0)}listenDictionaryModel(){this.app.getDictionaryModel().on(l.IDIOM_FETCHED,e=>{this._setText(e)})}listenApp(){this.app.onAction(c.CLOSE_POPUP,()=>this.closePopup()).onAction(c.COMPLAINT,()=>this._handleComplaintMode(!0)).onAction("cancelComplaintMode",()=>{this.idiomsComponent.setProperty("complaint",!1)}).on(l.CLEAR_IDIOMS,()=>{this.reset(),this.app.emit("idiomsRendered",0)}).on("translationError",()=>this.reset()).on("resize",()=>this._updatePopupPosition())}listenIdiomsComponent(){this.idiomsComponent.on(l.OPEN_POPUP,(e,t)=>this._handlePopupVisibility(e,t)).on(l.SEND_METRIC,e=>this._sendMetric(e))}isIdiomNode(e){return!e.target||!n.default.isString(e.target.className)||e.target.className.indexOf("idiomsPopup")>=0||e.target.className.indexOf("idioms-info")>=0||e.target.className.indexOf("idiom-info")>=0||e.target.className.indexOf("type_idiom")>=0&&-1===e.target.className.indexOf("example")}closePopup(){this._handlePopupVisibility(!1)}handlePropsChange(e){this.model.updateHash(e),this.model.needReset()&&this.reset()}_makeIdiomsModel(){return new a.IdiomsModel({hash:"",buttonNumber:null})}_sendMetric(e){const{srcLang:t,dstLang:s,text:i}=this.app.getProps(),n=this.idiomsComponent.getText();u(d.COMMON_EVENT,{metricKey:e,metricInfo:{srcText:i,idiomText:n,dir:`${t}-${s}`}})}_handlePopupVisibility(e,t){this.idiomsComponent.setProperty("popupIsVisible",e).updateAsync(),e&&this.idiomsPopup.setPosition(t,!1),this.idiomsPopup.setVisible(e)}_updatePopupPosition(){this.idiomsComponent.updatePopupPosition()}}t.AbstractIdiomsModule=h},function(e,t,s){"use strict";t.__esModule=!0,t.EXAMPLES_OPTIONS=t.DictionaryExamplesModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(9),r=s(171),a=s(213),l=s(172);t.EXAMPLES_OPTIONS={DEBUG:1,CHUNKS:2,LIGHTWEIGHT:4,RANDOM_RANKING:8,LEARNING:16,MONOLING:32};class c extends r.DictionaryModel{getParams(){const e=this.getProps();return{...super.getParams(),src:e.text,dst:e.translation,options:e.options,chunks:e.chunks?1:0,maxlen:e.maxLength,v:2}}getDefaults(){return{ui:"",srv:"",url:"/",src:"",text:"",data:"",lang:"",flags:0,options:0,chunks:!1,maxLength:0,voteResults:"",expandedLists:"",speakersSupport:""}}hasOption(e){return(this.getProperty("options")&e)===e}setOption(e,t){let s=this.getProperty("options");return Boolean(t)===this.hasOption(e)||(s+=e*(t?1:-1),this.setProperty("options",s)),this}prepareExamples(e){const t=n.default.safeParseJSON(e),s=(0,l.validateServerResponse)(t),i=(0,l.transformServerExamples)(t),{allExamples:r}=i;return s||(0,o.logError)(new a.DictionaryExamplesApiError(2)),r.length&&this.emit("examplesRendered"),i}setVoteResult(e,t){const s=this.getVoteResults();s[e]=t,this.setVoteResults(s)}getVoteResults(){const e=this.getProperty("voteResults");return e?JSON.parse(e):{}}setVoteResults(e){this.setProperty("voteResults",JSON.stringify(e))}setSpeakerSupport(e,t,s){const i=this.getSpeakersSupport();i[e]={srcValid:t,dstValid:s},this.setSpeakersSupport(i)}setSpeakersSupport(e){this.setProperty("speakersSupport",JSON.stringify(e))}getSpeakersSupport(){const e=this.getProperty("speakersSupport");return e?JSON.parse(e):{}}setExpandedList(e,t){const s=this.getExpandedLists();s[e]=t,this.setExpandedLists(s)}getExpandedLists(){const e=this.getProperty("expandedLists");return e?JSON.parse(e):{}}setExpandedLists(e){this.setProperty("expandedLists",JSON.stringify(e))}}t.DictionaryExamplesModel=c},function(e,t,s){"use strict";t.__esModule=!0,t.ToastPresenter=void 0;var i=s(17);class n extends i.Presenter{constructor(e){super(e);const t=this.getView(),s=this.getModel();t.on("tap",(function(){s.resetTimer(),this.setVisible(!1)})),s.on("timedout",(function(){t.setVisible(!1)})).on("set:text",(function(e,s){if(!e)return this.resetTimer(),t.setVisible(!1);this.resetTimer(),t.setContent(e,{asText:!0}).setVisible(!0),this.setTimeout(s.delay)}))}showToast(e,t){return this.getModel().setProperty("text",e,{delay:t}),this}}t.ToastPresenter=n},function(e,t,s){"use strict";t.__esModule=!0,t.ToastModel=void 0;var i=s(4);class n extends i.Model{resetTimer(){return clearTimeout(this.getProperty("timer")),this}_onTimeout(){return this.emit("timedout")}setTimeout(e){return this.setProperty("timer",setTimeout(this._onTimeout.bind(this),e||this.getProperty("delay")))}getDefaults(){return{text:"",timer:0,delay:2e3}}}t.ToastModel=n},function(e,t,s){"use strict";t.__esModule=!0,t.Uniproxy=t.STREAM_CONTROL_REASONS=t.STREAM_CONTROL_ACTIONS=t.EVENTS=t.ERRORS=t.CONNECTION_STATUSES=t.CLOSING_CODES=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(8);const r={OPEN:"open",CONNECTING:"connecting",CLOSE:"close",ERROR:"error",RECONNECT:"reconnect",MESSAGE:"message",STREAM:"stream",STREAM_CONTROL:"stream_control",READY:"ready",STOP:"stop",STATUS_CHANGED:"status_changed"};t.EVENTS=r;const a={CONNECTING:"connecting",OPEN:"open",CLOSING:"closing",CLOSED:"closed",STOPPED:"stopped"};t.CONNECTION_STATUSES=a;const l={NORMAL:1e3,OFFLINE:4001,CONNECTING_TIMEOUT:4002,HEARTBEAT_TIMEOUT:4003,CONNECTION_DIED:4004,STOP:4005,UNAUTHORIZED:4006,NOT_INTERNAL_NETWORK:4007};t.CLOSING_CODES=l;const c={REQUEST_TIMEOUT_ERROR:"request_timeout",SYNC_STATE_ERROR:"sync_state",EVENT_ERROR:"event_error",CONNECTION_ERROR:"connection",UNSUPPORTED_PACKET:"unsupported_packet",RATE_LIMIT_ERROR:"rate_limit",RESPONSE_ERROR:"response"};t.ERRORS=c;const d={CLOSE:0,CHUNK:1};t.STREAM_CONTROL_ACTIONS=d;const u={NO_ERROR:0,PROTOCOL_ERROR:1,INTERNAL_ERROR:2,FLOW_CONTROL_ERROR:3,SETTINGS_TIMEOUT:4,STREAM_CLOSED:5,FRAME_SIZE_ERROR:6,REFUSED_STREAM:7,CANCEL:8,COMPRESSION_ERROR:9,CONNECT_ERROR:10,ENHANCE_YOUR_CALM:11,INADEQUATE_SECURITY:12,HTTP_1_1_REQUIRED:13};t.STREAM_CONTROL_REASONS=u;const h="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";class p extends o.Emitter{constructor(e){super(),this._nextStreamId=-1,this._status=a.STOPPED,this._requests={},this._ws=null,this._seqNumber=1,this._apiKey=e.apiKey,this._url=e.url,this._uuid=n.default.guid(h),this._vins={application:{lang:window.config.UI_LANG,platform:g(),uuid:this._uuid,app_id:"ru.yandex.translate."+("tr-text"===window.config.SRV?"desktop":"touch")}}}startStream(){return this._nextStreamId+=2,this._nextStreamId}closeStream(e,t,s=u.NO_ERROR){return this._sendRaw({streamcontrol:{action:d.CLOSE,streamId:e,reason:s,messageId:t}})}start(){this._ws=new WebSocket(this._url),this._ws.binaryType="arraybuffer",this._ws.onclose=this._handleClose.bind(this),this._ws.onerror=this._handleError.bind(this),this._ws.onmessage=this._handleMessage.bind(this),this._ws.onopen=this._handleOpen.bind(this),this.emit(r.CONNECTING),this.setStatus(a.CONNECTING)}stop(){this.ensureClose(l.NORMAL),this.setStatus(a.STOPPED)}isConnected(){return this._ws&&this._status===a.OPEN}ensureConnection(e){this._ws&&this._status!==a.STOPPED||this.start(),this._status===a.CONNECTING?this.once(r.OPEN,e):this.isConnected()&&e()}sendRequest(e,t,s={},i=(()=>{}),n=(()=>{}),o=1e4){const r=this.sendEvent(e,t,s),a="SynchronizeState"===t;if(!r)return navigator.onLine&&this._throwError(c.CONNECTION_ERROR,{namespace:e,name:t}),n(c.CONNECTION_ERROR);const l=window.setTimeout(()=>{a||(this._processRequest(r,c.REQUEST_TIMEOUT_ERROR),this._throwError(c.REQUEST_TIMEOUT_ERROR,{messageId:r}))},o);return this._requests[r]=(e,t)=>{window.clearTimeout(l),e?(navigator.onLine&&this._throwError(e,{messageId:r}),n(e)):t&&i(t.payload),delete this._requests[r]},r}sendEvent(e,t,s={}){const{streamId:i}=s,o=n.default.guid(h),r={header:{namespace:e,name:t,messageId:o,streamId:i,seqNumber:this._seqNumber},payload:s};if(this._sendRaw({event:r}))return this._seqNumber++,o}_sendRaw(e){if(!this._ws||this._ws.readyState!==WebSocket.OPEN)return!1;try{return this._ws.send(e instanceof Blob?e:JSON.stringify(e)),!0}catch(e){return!1}}sendStreamData(e,t,s=null){const i=new ArrayBuffer(4);return new DataView(i).setUint32(0,e),this._sendRaw(new Blob([i,t],{type:s}))}setStatus(e){this._status=e,this.emit(r.STATUS_CHANGED,e)}ensureClose(e=l.NORMAL,t=null){if(this._ws){this._ws.onclose=null,this._ws.onerror=null,this._ws.onmessage=null,this._ws.onopen=null;try{this._ws.readyState<WebSocket.CLOSING&&this._ws.close(e)}finally{this._ws=null,this.emit(r.CLOSE,{reason:t}),this.setStatus(a.CLOSED)}}}_processRequest(e,t,s){const i=e&&this._requests[e];i&&i.call(this,t,s)}_sendSyncState(){try{this.sendRequest("System","SynchronizeState",{uuid:this._uuid,auth_token:this._apiKey,vins:this._vins})}catch(e){this._throwError(e.message,e)}}_handleOpen(){this._sendSyncState(),this.setStatus(a.OPEN),this.emit(r.OPEN)}_handleClose(e){const t=window.navigator.onLine?e.code:l.OFFLINE;this.ensureClose(t,e.reason)}_handleError(){this._throwError(c.CONNECTION_ERROR)}_handleMessage({data:e}){if(e){if(e instanceof ArrayBuffer)return this._receiveStream(e);try{const t=JSON.parse(e);return t?t.hasOwnProperty("streamcontrol")?this._receiveStreamControl(t.streamcontrol):t.hasOwnProperty("directive")?this._handleDirective(t.directive):this._throwError(c.UNSUPPORTED_PACKET):this._throwError(c.UNSUPPORTED_PACKET)}catch(e){return this._throwError(c.UNSUPPORTED_PACKET,e)}}}_handleDirective(e){switch(`${e.header.namespace}:${e.header.name}`){case"System:EventException":case"System:InvalidAuth":this._receiveException(e);break;default:this._receiveMessage(e)}}_receiveStream(e){const t=new DataView(e);this.emit(r.STREAM,{streamId:t.getUint32(0),data:t.buffer.slice(4)})}_receiveStreamControl(e){this.emit(r.STREAM_CONTROL,{data:e})}_receiveException(e){const{header:t,payload:s}=e,i=function(e){if(!e||!e.Response)return c.EVENT_ERROR;if(e.Response.RateLimit)return c.RATE_LIMIT_ERROR;return c.RESPONSE_ERROR}(s);this._processRequest(t.refMessageId,i,e),this._throwError(i,{header:t,payload:s})}_receiveMessage(e){const{header:t}=e;this._processRequest(t.refMessageId,void 0,e),this.emit(r.MESSAGE,{data:e})}_throwError(e,t={}){this.emit(r.ERROR,{error:e,data:t})}}function g(){return n.default.iOS?"ios":n.default.android?"android":"windows"}t.Uniproxy=p},function(e,t,s){"use strict";t.__esModule=!0,t.initTextArea=t.TEXTAREA_APP_EVENTS=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(11),r=s(2),a=s(3),l=s(45),c=s(143);const d={FOCUS:"textFocus",BLUR:"textBlur",TAP:"textTap",KEYDOWN:"textKeydown",PASTE:"textPaste",CLEAR:"textDelete"};t.TEXTAREA_APP_EVENTS=d;const u=40,h=250;t.initTextArea=function(e){const t=this,s=e.USE_FAKEAREA&&o.InputView.fakeAreaSupported,i=this.getView(),p=this.getSettings(),g=this.getTextareaPresenter(),m=g.getView(),E=this.getModel();E.setProperty("isFakeTextArea",s);const _=new r.TouchView({element:e.ELEMENTS.clearButton}),T=new r.TouchView({element:e.ELEMENTS.sourceTranslit}),f=n.default.debounce(()=>{setTimeout(()=>{const e=m.getSelection();if(e.start===e.end)return;e.trim=!0;const t=g.getValue(e);t&&E.setProperty("selText",t)},10)}),S=n.default.debounce(()=>{this.updateTrText("type-end")},1500);let C;T.onTap(e=>{e.preventDefault(),e.stopImmediatePropagation()});const y=()=>{document.execCommand("insertHTML",!1,"\n"),this.emit("input")};this.on("pageReady",(function(){const t=e.DEFAULT_TEXT||"";window.location.pathname!==e.COLLECTIONS_PATHNAME&&m.setFocus(!0),m.getValue()&&m.getValue()!==g.getValue()&&m.setValue(""),m.setValue(t,{caret:t.length,sender:"url"})})).on("keyboardOpen",(function(){m.setFocus(!0)})).on("refreshAlertShow",(function(){e.IS_SEARCH_BOT||(m.setFocus(!1),i.setState("expired",!0).on("keydown",(function(e){n.default.preventEvent(e),e.keyCode===o.InputView.keys.ENTER&&t.reload()})))})).on("visibilityChange",(function(e){e||t.reloadIfSessionExpired()})).onAction("swapDirection",()=>{const e=E.getProperty("text"),t=E.getProperty("translation");t&&(E.setProperty("translation",e,{sender:"translator"}),E.setProperty("text",t,{sender:"translator"}))}).onAction("expiredRefresh",()=>{this.reload()}).onAction("applyText",e=>{const t={sender:n.default.getDataAttr(e,"sender")},s=n.default.getDataAttr(e,"text"),i=n.default.getDataAttr(e,"translation"),o=n.default.getDataAttr(e,"src-lang"),r=n.default.getDataAttr(e,"dst-lang"),a=n.default.getDataAttr(e,"swap-dir");s&&E.setProperty("text",s,t),i&&E.setProperty("translation",i,t),o&&E.setProperty("srcLang",o,t),r&&E.setProperty("dstLang",r,t),a&&this.swapDirection()}).addHotKey(l.HOT_KEYS_MAP.FOCUS_INPUT,{condition:()=>!m.hasState("focused"),callback:()=>g.setCaret(E.getProperty("text").length),getActionName:()=>"focus_input"}).addHotKey(l.HOT_KEYS_MAP.CLEAR_INPUT,{view:_,getActionName:()=>"clear_input"}).bindFocusActivation(_),i.onStateChanged("longtext",(function(){m.getContentElement().value=String(m.getContentElement().value)})).onStateChanged("editing",(function(e){e&&m.setFocus(!1)})).setState("faked",s),m.on("tap",(function(e){t.emit(d.TAP,g.getCaret(),e),i.setState("listening",!1)})).on("scroll",(function(e){if(e.target!==this.getContentElement())return;const t=this.getScrollInfo();E.setProperty("textScrollY",100/t.maxTop*t.top,{userScroll:this.userScroll}),this.userScroll=!0})).on(r.TOUCH_VIEW_EVENTS.SELECT,e=>f(e)).on("mouseup",e=>{if(-1!==n.default.get(e,"target.className","").indexOf("translit"))return;if(!n.default.getClosest(e.target,e=>"button"===e.getAttribute("role"))){if(!m.getContentElement().contains(e.target)){const e=m.getValue().length;m.setSelection({start:e,end:e})}f()}}).on("keydown",(function(e){t.emit(d.KEYDOWN,e)})).on("keydown",e=>{if(e.keyCode===o.KEYBOARD_KEYS.BACKSPACE){const{text:e}=E.getProps();a.$tracker.sendMetric("backspace_pressed",{src:e,caret:g.getCaret()})}else e.keyCode===o.KEYBOARD_KEYS.ENTER&&e.shiftKey&&!p.isOptionEnabled(c.AVAILABLE_OPTIONS.ENTER)&&y()}).on("enterPressed",()=>{p.isOptionEnabled(c.AVAILABLE_OPTIONS.ENTER)&&!this.getPredictorPresenter().getView().isEnabled()&&y()}).onStateChanged("empty",e=>{i.setState("empty",e)}).onStateChanged("focused",e=>{t.emit(d.FOCUS,e),e?i.setState("collapsed",!1):t.updateTrText()}).on("focus",()=>{m.setState({focused:!0})}).on("blur",()=>{m.setState({focused:!1}),this.emit(d.BLUR),C=g.getCaret()}).bindDOMEvents("scroll",!0).bindDOMEvents("blur",!0).bindDOMEvents("focus",!0).bindDOMEvents("paste select keydown enterPressed mouseup"),E.setFilter("selText",(function(e){let s=e,i=this.getProperty("spellerData");if(!i||!p.getProperty("autospeller"))return s;try{i=JSON.parse(i)}catch(e){return s}return n.default.isArray(i)&&i.forEach((function(e){e.s&&e.s.length&&s===e.word&&(t.hasSpellerSavedWord(e.word)||(s=e.s[0]))})),s})),i.on("stateChanged:collapsed",(function(e){e&&m.setFocus(!1)})),g.on("input",(function(e,s){e.length-s.oldValue.length>1&&!s.sender&&t.emit(d.PASTE,e,s.oldValue),s.caret=s.caret||this.getCaret(),t.setText(e,s),S()}));const A=(e={})=>{("langHistory"===e.sender||"langSelect"===e.sender)&&(g.setCaret(C),m.setFocus(!0))};return E.on("change",(function(s,i,o){switch(s){case"text":this.setProperty("timestamp",Date.now());const s=i.length;if(m.setFocus(!0),"synonyms"===o.sender){const e=m.getSelection();if(e.start!==e.end){const t=o.oldValue.slice(e.start,e.end);e.start+=t.search(/\S/),e.end-=t.length-t.search(/\s*$/),n.default.extend(o,e),o.caret=e.start+s}}g.setValue(i,o),o.caret&&g.setCaret(o.caret);const r=m.getScrollInfo();this.setProperty("textScrollY",100/r.maxTop*r.top),_.setEnabled(i);break;case"trText":this.setProperty("selText","",{silent:!0});break;case"srcLang":A(o),m.setLanguage(i),T.setState("chinese","zh"===i);break;case"dstLang":A(o);break;case"timestamp":i-o.oldValue>e.SESSION_RESUME_TIME&&t.emit("sessionResumed",i-o.oldValue);break;case"sourceTranslit":T.setContent(i||""),t.emit("containerHeightChanged");break;case"translationScrollY":o.userScroll&&m.scrollTo(m.getScrollInfo().maxTop/100*i)}})),E.onChange("text",e=>{const t=e.length,s=t<=u,n=t>u&&t<=h,o=t>h;i.setState({size0:s,size1:n,size2:o})}).on("translationViewScrollY",e=>{m.scrollTo(e)}).on("moveTextAreaCaret",e=>{g.setCaret(e)}),_.on("tap",()=>{this.emit(d.CLEAR),E.setProperty("text","",{sender:"clearButton"}),t.toggleTranslatorExpandState(!1)}),p.hasProperty("savedText")&&(e.DEFAULT_TEXT=p.getProperty("savedText"),p.setProperty("savedText",null)),m.setValue(""),this}},function(e,t,s){"use strict";t.__esModule=!0,t.CARDS_CAROUSEL_EVENTS=t.AbstractCardsCarousel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(46),r=s(6),a=s(3),l=s(152);const c={APPLY_PHRASE:"applyPhrase",APPLY_ACTIVE_PHRASE:"applyActivePhrase",OPEN_STORY:"openStory"};t.CARDS_CAROUSEL_EVENTS=c;class d extends r.Component{constructor(e,t){super(e,t),this.refs={carousel:"carousel"};const{stories:s=[]}=e;s.length&&(n.default.toggleClass(this.getContainer(),"theme-night"),this.patchPhraseThemes(),this.onceRendered(()=>{a.$tracker.sendMetric("stories_rendered",{stories:s.map(({id:e})=>e).join(",")})})),this.update()}patchPhraseThemes(){const{stories:e,phrases:t}=this.getProps();let s=e[e.length-1].theme;t.forEach(e=>{e.theme={cardType:(s.cardType+2)%l.MAX_CARD_TYPES+1,colorType:(s.colorType+2)%l.MAX_COLOR_TYPES+1},s=e.theme})}getCardsCount(){const{phrases:e,stories:t}=this.getProps();return e.length+t.length}applyPhrase(e){return a.$tracker.sendMetric("daily_phrase_activate",{phrase:e.text}),this.emit(c.APPLY_PHRASE,e)}openStory(e){return this.emit(c.OPEN_STORY,e)}getPhraseBg(e){return e.bg||(e.bg=(0,l.getStoryBgElement)(e.theme.cardType)),e.bg}getStoryPreview(e){return l.StoryCard.getCachedInstance(e.id,{story:e}).getDirective({view:l.STORY_CARD_VIEWS.PREVIEW_BIG})}itemsTemplate(){const{html:e,cn:t,nothing:s}=this.getRenderHelpers(),{phrases:i,stories:n}=this.getProps(),r=t("cardsCarousel"),a=t("storyCard"),l=t("dailyPhrase");return e`
            ${n.map((t,s)=>(t.index=s,e`<div class=${r("card",{type:"story"})}
                    @click=${()=>this.openStory(t)}>
                    ${this.getStoryPreview(t)}
                </div>`))}
            ${i.map(t=>e`
                <div class=${(e=>r("card",{type:"phrase"},[l(),e.theme?"grad_"+e.theme.colorType:""]))(t)}
                     @click=${()=>this.applyPhrase(t)}>
                    ${t.theme?e`
                        <div class=${l("cardBg",[a("bgContainer")])}>
                            ${this.getPhraseBg(t)}
                        </div>
                    `:s}
                    <div class="${l("cardContent")}">
                        <div class=${l("title")}>${o.locales.cardsCarousel.dailyPhrase}</div>
                        <div class=${l("src")} lang="${t.lang}">
                            <span>${t.text}</span>
                        </div>
                        <div class=${l("dst")}>${t.translation}</div>
                        <div class=${l("dst-secondary")}>${t.details}</div>
                    </div>
                </div>
            `)}
        `}}t.AbstractCardsCarousel=d,d.defaults={activeCard:0,phrases:[],stories:[]}},,,,function(e,t,s){"use strict";t.__esModule=!0,t.Database=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(8),r=s(202);class a extends o.Emitter{static isSupported(){try{return"indexedDB"in window&&window.indexedDB}catch(e){return!1}}constructor(e){if(super(),!e||!e.name)throw new Error("Can't open the base with no name");if(!e.version||!n.default.isNumber(e.version))throw new Error("Unsupported base version");this._name=e.name,this._trace=[],this._active=!1,this._version=e.version,this._keyGenerator=new r.KeyGenerator}open(){let e;try{e=window.indexedDB.open(this._name,this._version)}catch(t){this.emit("openError",t),e=null}e&&(this.addTrace("opn"+this._version),e.onblocked=()=>{this.emit("databaseBlocked",this.getTrace())},e.onupgradeneeded=e=>{this._db=e.target.result,this.emit("upgradeneeded"),e.oldVersion<1?this.addTrace("crtdVer"+this._db.version).createDatabase(e):this.addTrace("upgrFrm"+e.oldVersion).upgradeDatabase(e)},e.onsuccess=e=>{this._db||(this._db=e.target.result),this._db.onversionchange=()=>{this._db.close(),setTimeout(()=>{window.location.reload()},1e3*(10+30*Math.random()))},this._db.onclose=()=>{this._active=!1,this.emit("close")},this._active=!0,this.emit("ready")},e.onerror=e=>{this.emit("error",e,"open",this.getTrace())})}tryReconnect(){let e;if(!this._reconnecting){try{e=window.indexedDB.open(this._name,this._version)}catch(e){return}this._reconnecting=!0,e.onupgradeneeded=e=>{this._db=e.target.result,e.oldVersion<1?this.createDatabase(e):this.upgradeDatabase(e)},e.onsuccess=e=>{this._db=e.target.result,this._db.onclose=()=>{this._active=!1,this.emit("close")},this._reconnecting=!1,this._active=!0,this.emit("reconnected")}}}safeTransaction(e,t){const s=this._db;try{return s.transaction(e,t)}catch(e){return!e.message.includes(" clos")&&this.isActive()||this.tryReconnect(),!1}}waitReconnect(e){return this.once("reconnected",e)}addTrace(e){return this._trace.push(e),this}getTrace(){return this._trace.join(",")}generateKey(){return this._keyGenerator.generate()}isActive(){return this._active}createDatabase(){throw new Error("createDatabase not implemented")}upgradeDatabase(){throw new Error("upgradeDatabase not implemented")}}t.Database=a},function(e,t,s){"use strict";t.__esModule=!0,t.CollectionModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(203),r=s(149);class a extends r.CollectionServerModel{static getRandomColor(){return this.COLORS[Math.floor(Math.random()*this.COLORS.length)]}static generateColorRules(e,t){const s=this.COLOR_CSSRULE,i=e.sheet;try{this.COLORS.forEach((function(e){i.insertRule(n.default.parseString(s,t,e),i.cssRules.length?i.cssRules.length:0)}))}catch(e){}}constructor(e,t){super(e,t);const s=this,i=new o.CollectionDatabase({name:o.CollectionDatabase.DATABASE_NAME,version:o.CollectionDatabase.DATABASE_VERSION},{migrateParams:{defaultFavName:t.defaultFavName,defaultHistoryName:t.defaultHistoryName}});this._database=i,i.on("upgradeneeded",(function(){s.emit("upgradeneeded")})).on("ready",(function(){s.emit("dbReady")})).on("close",(function(){s.emit("dbClosed")})).on("synced",(function(){this.getCollections(),this.getRecordsByCollection(s.getProperty("activeId")),s.emit("synced")})).on("checked",(function(e){s.emit("checked",e)})).on("added",(function(e,t){if(this.getCollections({sync:t.subscribe}),!t.subscribe){if(s.getProperty("addingRecord")){const t=s.getItems();t.push(e),s.setProperty("addingRecord",!1).setItems(t).emit("addToNewCollection",e.id)}s.isValid("activeId",e.id)&&s.setProperty("activeId",e.id)}})).on("addedRecords",(function(e){this.getCollections(),this.getRecordsByCollection(e)})).on("records",(function(e,t,i){if(i.sync){const i=s.getItems().find((function(e){return e.id===t}));s.timeoutSyncCollection(i.serverId,e)}else s.setRecords(e),s.emit("recordsReceived",t,e),t===s.getProperty("activeId")&&s.checkRecord(),i.active&&s.deleteRecords()})).on("collections",(function(e,t){s.setItems(e),t.sync?(s._presyncCollections(s.getPreSyncData()),s.emit("collectionsSynced")):(s.checkRecord(),s.emit("updateTop")),s.emit("collectionsSet")})).once("collections",()=>{this.emit("firstCollectionSync")}).on("collectionUpdated",(function(){this.getCollections()})).on("recordUpdated",(function(e=null){s.checkRecord(),s.emit("recordUpdated",e)})).on("recordDeleted",e=>{i.getCollections();this.getItems().some(t=>t.type===r.COLLECTION_TYPES.HISTORY&&t.id===e)?i.getRecordsByCollection(e):i.getRecordsByCollection(this.getProperty("activeId"))}).on("collectionDeleted",(e={})=>{i.getCollections({sync:e.unsubscribed})}).on("resetedScore",(function(e){s.emit("updateRecords",e)})).on("resetedIds",(function(){s.emit("resetedIds").setProperty("syncedUid",null),this.getCollections({sync:!s.isNotAuthorized()})})).on("checkRecordError",(function(e){s.emit("checkRecordError",String(e))})).on("databaseBlocked",(function(e){const t={trace:e,sender:"blocked"};s.emit("databaseError",t)})).on("openError",(function(e){s.emit("databaseError",{name:e&&e.name,sender:"openTryCatch",message:e&&e.message})})).on("error",(function(e,t,i){const n=e.target.error,o={name:n&&n.name,trace:i,sender:t,message:n&&n.message};s.emit("databaseError",o)})).on("indexNotFound",(function({indexName:e,version:t}){s.emit("dbIndexNotFound",{indexName:e,version:t})})).open()}getDefaults(){return{srv:"",uid:"",url:"/",limit:0,recordsLimit:0,items:"",records:"",value:"",xtoken:"",activeId:"",text:"",srcLang:"",dstLang:"",translation:"",syncedUid:"",addingRecord:!1}}isNotAuthorized(){return!this.getProperty("uid")}timeoutSyncCollection(e,t){const s=this,i=this.getSyncData(e,t);setTimeout((function(){s._syncCollection(e,i)}),Math.floor(Math.random()*a.SYNC_TIMEOUT))}getCollectionList(){return this._database.getCollections(),this}getCollection(e){return this._database.getRecordsByCollection(e),this}deleteCollection(e){const t=this._database;let s,i=this.getItems(),n="";return t.deleteCollection(e),e===this.getProperty("activeId")&&(s=i.filter((function(e){return e.type===r.COLLECTION_TYPES.FAVORITES}))[0],s?n=s.id:(i=i.filter((function(t){return e!==t.id&&!r.CollectionServerModel.isSubscription(t)})),i.length&&(n=i[0].id)),this.setProperty("activeId",n)),this}createCollection(e){const t=this._database,s=!e.sourceCollectionId,i={name:e.name,type:s?r.COLLECTION_TYPES.COLLECTION:r.COLLECTION_TYPES.SUBSCRIPTION,color:e.color,public:e.public,status:r.COLLECTION_STATUSES.ADDED,version:0,recordsCount:e.recordsCount||0,creationTimestamp:r.CollectionServerModel.getTimestamp(),attributesTimestamp:r.CollectionServerModel.getTimestamp()};return s||(i.authorName=e.authorName,i.sourceCollectionId=e.sourceCollectionId,i.authorUid=e.authorUid),s&&!i.color&&(i.color=a.getRandomColor()),t.createCollection(i,{subscribe:!s}),this}updateCollection(e,t){return t.status=r.COLLECTION_STATUSES.UPDATED,t.attributesTimestamp=r.CollectionServerModel.getTimestamp(),this._database.updateCollectionData(e,t),this}addRecords(e,t){return this._database.addRecords(e,t),this}deleteRecords(e){let t=e;const s=this._database,i=this.getProps(),n=this.getRecords();if(!t){const e=n.find((function(e){return i.text===e.text&&i.srcLang+"-"+i.dstLang===e.lang&&i.translation===e.translation}));e&&(t=[e.id])}return t&&s.deleteRecords(t),this}resetRecordsScore(e){return this._database.resetRecordsScore(e),this}updateRecord(e,t){return t.modificationTimestamp=r.CollectionServerModel.getTimestamp(),this._database.updateRecord(e,t),this}updateHistoryRecord(e,t){return this._database.updateHistoryRecord(e,t),this}deleteRecordByProps(e,t){return this._database.deleteRecordByProps(e,t),this}moveRecords(e,t){const s=this._database;return e.forEach((function(e){s.moveRecord(e,t)})),this}checkRecord(e=this.getProperty("activeId")){const t=this._database,s=this.getProps();return e&&t.isActive()&&s.text&&s.translation?(t.checkRecord({text:s.text,lang:s.srcLang+"-"+s.dstLang,translation:s.translation,collectionId:e}),this):this.emit("checked",!1)}getActive(){return this._database.getRecordsByCollection(this.getProperty("activeId"),{active:!0}),this}syncCollections(){const e=this._database,t=this.getProps();return t.syncedUid&&(this.isNotAuthorized()||t.syncedUid!==t.uid)?e.resetServerIds():e.getCollections({sync:!this.isNotAuthorized()}),this}subscribe(e){return this.createCollection({name:e.name,color:e.color,public:!1,authorName:e.authorName,authorUid:e.authorUid,sourceCollectionId:e.id}),this}getPreSyncData(){let e=this.getItems();return this.getProperty("shouldSyncHistory")||(e=e.filter(e=>e.type!==r.COLLECTION_TYPES.HISTORY)),{collectionsStatuses:e.filter(e=>e.serverId||e.status!==r.COLLECTION_STATUSES.DELETED).map((function(e){if(e.serverId)return{id:e.serverId,type:e.type,tmpId:e.id,status:e.status,version:e.version};const t={name:e.name,type:e.type,tmpId:e.id,status:r.COLLECTION_STATUSES.ADDED,creationTimestamp:e.creationTimestamp};return e.color&&(t.color=e.color),r.CollectionServerModel.isSubscription(e)?(t.authorName=e.authorName,t.sourceCollectionId=e.sourceCollectionId):t.public=e.public,t}))}}getSyncData(e,t){let s={};const i=this.getItems().find((function(t){return t.serverId===e}));return i&&(s={name:i.name,type:i.type,tmpId:i.id,version:i.version,attributesTimestamp:i.attributesTimestamp},i.color&&(s.color=i.color),r.CollectionServerModel.isSubscription(i)?s.authorName=i.authorName:s.public=i.public),s.status=i?r.COLLECTION_STATUSES.UPDATED:r.COLLECTION_STATUSES.ABSENT,t&&t.length&&(s.recordsStatuses=t.filter((function(e){return e.serverId||e.status!==r.COLLECTION_STATUSES.DELETED})).map((function(e){return e.serverId?{id:e.serverId,score:e.score,tmpId:e.id,status:e.status,modificationTimestamp:e.modificationTimestamp}:{lang:e.lang,text:e.text,score:e.score,tmpId:e.id,status:r.COLLECTION_STATUSES.ADDED,translation:e.translation,creationTimestamp:e.creationTimestamp,modificationTimestamp:e.modificationTimestamp}}))),{collectionStatus:s}}processCollections(e){const t=this._database,s=this,i=this.getItems();return e.length?(e.forEach((function(e){switch(e.action){case r.COLLECTION_ACTIONS.ADD:s.timeoutSyncCollection(e.id);break;case r.COLLECTION_ACTIONS.DROP:case r.COLLECTION_ACTIONS.DELETE:t.deleteCollection(e.tmpId,!0);break;case r.COLLECTION_ACTIONS.UPDATE:t.getRecordsByCollection(e.tmpId,{sync:!0});break;case r.COLLECTION_ACTIONS.REGISTER:i.map((function(t){return t.id===e.tmpId&&(t.serverId=e.id),t})),s.setItems(i),t.updateCollectionData(e.tmpId,{status:r.COLLECTION_STATUSES.UPDATED,serverId:e.id}),t.getRecordsByCollection(e.tmpId,{sync:!0});break;case r.COLLECTION_ACTIONS.POSTPONE:case r.COLLECTION_ACTIONS.MERGE:}})),this):this.emit("synced")}mergeCollection(e){const t=this._database,s=this.getItems().find((function(t){return t.id===e.tmpId||t.serverId===e.id})),i=e.changedAttributes||{},n=e.recordsActions||[];switch(e.action){case r.COLLECTION_ACTIONS.NOP:t.updateCollectionData(s.id,{status:r.COLLECTION_STATUSES.UNCHANGED});break;case r.COLLECTION_ACTIONS.DELETE:t.deleteCollection(s.id,!0);break;case r.COLLECTION_ACTIONS.ADD:const o={};Object.keys(i).forEach((function(e){o[e]=i[e]})),o.status=r.COLLECTION_STATUSES.UNCHANGED,o.serverId=e.id,t.addCollection(o,this.mergeRecords(n));break;case r.COLLECTION_ACTIONS.UPDATE:Object.keys(i).forEach((function(e){s[e]=i[e]})),s.status=r.COLLECTION_STATUSES.UNCHANGED,t.updateCollection(s,this.mergeRecords(n))}return this}mergeRecords(e){const t=[],s=[],i=[];return e.forEach((function(e){switch(e.modificationTimestamp=e.modificationTimestamp||e.creationTimestamp||0,e.score=e.score||0,e.action){case r.COLLECTION_ACTIONS.ADD:t.push({lang:e.lang,text:e.text,translation:e.translation,serverId:e.id,score:e.score,status:r.COLLECTION_STATUSES.UNCHANGED,creationTimestamp:e.creationTimestamp,modificationTimestamp:e.modificationTimestamp});break;case r.COLLECTION_ACTIONS.DROP:case r.COLLECTION_ACTIONS.DELETE:s.push({id:e.tmpId});break;case r.COLLECTION_ACTIONS.UPDATE:i.push({id:e.tmpId,params:{score:e.score,status:r.COLLECTION_STATUSES.UNCHANGED,modificationTimestamp:e.modificationTimestamp}});break;case r.COLLECTION_ACTIONS.REGISTER:i.push({id:e.tmpId,params:{serverId:e.id,status:r.COLLECTION_STATUSES.UNCHANGED}});break;case r.COLLECTION_ACTIONS.POSTPONE:}})),{new:t,deleted:s,updated:i}}filter(e){const t=this.getRecords(),s=n.default.trim(e).toLowerCase();return t.forEach((function(e){e.filtered=s&&(e.deleted||e.text.toLowerCase().indexOf(s)<0&&e.translation.toLowerCase().indexOf(s)<0)})),t}getRecords(){let e=this.getProperty("records");try{e=JSON.parse(e)}catch(t){e=[]}return e}setRecords(e){return this.setProperty("records",e&&JSON.stringify(e))}}t.CollectionModel=a,a.SYNC_TIMEOUT=2e3,a.COLORS=["#b0a79a","#ffbb5a","#fd9060","#ff6665","#e43c31","#c44f69","#9d65a9","#6c65a9","#3779bc","#6fc3e0","#59cd9c","#a5c94b"],a.COLOR_CSSRULE='.{0}[data-color="{1}"] { color: {1}; }'},function(e,t,s){"use strict";t.__esModule=!0,t.Router=t.ROUTER_EVENTS=t.MAX_SHARE_TEXT_LENGTH=t.HISTORY_MOVES=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(4),r=s(205),a=s(169);const l={NAVIGATED_FROM_URL:"navigatedFromURL",HISTORY_MOVE:"historyMove",HISTORY_UPDATED:"historyUpdated",MODEL_UPDATED:"modelUpdated",VIEW_ID_UPDATED:"viewIdUpdated"};t.ROUTER_EVENTS=l;const c="currentRoute",d="push",u="replace",h={BACK:"back",FORWARD:"forward"};t.HISTORY_MOVES=h;const p={method:d,pageTitle:null,isRecording:!0,enforced:!1},g=2,m=["client","force_ui","ui","v","test_id","exp_flags"];t.MAX_SHARE_TEXT_LENGTH=1e3;class E extends o.Model{constructor(e,t){var s;super(e,t),this.historyObject=window.history,this.documentObject=window.document,this.urlController=new r.UrlController(window.location),function(e){const t={method:u,state:{index:0,queryParams:{},viewId:_(e)},enforced:!0},s=m,i=e.getRouteWithQueryString();if(function(e){return n.default.isEmpty(e.currentState)}(e)){const n=e.getQueryParams();n.text&&(t.state.trText=n.text),n.srcLang&&(t.state.srcLang=n.srcLang),n.dstLang&&(t.state.dstLang=n.dstLang);for(let e,i=0,o=s.length;i<o;i+=1)e=s[i],n[e]&&(t.state.queryParams[e]=n[e]);e.updateHistory(i,t)}}(this),s=this,window.addEventListener("popstate",({state:e})=>{if(!e)return;const t=s.getHistoryState(),i=function(e,t){const s=e.getHistoryState(),i={currentState:t,previousState:s};return t.index>s.index?(i.direction=h.FORWARD,i.step=t.index-s.index):(i.direction=h.BACK,i.step=s.index-t.index),i}(s,e),o=s.urlController.getRoute();i.direction===h.BACK&&i.step>0&&n.default.isArray(s.minorViews)&&s.minorViews.forEach(e=>s.emit("closeMinorView",e)),t.action!==e.action&&(t.action&&s.emit("cancelAction",t.action),e.action&&s.emit("activateAction",e.action)),s.emit(l.HISTORY_MOVE,i),s.currentState=e,s.emit(l.MODEL_UPDATED,function(e){const t={};return t.text=e.trText||"",e.srcLang&&(t.srcLang=e.srcLang),e.dstLang&&(t.dstLang=e.dstLang),t}(e)).emit(l.VIEW_ID_UPDATED,e.viewId,t.viewId).setProperty(c,o)})}navigateInitialRoute(){const e=this.urlController.getRoute();this.emit(l.NAVIGATED_FROM_URL,{route:e,pathArray:this.urlController.getPathArray(e)}),this.setProperty({isLoaded:!0})}updateTranslationState(e){const t=this.urlController.getRouteFromTranslationProps(e),s=T(this.getHistoryState()),i=T(e),o=!n.default.isEqualDeep(s,i),r=t.slice(0,1e3);o&&this.updateHistory(r,{state:i})}updateHistory(e,t={}){if(!t.enforced&&this.urlController.getRoute()===e)return;const s={...p,...t},i=this.getHistoryState(),o={route:e,timeStamp:Date.now()};!t.enforced&&""===i.trText&&i.index>0&&(s.method=u),n.default.isEmpty(i)||(o.index=s.method===d?i.index+1:i.index),delete i.action;const r={...i,tab:null,...o,...s.state};if(r.route=this.urlController.addQueryParamsToPathname(e,r),s.pageTitle&&(this.documentObject.title=s.pageTitle),s.isRecording){const e=s.method+"State";if(n.default.isFunction(this.historyObject[e]))try{this.historyObject[e](r,s.pageTitle,r.route)}catch(e){console.error(e)}this.minorViews=[],this.currentState=r}this.setProperty(c,r.route),this.emit(l.HISTORY_UPDATED,r)}updateCurrentState(e={}){const t=this.urlController.getRoute(),s={...this.getHistoryState(),...e};s.route=this.urlController.addQueryParamsToPathname(t,s);try{this.historyObject.replaceState(s,void 0,s.route)}catch(e){console.error(e)}this.currentState=s}removeQueryParams(e){const t=this.urlController.getRoute(),s=this.urlController.getQueryParams(!1),i=this.getHistoryState();e.forEach(e=>delete s[e]),i.route=`${t}${this.urlController.buildQueryString(s)}`;try{this.historyObject.replaceState(i,void 0,i.route)}catch(e){console.error(e)}}createEmptyHistoryStep(){this.updateHistory(this.urlController.getRouteWithQueryString(),{enforced:!0})}pushHistoryState(e={},t={}){e.route||(e.route=this.getRouteFromState(t.isSameRoute)),this.updateHistory(e.route,{enforced:!0,...t,state:e})}pushMinorView(e){this.minorViews.push(e)}excludeMinorView(e){this.minorViews=this.minorViews.filter(t=>t!==e)}getRouteFromState(e){return e?this.getHistoryState().route:"/"}getCollectionId(){return this.urlController.getCollectionId()}back(){this.historyObject.back()}getHistoryState(){const e=n.default.isEmpty(this.currentState)?this.historyObject.state||{}:this.currentState;return n.default.clone(e)}getCurrentViewId(){return this.getHistoryState().viewId}getRouteWithQueryString(){return this.urlController.getRouteWithQueryString()}getQueryParams(e=!0){return this.urlController.getQueryParams(e)}getQueryParam(e){return this.getQueryParams()[e]}getRefPageParam(){return this.getQueryParam("ref_page")}openCollection(e,t={}){const s=e.type===g,i=e.public&&Boolean(e.serverId),n=new a.RouteBuilder(r.VIEW_IDS.COLLECTIONS);s||i?n.append(e.serverId):t.isTop&&n.append(e.id),setTimeout(()=>this.openCollectionsInternal(n.build(),e,t),0)}openCollectionsInternal(e,t,s){const i=this.getHistoryState();let o=!1;if(n.default.isObject(i.viewId)){const e=i.viewId.collectionId===t.id,n=i.viewId.isTop&&i.viewId.collectionId,r=i.action===s.action;if(o=!i.viewId.isTop&&t.sourceCollectionId===i.viewId.collectionId,(!n||e)&&r)return}const a={route:e,action:s.action,viewId:{view:r.VIEW_IDS.COLLECTIONS,collectionId:t.id,isTop:s.isTop}},l=o?u:d,c={method:s.method||l};this.pushHistoryState(a,c)}closeCollection(e={}){this.pushHistoryState({route:new a.RouteBuilder(r.VIEW_IDS.COLLECTIONS).build(),viewId:r.VIEW_IDS.COLLECTIONS},e)}isCurrentRoute(e){return this.urlController.isCurrentRoute(e)}getEventNames(){return l}isVisibleRoute(e){return-1!==r.ACTIVE_VIEWS.indexOf(e)}getRouteFromViewName(e){return this.urlController.getRouteFromViewName(e)}}function _(e){const[t,s]=e.urlController.getPathArray();return t===r.VIEW_IDS.COLLECTIONS?s?{view:t,collectionId:s}:t:null}function T(e){return{trText:e.trText||"",srcLang:e.srcLang||"",dstLang:e.dstLang||""}}t.Router=E,E.minorViews=[]},function(e,t,s){"use strict";t.__esModule=!0,t.RouteBuilder=void 0;t.RouteBuilder=class{constructor(e){this.routeList=[],e&&this.append(e)}append(e){return this.routeList.push(e),this}build(){return"/"+this.routeList.join("/")}}},function(e,t,s){"use strict";t.__esModule=!0,t.DictionaryMultipleModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(136),r=s(130),a=s(156),l=s(131),c=s(137),d=s(171),u=s(70),h=s(172);class p extends d.DictionaryModel{constructor(e,t){super(e,t);const{getLangDir:s}=e;this._getLangDir=s,this.onSet("data",(e,t={})=>{if("selection"===t.reason)return;const s=this.getDeclensions(e);this.emit(r.DECLENSIONS_EVENTS.DECLENSIONS_FETCHED,s)}).onSet("data",e=>{const t=this.getIdioms(e);t&&this.emit(a.IDIOMS_EVENTS.IDIOM_FETCHED,t)}).onSet("data",(e,t={})=>{if("selection"===t.reason)return;const s=this.getDefinitionAndAbbreviations(e);this.emit(l.DEFINITION_EVENTS.DEF_FETCHED,s)}).onSet("data",(e,t={})=>{if("selection"===t.reason)return;const s=this.getRelatedWords(e);this.emit(o.RELATED_WORDS_EVENTS.WORDS_FETCHED,{relatedWords:s,visible:s&&this.hasRelatedWords(s)})}).onSet("data",(e,t={})=>{if("selection"===t.reason||t.invalid)return;const s=this.parseDataResponse(e);this.emit(c.DICTIONARY_EVENTS.DICT_FETCHED,s)})}getLangDir(){const e=this._getLangDir();return this.getProperty("dirReversed")?e.split("-").reverse().join("-"):e}getParams(){let e,t;const s=this.getProps(),i=s.type.split(","),n=[];for(e=0,t=i.length;e<t;e++)i[e]===u.DictionaryPresenter.types.REGULAR?n.push(s.srcLang+"-"+s.dstLang+"."+i[e]):n.push(s.srcLang+"."+i[e]);return{...super.getParams(),ui:s.ui,srv:s.srv,text:s.text,flags:s.flags,dict:n.join(",")}}hasRelatedWords({synWords:e,antWords:t,derivedWords:s}){return[e,t,s].some(e=>e.length)}transformDefinition(e,t=!1){return{imgUrl:e.img,origUrl:e.orig,textVal:e.def.split(/[<>]/).map((e,t)=>({text:e,highlighted:t%2!=0})),altText:e.text,sourceUrl:e.ref.url,sourceName:e.ref.name,isAbbreviation:t}}getDefinition(e){const t=n.default.get(e,"0.tr.0");return!t||t.idiom||t.abbr?null:this.transformDefinition(t)}getAbbreviations(e){return n.default.get(e,"0.tr.0.abbr",!1)?e.map(({text:e,tr:t})=>({...this.transformDefinition(t[0],!0),abbrText:e})):[]}getDefinitionAndAbbreviations(e){const t={definition:null,abbreviations:[]};if(!e)return t;const s=n.default.safeParseJSON(e),i=this.getLangDir();if(!s[i])return t;const o=s[i][u.DictionaryPresenter.types.DEF];return n.default.isNonEmptyArray(o)?{definition:this.getDefinition(o),abbreviations:this.getAbbreviations(o)}:t}getIdioms(e){if(!e)return null;const t=this.getLangDir(),s=n.default.safeParseJSON(e);if(!s[t])return null;const i=s[t][u.DictionaryPresenter.types.DEF];let o;return n.default.isArray(i)&&i.forEach(({tr:e})=>{n.default.isArray(e)&&e.forEach(({def:e,idiom:t})=>{t&&e&&(o=e)})}),o}getRelatedWords(e){if(!e)return null;const t=n.default.safeParseJSON(e);if(!t)return null;const{srcLang:s}=this.getProps(),i=t[s]||{};return{synWords:i.syn||[],derivedWords:i.deriv||[],antWords:i.ant||[]}}getDeclensions(e){const{areNewDeclensions:t}=this.getProps(),s=this.getLangDir(),i="en-ru"===s;if(!e)return[];const o=n.default.safeParseJSON(e);if(!o[s])return[];const r=o[s][u.DictionaryPresenter.types.REGULAR];return r&&r.length?t?(0,h.transformServerDeclensions)({dict:r,isEnglish:i}):this.getLegacyDeclensions(r):[]}getLegacyDeclensions(e){const t=[];return e.forEach(({prdg:e,text:s,pos:i,ts:n})=>{e&&t.push({...e,text:s,partOfSpeech:i&&i.text?i.text:"",ts:n})}),t}}t.DictionaryMultipleModel=p},function(e,t,s){"use strict";t.__esModule=!0,t.DictionaryModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(69),r=s(19),a=s(28),l=s(70);class c extends o.SyncModel{getParams(){const e=this.getProps();return{sid:e.sid,ui:e.ui,srv:e.srv,text:e.text,type:e.type,lang:e.srcLang+"-"+e.dstLang,flags:e.flags}}getDefaults(){return{ui:"",srv:"",url:"/",data:"",text:"",type:"",flags:0,srcLang:"",dstLang:"",customExamples:!1,customExamplesText:""}}hasFlag(e){return(this.getProperty("flags")&e)===e}hasType(e){let t=this.getProperty("type");return t=t?t.split(","):[],-1!==t.indexOf(e)}setType(e,t){let s=this.getProperty("type");s=s?s.split(","):[];const i=s.indexOf(e);return Boolean(t)===i>=0||(t?s.push(e):s.splice(i,1),this.setProperty("type",s.join(","))),this}setFlag(e,t){let s=this.getProperty("flags");return Boolean(t)===this.hasFlag(e)||(s+=e*(t?1:-1),this.setProperty("flags",s)),this}runRequest(e={}){const{url:t}=this.getProps(),s=this.getParams();return this.setRequest(r.HTTPRequest.get(t,s,(t,s)=>{const i=t?t.code:r.HTTPRequest.codes.OK;i===r.HTTPRequest.codes.OK?this.setProperty("data",s.text,{reason:e.reason,resultLength:s.body&&s.body.result&&s.body.result.length}):i!==a.HTTPError.ABORT&&this.emit("error",t)}))}requestData(e){if(this.abort(),!this.isValid())return this;this.getSid().then(()=>this.runRequest(e))}parseDataResponse(e){if(!e)return null;const t=n.default.safeParseJSON(e),s=this.getLangDir();if(!t[s])return null;const i=t[s][l.DictionaryPresenter.types.REGULAR];return i&&i.length?i:null}}t.DictionaryModel=c},function(e,t,s){"use strict";t.__esModule=!0,t.transformServerDeclensions=function({dict:e,isEnglish:t}){const s=[],i=e=>{const t=n.default.get(e,"pos.code","");return r.POS_CODES[t]||""},o=e=>{const t={optional:"",main:e};if("("!==e[0])return t;try{const[,t,s]=e.match(/^(\(.+?\)) (.+)$/);return{optional:t,main:s}}catch(e){return t}},a=({headers:e=[],headerComments:t=[],rows:s,rowComments:i=[],timelines:n=[]})=>s.map((s,r)=>{const a=s.map((e,t)=>({value:o(e),comment:Array.isArray(i[r])?i[r][t]:""})),l={header:e[r]||"",comment:t[r]||"",cells:a},c=n[r]||null;return c&&(l.timeline=c),l}),l=(e,t)=>(e.length||(e=[""]),e.map((e,s)=>({header:e,tables:a(t[s])})));for(const o of e){const e=i(o),r=n.default.get(o,"text",""),a=n.default.get(o,"prdg.data.0.tabs",[]),c=n.default.get(o,"prdg.data.0.tables",[]);if(!e||!c.length)continue;const d={isEnglish:t,text:r,partOfSpeech:e,tabs:l(a,c)};s.push(d)}return s.sort((e,t)=>{const s=r.POS_ORDER[e.partOfSpeech],i=r.POS_ORDER[t.partOfSpeech];return s-i}),s},t.transformServerExamples=function(e){const t=n.default.get(e,"result.tabs",[]),s=n.default.get(e,"result.examples",[]);if(0===s.length)return{exampleTabs:[],allExamples:[]};const i=[],o=t.map(e=>({...e,examples:[]}));for(const e of s){const t=c(e);i.push(t),n.default.get(e,"ref.type")!==a.NEWS&&o[e.tabIndex].examples.push(t)}return{exampleTabs:o,allExamples:i}},t.validateServerResponse=function(e){const t=n.default.get(e,"result.tabs"),s=n.default.get(e,"result.examples"),i=n.default.isArray(t),o=n.default.isArray(s);if(!i||!o)return!1;if(t.length){const e=n.default.get(t,"0.text");if(!(n.default.isString(e)&&e.length))return!1;const s=n.default.get(t,"0.translation");if(!(n.default.hasProperty(s,"text")||n.default.hasProperty(s,"other")||n.default.hasProperty(s,"idiom")))return!1}if(s.length){const e=s[0];if(![n.default.isNumber(e.tabIndex),n.default.isString(e.id),n.default.isString(e.src)&&e.src.length,n.default.isString(e.dst)&&e.dst.length,Object.values(a).includes(n.default.get(e,"ref.type"))].every(e=>e))return!1}return!0},s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(46),r=s(70);const a={IDIOM:"idiom",BOOK:"book",SERIES:"series",MOVIE:"movie",NEWS:"news"};function l(e,t){return{text:e,highlighted:t%2!=0}}function c(e){const t=e.src.split(/[<>]/),s=e.dst.split(/[<>]/),i=e.ref;return{id:e.id,refType:i.type,ref:i.type===a.IDIOM?a.IDIOM:i.title,isIdiom:i.type===a.IDIOM,isBook:i.type===a.BOOK,isMovieOrSeries:i.type===a.MOVIE||i.type===a.SERIES,exampleVal:t.map(l),originalVal:t.join(""),exampleTrs:s.map(l),originalTrs:s.join(""),title:i.type===a.NEWS?o.locales.labels.news:i.title,origTitle:i.orig_title,author:i.author,translator:i.translator,year:i.year,director:i.director,refUrl:i.url}}},function(e,t,s){"use strict";t.__esModule=!0,t.PredictorModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(9),r=s(44),a=s(72),l=s(19),c=s(28),d=s(214),u=s(215);class h extends a.ListboxModel{static prepareValue(e,t){const s=t.pos;let i=t.index,n=t.value;return s<0?i+=s:n=new Array(s+1).join(" ")+n,{text:e.slice(0,i)+n+e.slice(t.index),caret:i+n.length}}static extractWords(e,t){if(!n.default.trim(e))return"";const s=e.match(/(\S+\s*)/g),i=t?-t:0;return s?s.slice(i).join(""):""}constructor(e,t={}){super(e,t),this._url=t.url,this._counter=0,this._detectUrl=t.detectUrl,this._detectCounter=0}getParams(){const e=this.toJSON();return{q:e.text,srv:e.srv,sid:e.sid,lang:e.srcLang,limit:e.limit}}getDefaults(){return{pos:0,srv:"",text:"",auto:!1,index:0,value:"",items:"",limit:10,reason:"",srcLang:"",dstLang:"",endOfWord:!1}}validateDetectResponse(e,t){if(!n.default.hasAlpha(t.q))return!0;const s=e&&e.body,{languages:i}=this.getProps();return n.default.isObject(s)&&i[s.lang]}runDetectRequest(){if(!this.canDetectLanguage())return this;const e=this.getDetectParams(),t=++this._detectCounter;l.HTTPRequest.get(this._detectUrl,e,(s,i)=>{const n=s&&s.code===c.HTTPError.ABORT;if(!(i&&i.code===l.HTTPRequest.codes.OK)||n||this.validateDetectResponse(i,e)||(0,o.logError)(new u.DetectApiError),t!==this._detectCounter||JSON.stringify(e)!==JSON.stringify(this.getDetectParams()))return;const r=s?s.code:i.body.code;if(r!==l.HTTPRequest.codes.OK)return this.emit("detectError",s||new c.HTTPError(r,i.body.message));i.body.lang&&this.setProperty("srcLang",i.body.lang,{kbd:Boolean(i.body.kbd),detected:!0})})}detectLanguage(){return r.sessionManager.getSid().then(e=>{this.setProperty({sid:e}).runDetectRequest()}),this}getDetectParams(){const e=this.toJSON();return{sid:e.sid,srv:e.srv,text:n.default.trim(e.text),hint:[e.srcLang,e.dstLang].join(","),options:e.detectOptions}}canDetectLanguage(){return this.isValid("text")&&this.getProperty("auto")}validateSuggestionsResponse(e){const t=e&&e.body;return n.default.isObject(t)&&n.default.isArray(t.text)&&"number"==typeof t.pos&&"boolean"==typeof t.endOfWord}runSuggestionRequest(){if(!this.canRequestSuggestion())return this;const e=this.getParams(),t=++this._counter;this.emit("query",e),l.HTTPRequest.get(this._url,e,(s,i)=>{const n=s&&s.code===c.HTTPError.ABORT;if(!(i&&i.code===l.HTTPRequest.codes.OK)||n||this.validateSuggestionsResponse(i)||(0,o.logError)(new d.PredictorApiError),t===this._counter&&JSON.stringify(e)===JSON.stringify(this.getParams()))return s?this.emit("error",s):void this.setProperty({pos:i.body.pos,endOfWord:i.body.endOfWord}).setItems(i.body.text&&i.body.text.length?i.body.text:"")})}requestSuggestion(){return r.sessionManager.getSid().then(e=>{this.setProperty({sid:e}).runSuggestionRequest()}),this}canRequestSuggestion(){return this.isValid()}}t.PredictorModel=h},function(e,t,s){"use strict";t.__esModule=!0,t.MicNotificationChip=t.MAC_NOTIFICATION_CHIP_TYPES=void 0;var i=s(6),n=s(2),o=s(18);const r={DISABLED:"disabled",ACTIVATING:"activating"};t.MAC_NOTIFICATION_CHIP_TYPES=r;class a extends i.Component{constructor(e,t){super(e,t),this.locales=o.desktopLocales.micNotificationChip,this.update(),this.handleEnableMicGif(),this.tooltipView=new n.TouchView({element:e.tooltipElement}),this.tooltipView.setVisible(this.getProperty("type")===r.ACTIVATING),this.onChange("type",()=>{this.tooltipView.setVisible(this.getProperty("type")!==r.DISABLED),this.update()}),this.onVisibilityChanged(e=>{e||this.tooltipView.setVisible(!1)})}handleEnableMicGif(){const{gifUrl:e}=this.getProps(),t=document.createElement("img");t.classList.add("micNotificationChipTooltip_image"),t.setAttribute("alt",this.locales.micEnableInstructionAlt),t.src=e,t.onload=()=>{const e=this.getProps().tooltipElementWrapper,s=this.getProps().spinnerElement;e&&s&&(e.removeChild(s),e.appendChild(t))}}getTitle(){return this.getProperty("type")===r.ACTIVATING?this.locales.micActivating:this.locales.micDisabled}isTooltipVisible(){return this.tooltipView.isVisible()}closeTooltip(){this.tooltipView.setVisible(!1)}template({html:e,cn:t}){return e`
            <div @click=${()=>this.closeTooltip()}
                 class="${t("button")({view:"primary",disabled:!0,size:"l",round:!0})} micNotificationChip"
                 data-tooltip="${this.locales.micAccessDenied}"
                 data-tooltip-position="top-right"
                 data-tooltip-vetrical-margin="5">
                ${this.getTitle()}
            </div>
        `}}t.MicNotificationChip=a,a.defaults={type:r.DISABLED}},function(e,t,s){"use strict";t.__esModule=!0,t.MAX_EXAMPLES_AMOUNT=t.EXAMPLES_FILTER_DELIMITER=t.EXAMPLES_FILTER_ALL=t.DictionaryPresenter2=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(70);const r=window.config||{},a="allTr";t.EXAMPLES_FILTER_ALL=a;t.EXAMPLES_FILTER_DELIMITER=":";t.MAX_EXAMPLES_AMOUNT=10;class l extends o.DictionaryPresenter{static prepareExampleData(e,t,s,i=[],n,o=[],r=[],a=[]){return l.prepareItems(e).filter(e=>l.filterItem(e,n)).map((e,c)=>l.processItem(e,c,t,s,i,n,o,r,a)).filter(e=>e.examples.length)}static prepareItems(e){return e}static filterItem(e,t){const s=e.translation,i=s.text||s;if(t&&t.includes(":")){const n=s.pos&&s.pos.code;return t===[a,null].join(":")||t===[i,n].join(":")||t===[e.text,null].join(":")}if(!t||t===a||i===t)return e}static processItem(e,t,s,i,o,a,c,d,u){let h;h=e.translation.other?r.TABS.other:e.translation.idiom?r.TABS.idioms:e.translation.text||e.translation;const p=a===h,g=o[t],m=e.examples.filter(({id:e})=>!n.default.isArray(u)||!u.includes(e)).map((function(e){return l.processExample(e,s,i,c,d,h)}));return l.prepareExampleGroup(e,t,m,p,g,h)}static processExample(e,t,s,i,o,r){const a=e.src.split(/[<>]/),c=e.dst.split(/[<>]/),d=l.prepareOneExample(e,a,c,t,s,r);if(n.default.hasProperty(i,d.id)&&(d.voteResult={isGood:i[d.id],isBad:!i[d.id]}),n.default.hasProperty(o,d.id)){const e=o[d.id];d.speakerSrc=e.srcValid,d.speakerDst=e.dstValid}return d}static prepareOneExample(e,t,s,i,n,o){return{id:e.id,exampleVal:t.map((function(e,t){return{text:e,highlighted:t%2!=0}})),originalVal:t.join(""),srcLang:i,exampleTrs:s.map((function(e,t){return{text:e,highlighted:t%2!=0}})),originalTrs:s.join(""),translation:o,dstLang:n,ref:"idiom"===e.ref.type?e.ref.type:e.ref.title,author:e.ref.author,translator:e.ref.translator,year:e.ref.year,director:e.ref.director,title:e.ref.title,origTitle:e.ref.orig_title,message:l.getTooltipMessage(e.ref),refType:e.ref.type,refUrl:e.ref.url}}static prepareExampleGroup(e,t,s,i,o,a){const l=s.length-r.MIN_EXAMPLE_COUNT,c=e.translation,d=c.pos?c.pos:null,u=c.other;return{pos:!u&&d&&d.text,text:e.text,index:t,showAll:s.length===r.MAX_EXAMPLE_COUNT,posCode:!u&&d&&d.code,tooltip:!u&&d&&d.tooltip,examples:s,expanded:i||o,filtered:i,other:u,moreCount:s.length>r.MIN_EXAMPLE_COUNT?s.length-r.MIN_EXAMPLE_COUNT:"",translation:a,moreMessage:l>0?n.default.parseString(r.MORE_MESSAGE,l):""}}static getTooltipMessage(e){const t=e.type||e.refType;switch(t){case"news":return r.REFERENCE_TOOLTIP_MESSAGES.news;case"book":return n.default.parseString(r.REFERENCE_TOOLTIP_MESSAGES.book,e.author,e.title,e.translator);case"movie":case"series":return n.default.parseString(r.REFERENCE_TOOLTIP_MESSAGES[t],e.title,e.director);case"idiom":return r.REFERENCE_TOOLTIP_MESSAGES.idiom}}constructor(e){super(e);const t=this;this.getModel().on("change:voteResults",(function(e,s){t._renderData(this.getProperty("data"),s)})).on("change:speakersSupport",(function(e,s){t._renderData(this.getProperty("data"),s)})).on("change:expandedLists",(function(e,s){t._renderData(this.getProperty("data"),s)}))}updateView(){const e=this.getModel();this._renderData(e.getProperty("data"))}setTranslation(e,t){return this.getModel().setProperty("translation",e,t),this}getDict(){return this.getModel().getProperty("dict")}setVoteResult(e,t){this.getModel().setVoteResult(e,t)}setVoteResults(e){return this.getModel().setVoteResults(e),this}getVoteResults(){return this.getModel().getVoteResults()}setSpeakerSupport(e,t,s){this.getModel().setSpeakerSupport(e,t,s)}setSpeakersSupport(e){return this.getModel().setSpeakersSupport(e),this}getSpeakersSupport(){return this.getModel().getSpeakersSupport()}setExpandedList(e,t){this.getModel().setExpandedList(e,t)}getExpandedLists(){return this.getModel().getExpandedLists()}setDict(e,t){return this.getModel().setProperty("dict",e,t),this}setMaxLength(e,t){return this.getModel().setProperty("maxLength",e,t),this}setData(e,t){return this.getModel().setProperty("data",e,t),this}setCustomExamplesFlag(e,t){const s=this.getModel();return s.setProperty({customExamplesText:e?s.getProperty("text"):"",customExamples:e},t),this}customExamplesEnabled(){return Boolean(this.getModel().getProperty("customExamples"))}getText(){return this.getModel().getProperty("text")}getSelectedText(){return this.getModel().getProperty("selText")}setSelectedText(e,t){return this.getModel().setProperty("selText",e,t),this}getSrcLanguage(){return this.getModel().getProperty("srcLang")}getDstLanguage(){return this.getModel().getProperty("dstLang")}_handleSetData(e,t){this.emit("dataSet",e,t)}_handleChangeLang(){this.emit("langChanged")}}t.DictionaryPresenter2=l},function(e,t,s){"use strict";t.__esModule=!0,t.SpeechRecognizerView=t.RECOGNIZER_STATES=void 0;var i=s(2);t.RECOGNIZER_STATES={LISTENING:"listening",PREPARING:"preparing",INVALID:"invalid",ACTIVATING:"activating",MIC_DISABLED:"mic-disabled"};class n extends i.TouchView{}t.SpeechRecognizerView=n},function(e,t,s){"use strict";t.__esModule=!0,t.SpeechRecognizerNative=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(144);class r extends o.SpeechRecognizerBase{static isAvailable(){const e=window.SpeechRecognition||window.webkitSpeechRecognition;return e&&n.default.isFunction(e)&&!/opr/.test(navigator.userAgent.toLowerCase())}constructor(e={}){super(e),this._options=e,this._isListening=!1}getRecognition(){return this._recognition||this._createRecognizer(),this._recognition}getNewRecognition(){return this._createRecognizer(),this._recognition}_createRecognizer(){this._recognition&&this._clearListeners();const{continuous:e,interimResults:t}=this._options,s=new(window.SpeechRecognition||window.webkitSpeechRecognition);s.continuous=e,s.interimResults=t,s.onstart=this._onStart.bind(this),s.onend=this._onEnd.bind(this),s.onresult=this._onResult.bind(this),s.onerror=s.onend,this._recognition=s}_clearListeners(){const e=this._recognition;e.onstart=null,e.onend=null,e.onresult=null,e.onerror=null}_onStart(){this._isListening=!0,this.emit(o.RECOGNITION_EVENTS.START,"native")}_onEnd(e){this._isListening=!1,"error"===e.type&&this.getRecognition().abort(),this.emit(o.RECOGNITION_EVENTS.END,"error"===e.type?e.error:"")}_onResult(e){this._isListening&&this.emit(o.RECOGNITION_EVENTS.RECOGNIZE,e)}stopListening(){return this.getRecognition().abort(),this}startRecognition(e){const t=this.getNewRecognition();if(!navigator.onLine)return this.emit(o.RECOGNITION_EVENTS.END,o.RECOGNITION_ERRORS.NETWORK);t.lang=e,t.start()}convertLanguage(e,t){t(r.langs[e]||"")}prepareData(e,t){let s="",i=!0;const o=e.results;for(let t=e.resultIndex,n=o.length;t<n;t++){if(!o[t])return;o[t][0]&&(s+=o[t][0].transcript),o[t].isFinal||(i=!1)}return{final:i,value:n.default.trim(s),index:t,resultIndex:e.resultIndex}}getVisualizer(){return null}getPriority(){return/yabrowser/.test(navigator.userAgent.toLowerCase())?o.RECOGNITION_PRIORITIES.LOW:o.RECOGNITION_PRIORITIES.NORMAL}}t.SpeechRecognizerNative=r,r.langs={ar:"ar-EG",bg:"bg-BG",ca:"ca-ES",cs:"cs-CZ",da:"da-DK",de:"de-DE",el:"el-GR",en:"en-GB",es:"es-ES",fi:"fi-FI",fr:"fr-FR",he:"he-IL",hr:"hr_HR",hu:"hu-HU",id:"id-ID",is:"is-IS",it:"it-IT",ja:"ja-JP",ko:"ko-KR",lt:"lt-LT",ms:"ms-MY",nl:"nl-NL",no:"nb-NO",pl:"pl-PL",pt:"pt-PT",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sl:"sl-SI",sr:"sr-RS",sv:"sv-SE",th:"th-TH",tr:"tr-TR",uk:"uk-UA",vi:"vi-VN",zh:"cmn-Hans-CN"}},function(e,t,s){"use strict";t.__esModule=!0,t.StreamPlayer=t.AUDIO_FORMATS=void 0;var i=s(10);t.AUDIO_FORMATS={WEBM:"audio/webm;codecs=opus",OGG:"audio/ogg;codecs=opus",WAV:"audio/x-wav;bit=16",WAV_PCM:"audio/x-pcm;bit=16",RAW:"audio/x-raw"};const n="no_stream",o="decode_error",r="buffer_source_error",a="player_error";t.StreamPlayer=class{constructor(e){this.stream=null,this.activeSource=null,this.activeBufferIndex=0,this.stopped=!0,this.format="",this.streamFactory=e,this.audioContext=null}setAudioContext(e){this.audioContext=e}start({onStart:e,onError:t,onFinished:s,format:i}){this.decodeErrorCounter=0,this.format=i,this.stopped=!1,this.onStart=e,this.onError=t,this.onFinished=s}stop(){this.stream&&this.stream.break(),this.finished()}onPackage(e){this.stream||(this.stream=this.streamFactory({onBufferReady:this.onBufferReady.bind(this),format:this.format})),this.stream?this.stream.add(e):this.error(n)}onStreamFinished(){this.stream&&this.stream.finish()}onBufferReady(e,t){e?(this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext)),this.audioContext.decodeAudioData(e,e=>this.handleDecodeAudioData(e,t),this.handleDecodeError.bind(this))):this.stop()}handleDecodeError(e){if(0==this.decodeErrorCounter++){const t=e?e.message:null;(0,i.getGlobalEmitter)().emit("uniproxyTtsError",o,t,{format:this.format,errorCount:this.decodeErrorCounter})}else this.decodeErrorCounter>5&&(this.error(o,e),this.decodeErrorCounter=0)}handleDecodeAudioData(e,t){this.stopped||(this.audioBuffers||(this.audioBuffers=[]),this.audioBuffers[t]=e,this.playBuffer())}finished(){this.onFinished&&this.onFinished(),this.clean()}clean(){this.stream=null,this.stopped=!0,this.audioBuffers=null,this.activeBufferIndex=0,this.activeSource&&(this.activeSource.disconnect(),this.activeSource.removeEventListener("ended",this.handleEnded.bind(this)),this.activeSource.removeEventListener("error",this.handleError.bind(this,r)),this.activeSource.stop()),this.activeSource=null,this.onStart=null,this.onError=null,this.onFinished=null}error(e=null,t=null){null===e&&(e=a);const s=t instanceof Error?t.message:null;this.onError&&this.onError(e,s),this.clean()}playBuffer(e=!1){if(!this.audioBuffers||!this.audioBuffers.length)return;const t=this.audioBuffers[this.activeBufferIndex];if(t&&(!this.activeSource||e)){this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext));const e=this.audioContext,s=e.createBufferSource();this.activeSource=s,s.buffer=t,s.connect(e.destination),s.addEventListener("ended",this.handleEnded.bind(this)),s.addEventListener("error",this.handleError.bind(this,r)),s.start(),0===this.activeBufferIndex&&this.onStart&&this.onStart()}}handleError(e,t=null){this.error(e,t)}handleEnded(){this.activeSource&&(this.activeSource.disconnect(),this.activeSource=null),this.audioBuffers&&this.stream?(this.audioBuffers[this.activeBufferIndex]=null,this.stream.finished&&this.stream.index===this.activeBufferIndex?this.finished():(this.activeBufferIndex++,this.audioBuffers[this.activeBufferIndex]&&this.playBuffer(!0))):this.clean()}}},function(e,t,s){"use strict";t.__esModule=!0,t.SharePresenter=void 0;var i=s(139);class n extends i.ListboxPresenter{constructor(e){super(e),this.on("itemSelected",(function(){this.share()}))}share(){const e=this.getModel();return e.share(),this.emit("share",e.getParams())}write(){const e=this.getModel();return e.write(),this.emit("write",e.getMailParams())}setLink(e){return this.getModel().setProperty("link",e),this}setTitle(e){return this.getModel().setProperty("title",e),this}setDescription(e){return this.getModel().setProperty("description",e),this}}t.SharePresenter=n},function(e,t,s){"use strict";t.__esModule=!0,t.ShareModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(72);const r="telegram",a="whatsapp",l="odnoklassniki";class c extends o.ListboxModel{share(){const e=this.getParams(),t=encodeURIComponent(e.url).replace(/%2520/g,"%2B");let s;s=e.service===r?`https://telegram.me/share/url?text=${e.title}&url=${t}`:e.service===a?"whatsapp://send?text="+t:e.service===l?`https://connect.ok.ru/offer?url=${t}&title=${encodeURIComponent(e.title)}`:this.getProperty("url")+"?"+n.default.toQueryString(e),window.open(s)}write(){window.location.href="mailto:?"+n.default.toQueryString(this.getMailParams())}getParams(){const e=this.toJSON();return{url:e.link,title:e.title,service:e.value,description:e.description}}getDefaults(){return{url:"",link:"",title:"",value:"",items:"",description:""}}getMailParams(){const e=this.toJSON();return{subject:e.title,body:e.description}}}t.ShareModel=c},function(e,t,s){"use strict";t.__esModule=!0,t.TTSPresenter=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(17),r=s(140);class a extends o.Presenter{static normalizeText(e){return n.default.trim(e.replace(/[^\S\r\n]+/g," "))}constructor(e){super(e);const t=this,s=this.getView(),i=this.getModel();this._players=[],s.on("tap",()=>{s.hasState("playing")&&this._onActionStarted({action:r.PLAYER_ACTIONS.STOP,manual:!0}),s.hasState("invalid")?this.emit("invalidState",i.toJSON()):this.toggle()}).on("stateChanged:invalid",(function(e){t.emit("toggleValid",!e)})),i.onChange(["text","lang"],()=>{this._updatePlayerState()})}_updatePlayerState(){const e=this.getView(),t=this.getModel(),{text:s,lang:i}=t.getProps();this.stop(),this._resetPlayingCounter(),this.getPlayerState(s,i,(function(s){e.setState("invalid",s!==r.PLAYER_STATES.OK),t.setProperty("state",s)}))}stop(){const e=this._players.some(e=>e.isActive());this._players.forEach(e=>e.stop()),e&&!this.getView().hasState("silent")&&this._onActionStarted({action:r.PLAYER_ACTIONS.STOP,manual:!0})}play(){const{text:e,lang:t}=this.getProps(),s=!!Boolean(window.config.ENABLE_TTS_SLOWING)&&this._getPlayingCounter()%2;n.default.asyncFilter(this.getSortedPlayers(e,t),(i,n)=>i.play(e,t,s,e=>{e?this._incrementPlayingCounter():n(!1)}))}getPlayerState(e,t,s){n.default.asyncFilter(this._players,(function(e,s){e.isLangSupported(t,s)}),(function(t){let i=t;return i.length?(i=i.filter(t=>t.isTextSupported(e)),i.length?(i=i.filter(t=>t.isTextSizeBelowLimit(e)),i.length?void s(r.PLAYER_STATES.OK):s(r.PLAYER_STATES.TEXT_SIZE_EXCEEDED)):s(r.PLAYER_STATES.TEXT_NOT_SUPPORTED)):s(r.PLAYER_STATES.LANG_NOT_SUPPORTED)}))}getSortedPlayers(e,t){return this._players.map(s=>[s.getPriority(e,t),s]).sort(([e],[t])=>t-e).map(([e,t])=>t)}toggle(){const e=this.isActive();return e?this.stop():this.play(),!e}isActive(){return this._players.some((function(e){return e.isActive()}))}isValid(e,t,s){this.getPlayerState(e,t,e=>{s(e===r.PLAYER_STATES.OK)})}addPlayer(e){e.on("actionStarted",this._onActionStarted.bind(this)),e.on("playerUpdated",this._updatePlayerState.bind(this)),this._players.push(e)}setText(e){return this.getModel().setProperty("text",a.normalizeText(e)),this}setLanguage(e){return this.getModel().setProperty("lang",e),this}_getPlayingCounter(){return this.getModel().getProperty("counter")||0}_incrementPlayingCounter(){return this.getModel().setProperty("counter",this._getPlayingCounter()+1),this}_resetPlayingCounter(){return this.getModel().setProperty("counter",0),this}_onActionStarted(e){const t=this.getView(),s=e.action,{STOP:i,LOAD:n,PLAY:o}=r.PLAYER_ACTIONS;t.setState({silent:s===i,loading:s===n,playing:s===o}),this.emit("actionStarted",{...e,...this.getProps()})}}t.TTSPresenter=a},function(e,t,s){"use strict";t.__esModule=!0,t.HISTORY_APP_EVENTS=t.AbstractHistoryModule=void 0;var i=s(5),n=s(238),o=s(184),r=s(185);const a={PRE_OPEN_HISTORY:"preOpenHistory",OPEN_HISTORY:"openHistory"};t.HISTORY_APP_EVENTS=a;class l extends i.AppModule{constructor(e,t){super(e,t),this.moduleName="history",this.recordFields=["text","translation","srcLang","dstLang"],this.historyCache=this.makeHistoryCache(),this.historyCollection=this.makeHistoryCollection(),this.history=this.makeHistoryComponent(),this.updateHistoryAsync=this.debounceMethod(this.updateHistory,1e3),this.updateHistorySessionAsync=this.debounceMethod(this.updateHistorySession,500),this.listenApp(),this.listenAppModel(),this.listenHistoryCollection(),this.listenHistoryComponent(),this.updateHistorySettingState(),this.historyCache.getSessionRecord()&&(this.historyCollection.processRecord(this.historyCache.getSessionRecord()),this.historyCache.setSessionRecord(null))}makeHistoryCache(){return new o.HistoryCache({},{name:o.STORE_KEY,maxItems:this.appConfig.MAX_HISTORY_SHOW})}makeHistoryCollection(){return new n.HistoryCollection({maxTextLength:this.appConfig.MAX_FAV_TEXT_LENGTH,maxRecords:this.appConfig.MAX_HISTORY_RECORDS})}makeHistoryComponent(){}getRecord(){const e={};return this.recordFields.forEach(t=>{e[t]=this.appModel.getProperty(t)}),e}isHistorySettingEnabled(){}updateHistorySettingState(){const e=this.isHistorySettingEnabled();this.appModel.setProperty({historyEnabled:e}),this.history.setSettingState(e),this.historyEnabled=e}updateHistory(){this.historyEnabled&&this.historyCollection.processRecord(this.getRecord())}updateHistorySession(){if(this.historyEnabled){const e=this.getRecord();this.historyCache.setSessionRecord(this.historyCollection.isRecordValid(e)?e:null)}}listenAppModel(){this.appModel.onChange(this.recordFields,()=>{this.updateHistorySessionAsync()}).onChange("translation",e=>{this.history.setVisible(!e)})}listenApp(){this.app.on("databaseError",()=>{this.historyCollection.setProperty("updating",!1)})}listenHistoryCollection(){this.historyCollection.onChange("records",e=>{this.historyCache.setRecords(e)})}listenHistoryComponent(){this.history.on(r.HISTORY_EVENTS.OPEN_HISTORY,()=>{this.app.emit(a.PRE_OPEN_HISTORY),this.historyCollection.isReady()?this.app.emit(a.OPEN_HISTORY):this.historyCollection.onceReady(()=>{this.app.emit(a.OPEN_HISTORY)})}).on(r.HISTORY_EVENTS.APPLY_ITEM,({text:e,srcLang:t,dstLang:s})=>{this.appModel.setProperty({text:e,srcLang:t,dstLang:s},{sender:"translationHistory"})})}}t.AbstractHistoryModule=l},function(e,t,s){"use strict";t.__esModule=!0,t.COLLECTION_EVENTS=void 0,t.getCollectionsEmitter=function(){return i};const i=new(s(8).Emitter);t.COLLECTION_EVENTS={SYNCED:"synced",DB_READY:"dbReady",INIT:"init",COLLECTIONS_SET:"collectionsSet"}},function(e,t,s){"use strict";t.__esModule=!0,t.STORE_KEY=t.HistoryCache=t.HISTORY_CACHE_FIELDS=void 0;var i=s(63);t.STORE_KEY="yTrHistory";const n={RECORDS:"records",SESSION_RECORD:"sessionRecord"};t.HISTORY_CACHE_FIELDS=n;class o extends i.Storage{constructor(e,t){super(e,t);const{maxItems:s=10}=t;this.maxItems=s,this.getRecords()||this.setRecords([])}setRecords(e){return this.setProperty(n.RECORDS,e.slice(0,this.maxItems))}getRecords(){return this.getProperty(n.RECORDS)}setSessionRecord(e){return this.setProperty(n.SESSION_RECORD,e)}getSessionRecord(){return this.getProperty(n.SESSION_RECORD)}}t.HistoryCache=o,o.defaults={records:[],sessionRecord:null}},function(e,t,s){"use strict";t.__esModule=!0,t.HISTORY_METRIKAS=t.HISTORY_EVENTS=t.AbstractHistoryComponent=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(6),r=s(184),a=s(3);const l={APPLY_ITEM:"applyItem",OPEN_HISTORY:"openHistory"};t.HISTORY_EVENTS=l;const c={APPLY_ITEM:"applyItem",OPEN_HISTORY:"openHistory"};t.HISTORY_METRIKAS=c;const{$track:d}=(0,a.getTrackerByNamespace)(c);class u extends o.Component{constructor(e,t){super(e,t);const{storageModel:s}=e;s.onChange(r.HISTORY_CACHE_FIELDS.RECORDS,()=>this.updateComponent()),this.onChange("settingEnabled",()=>this.updateComponent()),this.updateComponent()}updateComponent(){const{storageModel:e,settingEnabled:t}=this.getProps();this.setEnabled(e.getRecords().length>0&&t),this.update()}setSettingState(e){return this.setProperty("settingEnabled",e)}applyItem(e,t){d(c.APPLY_ITEM,{index:t}),this.emit(l.APPLY_ITEM,e)}openHistoryCollection(e){d(c.OPEN_HISTORY,{source:e}),this.emit(l.OPEN_HISTORY)}getItems(){const{storageModel:e,maxItems:t}=this.getProps();return e.getRecords().slice(0,t)}getLangDir(e){return n.default.isRTLLang(e)?"rtl":"ltr"}}t.AbstractHistoryComponent=u,u.defaults={settingEnabled:!0,maxItems:10}},function(e,t,s){"use strict";t.__esModule=!0,t.getAvailablePlayers=function(e,t){const s=e.FORCE_UNIPROXY,r=!s,a=[];!s&&i.TTSNativePlayer.isAvailable()&&a.push(new i.TTSNativePlayer({rate:e.TTS_RATE,maxTextLength:e.MAX_NATIVE_TTS_LENGTH}));o.TTSUniproxyPlayer.isAvailable()&&a.push(new o.TTSUniproxyPlayer({uniproxy:t,maxTextLength:e.MAX_UNIPROXY_TTS_LENGTH}));n.TTSOnlinePlayer.backendSupportedFormats.find(({format:t,quality:s})=>!(!r||!n.TTSOnlinePlayer.isAvailable(t))&&(a.push(new n.TTSOnlinePlayer({speakerUrl:e.TTS_URL,speakerLangs:e.TTS_LANGS,maxTextLength:e.MAX_TTS_LENGTH,params:{format:t,quality:s,chunked:0,platform:"web","mock-ranges":1,application:"translate"}})),!0)),!1;return a},t.isScreenNarrow=function(e){return window.innerWidth<e.NARROW_SCREEN_WIDTH};var i=s(239),n=s(240),o=s(241)},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractStream=void 0;var i=s(243);t.AbstractStream=class{constructor({onBufferReady:e}){this.pendingBuffer=null,this.index=-1,this.finished=!1,this.breaked=!1,this.preloadBufferSize=void 0,this.bufferSize=void 0,this.onBufferReady=e}add(e){}getChunk(e){}createBuffer(e=0){this.index++,this.pendingBuffer=new i.PackageBuffer(Math.max(e,0===this.index?this.preloadBufferSize:this.bufferSize))}insert(e,t){const s=t?t.byteLength:0,i=e.byteLength+s;this.pendingBuffer||this.createBuffer(i),this.pendingBuffer&&(this.pendingBuffer.add(e,t)||(this.ready(),this.createBuffer(i),this.pendingBuffer.add(e,t)))}finish(){this.finished=!0,this.ready()}break(){this.breaked=!0,this.pendingBuffer=null}ready(){this.pendingBuffer?(this.onBufferReady(this.getChunk(this.pendingBuffer.relax()),this.index),this.pendingBuffer=null):this.onBufferReady(void 0,this.index)}}},function(e,t,s){"use strict";t.__esModule=!0,t.TranslitModel=void 0;var i=s(9),n=s(28),o=s(69),r=s(19),a=s(251);class l extends o.SyncModel{getData(){const{lang:e,text:t}=this.getProps();return{lang:e,text:t}}getParams(){const{sid:e,srv:t}=this.getProps();return{sid:e,srv:t}}getDefaults(){return{sid:"",srv:"",url:"/",lang:"",text:"",translit:""}}validateResponse(e){return e&&"string"==typeof e.body&&e.body}runRequest(){const e=new r.HTTPRequest(this.getProperty("url"));if(this.abort(),!this.isValid())return this;const t=this.getData();return this.setRequest(e.setType(r.HTTPRequest.types.FORM).setData(t).setParams(this.getParams()).setMethod(r.HTTPRequest.methods.POST).send((e,t)=>{const s=e&&e.code===n.HTTPError.ABORT;!(t&&t.code===r.HTTPRequest.codes.OK)||s||this.validateResponse(t)||(0,i.logError)(new a.TranslitApiError),e&&this.emit("error",e),this.setProperty("translit",e?"":t.body)}))}requestTranslit(){return this.getSid().then(()=>this.runRequest()),this}}t.TranslitModel=l},function(e,t,s){"use strict";t.__esModule=!0,t.TranslitPresenter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(17);class r extends o.Presenter{constructor(e={}){super(e);const t=this,s=this.getView();this.getModel().on("error",(function(e){t.emit("error",e)})).on("change",(function(e,i){switch(e){case"lang":case"text":t.requestTranslit();break;case"translit":t.emit("result",i),s.setVisible(i).setContent(i,{asText:!0})}})).on("invalid",(function(){this.setProperty("translit","")})),this.requestTranslit=n.default.debounce(this.requestTranslit,e.debounceDelay||200)}setLang(e){return this.getModel().setProperty("lang",e),this}setText(e){return this.getModel().setProperty("text",e),this}requestTranslit(){return this.getModel().requestTranslit(),this}}t.TranslitPresenter=r},function(e,t,s){"use strict";t.__esModule=!0,t.Suggestions=t.SUGGESTIONS_TYPES=t.SUGGESTIONS_METRIKAS=t.SUGGESTIONS_EVENTS=t.SUGGESTIONS_APPLYING_SOURCES=void 0;var i=s(6),n=s(15),o=s(3);const r={APPLY:"apply",ITEMS_UPDATED:"itemsUpdated"};t.SUGGESTIONS_EVENTS=r;const a={SHOW:"show",APPLY:"apply",ITEM_HOVER:"itemHover",ITEM_NAVIGATE:"itemNavigate"};t.SUGGESTIONS_METRIKAS=a;const l={SUGGEST:"suggest",PREDICT:"predict"};t.SUGGESTIONS_TYPES=l;const c={CLICK:"click",ENTER:"enter",TAB:"tab"};t.SUGGESTIONS_APPLYING_SOURCES=c;const{$track:d}=(0,o.getTrackerByNamespace)(a);class u extends i.Component{constructor(e,t){super(e,t);const{model:s}=e,i=["predictions","suggestions"];s.onChange(i,(e,t)=>{this.resetActiveIndex(),this.setProperty(e,t?t.predictions.filter(t=>"suggestions"!==e||!this.hasPrediction(t.src)):[])}),this.onChange(e=>{this.updateAsync({field:e})}).onRendered(({field:e})=>{i.includes(e)&&this.emit(r.ITEMS_UPDATED)}).onStateChanged([n.VIEW_STATES.HIDDEN,n.VIEW_STATES.DISABLED],()=>{this.isVisible()&&this.isEnabled()&&d(a.SHOW,this.getTrackingParams())})}hasPrediction(e){return this.getProperty("predictions").some(({src:t})=>t.toLowerCase()===e.toLowerCase())}getTrackingParams(){const{model:e}=this.getProps();return{lang:e.getLangPair()}}getActiveIndex(){return this.getProperty("activeIndex")}getTypeByIndex(e){const{suggestions:t,predictions:s}=this.getProps();return e<s.length?l.PREDICT:e<t.length+s.length?l.SUGGEST:null}applyItem(e,t,{index:s,source:i}){return d(a.APPLY,{...this.getTrackingParams(),len:e.src.length,type:t,index:s,source:i}),this.emit(r.APPLY,e,t)}applySuggest(e,t){return this.applyItem(e,l.SUGGEST,t)}applyPredict(e,t){return this.applyItem(e,l.PREDICT,t)}applyActiveItem(e){const{suggestions:t,predictions:s,activeIndex:i}=this.getProps();if(i<s.length)this.applyPredict(s[i],{source:e,index:i});else if(i<t.length+s.length){const n=i-s.length;this.applySuggest(t[n],{source:e,index:n})}return this}updateActiveIndex(e){if(!this.isEnabled())return;const{suggestions:t,predictions:s,activeIndex:i}=this.getProps(),n=t.length+s.length;let o=i+e;o<0?o=n-1:o>=n&&(o=0);const r=this.getTypeByIndex(o),c=r===l.PREDICT?o:o-s.length;return d(a.ITEM_NAVIGATE,{...this.getTrackingParams(),index:c,type:r}),this.setActiveIndex(o)}setActiveIndex(e){return this.setProperty({activeIndex:e})}resetActiveIndex(){return this.setActiveIndex(0)}handlePosition(e,t=!1){return this.setPosition(e,t)}onHoverPredict(e){if(this.getActiveIndex()!==e)return d(a.ITEM_HOVER,{...this.getTrackingParams(),index:e,type:l.PREDICT}),this.setActiveIndex(e)}onHoverSuggest(e,t){if(this.getActiveIndex()!==e+t)return d(a.ITEM_HOVER,{...this.getTrackingParams(),index:e,type:l.PREDICT}),this.setActiveIndex(e+t)}onClickPredict(e){const{predictions:t}=this.getProps();return this.applyPredict(t[e],{index:e,source:c.CLICK})}onClickSuggest(e){const{suggestions:t}=this.getProps();return this.applySuggest(t[e],{index:e,source:c.CLICK})}template({html:e,nothing:t,cn:s}){const{suggestions:i,predictions:n,activeIndex:o,model:r}=this.getProps(),{srcLang:a,dstLang:l}=r.getProps(),c=n.length&&i.length&&!r.arePosesEqual(),d=1===n.length&&!i.length,u=s("suggestions-item"),h=s("suggestions-wrapper");return e`
            <div class=${h({no_predict_prefix:!c,single_predict:d})}>
                ${n.map(({src:t,dst:s},i)=>e`
                    <div class=${u({predict:!0,active:i===o,no_dst:!s})}
                        @mouseover=${()=>this.onHoverPredict(i)}
                        @click=${()=>this.onClickPredict(i)}>
                        <div class=${u("value")} lang=${a}>${t}</div>
                        ${s&&e`<div class=${u("translation")} lang=${l}>${s}</div>`}
                    </div>
                `)}
                ${i.length&&n.length?e`
                    <div class="suggestions-divider"></div>
                `:t}
                ${i.map(({src:t,dst:s},i)=>e`
                    <div class=${u({suggest:!0,active:i+n.length===o})}
                        @mouseover=${()=>this.onHoverSuggest(i,n.length)}
                        @click=${()=>this.onClickSuggest(i)}>
                        <div class=${u("value")} lang=${a}>${t}</div>
                        ${s&&e`<div class=${u("translation")} lang=${l}>${s}</div>`}
                    </div>
                `)}
            </div>
        `}}t.Suggestions=u,u.defaults={suggestions:[],predictions:[],activeIndex:0}},function(e,t,s){"use strict";t.__esModule=!0,t.History=void 0;var i=s(16),n=s(185);t.HISTORY_EVENTS=n.HISTORY_EVENTS,t.HISTORY_METRIKAS=n.HISTORY_METRIKAS;class o extends n.AbstractHistoryComponent{getItems(){const{storageModel:e,maxItems:t}=this.getProps();return e.getRecords().slice(0,t)}template({html:e,cn:t}){const s=window.config.LOCALIZATIONS,n=t("history_records"),o=t("history_records-item");return e`
            <div class=${n("title")}
                 @click=${()=>this.openHistoryCollection("button")}
                 aria-label=${s.historyButton}
                 role="button"
                 tabindex="0"
                 data-default-enter-action="true"
            >
                ${s.historyTitle}
                ${(0,i.icn)("arrow-right",16)}
            </div>
            <div class=${n("container")}>
                <div class=${n("items_container")}>
                    ${this.getItems().map((t,s)=>e`
                        <div
                            class=${o()}
                            @click=${()=>this.applyItem(t,s)}
                            tabindex="0"
                            data-default-enter-action="true"
                        >
                            <div class=${o("text")}
                                dir=${this.getLangDir(t.srcLang)}
                                lang=${t.srcLang}
                                title=${t.text}>
                                ${t.text}
                            </div>
                            <div class=${o("translation")}
                                dir=${this.getLangDir(t.dstLang)}
                                lang=${t.dstLang}
                                title=${t.translation}>
                                ${t.translation}
                            </div>
                        </div>
                    `)}
                    <div class=${o({type:"history_button"})}
                        @click=${()=>this.openHistoryCollection("button")}
                        data-tooltip=${s.historyButton}
                        data-tooltip-position="top"
                        tabindex="0"
                        data-default-enter-action="true"
                    >
                        ${(0,i.icn)("history",24)}
                    </div>
                </div>
            </div>
        `}}t.History=o,o.defaults={settingEnabled:!0,maxItems:5}},function(e,t,s){"use strict";t.__esModule=!0,t.initTTSPlayer=t.TTS_APP_EVENTS=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(181),r=s(140),a=s(2),l=s(4),c=s(3),d=s(45),u=s(186);const h={SPEAKER_ACTION:"speakerAction"};t.TTS_APP_EVENTS=h;t.initTTSPlayer=function(e){const t=this,s=this.getView(),i=this.getModel(),p=this.toJSON(),g=new a.TouchView({element:e.ELEMENTS.textSpeaker,stopDefaultAction:!0}),m=new a.TouchView({element:e.ELEMENTS.translatorSpeaker,stopDefaultAction:!0}),E=new o.TTSPresenter({view:g,model:new l.Model}),_=new o.TTSPresenter({view:m,model:new l.Model}),T=()=>{E.stop(),_.stop()};[E,_].forEach(t=>{(0,u.getAvailablePlayers)(e,this._uniproxy).forEach(e=>{t.addPlayer(e)})}),this.on("visibilityChange",(function(e){e&&T()})).on("dialogTap",T).bindFocusActivation(g).bindFocusActivation(m),i.on("change",(function(e,t){switch(e){case"text":E.setText(t);break;case"srcLang":E.setLanguage(t);break;case"dstLang":_.setLanguage(t);break;case"translation":case"userTranslation":_.setText(t)}})),s.on("stateChanged:listening",e=>{e&&T()});const f=n.default.throttle((e,t)=>{c.$tracker.sendMetric(E?"tts_stop_src":"tts_stop_dst",{type:t?"manual":"auto"})},200);E.on("actionStarted",(function(e){switch(e.action){case r.PLAYER_ACTIONS.LOAD:_.stop();break;case r.PLAYER_ACTIONS.PLAY:case r.PLAYER_ACTIONS.ERROR:t.emit(h.SPEAKER_ACTION,e);break;case r.PLAYER_ACTIONS.STOP:f(E,e.manual)}})).on("toggleValid",(function(e){g.setEnabled(e)})),_.on("actionStarted",(function(e){switch(e.action){case r.PLAYER_ACTIONS.LOAD:E.stop(),s.setState("listening",!1);break;case r.PLAYER_ACTIONS.PLAY:case r.PLAYER_ACTIONS.ERROR:t.emit(h.SPEAKER_ACTION,e);break;case r.PLAYER_ACTIONS.STOP:f(_,e.manual)}})).on("toggleValid",(function(e){m.setEnabled(e)}));const S=t=>{t.getModel().onChange("state",s=>{s===r.PLAYER_STATES.OK?t.getView().setTooltipText(e.LOCALIZATIONS.ttsValidState):s===r.PLAYER_STATES.LANG_NOT_SUPPORTED?t.getView().setTooltipText(e.LOCALIZATIONS.ttsInvalidLangState):s!==r.PLAYER_STATES.TEXT_SIZE_EXCEEDED&&s!==r.PLAYER_STATES.TEXT_NOT_SUPPORTED||t.getView().setTooltipText(e.LOCALIZATIONS.ttsInvalidTextSizeState)})};S(E),S(_);const C=()=>{g.setTooltipPosition(document.body.clientWidth<1400?"top-right":"top")};return this.on("resize",n.default.throttle(C,500)),C(),this.addHotKey(d.HOT_KEYS_MAP.SRC_TTS,{view:g,getActionName:()=>"src_tts"}).addHotKey(d.HOT_KEYS_MAP.DST_TTS,{view:m,getActionName:()=>"dst_tts"}),p.text&&E.setText(p.text),p.srcLang&&E.setLanguage(p.srcLang),p.dstLang&&_.setLanguage(p.dstLang),p.translation&&_.setText(p.translation),this}},function(e,t,s){"use strict";t.__esModule=!0,t.getDefinitionAndAbbreviationsInfo=function({definition:e,abbreviations:t}){const s=Boolean(e),i=n.default.isNonEmptyArray(t);return{hasDefinition:s,hasAbbreviations:i,hasDefinitionOrAbbreviations:s||i}};var i,n=(i=s(0))&&i.__esModule?i:{default:i}},,,,,,,,function(e,t,s){"use strict";s(73);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(71),r=s(2),a=s(4),l=s(166),c=s(167),d=s(43),u=s(204),h=s(106),p=s(125),g=s(128),m=s(129),E=s(206),_=s(207),T=s(208),f=s(271),S=s(272),C=s(273),y=s(276),A=s(281),v=s(286),L=s(290),R=s(294),P=s(299),O=s(300),I=s(302),b=s(304),x=s(305),N=s(310),M=s(320),w=s(323),D=s(324),V=s(325),k=s(326);window.initTextApp=e=>{(0,o.rumSendTimeMark)(o.RUM_COUNTERS.APP_INIT_START),(0,o.rumTimeStart)(o.RUM_COUNTERS.APP_INIT_DURATION),function(e){!function(t,s,i,n){const o=i(46),r=i.apply(void 0,[83,73,68]);e[r]=e[r].split(o).map((function(e){return e.split("").reverse().join("")})).join(o)}(0,0,String.fromCharCode)}(e);const t=document.body.getAttribute("data-lang").split("-");e.DEFAULT_TEXT=document.body.getAttribute("data-text"),e.DEFAULT_SRC_LANG=t[0]||"",e.DEFAULT_DST_LANG=t[1]||"",e.TEMPLATES=(0,V.getTextTemplates)(),e.ELEMENTS=(0,k.getTextElements)();const s=new T.TextTranslateApplication({config:e,view:new r.TouchView({element:document.documentElement,ignoreSelection:!0,DOMEvents:`keydown keypress ${r.TouchView.eventTypes.MOVE} copy`}),model:new a.Model({text:"",trText:"",selText:"",srcLang:"",dstLang:"",tooltip:"",complaint:!1,timestamp:Date.now(),textScrollY:0,translation:"",spellerData:"",sourceTranslit:"",targetTranslit:"",userTranslation:"",translationScrollY:0,leadSpacingsCount:0},{validators:{srcLang:t=>n.default.hasProperty(e.TRANSLATOR_LANGS,t),dstLang:t=>n.default.hasProperty(e.TRANSLATOR_LANGS,t)}})});s.initMetrikas(e).initSelectionPopup(e).initToast(e).initUrlView(e).initCopying(e).initResizer(e).initKeyboard(e).initAlignment(e).initTranslator(e).initTextCounter(e).initShareButton(e).initExternalView(e).initAlternatives(e).initTargetTranslit(e).initComplaintPopup(e).initTranslationVote(e).initTextArea(e).initPredictor(e);const i=e.ENABLE_MINI_NAV?O.RelatedContentWithMiniNavModule:P.RelatedContentModule;s.registerModule(f.TooltipModule).registerModule(p.UserMenuModule).registerModule(h.DesktopLanguagesModule).registerModule(b.FileDropModule).registerModule(i).registerModule(S.HistoryModule).registerModule(I.IdiomDefinitionModule).registerModule(C.CardsCarouselModule).registerModule(y.DictionaryModule).registerModule(R.RelatedWordsModule).registerModule(v.DefinitionModule).registerModule(L.DeclensionsModule).registerModule(A.ExamplesModule).registerModule(g.AccessibilityModule).registerModule(u.SeoModule).registerModule(N.SpellerModule).registerModule(E.DynamicTitleModule).registerModule(_.TypingSpeedModule).registerModule(w.BlocksVisibilityModule),e.ENABLE_FEEDBACK&&s.registerModule(M.FeedbackModule),s.initUniproxy(e).initTTSPlayer(e).initSpeechRecognition(e),e.USE_FAKEAREA&&s.initSourceTranslit(e),e.ENABLE_STORIES&&s.registerModule(x.StoriesModule),e.ENABLE_COLLECTION&&(e.SUBSCRIPTION_MENU_ITEMS=n.default.extend(e.SUBSCRIPTION_MENU_ITEMS,{subscribe:{icon:"add",title:e.LOCALIZATIONS.collectionSubscribe,action:"subscribe"}})),e.ENABLE_SCROLLING_HEADER&&s.registerModule(D.ScrollHeaderModule),e.LANDING_TYPE?e.LANDING_TYPE===d.LANDING_TYPES.TRANSLATOR?(e.SERVICE_DESCRIPTION=!0,e.CLCK_PATH="web_desktop.landing.translate",T.TextTranslateApplication.isHistoryAvailable()&&(e.DEFAULT_TEXT||window.history.state||window.history.replaceState({},""),s.initHistory(e)),s.initDescription(e)):e.LANDING_TYPE===d.LANDING_TYPES.DICTIONARY&&(e.DICT_PAGE_DESCRIPTION=!0,e.CLCK_PATH="web_desktop.landing.dict",T.TextTranslateApplication.isHistoryAvailable()&&(window.history.replaceState({trText:e.DEFAULT_TEXT,srcLang:e.DEFAULT_SRC_LANG,dstLang:e.DEFAULT_DST_LANG},""),s.getModel().once("change:translation",(function(){s.initHistory(e)}))),s.initDescriptionDict(e)):(T.TextTranslateApplication.isHistoryAvailable()&&(e.DEFAULT_TEXT||window.history.state||window.history.replaceState({},""),s.initHistory(e)),s.initDescription(e)),e.ENABLE_LANG_SWITCHERS&&s.registerModule(m.LangSwitcherModule),l.Database.isSupported()&&(c.CollectionModel.generateColorRules(document.getElementById("collectionColors"),"clts .collection-color"),s.initCollections(e)),s.emit(d.TRANSLATE_APP_EVENTS.INIT_DONE),(0,o.rumTimeEnd)(o.RUM_COUNTERS.APP_INIT_DURATION)}},function(e,t,s){"use strict";t.__esModule=!0,t.KeyGenerator=void 0;class i{static getRadix(){return this._CHARS.length}static getCharAt(e){return this._CHARS.charAt(e)}static generateRandomStr(e){let t="";const s=this.getRadix();for(;t.length<e;)t+=this.getCharAt(Math.floor(Math.random()*s));return t}static convertInt(e){let t=e,s="";const i=this.getRadix();do{s=this.getCharAt(t%i)+s,t=Math.floor(t/i)}while(t>0);return s}constructor(e,t){const s=this.constructor;this._maxLength=e||s.DEFAULT_LENGTH,this._maxCounterDigits=t||s.DEFAULT_COUNTER_DIGITS,this._counter=this._generateCounter()}generate(){const e=this.constructor;let t=e.convertInt(Date.now())+e.convertInt(this._counter);return this._incrementCounter(),t+=e.generateRandomStr(this._maxLength-t.length),t}_getCounterLimit(){return Math.pow(this.constructor.getRadix(),this._maxCounterDigits)}_generateCounter(){return Math.floor(Math.random()*this._getCounterLimit())}_incrementCounter(){this._counter=(this._counter+1)%this._getCounterLimit()}}t.KeyGenerator=i,i._CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i.DEFAULT_COUNTER_DIGITS=2,i.DEFAULT_LENGTH=14},function(e,t,s){"use strict";t.__esModule=!0,t.DB_STORES=t.DB_INDEXES=t.CollectionDatabase=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(9),r=s(166),a=s(149);const l={COLLECTIONS:"collections",RECORDS:"records"};t.DB_STORES=l;const c={BY_COLLECTION:"by_collection_id",BY_RECORD:"by_record",BY_RECORD_HASH:"by_record_hash",BY_DATE:"by_creation_date",BY_COLLECTION_AND_DATE:"by_collection_and_date",BY_COLLECTION_AND_DATE_KEY:"by_collection_and_date_key"};t.DB_INDEXES=c;class d extends r.Database{static sameRecordData(e,t){return e.text===t.text&&e.lang===t.lang&&e.translation===t.translation}static getTextHash(e){let t,s=5381;const i=e.lang+e.text+e.translation,n=i.length;for(t=0;t<n;t++)s=33*s^i.charCodeAt(t);return(s>>>0).toString(16)}static getTextHashKey(e,t=e.collectionId){return this.getTextHash(e)+"::"+t}static getCreationTimeKey(e){let t=String(1e3*e.creationTimestamp);for(;t.length<13;)t="0"+t;return e.collectionId+"::"+t}constructor(e,t){super(e),this._migrateParams=t.migrateParams}prepareRecord(e,t){return e.id=e.id||this.generateKey(),e.collectionId=e.collectionId||t.id,e.creationTimestamp||(e.creationTimestamp=a.CollectionServerModel.getTimestamp()),e.creationTimeKey=d.getCreationTimeKey(e),e.modificationTimestamp=e.modificationTimestamp||e.creationTimestamp,t.type!==a.COLLECTION_TYPES.FAVORITES&&t.type!==a.COLLECTION_TYPES.COLLECTION||(e.textHashKey=d.getTextHashKey(e)),e}cloneRecord(e){return{text:e.text,lang:e.lang,score:e.score,status:a.COLLECTION_STATUSES.ADDED,translation:e.translation,creationTimestamp:e.creationTimestamp,modificationTimestamp:e.modificationTimestamp}}createDatabase(e){const t=e.target.result,s=t.createObjectStore(l.COLLECTIONS,{keyPath:"id"}),i=t.createObjectStore(l.RECORDS,{keyPath:"id"});s.createIndex(c.BY_DATE,"creationTimestamp",{unique:!1}),i.createIndex(c.BY_COLLECTION,"collectionId",{unique:!1}),i.createIndex(c.BY_RECORD_HASH,"textHashKey",{unique:!1}),i.createIndex(c.BY_COLLECTION_AND_DATE_KEY,"creationTimeKey",{unique:!1}),s.add(this.getFavoritesCollectionParams()),s.add(this.getHistoryCollectionParams())}upgradeDatabase(e){try{e.oldVersion<2&&this._upgradeDatabase2(e),e.oldVersion<5&&this._upgradeDatabase5(e)}catch(t){(0,o.logError)(t,{version:e.oldVersion})}}_upgradeDatabase2(e){const t=this,s={},i=e.target.transaction,n=i.objectStore(l.RECORDS),o=i.objectStore(l.COLLECTIONS);n.deleteIndex(c.BY_RECORD),n.deleteIndex(c.BY_COLLECTION_AND_DATE),n.createIndex(c.BY_RECORD_HASH,"textHashKey",{unique:!1}),n.createIndex(c.BY_COLLECTION_AND_DATE_KEY,"creationTimeKey",{unique:!1}),o.openCursor().onsuccess=function(e){const i=e.target.result;if(i){const e=i.value;s[e.id]=e,i.continue()}else n.openCursor().onsuccess=function(e){const i=e.target.result;if(i){const e=s[i.value.collectionId];e?i.update(t.prepareRecord(i.value,e)):i.delete(),i.continue()}else t.addTrace("migrFnsh")}}}_upgradeDatabase5(e){const t=e.target.transaction,s=t.objectStore(l.RECORDS),i=t.objectStore(l.COLLECTIONS),n=(t,s,i)=>{t.indexNames.contains(s)||(this.emit("indexNotFound",{indexName:s,version:e.oldVersion}),t.createIndex(s,i,{unique:!1}))};n(s,c.BY_RECORD_HASH,"textHashKey"),n(s,c.BY_COLLECTION,"collectionId"),n(s,c.BY_COLLECTION_AND_DATE_KEY,"creationTimeKey"),n(i,c.BY_DATE,"creationTimestamp")}getFavoritesCollectionParams(){const e=this._migrateParams;return{id:this.generateKey(),attributesTimestamp:a.CollectionServerModel.getTimestamp(),creationTimestamp:0,type:a.COLLECTION_TYPES.FAVORITES,name:e.defaultFavName,public:!1,status:a.COLLECTION_STATUSES.ADDED,version:0,recordsCount:0}}getHistoryCollectionParams(){const e=this._migrateParams;return{id:this.generateKey(),attributesTimestamp:a.CollectionServerModel.getTimestamp(),creationTimestamp:0,type:a.COLLECTION_TYPES.HISTORY,name:e.defaultHistoryName,public:!1,status:a.COLLECTION_STATUSES.ADDED,version:0,recordsCount:0}}createHistoryCollection(){this.createCollection(this.getHistoryCollectionParams(),{subscribe:!1})}createCollection(e,t={}){const s=this._db.transaction(l.COLLECTIONS,"readwrite"),i=s.objectStore(l.COLLECTIONS);e.id=this.generateKey(),s.oncomplete=()=>{t.silent||this.emit("added",e,t)},s.onerror=e=>{this.emit("error",e,"createCollection")},i.add(e)}getCollections(e={}){const t=this.safeTransaction(l.COLLECTIONS);if(!t)return this.waitReconnect(()=>this.getCollections(e));const s=this,i=[],n=window.IDBKeyRange.bound(0,Number.MAX_VALUE);t.objectStore(l.COLLECTIONS).index(c.BY_DATE).openCursor(n).onsuccess=function(t){const s=t.target.result;s&&((e.sync||s.value.status!==a.COLLECTION_STATUSES.DELETED)&&i.push(s.value),s.continue())},t.oncomplete=function(){s.emit("collections",i,e)},t.onerror=function(e){s.emit("error",e,"getCollections")}}checkRecord(e){try{this.checkRecordUnsafe(e)}catch(e){this.emit("checkRecordError",e)}}checkRecordUnsafe(e){const t=this.safeTransaction(l.RECORDS);if(!t)return this.waitReconnect(()=>this.checkRecordUnsafe(e));let s;const i=this,n=d.getTextHashKey(e),o=window.IDBKeyRange.only(n);t.objectStore(l.RECORDS).index(c.BY_RECORD_HASH).openCursor(o).onsuccess=function(t){const i=t.target.result;if(i){const t=i.value;!s&&t.status!==a.COLLECTION_STATUSES.DELETED&&d.sameRecordData(t,e)&&(s=!0),i.continue()}},t.oncomplete=function(){i.emit("checked",s)},t.onerror=function(e){i.emit("error",e,"checkRecordUnsafe")}}getRecordsByCollection(e,t={}){if(!e)return;const s=this.safeTransaction(l.RECORDS);if(!s)return this.waitReconnect(()=>this.getRecordsByCollection(e,t));const i=[],n=e+d.INDEX_BEGIN,o=e+d.INDEX_END,r=window.IDBKeyRange.bound(n,o);s.objectStore(l.RECORDS).index(c.BY_COLLECTION_AND_DATE_KEY).openCursor(r,"prev").onsuccess=function(e){const s=e.target.result;s&&((t.sync||s.value.status!==a.COLLECTION_STATUSES.DELETED)&&i.push(s.value),s.continue())},s.oncomplete=()=>{this.emit("records",i,e,t)},s.onerror=e=>{this.emit("error",e,"getRecordsByCollection")}}addRecords(e,t){const s=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!s)return this.waitReconnect(()=>this.addRecords(e,t));let i=0;const n=this,o=t.id,r=s.objectStore(l.RECORDS),u=s.objectStore(l.COLLECTIONS),h=r.index(c.BY_RECORD_HASH);s.oncomplete=function(){n.emit("addedRecords",o)},s.onerror=function(e){n.emit("error",e,"addRecords")},e.forEach((function(e,s,l){const c=l.length;let p;const g=d.getTextHashKey(e),m=window.IDBKeyRange.only(g);h.openCursor(m).onsuccess=function(l){const h=l.target.result;h?(!p&&d.sameRecordData(h.value,e)&&(p=h.value),h.continue()):(p?p.status===a.COLLECTION_STATUSES.DELETED&&(p.score=0,p.status=a.COLLECTION_STATUSES.UPDATED,p.modificationTimestamp=e.modificationTimestamp,r.put(p),i++):(r.add(n.prepareRecord(e,t)),i++),s===c-1&&(u.get(o).onsuccess=function(e){const t=e.target.result;t&&(t.status=a.COLLECTION_STATUSES.UPDATED,t.recordsCount=(t.recordsCount||0)+i,u.put(t))}))}}))}addCollection(e,t){const s=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!s)return this.waitReconnect(()=>this.addCollection(e,t));const i=this,n=s.objectStore(l.RECORDS);e.id=this.generateKey(),e.recordsCount=t.new.length,s.objectStore(l.COLLECTIONS).add(e).onsuccess=function(){t.new.forEach((function(t){n.add(i.prepareRecord(t,e))}))},s.oncomplete=function(){i.emit("synced")},s.onerror=function(e){i.emit("error",e,"addCollection")}}updateCollection(e,t){const s=this.safeTransaction(l.RECORDS,"readwrite");if(!s)return this.waitReconnect(()=>this.updateCollection(e,t));let i=0;const n=this._db,o=this,r=s.objectStore(l.RECORDS);t.deleted.forEach((function(e){r.get(e.id).onsuccess=function(t){const s=t.target.result;s&&s.status!==a.COLLECTION_STATUSES.DELETED&&i++,r.delete(e.id)}})),s.oncomplete=function(){const s=n.transaction(n.objectStoreNames,"readwrite"),r=s.objectStore(l.RECORDS),a=s.objectStore(l.COLLECTIONS);a.get(e.id).onsuccess=function(s){const n=s.target.result;t.new.forEach((function(t){r.add(o.prepareRecord(t,e))})),t.updated.forEach((function(e){r.get(e.id).onsuccess=function(t){const s=t.target.result;Object.keys(e.params).forEach((function(t){s[t]=e.params[t]})),r.put(s)}})),Object.keys(e).forEach((function(t){n[t]!==e[t]&&(n[t]=e[t])}));const l=(n.recordsCount||0)+t.new.length-i;n.recordsCount=l<0?0:l,a.put(n)},s.oncomplete=function(){o.emit("synced")},s.onerror=function(e){o.emit("error",e,"updateCollectionAdd")}},s.onerror=function(e){o.emit("error",e,"updateCollection")}}updateCollectionData(e,t){const s=this.safeTransaction(l.COLLECTIONS,"readwrite");if(!s)return this.waitReconnect(()=>this.updateCollectionData(e,t));const i=this,n=s.objectStore(l.COLLECTIONS);n.get(e).onsuccess=function(e){const s=e.target.result;Object.keys(t).forEach((function(e){s[e]=t[e]})),n.put(s)},s.oncomplete=function(){i.emit("collectionUpdated")},s.onerror=function(e){i.emit("error",e,"updateItem")}}deleteCollection(e,t){const s=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!s)return this.waitReconnect(()=>this.deleteCollection(e,t));const i=this,n=s.objectStore(l.RECORDS),o=s.objectStore(l.COLLECTIONS),r=window.IDBKeyRange.only(e),d=n.index(c.BY_COLLECTION);let u=!1;o.get(e).onsuccess=function(s){const i=s.target.result;t||!i.serverId?o.delete(e):(i.status=a.COLLECTION_STATUSES.DELETED,o.put(i)),u=i.type===a.COLLECTION_TYPES.SUBSCRIPTION},d.openCursor(r).onsuccess=function(e){const t=e.target.result;t&&(t.delete(),t.continue())},s.oncomplete=function(){i.emit("collectionDeleted",{unsubscribed:u})},s.onerror=function(e){i.emit("error",e,"deleteCollection")}}updateRecord(e,t){const s=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!s)return this.waitReconnect(()=>this.updateRecord(e,t));const i=this,n=s.objectStore(l.RECORDS);let o;n.get(e).onsuccess=function(e){const i=e.target.result,r=s.objectStore(l.COLLECTIONS),c=i.score+t.score;i.score=c<0?0:c,i.status=a.COLLECTION_STATUSES.UPDATED,i.modificationTimestamp=t.modificationTimestamp,n.put(i),o=i.collectionId,r.get(i.collectionId).onsuccess=function(e){const t=e.target.result;t&&(t.status=a.COLLECTION_STATUSES.UPDATED,r.put(t))}},s.oncomplete=function(){i.emit("recordUpdated",o)},s.onerror=function(e){i.emit("error",e,"updateRecord")}}updateHistoryRecord(e,t){const s=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!s)return this.waitReconnect(()=>this.updateHistoryRecord(e,t));const i=s.objectStore(l.RECORDS),n=s.objectStore(l.COLLECTIONS),o=i.index(c.BY_COLLECTION),r=window.IDBKeyRange.only(e),u=t.srcLang+"-"+t.dstLang;n.get(e).onsuccess=e=>{const t=e.target.result;t&&(t.status=a.COLLECTION_STATUSES.UPDATED,n.put(t))},o.openCursor(r).onsuccess=e=>{const s=e.target.result;if(s){const e=s.value;e.translation===t.translation&&e.text===t.text&&e.lang===u&&(e.creationTimestamp=a.CollectionServerModel.getTimestamp(),e.modificationTimestamp=a.CollectionServerModel.getTimestamp(),e.creationTimeKey=d.getCreationTimeKey(e),e.status=a.COLLECTION_STATUSES.UPDATED,s.update(e)),s.continue()}},s.oncomplete=()=>{this.emit("recordUpdated",e)},s.onerror=e=>{this.emit("error",e,"updateHistoryRecord")}}deleteRecordByProps(e,t){const s=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!s)return this.waitReconnect(()=>this.deleteRecordByProps(e,t));const i=s.objectStore(l.RECORDS),n=s.objectStore(l.COLLECTIONS),o=i.index(c.BY_COLLECTION),r=window.IDBKeyRange.only(e),d=t.lang||t.srcLang+"-"+t.dstLang;n.get(e).onsuccess=e=>{const t=e.target.result;t&&(t.recordsCount--,t.status=a.COLLECTION_STATUSES.UPDATED,n.put(t))},o.openCursor(r).onsuccess=e=>{const s=e.target.result;if(!s)return;const n=s.value;n.translation===t.translation&&n.text===t.text&&n.lang===d&&(n.serverId?(n.status=a.COLLECTION_STATUSES.DELETED,s.update(n)):i.delete(s.primaryKey)),s.continue()},s.oncomplete=()=>{this.emit("recordDeleted",e)},s.onerror=e=>{this.emit("error",e,"deleteHistoryRecord")}}resetRecordsScore(e){const t=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!t)return this.waitReconnect(()=>this.resetRecordsScore(e));const s=this,i=[],n=t.objectStore(l.RECORDS),o=t.objectStore(l.COLLECTIONS),r=n.index(c.BY_COLLECTION),d=window.IDBKeyRange.only(e);o.get(e).onsuccess=function(e){const t=e.target.result;t.status=a.COLLECTION_STATUSES.UPDATED,o.put(t)},r.openCursor(d).onsuccess=function(e){const t=e.target.result;t&&(t.value.score=0,t.value.status=a.COLLECTION_STATUSES.UPDATED,t.value.modificationTimestamp=a.CollectionServerModel.getTimestamp(),t.update(t.value),i.push(t.value),t.continue())},t.oncomplete=function(){s.emit("resetedScore",i)},t.onerror=function(e){s.emit("error",e,"resetRecordsScore")}}moveRecord(e,t){const s=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!s)return this.waitReconnect(()=>this.moveRecord(e,t));const i=this,n=t.id,o=s.objectStore(l.RECORDS),r=s.objectStore(l.COLLECTIONS),u=o.index(c.BY_RECORD_HASH),h=d.getTextHashKey(e,n),p=window.IDBKeyRange.only(h),g=function(e,t){let s=e.recordsCount||0;s=t?s+1:s-1,e.status=a.COLLECTION_STATUSES.UPDATED,e.recordsCount=s<0?0:s,r.put(e)};let m,E;const _=e.collectionId;u.openCursor(p).onsuccess=function(s){const l=s.target.result;l?(!m&&d.sameRecordData(l.value,e)&&(m=l.value),l.continue()):(m?m.status===a.COLLECTION_STATUSES.DELETED&&(m.status=a.COLLECTION_STATUSES.UNCHANGED,o.put(m),r.get(n).onsuccess=function(e){g(e.target.result,!0)}):(E=i.prepareRecord(i.cloneRecord(e),t),o.add(E),r.get(n).onsuccess=function(e){g(e.target.result,!0)}),e.serverId?(e.status=a.COLLECTION_STATUSES.DELETED,o.put(e)):o.delete(e.id),r.get(_).onsuccess=function(e){g(e.target.result)})},s.oncomplete=function(){i.emit("recordUpdated")},s.onerror=function(e){i.emit("error",e,"moveRecord")}}deleteRecords(e){const t=n.default.isArray(e)?e:[e];if(!t.length)return;const s=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!s)return this.waitReconnect(()=>this.deleteRecords(e));let i;const o=this,r=s.objectStore(l.RECORDS),d=s.objectStore(l.COLLECTIONS);r.index(c.BY_COLLECTION).openCursor().onsuccess=function(e){const s=e.target.result;if(s){if(-1!==t.indexOf(s.primaryKey)){const e=s.value;i=s.key,e.serverId?(e.status=a.COLLECTION_STATUSES.DELETED,s.update(e)):r.delete(s.primaryKey)}s.continue()}else i&&(d.get(i).onsuccess=function(e){const s=e.target.result,i=(s.recordsCount||0)-t.length;s.status=a.COLLECTION_STATUSES.UPDATED,s.recordsCount=i<0?0:i,d.put(s)})},s.oncomplete=function(){o.emit("recordDeleted",i)},s.onerror=function(e){o.emit("error",e,"deleteRecords")}}resetServerIds(){const e=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!e)return this.waitReconnect(()=>this.resetServerIds());const t=this,s=e.objectStore(l.RECORDS);e.objectStore(l.COLLECTIONS).openCursor().onsuccess=function(e){const t=e.target.result;if(t){const e=t.value;e.status===a.COLLECTION_STATUSES.DELETED?t.delete():e.serverId&&(e.status=a.COLLECTION_STATUSES.ADDED,delete e.serverId,t.update(e)),t.continue()}else s.openCursor().onsuccess=function(e){const t=e.target.result;let s;t&&(s=t.value,s.status===a.COLLECTION_STATUSES.DELETED?t.delete():s.serverId&&(s.status=a.COLLECTION_STATUSES.ADDED,delete s.serverId,t.update(s)),t.continue())}},e.oncomplete=function(){t.emit("resetedIds")},e.onerror=function(e){t.emit("error",e,"resetServerIds")}}}t.CollectionDatabase=d,d.INDEX_BEGIN="::",d.INDEX_END="::~",d.DATABASE_NAME="ytr_collections",d.DATABASE_VERSION=5},function(e,t,s){"use strict";t.__esModule=!0,t.SeoModule=t.LANDING_TEXT_PREFIX=t.LANDING_LANGS_PREFIX=t.APP_EVENTS=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(5),r=s(168);t.APP_EVENTS={};t.LANDING_TEXT_PREFIX="dictionary";t.LANDING_LANGS_PREFIX="translator";class a extends o.AppModule{constructor(e,t){super(e,t);const s=n.default.slice(document.querySelectorAll("link[rel=canonical], link[rel=alternate]"));this.links=s.map(e=>{const t=e.getAttribute("href");return{el:e,host:t.split("/").slice(0,3).join("/"),query:n.default.fromQueryString(t.split("?",2)[1])}}),this.updateSeoLinksAsync=this.debounceMethod(this.updateSeoLinks,200),this.appModel.onChange(["srcLang","dstLang","trText"],this.updateSeoLinksAsync.bind(this)),this.app.getRouter().on(r.ROUTER_EVENTS.HISTORY_UPDATED,this.updateSeoLinksAsync.bind(this))}getCanonicalPath(){const{pathname:e,search:t}=window.location,{srcLang:s,dstLang:i,trText:n}=this.appModel.getProps();return"/"===e?n&&n.length<=r.MAX_SHARE_TEXT_LENGTH?`/dictionary/${s}-${i}/${encodeURIComponent(n)}`:`/translator/${s}-${i}`:e+t}updateSeoLinks(){const e=this.getCanonicalPath();this.links.forEach(({el:t,host:s,query:{ui:i}})=>{let n=s+e;i&&!e.includes("?")&&(n+="?ui="+i),t.setAttribute("href",n)})}}t.SeoModule=a},function(e,t,s){"use strict";t.__esModule=!0,t.VIEW_IDS=t.UrlController=t.ACTIVE_VIEWS=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(4),r=s(169);const a=/\w+-\w+/,l={OCR:"ocr",TRANSLATE:"translate",COLLECTIONS:"collections"};t.VIEW_IDS=l;const c=[l.OCR,l.TRANSLATE,l.COLLECTIONS];t.ACTIVE_VIEWS=c;const d=e=>{if(!e&&!(e=>a.test(e))(e))return[];const t=e.split("-");return t[0]&&t[1]?t:[]};class u extends o.Model{constructor(e){super({},{}),this.locationObject=e}getRouteWithQueryString(){return this.getRoute()+this.getQueryString()}getQueryParams(e){const t=this.getQueryString();let s={};if(t.length>1){if(s=n.default.fromQueryString(t.slice(1)),!e)return s;const i=d(s.lang);if(i.length>0){const[e,t]=i;s.srcLang=e,s.dstLang=t}}return s}getRouteFromTranslationProps({queryParams:e={},srcLang:t,dstLang:s,trText:i}){const n={...e,...this.getQueryParams()};return t&&s&&(n.lang=`${t}-${s}`),i?n.text=i:delete n.text,"/"+this.buildQueryString(n)}getRoute(){return this.locationObject.pathname}getQueryString(){return this.locationObject.search}getPathArray(e=this.getRoute()){return e.split("/").slice(1)}hasQueryString(e){return-1!==e.indexOf("?")}getRouteFromViewName(e){return new r.RouteBuilder(e).build()}isCurrentRoute(e){return-1!==this.getRoute().indexOf(e)}isMainPageWithoutQueryParams(e){return"/"===e}getCollectionId(){return this.getPathArray()[1]}buildQueryString(e){return n.default.isEmpty(e)?"":"?"+n.default.toQueryString(e)}buildUrl(e,t){return n.default.isEmpty(t)||this.hasQueryString(e)?e:e+this.buildQueryString(t)}addQueryParamsToPathname(e,t){return this.isMainPageWithoutQueryParams(e)?this.getRouteFromTranslationProps(t):c.includes(this.getPathArray(e)[0])?this.buildUrl(e,t.queryParams):e}}t.UrlController=u},function(e,t,s){"use strict";t.__esModule=!0,t.DynamicTitleModule=void 0;var i=s(5);class n extends i.AppModule{constructor(e,t){super(e,t),this.titleChangeTimeout=null,this.listenAppModel()}listenAppModel(){const e=()=>{const e=this.makePageTitle();this.setPageTitle(e)};this.appModel.onChange("text",t=>{clearTimeout(this.titleChangeTimeout),t?this.titleChangeTimeout=setTimeout(e,5e3):e()})}makePageTitle(){const{text:e}=this.appModel.getProps();let t=e.split(/\s/).slice(0,5).join(" ");t.length>30&&(t=t.slice(0,30),t+="...");let s=this.appConfig.SERVICE_DESCRIPTION;return t&&(s=`${t}  ${this.appConfig.SERVICE_DESCRIPTION}`),s}setPageTitle(e){const t=document.querySelector("title");t&&(t.innerText=e)}}t.DynamicTitleModule=n},function(e,t,s){"use strict";t.__esModule=!0,t.TypingSpeedModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(5),r=s(3);const a="predictor",l="clearButton",c="input",d="cut";class u extends o.AppModule{constructor(e,t){super(e,t),this.timeout=null,this.hasPredicted=!1,this.hasSuggested=!1,this.startTimestamp=null,this.lastTimestamp=null,this.counters=this.getClearCounters(),this.listenAppModel()}getClearCounters(){return{duration:0,typed:0,suggested:0,predicted:0,cleared:0,clearedPredicts:0,clearedSuggests:0}}handleSuggest(e,t){"suggest"===t?this.counters.suggested+=Math.abs(e):this.counters.predicted+=Math.abs(e)}handleTyping(e){this.counters.typed+=Math.abs(e)}handleClearing(e){this.hasPredicted?this.counters.clearedPredicts+=1:this.hasSuggested&&(this.counters.clearedSuggests+=1),this.counters.cleared+=Math.abs(e)}listenAppModel(){this.appModel.onChange("text",(e,{reason:t,sender:s,suggestType:i,oldValue:o=""})=>{const r=n.default.trim(e),u=r.length-o.length,h=t===c,p=t===d,g=s===a,m=s===l;null!==this.timeout&&clearTimeout(this.timeout),m||(this.timeout=setTimeout(()=>{this.timeout=null,this.handleEnd()},3e3),u&&(h||g||p)&&(this.startTimestamp||(this.startTimestamp=n.default.now()),this.lastTimestamp=n.default.now(),u>0?g?this.handleSuggest(u,i):this.handleTyping(u):this.handleClearing(u),this.hasPredicted=g&&"suggest"!==i,this.hasSuggested=g&&"suggest"===i,u&&!r&&(this.lastTimestamp=n.default.now(),this.handleEnd())))})}handleEnd(){null!==this.timeout&&(clearTimeout(this.timeout),this.timeout=null);const{text:e}=this.appModel.getProps();if((!this.startTimestamp||!this.lastTimestamp)&&e)return void(this.counters=this.getClearCounters());const t=this.lastTimestamp-this.startTimestamp;this.startTimestamp=null,this.counters.duration=t,r.$tracker.sendMetric("typing_speed_report",{duration:this.counters.duration,typed:this.counters.typed,suggested:this.counters.suggested,predicted:this.counters.predicted,cleared:this.counters.cleared,cleared_predicts:this.counters.clearedPredicts,cleared_suggests:this.counters.clearedSuggests,src:e}),this.startTimestamp=null,this.counters=this.getClearCounters()}}t.TypingSpeedModule=u},function(e,t,s){"use strict";t.__esModule=!0,t.TextTranslateApplication=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(168),r=s(63),a=s(45),l=s(209),c=s(210),d=s(212),u=s(2),h=s(24),p=s(150),g=s(29),m=s(173),E=s(142),_=s(216),T=s(11),f=s(132),S=s(138),C=s(143),y=s(174),A=s(217),v=s(218),L=s(219),R=s(220),P=s(221),O=s(222),I=s(223),b=s(233),x=s(234),N=s(245),M=s(246),w=s(247),D=s(250),V=s(252),k=s(253),H=s(257),U=s(258),$=s(259),B=s(260),G=s(261),F=s(262),Y=s(263),W=s(161),K=s(264),X=s(192),j=s(265),q=s(266),z=s(268);class J extends a.DesktopTranslateApplication{constructor(e){super(e),this.initToast=n.default.bindInit(A.initToast),this.initUrlView=n.default.bindInit(v.initUrlView),this.initResizer=n.default.bindInit(L.initResizer),this.initHistory=n.default.bindInit(R.initHistory),this.initKeyboard=n.default.bindInit(P.initKeyboard),this.initSelectionPopup=n.default.bindInit(O.initSelectionPopup),this.initSpeechRecognition=n.default.bindInit(I.initSpeechRecognition),this.initPredictor=n.default.bindInit(b.initPredictor),this.initSuggestions=n.default.bindInit(z.initSuggestions),this.initCollections=n.default.bindInit(x.initCollections),this.initCopying=n.default.bindInit(N.initCopying),this.initAlignment=n.default.bindInit(M.initAlignment),this.initSourceTranslit=n.default.bindInit(D.initSourceTranslit),this.initTargetTranslit=n.default.bindInit(V.initTargetTranslit),this.initTranslator=n.default.bindInit(k.initTranslator),this.initComplaintPopup=n.default.bindInit(H.initComplaintPopup),this.initShareButton=n.default.bindInit(U.initShareButton),this.initExternalView=n.default.bindInit($.initExternalView),this.initAlternatives=n.default.bindInit(w.initAlternatives),this.initTranslationVote=n.default.bindInit(B.initTranslationVote),this.initTextCounter=n.default.bindInit(G.initTextCounter),this.initDescription=n.default.bindInit(F.initDescription),this.initDescriptionDict=n.default.bindInit(Y.initDescriptionDict),this.initTextArea=n.default.bindInit(W.initTextArea),this.initMetrikas=n.default.bindInit(K.initMetrikas),this.initTTSPlayer=n.default.bindInit(X.initTTSPlayer),this.initUniproxy=n.default.bindInit(j.initUniproxy),this.initDistBanner=n.default.bindInit(q.initDistBanner);const t=this,s=this.getDesktopSettings(),i=this.getView(),r=this.getModel();this._settings=s,this._router=new o.Router,s.on("change",(function(e,s,i){switch(e){case"textboxHeight":t.emit("resizerResize",i)}})),i.on("tap",(function(e){const s=this.getClosest(e.target,(function(e){return e.hasAttribute("data-external-name")}));s&&t.emit("externalClick",n.default.getAttribute(s,"data-external-name"))})).on("copy",(function(e){if("emj"===r.getProperty("dstLang"))return;const t=window.getSelection().toString(),s=e.clipboardData||window.clipboardData;t&&s&&!1!==s.setData("Text",t)&&n.default.preventEvent(e)})),r.on("change",(function(e,s,i){switch(e){case"text":switch(i.sender){case"dictionary":t.emit("dictLinkClick",s,i);break;case"synonyms":t.emit("synonymsInsert",s,i);break;case"favourites":t.emit("favInsert")}break;case"srcLang":case"dstLang":switch(i.sender){case"langHistory":case"langSelect":t.emit("langChanged",e,i)}break;case"complaint":t.emit("dictComplaintToggle",s,i);break;case"examplesComplaint":s&&t.emit("examplesComplaintStart",i)}})),r.onChange("text",(e,t)=>{switch(t.sender){case"example":case"relatedWords":case"dictionary":case"declensions":setTimeout(()=>this.scrollToTop(),0)}}).onChange("trText",e=>{i.setState("empty",!e)}),this.trackPerformance()}getRouter(){return this._router}getConfig(){return this._config}getSpellerSavedWords(){const e=this.getSettings().getProperty("savedSpellerItems");return e?e.split(";"):[]}hasSpellerSavedWord(e,t=this.getModel().getProperty("srcLang")){return-1!==this.getSpellerSavedWords().indexOf(t+":"+e)}getTranslatorView(){if(!this._translatorView){const e=window.config;this._translatorView=new l.TranslatorView({element:e.ELEMENTS.textbox2,template:e.TEMPLATES.translator,partials:{value:e.TEMPLATES.emojiValue},contentElement:e.ELEMENTS.translation})}return this._translatorView}getDictionaryModel(){return this._dictionaryModel||(this._dictionaryModel=this.makeDictionaryModel()),this._dictionaryModel}getBannedExamplesStorage(){return this._bannedExamplesStorage||(this._bannedExamplesStorage=new r.Storage({},{name:"cmplExpl"})),this._bannedExamplesStorage}getExamplesModel(){return this._examplesModel||(this._examplesModel=this.makeExamplesModel()),this._examplesModel}getContainerView(){return this._containerView||(this._containerView=new u.TouchView({element:this.getConfig().ELEMENTS.contentContainer})),this._containerView}toggleTranslatorExpandState(e){return window.config.DAILY_PHRASES?(this.getView().setState("translatorExpanded",e),this):this}scrollToTop(){n.default.smoothScrollTo(document.documentElement,0)}makeDictionaryModel(){const e=this.getConfig(),t=this.getSettings();return new c.DesktopDictionaryMultipleModel({ui:e.UI_LANG,srv:e.SRV,url:e.DICTIONARY_URL,getLangDir:()=>this.getLangsPair(),areNewDeclensions:e.ENABLE_NEW_DECLENSIONS,settings:t,constants:{disableDictionary:e.DISABLE_DICTIONARY,dictionaryLangs:e.DICTIONARY_LANGS,maxDictQuery:e.MAX_DICT_QUERY,maxDictWordsCount:e.MAX_DICT_WORD_COUNT}})}makeExamplesModel(){const e=this.getConfig(),t=this.getSettings();return new d.DesktopExamplesModel({ui:e.UI_LANG,srv:e.SRV,url:e.EXAMPLES_URL,chunks:!0,maxLength:e.MAX_EXAMPLE_LENGTH,settings:t,constants:{maxExampleQuery:e.MAX_EXMP_QUERY,maxExampleWordCount:e.MAX_EXMP_WORD_COUNT,exampleLangs:e.EXAMPLE_LANGS,disableExamples:e.DISABLE_EXAMPLES}})}getPredictorPresenter(){if(!this._predictorPresenter){const e=this.getConfig();this._predictorPresenter=new p.PredictorPresenter({view:new g.ListboxView({element:e.ELEMENTS.predictor,template:e.TEMPLATES.predictor}),model:new m.PredictorModel({languages:e.TRANSLATOR_LANGS,srv:e.SRV,limit:e.MAX_PREDICTOR_ITEMS,detectOptions:p.PredictorPresenter.detectOptions.KBD},{languages:e.TRANSLATOR_LANGS,url:e.PREDICTOR_URL,detectUrl:e.DETECTOR_URL,validators:{text(t){return t&&t.length<=e.MAX_PREDICTOR_QUERY&&"sjn"!==this.getProperty("srcLang")&&!n.default.isUrl(n.default.trim(t))},srcLang:t=>n.default.hasProperty(e.PREDICTOR_LANGS,t)}})})}return this._predictorPresenter}getMeasurerViewDst(){if(!this._measurerViewDst){const e=this.getConfig();this._measurerViewDst=new h.TemplateView({element:e.ELEMENTS.measurerDst,template:e.TEMPLATES.measurer})}return this._measurerViewDst}getMeasurerViewSrc(){if(!this._measurerViewSrc){const e=this.getConfig();this._measurerViewSrc=new h.TemplateView({element:e.ELEMENTS.measurer,template:e.TEMPLATES.measurer})}return this._measurerViewSrc}getLayerView(){if(!this._layerView){const e=this.getConfig();this._layerView=new h.TemplateView({element:e.ELEMENTS.textLayer,template:e.TEMPLATES.measurer})}return this._layerView}getTranslatorModel(){if(!this._translatorModel){const e=this.getConfig();this._translatorModel=new _.TranslatorModel2({srv:e.SRV,url:e.TRANSLATOR_URL,options:E.TranslatorModel.options.ALIGN|e.TRANSLATOR_EXTRA_OPTIONS,maxTranslatorQuery:e.MAX_TRANSLATOR_QUERY,translatorLangs:e.TRANSLATOR_LANGS})}return this._translatorModel}onToggleSpellerOption(e){return this.getSettings().onToggleOption(C.AVAILABLE_OPTIONS.AUTOCORRECT,e)}getTextareaPresenter(){if(!this._textareaPresenter){const e=this.getConfig(),t=e.USE_FAKEAREA&&T.InputView.fakeAreaSupported,s=new T.InputView({element:e.ELEMENTS.textbox,activateFocus:!1,contentElement:t?T.InputView.makeFakeArea(e.ELEMENTS.fakeArea):e.ELEMENTS.textarea});s.bindDOMEvents("scroll",!0),this._textareaPresenter=new f.InputPresenter({view:s,model:new S.InputModel})}return this._textareaPresenter}getTextInputView(){return this.getTextareaPresenter().getView()}autoSpellerEnabled(){return this.getSettings().isOptionEnabled(C.AVAILABLE_OPTIONS.AUTOCORRECT)}getComplaintCommentInput(){if(!this._complaintPopupCommentInput){const e=this.getConfig();this._complaintPopupCommentInput=new f.InputPresenter({view:new T.InputView({element:e.ELEMENTS.complaintPopupComment,activateFocus:!0,contentElement:e.ELEMENTS.complaintPopupCommentInput}),model:new S.InputModel})}return this._complaintPopupCommentInput}getSpeechRecognitionChip(){if(!this._speechRecognitionChip){const e=this.getConfig();this._speechRecognitionChip=new y.MicNotificationChip({gifUrl:e.MIC_ENABLE_GIF,tooltipElement:e.ELEMENTS.micNotificationChipTooltip,tooltipElementWrapper:e.ELEMENTS.micNotificationChipTooltipWrapper,spinnerElement:e.ELEMENTS.micNotificationChipTooltipSpinner},{container:e.ELEMENTS.micButtonChip})}return this._speechRecognitionChip}}t.TextTranslateApplication=J},function(e,t,s){"use strict";t.__esModule=!0,t.TranslatorView=void 0;var i=s(24);class n extends i.TemplateView{getSelectedText(e){const t={src:"",dst:""},s=window.getSelection();if(s&&s.anchorNode&&s.focusNode){let i=s.anchorNode,n=s.focusNode;i===n&&"translation"===i.id&&(t.dst=e),t.src=s.toString(),i.compareDocumentPosition(n)===Node.DOCUMENT_POSITION_PRECEDING&&(n=i,i=s.focusNode);const o=[this.getAlign(i.parentNode)];if(i!==n)for(i=i.parentNode;i&&!i.contains(n);)i=i.nextElementSibling,o.push(this.getAlign(i));o.filter((e,t,s)=>e&&s.findIndex(t=>t&&t[0]===e[0]&&t[1]===e[1])===t).forEach((s,i,n)=>{t.dst+=e.slice(s[0],s[1]),i!==n.length-1&&(t.dst+=" ")})}return t}getAlign(e){const t=this.getClosest(e,(function(e){return e.hasAttribute&&e.hasAttribute("data-align")}),!0);return t?t.getAttribute("data-align").split(":").map(Number):null}getOffsetHeight(){const e=this.getContentElement("[data-complaint-type=fullTextTranslation]");return e?e.offsetHeight:0}}t.TranslatorView=n},function(e,t,s){"use strict";t.__esModule=!0,t.DesktopDictionaryMultipleModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(170);class r extends o.DictionaryMultipleModel{constructor(e,t){super(e,t);const{config:s,settings:i,constants:n}=e;this.config=s,this.settings=i,this.constants=n,this.setValidator(this.getDefaultValidators())}getDefaultValidators(){const{settings:e}=this,{disableDictionary:t,dictionaryLangs:s,maxDictQuery:i,maxDictWordsCount:o}=this.constants;return{text:s=>!t&&(s&&!/[\n\r]/.test(s)&&s.length<=i&&n.default.getValueTokens(s).length<=o&&e.isOptionEnabled("dictionary")&&!n.default.isUrl(s)&&n.default.hasAlpha(s)),srcLang(e){const t=this.getProperty("dstLang");return e!==t&&(n.default.hasProperty(s,e+"-"+t)||n.default.hasProperty(s,e+"-"+e))},dstLang(e){const t=this.getProperty("srcLang");return t!==e&&(n.default.hasProperty(s,t+"-"+e)||n.default.hasProperty(s,t+"-"+t))}}}}t.DesktopDictionaryMultipleModel=r},function(e,t,s){"use strict";t.__esModule=!0,t.IdiomsModel=void 0;var i=s(4);class n extends i.Model{needReset(){const{needReset:e}=this.getProps();return this.setProperty("needReset",!1),e}updateHash(e){const{text:t,srcLang:s,dstLang:i}=e,n=`${t.trim().toLowerCase()}-${s}-${i}`,o=this.getProperty("hash");this.setProperty("hash",n).setProperty("needReset",o!==n)}}t.IdiomsModel=n},function(e,t,s){"use strict";t.__esModule=!0,t.DesktopExamplesModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(157);class r extends o.DictionaryExamplesModel{constructor(e,t){super(e,t);const{constants:s,settings:i}=e;this.constants=s,this.settings=i,this.setValidator(this.getDefaultValidators())}getDefaultValidators(){const{maxExampleQuery:e,maxExampleWordCount:t,exampleLangs:s,disableExamples:i}=this.constants;return{text(s){return!i&&(s&&!/[\n\r]/.test(s)&&s.length<=e&&n.default.getValueTokens(s).length<=t&&this.settings.isOptionEnabled("dictionary")&&!n.default.isUrl(s)&&n.default.hasAlpha(s))},srcLang(e){const t=this.getProperty("dstLang");return e!==t&&n.default.hasProperty(s,e+"-"+t)},dstLang(e){const t=this.getProperty("srcLang");return t!==e&&n.default.hasProperty(s,t+"-"+e)}}}}t.DesktopExamplesModel=r},function(e,t,s){"use strict";t.__esModule=!0,t.DictionaryExamplesApiError=void 0;class i extends Error{constructor(e){super(),this.message="Dictionary Examples Api Error: v"+e}}t.DictionaryExamplesApiError=i},function(e,t,s){"use strict";t.__esModule=!0,t.PredictorApiError=void 0;class i extends Error{constructor(...e){super(...e),this.message="Predictor Api Error"}}t.PredictorApiError=i},function(e,t,s){"use strict";t.__esModule=!0,t.DetectApiError=void 0;class i extends Error{constructor(...e){super(...e),this.message="Detect Api Error"}}t.DetectApiError=i},function(e,t,s){"use strict";t.__esModule=!0,t.TranslatorModel2=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(9),r=s(142),a=s(28),l=s(19),c=s(151);class d extends r.TranslatorModel{constructor(e={},t={}){super(e,t),this._chunks=[],this._chunkSize=e.chunkSize||600,this._maxThreads=e.maxThreads||4,this._activeRequests=[],t.validators||this.setValidator(this.getDefaultValidators()),this.on("invalid",this.reset)}reset(){return this._index=0,this._align="",this._chunks.length=0,this._activeRequests.forEach((function(e){e.abort()})),this._activeRequests.length=0,this._completedThreads=0,this}getDefaultValidators(){const{maxTranslatorQuery:e,translatorLangs:t}=this.getProps();return{text(){const t=this.getText().join("\n");return t&&t.length<=e&&!n.default.isUrl(t)},srcLang(e){return n.default.hasProperty(t,e)&&e!==this.getProperty("dstLang")},dstLang(e){return n.default.hasProperty(t,e)&&e!==this.getProperty("srcLang")}}}getData(e){const t=r.TranslatorModel.prototype.getData.call(this);return e&&(t.text=[e]),t}getParams(e){const t=r.TranslatorModel.prototype.getParams.call(this);return e&&(t.id=t.id.replace(/\d+$/,e)),t}makeChunks(){let e,t=this.getText().join("\n");for(;t;)e=n.default.truncateText(t,this._chunkSize),this._chunks.push(e),t=t.slice(e.length);return this}requestTranslation(){return!this.isValid()||this.getProperty("shouldNotRequest")||(this.emit("request"),this.reset(),this.makeChunks(),this.increaseCounter(),this.getSid().then(()=>{this.saveLastTranslationId(this.getTranslationId()),this.emit("query",n.default.extend(this.getData(),this.getParams()));for(let e=0;e<this._maxThreads;e++)this.translateNextChunk()})),this}translateNextChunk(){const e=this._chunks.length;if(!e)return this;const t=this._index++,s=this._chunks[t];if(t<e){if(s.length>this._chunkSize||!n.default.trim(s))return this.translateNextChunk();this._activeRequests.push(new l.HTTPRequest(this.getProperty("url")).setType(l.HTTPRequest.types.FORM).setData(this.getData(s)).setParams(this.getParams(t)).setMethod(l.HTTPRequest.methods.POST).send(this._handleChunkResponse.bind(this,t)))}else++this._completedThreads===this._maxThreads&&this.setProperty("translation",this._chunks.join(""),{align:this._align});return this}_handleChunkResponse(e,t,s){const i=t?t.code:s.body.code,n=t&&t.code===a.HTTPError.ABORT;!(s&&s.code===l.HTTPRequest.codes.OK)||n||this.validateResponse(s)||(0,o.logError)(new c.TranslateApiError),i===l.HTTPRequest.codes.OK?(this._chunks[e]=s.body.text.join("\n"),s.body.align&&1===this._chunks.length&&(this._align=s.body.align[0]),this.translateNextChunk()):i!==a.HTTPError.ABORT&&this.reset().emit("error",t||new a.HTTPError(i,s.body.message))}}t.TranslatorModel2=d},function(e,t,s){"use strict";t.__esModule=!0,t.initToast=void 0;var i=s(158),n=s(2),o=s(159);t.initToast=function(e){const t=new i.ToastPresenter({view:new n.TouchView({element:e.ELEMENTS.errorToast,contentElement:e.ELEMENTS.errorToastContent}),model:new o.ToastModel({delay:e.TOAST_DELAY})});return this.getModel().on("set:toast",(function(e,s){t.getView().setState("commonComplaint",s.commonComplaint),t.showToast(e,s.delay)})),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initUrlView=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(24);t.initUrlView=function(e){const t=new o.TemplateView({element:e.ELEMENTS.url,template:e.TEMPLATES.url}),s=this.getView(),i=this.getModel();return this.onAction("translatePage",(function(){if(t.isEnabled())if(this.emit("translatePage"),e.GOODBYE_IFRAME){const{text:e}=this.getProps();this.openSiteTranslateUrl(e)}else t.getElement().submit()})),t.on("stateChanged:hidden",(function(e){s.setState("url",!e)})),i.on("change",(function(s,i){let o;switch(s){case"text":case"srcLang":case"dstLang":if(o=this.toJSON(),o.text=n.default.trim(o.text),!o.text){t.setVisible(!1);break}n.default.isUrl(o.text)&&(this.setProperty({trText:o.text,translation:o.text}),t.renderData({ui:e.UI_LANG,url:o.text,lang:o.srcLang+"-"+o.dstLang}).setVisible(!0).setEnabled(!n.default.hasProperty(e.INVALID_URL_LANGS,o.srcLang)&&!n.default.hasProperty(e.INVALID_URL_LANGS,o.dstLang)));break;case"translation":i&&!n.default.isUrl(i)&&t.setVisible(!1)}})),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initResizer=void 0;var i=s(24);t.initResizer=function(e){const t=this,s=new i.TemplateView({element:e.ELEMENTS.translationLayer,template:e.TEMPLATES.measurer}),n=this.getView(),o=this.getModel(),r=this.getLayerView(),a=n.getContentElement('[data-resizer-target="max"]'),l=n.getContentElement('[data-resizer-target="src"]'),c=n.getContentElement('[data-resizer-target="dst"]');let d=null,u=null;const h=function(){const t=e.ELEMENTS.sourceTranslit.clientHeight,i=e.ELEMENTS.targetTranslit.clientHeight;((t,s)=>{d===t&&u===s||(d=t,u=s,e.ELEMENTS.textlayerCustomStyles.textContent=`\n            .textlayer_src {\n                border-bottom-width: ${68+t}px;\n            }\n            .textlayer_dst {\n                border-bottom-width: ${68+s}px;\n            }\n        `)})(t,i);const n=r.getContentElement().clientHeight+t,h=s.getContentElement().clientHeight+i,p=Math.max(n,h);a&&(a.style.height=p+"px"),l&&(l.style.height=n+"px"),c&&(c.style.height=h+"px");const g=s.getContentElement('[data-measurer-target="true"]');g&&o.setProperty("dstMeasurerHeight",g.offsetHeight)},p=function(e){switch(e){case"longtext":case"keyboard":h()}},g=function(e,t){switch(e){case"text":r.renderData({text:t,rightText:this.getProperty("sourceTranslit")&&"."});break;case"sourceTranslit":r.renderData({text:this.getProperty("text"),rightText:t&&"."});break;case"targetTranslit":s.renderData({text:this.getProperty("translation"),rightText:t&&"."});break;case"translation":case"userTranslation":s.renderData({text:t,rightText:this.getProperty("targetTranslit")&&"."})}};return function(e){const i=e?"on":"off";t[i]("resize",h),t[i]("containerHeightChanged",h),n[i]("stateChanged",p),o[i]("change",g),r[i]("contentChanged",h),s[i]("contentChanged",h)}(!0),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initHistory=void 0;t.initHistory=function(e){const t=this,s=this.getModel(),i=this._router;return i.on("historyMove",(function(s){t.emit("toggleCollections",s.currentState.route===e.COLLECTIONS_PATHNAME)})).on("modelUpdated",(function(e){s.setProperty(e,{sender:"history"})})),this.on("collectionsActivated",(function(t){const s=t?{excludeParams:!0,includePathname:!0,pathname:e.COLLECTIONS_PATHNAME}:{includeSearch:!0},n=this.getLink(s);i.updateHistory(n)})),s.on("set:translation",(function(){i.updateTranslationState(this.toJSON())})),s.onChange(["srcLang","dstLang"],(function(){i.updateTranslationState(this.toJSON())})),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initKeyboard=void 0;var i=s(2);t.initKeyboard=function(e){const t=this,s=this.getModel(),n=this.getView(),o=new window.Keyboard(e.ELEMENTS.keyboard),r=new i.TouchView({element:e.ELEMENTS.keyboardButton}),a=new i.TouchView({element:e.ELEMENTS.keyboardLangSwap}),l=new i.TouchView({element:e.ELEMENTS.keyboardContainer,contentElement:e.ELEMENTS.keyboardLang,hideAfterTransition:!0}),c=e=>window.Keyboard.layouts.hasOwnProperty(e),d=t=>{o.setLang(t),r.setEnabled(!0),l.setContent(e.TRANSLATOR_LANGS[t],{asText:!0})};return this.on("action:closeKeyboard",(function(){l.setVisible(!1),t.emit("keyboardOpen",{open:!1,type:"cross"})})).bindFocusActivation(r),r.on("tap",(function(){l.setVisible(),t.emit("keyboardOpen",{open:l.isVisible(),type:"icon"})})),a.on("tap",()=>{const{srcLang:e,dstLang:t}=s.getProps(),i=o.getLang(),n=c(e)?e:"en",r=c(t)?t:"en";d(i===n?r:n)}),s.on("change:srcLang",e=>{const t=c(e)?e:"en";d(t)}),l.on("stateChanged:hidden",(function(e){e||o.setExtra(!1).setShifted(!1),n.setState("keyboard",!e),o.setActive(!e),r.setState("active",!e)})),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initSelectionPopup=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(29),r=s(170),a=s(157),l=s(2),c=s(70),d=s(11),u=s(175);t.initSelectionPopup=function(e){let t;const s=this,i=this._settings,h=this.getView(),p=this.getModel(),g=p.getProps(),m=new u.DictionaryPresenter2({view:new o.ListboxView({template:e.TEMPLATES.empty}),model:new r.DictionaryMultipleModel({ui:e.UI_LANG,srv:e.SRV,url:e.DICTIONARY_URL,getLangDir:()=>this.getLangsPair()},{validators:{text:t=>!!h.hasState("select")&&(!e.DISABLE_DICTIONARY&&(t&&!/[\n\r]/.test(t)&&t.length<=e.MAX_DICT_QUERY&&n.default.getValueTokens(t).length<=e.MAX_DICT_WORD_COUNT&&!n.default.isUrl(t)&&n.default.hasAlpha(t))),srcLang(t){const s=this.getProperty("dstLang");return t!==s&&(n.default.hasProperty(e.DICTIONARY_LANGS,t+"-"+s)||n.default.hasProperty(e.DICTIONARY_LANGS,t+"-"+t))},dstLang(t){const s=this.getProperty("srcLang");return s!==t&&(n.default.hasProperty(e.DICTIONARY_LANGS,s+"-"+t)||n.default.hasProperty(e.DICTIONARY_LANGS,s+"-"+s))}}})}),E=new a.DictionaryExamplesModel({ui:e.UI_LANG,srv:e.SRV,url:e.EXAMPLES_URL,chunks:!0,maxLength:e.MAX_EXAMPLE_LENGTH},{validators:{text:t=>!!h.hasState("select")&&(!e.DISABLE_EXAMPLES&&(t&&!/[\n\r]/.test(t)&&t.length<=e.MAX_EXMP_QUERY&&n.default.getValueTokens(t).length<=e.MAX_EXMP_WORD_COUNT&&!n.default.isUrl(t)&&n.default.hasAlpha(t))),srcLang(t){const s=this.getProperty("dstLang");return t!==s&&n.default.hasProperty(e.EXAMPLE_LANGS,t+"-"+s)},dstLang(t){const s=this.getProperty("srcLang");return s!==t&&n.default.hasProperty(e.EXAMPLE_LANGS,s+"-"+t)}}}),_=new u.DictionaryPresenter2({view:new o.ListboxView({template:e.TEMPLATES.empty}),model:E}),T=new o.ListboxView({element:e.ELEMENTS.popunder,template:e.TEMPLATES.examplePopup}),f=new o.ListboxView({element:e.ELEMENTS.popunderTooltip,template:e.TEMPLATES.empty}),S=this.getTranslatorView(),C=this.getMeasurerViewSrc(),y=this.getMeasurerViewDst(),A=function(){const i=_.getText();n.default.getValueTokens(i).length>e.MAX_EXMP_WORD_COUNT||!n.default.hasAlpha(i)?T.setVisible(!1):(T.renderData({noExamples:!0}),T.setVisible(!0),s.emit("popupShown",{show:!0,empty:!0}),clearTimeout(t),t=setTimeout((function(){T.setVisible(!1)}),4e3))},v=function(){s._dictPopup=void 0,s._exmpPopup=void 0},L=({isTranslation:t})=>{const s=t?"translation":"text",i=p.getProperty(s),o=p.getProperty("isFakeTextArea")?e.ELEMENTS.fakeArea:e.ELEMENTS.textarea,r=t?e.ELEMENTS.translation:o,a=t?y:C;a.renderData({text:i.slice(r.selectionStart,r.selectionEnd),leftText:i.slice(0,r.selectionStart),rightText:i.slice(r.selectionEnd)}).scrollTo(a.getScrollInfo().maxTop/100*p.getProperty("textScrollY"));const l=a.getContentElement("[data-measurer-target]");if(l){const e=n.default.getMutableBoundingClientRect(l);e.left-=20;const t=document.documentElement.clientHeight-e.bottom-20;T.setStyle("maxHeight",t+"px").setPosition(e,!0,!0)}},R=n.default.debounce((function(){const{trText:e,selTr:i,selText:n}=p.getProps();if(!e||!i&&!n)return v(),void T.setVisible(!1);s._exmpPopup||s._dictPopup&&s._dictPopup.hasWords?(s._dictPopup=s._dictPopup||{},s._dictPopup.text=s._dictPopup.text||i||n,s._dictPopup.hasExamples=s._exmpPopup&&s._exmpPopup.hasExamples,s._dictPopup.items=s._exmpPopup&&s._exmpPopup.items,s._dictPopup.isSrc=Boolean(n),T.setState("overflow",s._dictPopup.hasWords),T.renderData(s._dictPopup),T.setVisible(!0),s.emit("popupShown",{show:!0}),clearTimeout(t)):A()}),200),P=()=>{s._dictPopup&&s._dictPopup.hasWords&&s._exmpPopup?R.callNow():R()},O=n.default.debounce((function(e,t,s){-1===s.target.className.indexOf("translit")&&setTimeout(()=>{const e=p.getProperty("text"),t=S.getSelectedText(e);t.src&&setTimeout((function(){p.setProperty("selTr",t.src,{dst:t.dst})}),0)},10)})),I=function(t,s){let i="",n="";const o=[];return t.forEach((function(e){i=e.pos&&e.pos.code,n=e.text,e.tr.forEach((function(e,t){o.push({name:s,value:e.text,title:n,groupIndex:t,partOfSpeech:i}),e.syn&&e.syn.forEach((function(e){o.push({name:s,value:e.text,title:n,groupIndex:t,partOfSpeech:i})}))}))})),o.length>e.MAX_SYNONYMS_ITEMS2&&(o.length=e.MAX_SYNONYMS_ITEMS2),o[o.length-1].isLast=!0,o},b=e=>{e.keyCode===d.InputView.keys.ESCAPE&&(s._dictPopup||s._exmpPopup)&&T.isVisible()&&(T.setVisible(!1),v())};this.on("resize",()=>{v(),T.setVisible(!1)}).on("textKeydown",(function(e){b(e)})).on("action",(function(e){switch(e){case"retry":m.requestData(),_.requestData()}})).on(["trTextSelect","trTextClick"],(e,...t)=>O(...t)).onAction("enableCustomMode",n.default.debounce(()=>{T.setVisible(!1),n.default.removeAllSelections()})),p.on("change",(function(t,i,o){let r,a;const l=p.getProperty("trText"),d=p.getProperty("srcLang"),u=p.getProperty("dstLang");switch(t){case"text":(s._dictPopup||s._exmpPopup)&&(v(),T.setVisible(!1)),"dictionary"===o.sender&&"tr"===o.type&&s.swapDirection();break;case"trText":case"selText":a=n.default.trim(i);const g="selText"===t,E="trText"===t,f=n.default.getValueTokens(a).length>e.MAX_EXMP_WORD_COUNT,S=_.customExamplesEnabled();if(g&&S&&f)return;r=a&&g&&!f&&n.default.hasAlpha(a)&&m.hasType(c.DictionaryPresenter.types.REGULAR),h.setState("select",r),a&&!S&&(m.setSrcLanguage(d,{silent:!0}).setDstLanguage(u).requestData(),_.setSrcLanguage(d,{silent:!0}).setDstLanguage(u,{silent:!0}).setTranslation("",{silent:!0}).setMaxLength("selText"===t?e.MAX_EXAMPLE_POPUP_LENGTH:e.MAX_EXAMPLE_LENGTH).requestData()),r&&(v(),L({isTranslation:!1}),T.renderData({noExamples:!0,template:!0}).setState("text",!0).setVisible(!0)),m.setText(a),_.setText(a),E&&_.setCustomExamplesFlag(!1);break;case"selTr":const C=o.dst&&o.dst.length<=e.MAX_EXMP_DST_QUERY?o.dst:"";a=n.default.trim(i),m.setSrcLanguage(u,{silent:!0}).setDstLanguage(d),r=a&&n.default.hasAlpha(a)&&m.hasType(c.DictionaryPresenter.types.REGULAR),r&&(v(),h.setState("select",!0),L({isTranslation:!0}),T.renderData({noExamples:!0,template:!0}).setState("text",!1).setVisible(!0),m.setText(a).requestData(),_.setSrcLanguage(u,{silent:!0}).setDstLanguage(d,{silent:!0}).setTranslation(C,{silent:!0}).setMaxLength(e.MAX_EXAMPLE_POPUP_LENGTH).setText(a).requestData());break;case"srcLang":p.setProperty("supportExamples",e.EXAMPLE_LANGS[i+"-"+u]),_.setCustomExamplesFlag(!1).setSrcLanguage(i).setDstLanguage(u).setText(l).requestData(),m.setSrcLanguage(i).setDstLanguage(u).setText(l).requestData();break;case"dstLang":p.setProperty("supportExamples",e.EXAMPLE_LANGS[d+"-"+i]),_.setCustomExamplesFlag(!1).setSrcLanguage(d).setDstLanguage(i).setText(l).requestData(),m.setFlag(c.DictionaryPresenter.flags.DEFINITIONS,i===e.UI_LANG).setSrcLanguage(d).setDstLanguage(i).setText(l).requestData()}})),h.on("stateChanged:select",(function(e){e||(v(),T.setVisible(!1))})).on("stateChanged:empty",(function(e){e&&h.setState("select",!1)})).on("tap",(function(e){T.isVisible()&&!T.getElement().contains(e.target)&&(T.setVisible(!1),s.emit("popupShown",{}))})),S.on("keydown",(function(e){e.keyCode===d.InputView.keys.A&&n.default.hasCtrlKey(e)?p.setProperty("selTr",p.getProperty("translation"),{dst:p.getProperty("text")}):b(e)})).bindDOMEvents("keydown",!0),T.on("stateChanged:hidden",(function(i){i?(p.setProperty("selText","",{silent:!0}),p.setProperty("selTr","",{silent:!0}),_.getModel().getProperty("maxLength")!==e.MAX_EXAMPLE_LENGTH&&(_.setText("",{silent:!0}),m.setText("",{silent:!0})),h.hasState("emptyPopup")||h.setState("select",!1)):(clearTimeout(t),s._showedExamples||(s._showedExamples=!0))})).on(l.TouchView.eventTypes.OVER,(function(e){const t={},i=e.target;n.default.hasClass(i,"example_ref")&&!f.isVisible()&&(f.setContent(n.default.getAttribute(i,"data-message")),function(e,t){const s=t.getElement(),i=e.left,n=e.top-t.getRect().height;s.style.left=i+"px",s.style.top=n+"px"}(i.getBoundingClientRect(),f),f.setState("popup",T.isVisible()),f.setVisible(!0),t.type=n.default.getAttribute(i,"data-type"),t.text=_.getText(),t.origin=n.default.getAttribute(i,"data-ref"),s.emit("originTooltipShown",t))})).on(l.TouchView.eventTypes.OUT,(function(e){const t=e.target;n.default.hasClass(t,"example_ref")&&f.isVisible()&&f.setVisible(!1)})).bindDOMEvents(l.TouchView.eventTypes.OVER).bindDOMEvents(l.TouchView.eventTypes.OUT),m.setFlag(c.DictionaryPresenter.flags.MORPHO,!0).setFlag(c.DictionaryPresenter.flags.FAMILY,e.FAMILY).setFlag(c.DictionaryPresenter.flags.SHORT_POS,!0).setFlag(c.DictionaryPresenter.flags.TOOLTIPS,!0).setFlag(c.DictionaryPresenter.flags.IDIOMS,!0).setFlag(c.DictionaryPresenter.flags.LONG_EXAMPLES,!0),_.setFlag(c.DictionaryPresenter.flags.MORPHO,!0).setFlag(c.DictionaryPresenter.flags.FAMILY,e.FAMILY).setFlag(c.DictionaryPresenter.flags.SHORT_POS,!0).setFlag(c.DictionaryPresenter.flags.TOOLTIPS,!0).setFlag(c.DictionaryPresenter.flags.IDIOMS,!0).setVoteResults(i.getProperty("voteResults")),_.on("dataSet",(function(e,t){h.hasState("select")&&(s._dictPopup||t.resultLength?P():t.resultLength||A())})).on("error",(function(e){e&&setTimeout((function(){p.setProperty("selText","",{silent:!0}),p.setProperty("selTr","",{silent:!0}),h.setState("select",!1)}),500)})),_.prepareData=function(e){const t={},i=n.default.safeParseJSON(e),o=n.default.get(i,"result.tabs",[]),r=n.default.get(i,"result.examples",[]);if(!o.length)return null;if(s.emit("examplesRendered",{text:this.getText(),popup:h.hasState("select")}),h.hasState("select")){const e=Boolean(p.getProperty("selText"));t.items=[],t.hasExamples=!0;for(let s=0;s<2;s++){const i=o[s];if(!i)break;i.examples=r.filter(e=>e.tabIndex===s);const n=i.translation,a=n.text||n,l=n.pos;"idiom"!==i.examples[0].ref.type&&t.items.push({exampleId:i.examples[0].id,pos:l?l.text:null,posCode:l?l.code:null,original:i.text,text:i.translation.other?"":a,ref:i.examples[0].ref.title,refType:i.examples[0].ref.type,message:u.DictionaryPresenter2.getTooltipMessage(i.examples[0].ref),srcExp:i.examples[0].src.split(/[<>]/).map((function(t,s){return{text:t,highlighted:s%2!=0,needSwap:!e}})),dstExp:i.examples[0].dst.split(/[<>]/).map((function(t,s){return{text:t,highlighted:s%2!=0,needSwap:e}}))})}s._exmpPopup=t,h.setState("emptyPopup",!1)}};const x=e=>{const t=[];return e.gen&&t.push({value:e.gen.text,title:e.gen.tooltip}),e.num&&t.push({value:e.num.text,title:e.num.tooltip}),e.dia&&t.push({value:e.dia.text,title:e.dia.tooltip}),t};return m.prepareData=function(t){let i,o,r="",a=0;const l=e.SYN_TITLES2,d=p.getProperty("srcLang"),u=p.getProperty("dstLang"),g=p.getProperty("srcLang")+"-"+p.getProperty("dstLang"),E=p.getProperty("dstLang")+"-"+p.getProperty("srcLang"),_={words:[]},T=[],f=[],S={dict:{},syn:{}};if(!t)return null;let C=JSON.parse(t);const y=C[d]||C[u];if(C=C[g]||C[E],!C&&!y)return null;const A=Boolean(C&&C[c.DictionaryPresenter.types.DEF]),v=Boolean(p.getProperty("selText")),L=[];[c.DictionaryPresenter.types.DEF,c.DictionaryPresenter.types.REGULAR].forEach(e=>{const t=C&&C[e];t&&t.length&&L.push(t)});let R,P=!1;if(L.forEach(t=>{if(P)return;R=t,S.dict.hasModernLabel=t.some((function(e){return e.new||e.tr.some((function(e){return e.new}))})),S.dict.items=t.map((function(t){let s="";const i={meanings:[],definition:{},show:a<e.DICTIONARY_COUNT},o=[];return i.title={title:t.text,marks:x(t)},t.text!==r&&t.fl&&(i.title.fl=t.fl),r=t.text,t.pos&&(s=t.pos.code,i.title.partOfSpeechCode=s,i.title.tooltip=t.pos.tooltip,i.title.partOfSpeech=t.pos.text),t.ts&&(i.title.transcription=t.ts),i.title.gen=n.default.get(t,"gen.tooltip",""),i.title.fl=n.default.get(t,"fl",""),t.tr.forEach((function(t,n){const l={examples:[],hasExamples(){return Boolean(this.examples.length)},hasTranslations(){return Boolean(this.meaningTrs.length)},groupIndex:n},c=[],d=[{needSwap:v,title:r,value:t.text,marks:x(t),groupIndex:n,partOfSpeech:s}];t.def?i.definition=(e=>({imgUrl:e.img,origUrl:e.orig,textVal:e.def.split(/[<>]/).map((function(e,t){return{text:e,highlighted:t%2!=0,isSrc:Boolean(p.getProperty("selText"))}})),altText:e.text,sourceUrl:e.ref.url,sourceName:e.ref.name}))(t):(t.syn&&t.syn.forEach((function(e){d.push({needSwap:v,title:r,value:e.text,marks:x(e),groupIndex:n,partOfSpeech:s})})),t.mean&&t.mean.forEach((function(e){c.push({needSwap:!v,title:r,value:e.text,groupIndex:n,partOfSpeech:s})})),d[d.length-1].isLast=!0,c.length&&(c[c.length-1].isLast=!0),l.meaningTrs=c,l.meaningVals=d,l.show=a<e.DICTIONARY_COUNT,a++,l.show?(l.hasExamples()&&(i.title.showExampleToggle=!0),o.push({values:l.meaningVals,hasSyn:l.meaningTrs.length,syn:l.meaningTrs,groupIndex:l.groupIndex,groupIndex1:n+1})):d.forEach((function(e){f.push(e.value)})),i.meanings.push(l))})),i.show&&_.words.push({partOfSpeechCode:i.title.partOfSpeechCode,partOfSpeech:i.title.partOfSpeech,transcription:i.title.transcription,gen:i.title.gen,fl:i.title.fl,title:r,popupVals:o}),(e=>!(e.meanings.length||e.title.hasExamples||e.title.transcription||Object.keys(e.definition).length))(i)?null:(P=!0,i)}));const s=a>e.DICTIONARY_COUNT;S.dict.title=e.DICT_TITLES.regular,S.dict.showToggle=s,S.dict.showToggle&&(S.dict.moreMessage=n.default.parseString(e.MORE_MESSAGE,f.length),S.dict.moreMessage+=": "+f.slice(0,2).join(", "))}),y){for(i in l)y[i]&&y[i].length&&(o={subtitle:l[i].title,tooltip:l[i].tooltip,tab:i,items:I(y[i],i)},T.push(o));T.length&&(S.syn.articles=T)}const O=S.dict.items&&S.dict.items.filter(Boolean).length,b=S.syns&&S.syns.articles&&S.syns.articles.length;if(!O&&!b)return null;O?s.emit("dictRendered",{text:m.getText(),popup:h.hasState("select"),noExamples:!0,definition:A}):(S.dict.items=null,S.dict.title=null),h.hasState("select")&&(R&&(_.words=_.words.slice(0,3),_.words.forEach((function(e){e.syn&&e.syn.length&&(e.syn[e.syn.length-1].isLast=!0),e.values&&e.values.length&&(e.values[e.values.length-1].isLast=!0)})),_.hasWords=_.words.length,_.ts=R[0]&&R[0].ts,_.text=R[0]&&R[0].text||p.getProperty("selTr"),_.pos=R[0]&&R[0].pos&&R[0].pos.text),s._dictPopup=_)},m.on("valueSelected",(function(e){if(h.hasState("complaint"))return;const t=e.split(":");p.setProperty("text",t[1],{type:t[0],sender:"tr"===t[0]||"mean"===t[0]?"dictionary":"synonyms"})})).on("dataSet",(function(e,t){h.hasState("select")&&(t.invalid&&(s._dictPopup={}),P())})).on("langChanged",(function(){const t=m.getSrcLanguage(),s=m.getDstLanguage();m.setType(c.DictionaryPresenter.types.SYN,e.DICTIONARY_LANGS[t+"-"+t]).setType(c.DictionaryPresenter.types.REGULAR,e.DICTIONARY_LANGS[t+"-"+s]).setType(c.DictionaryPresenter.types.ANT,e.ANT_LANGS[t]).setType(c.DictionaryPresenter.types.DERIV,e.DERIV_LANGS[t])})),g.trText&&m.setText(g.trText),g.srcLang&&m.setSrcLanguage(g.srcLang),g.dstLang&&m.setDstLanguage(g.dstLang),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initSpeechRecognition=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(24),r=s(224),a=s(176),l=s(225),c=s(226),d=s(227),u=s(144),h=s(228),p=s(177),g=s(174),m=s(45);t.initSpeechRecognition=function(e){let t="";const s=this,i=this.getView(),E=this.getModel(),_=new o.TemplateView({element:e.ELEMENTS.interim,template:e.TEMPLATES.measurer}),T=new r.AudioVisualizerView({colors:["#e0e0e0","#e1e1e1","#e2e2e2"],shadow:{color:"#efefef",radius:10},element:e.ELEMENTS.volume,levelPayload:19}),f=new a.SpeechRecognizerView({element:e.ELEMENTS.microphone,activateFocus:!0,ignorePreventFocus:!0}),S=new d.SpeechRecognizerPresenter({view:f,model:new l.SpeechRecognizerModel({},{validators:{lang:e=>e}})}),C=e=>{const t=this.getSpeechRecognitionChip();S.getView().setVisible(!1),t.setVisible(!0).setProperty({type:e})},y=()=>{const t=S.getModel().isValid()?e.LOCALIZATIONS.asrValidState:e.LOCALIZATIONS.asrInvalidLangState;f.setTooltipText(t)},A=e.FORCE_UNIPROXY,v=!A;return e.ENABLE_NATIVE_ASR&&!A&&p.SpeechRecognizerNative.isAvailable()&&S.addRecognizer(new p.SpeechRecognizerNative({interimResults:!0})),v&&c.SpeechKitRecognizer.isAvailable()&&S.addRecognizer(new c.SpeechKitRecognizer({speechKitTimeout:e.SPEECHKIT_TIMEOUT,speechKitApikey:e.SPEECHKIT_KEY})),h.SpeechRecognizerUniproxy.isAvailable()&&S.addRecognizer(new h.SpeechRecognizerUniproxy({uniproxy:this._uniproxy})),this.bindFocusActivation(f),i.on("stateChanged:listening",(function(e){e||S.stop()})),E.onChange("srcLang",e=>{S.setLanguage(e),y()}),f.setEnabled(!1).onStateChanged(a.RECOGNIZER_STATES.INVALID,e=>{f.setEnabled(!e)}),S.on(u.RECOGNITION_EVENTS.END,(function(n){s.emit("asrEnd",n,t),i.setState("listening",!1),_.setContent(""),T.setVisible(!1).stopVisualization(),t="",n&&n.error===u.RECOGNITION_ERRORS.NETWORK&&(E.setProperty("tooltip",e.TOOLTIPS.sttErrorOldBrowser),f.setEnabled(!1))})).on(u.RECOGNITION_EVENTS.START,e=>{this.getSpeechRecognitionChip().setVisible(!1),S.getView().setVisible(!0);const n=S.getVisualizer();s.emit("asrStart",e),i.setState("listening",!0),n&&(n.fftSize=256,n.smoothingTimeConstant=.9,T.setVisible(!0).setAnalyserNode(n).startVisualization()),t=e}).on(u.RECOGNITION_EVENTS.RECOGNIZE,(function(e){let i=E.getProperty("text");const n=/\S/.test(i.slice(-1))?" ":"";e.final?(i+=n+e.value,E.setProperty("text",i,{sender:"microphone"}),_.setContent(""),s.emit("asrResult",e,t)):_.renderData({text:n+e.value,leftText:i}).scrollTo(_.getScrollInfo().maxTop/100*E.getProperty("textScrollY"))})).on(u.RECOGNITION_EVENTS.MIC_DISABLED,()=>{C(g.MAC_NOTIFICATION_CHIP_TYPES.DISABLED)}).on(u.RECOGNITION_EVENTS.MIC_ENABLED,()=>{this.getSpeechRecognitionChip().setVisible(!1),S.getView().setVisible(!0),S.syncView()}).on(u.RECOGNITION_EVENTS.ACTIVATING,()=>{C(g.MAC_NOTIFICATION_CHIP_TYPES.ACTIVATING)}).setLanguage(E.getProperty("srcLang")),this.on("resize",n.default.debounce(()=>{if(!f.isVisible()){this.getSpeechRecognitionChip().closeTooltip()}})).addHotKey(m.HOT_KEYS_MAP.ASR,{view:f,getActionName:()=>i.hasState("listening")?"asr_stop":"asr_start"}),y(),this}},function(e,t,s){"use strict";t.__esModule=!0,t.AudioVisualizerView=void 0;var i=s(15);class n extends i.View{static extractVolume(e){let t,s,i=0;for(t=0,s=e.length;t<s;t++)i<e[t]&&(i=e[t]);return i/255}constructor(e={}){super(e),this._colors=e.colors||[],this._levelWidth=e.levelWidth||10,this._levelPayload=e.levelPayload||10,this._shadow=e.shadow||null}draw(e){let t;const s=this.getElement(),i=s.width/2*e/2,n=s.getContext("2d");t=Math.min(this._colors.length,Math.ceil(i/this._levelWidth));const o=t;for(n.clearRect(0,0,s.width,s.height);t--;)n.beginPath(),n.fillStyle=this._colors[t],n.arc(s.width/2,s.height/2,Math.min(this._levelWidth*(t+1),i)+this._levelPayload,0,2*Math.PI,!0),n.closePath(),t===o-1&&this._shadow&&(n.strokeStyle=this._shadow.color,n.lineWidth=this._shadow.radius,n.stroke()),n.fill()}setAnalyserNode(e){return this._analyserNode=e,this}stopVisualization(){return window.cancelAnimationFrame(this._frameId),this}startVisualization(){const e=this._analyserNode,t=new Uint8Array(e.frequencyBinCount);e.getByteFrequencyData(t),this.draw(n.extractVolume(t)),this._frameId=requestAnimationFrame(this.startVisualization.bind(this))}}t.AudioVisualizerView=n},function(e,t,s){"use strict";t.__esModule=!0,t.SpeechRecognizerModel=void 0;var i=s(4);class n extends i.Model{getDefaults(){return{lang:"",index:0}}increaseIndex(){return this.setProperty("index",this.getProperty("index")+1)}}t.SpeechRecognizerModel=n},function(e,t,s){"use strict";t.__esModule=!0,t.SpeechKitRecognizer=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(177),r=s(144);class a extends r.SpeechRecognizerBase{static isAvailable(){return window.ya&&window.ya.speechkit&&(window.ya.speechkit.isSupported()||window.ya.speechkit.isWebAudioSupported())&&(!n.default.iOS||n.default.iOS>=13)}constructor(e={}){super(e);const t=window.ya.speechkit;this._timer=0,this._timeout=e.speechKitTimeout||0,this._resultIndex=0,this._supportedLangs=t.isWebAudioSupported()?o.SpeechRecognizerNative.langs:a.langs,this._recognitionOptions={apikey:e.speechKitApikey,format:t.FORMAT.OPUS||t.FORMAT.PCM16,punctuation:!1,partialResults:!0,utteranceSilence:250,allowMultiUtterance:!0,EouMode:"MultiUtterance"},this._recognition=new t.SpeechRecognition}setTimeout(){return this._timeout&&(clearTimeout(this._timer),this._timer=setTimeout(this.stopListening.bind(this),this._timeout)),this}startRecognition(e){this._recognition.start({...this._recognitionOptions,lang:e,initCallback:this._onStart.bind(this),stopCallback:this._onAbort.bind(this),dataCallback:this._onResult.bind(this),errorCallback:this._onAbort.bind(this)})}stopListening(){return this._recognition.abort(),this}convertLanguage(e,t){t(this._supportedLangs[e]||"")}prepareData(e,t){return{value:n.default.trim(e.text),final:e.final,index:t,resultIndex:e.resultIndex}}getVisualizer(){return this._recognition.recorder.getAnalyserNode()}getPriority(e){return n.default.iOS>=13&&n.default.safariVersion&&n.default.isOnline()?r.RECOGNITION_PRIORITIES.HIGH:n.default.isOnline()?r.RECOGNITION_PRIORITIES.NORMAL:r.RECOGNITION_PRIORITIES.LOW}_playSound(e){const t=new Audio;try{t.src=e,t.play()}catch(e){}}_onAbort(e){return clearTimeout(this._timer),this.emit(r.RECOGNITION_EVENTS.END,e)}_onStart(e,t,s){return this._resultIndex=0,this.setTimeout(),this.emit(r.RECOGNITION_EVENTS.START,s)}_onResult(e,t){const s={text:e,final:t,resultIndex:this._resultIndex};return e&&this.setTimeout(),t&&(this._resultIndex+=1),this.emit(r.RECOGNITION_EVENTS.RECOGNIZE,s)}}t.SpeechKitRecognizer=a,a.langs={en:"en-GB",ru:"ru-RU",tr:"tr-TR",uk:"uk-UA"}},function(e,t,s){"use strict";t.__esModule=!0,t.SpeechRecognizerPresenter=void 0,s(1);var i=s(17),n=s(144),o=s(176);class r extends i.Presenter{constructor(e){super(e);const t=this.getView(),s=this.getModel();this._loadingTimeout=0,this._recognizers=[],this.micButtonChip=e.micButtonChip||null,t.onTap(()=>{t.hasState(o.RECOGNIZER_STATES.INVALID)||(this.isActive()?this.stop():(t.setState(o.RECOGNIZER_STATES.PREPARING,!0),this.start(s.getProperty("lang"))))}),s.onChange(e=>{"lang"===e&&this.stop(),this.syncView()}),this.syncView()}addRecognizer(e){this._recognizers.push(e),e.on(n.RECOGNITION_EVENTS.START,this._onStartEvent.bind(this,e)).on(n.RECOGNITION_EVENTS.RECOGNIZE,this._onRecognizeEvent.bind(this,e)).on(n.RECOGNITION_EVENTS.END,this._onEndEvent.bind(this,e)).on(n.RECOGNITION_EVENTS.MIC_DISABLED,this._onMicDisabled.bind(this,e)).on(n.RECOGNITION_EVENTS.MIC_ENABLED,this._onMicEnabled.bind(this,e)).on(n.RECOGNITION_EVENTS.ACTIVATING,this._onMicActivating.bind(this,e)),e.onAsyncReady&&e.onAsyncReady(()=>{this._updateActiveRecognizerStatus()})}start(e){return this._clearLoadingTimeout(),this._loadingTimeout=setTimeout(()=>{this.getView().setState(o.RECOGNIZER_STATES.PREPARING,!1)},2e3),this._updateActiveRecognizer(e),this.getActiveRecognizer().startListening(e),this}stop(){return this._clearLoadingTimeout(),this.isActive()&&(this.getView().setState(o.RECOGNIZER_STATES.LISTENING,!1).setState(o.RECOGNIZER_STATES.PREPARING,!1),this.getActiveRecognizer().stopListening()),this}setLanguage(e){this.getModel().setProperty("origLang",e),this.getActiveRecognizer()||this._updateActiveRecognizer(e);const t=this.getActiveRecognizer();return t&&t.convertLanguage(e,e=>{this.getModel().setProperty("lang",e||"")}),this}prepareData(e,t=this.getActiveRecognizer()){return t.prepareData(e,this.getModel().getProperty("index"))}isActive(){return this.getView().hasState(o.RECOGNIZER_STATES.PREPARING)||this.getView().hasState(o.RECOGNIZER_STATES.LISTENING)}getVisualizer(){return this.getActiveRecognizer().getVisualizer()}getActiveRecognizer(){return this._recognizer}syncView(){const e=this.getView(),t=this.getModel().isValid();e.setState(o.RECOGNIZER_STATES.INVALID,!t)}_updateActiveRecognizer(e){this._recognizer=this._recognizers.map(t=>[t.getPriority(e),t]).sort(([e],[t])=>t-e).map(([e,t])=>t)[0]}_updateActiveRecognizerStatus(){return this.setLanguage(this.getModel().getProperty("origLang"))}_onStartEvent(e,t){this._clearLoadingTimeout(),this.getView().setState(o.RECOGNIZER_STATES.LISTENING,!0).setState(o.RECOGNIZER_STATES.PREPARING,!1).setState(o.RECOGNIZER_STATES.ACTIVATING,!1),this.emit(n.RECOGNITION_EVENTS.START,t)}_onRecognizeEvent(e,t){this.emit(n.RECOGNITION_EVENTS.RECOGNIZE,this.prepareData(t,e))}_onMicDisabled(){this.getView().setEnabled(!0).setState(o.RECOGNIZER_STATES.ACTIVATING,!1),this.emit(n.RECOGNITION_EVENTS.MIC_DISABLED)}_onMicEnabled(){this.getView().setState(o.RECOGNIZER_STATES.ACTIVATING,!1),this.emit(n.RECOGNITION_EVENTS.MIC_ENABLED)}_onMicActivating(){this.getView().setState(o.RECOGNIZER_STATES.ACTIVATING),this.emit(n.RECOGNITION_EVENTS.ACTIVATING)}_onEndEvent(e,t){const s=this.getModel();this._clearLoadingTimeout(),this.isActive()&&this.getView().setState(o.RECOGNIZER_STATES.LISTENING,!1).setState(o.RECOGNIZER_STATES.PREPARING,!1),t!==n.RECOGNITION_ERRORS.ABORTED&&(this.emit(n.RECOGNITION_EVENTS.END,{error:t,index:s.getProperty("index")}),s.increaseIndex())}_clearLoadingTimeout(){clearTimeout(this._loadingTimeout),this._loadingTimeout=0}}t.SpeechRecognizerPresenter=r},function(e,t,s){"use strict";t.__esModule=!0,t.SpeechRecognizerUniproxy=t.SUPPORTED_LANGS=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(10),r=s(160),a=s(229),l=s(144);const c="Recognize",d="Result",u="InternalError",h={en:"en-GB",ru:"ru-RU",tr:"tr-TR",uk:"uk-UA"};t.SUPPORTED_LANGS=h;const p={"en-GB":"freeform","ru-RU":"dialogeneral","tr-TR":"freeform","uk-UA":"freeform"};class g extends l.SpeechRecognizerBase{static isAvailable(){return!n.default.iOS&&a.MEDIA_RECORDER_SUPPORTED||window.config.FORCE_UNIPROXY}constructor(e={}){super(e),this._streamId=null,this._recorder=null,this._currentMessageId="",this._uniproxy=e.uniproxy,this._timeout=e.timeout||7e3}_setTimeout(){return this._timeout&&(clearTimeout(this._timer),this._timer=setTimeout(this.stopListening.bind(this),this._timeout)),this}_clearTimeout(){this._timeout&&clearTimeout(this._timer)}stopListening(){if(!this._streamId||!this._currentMessageId)return;const e=r.STREAM_CONTROL_REASONS.NO_ERROR;return this._uniproxy.closeStream(this._streamId,this._currentMessageId,e),this._clean(),this._onAbort(),this}startRecognition(e){this._streamId||(this._recorder||(this._recorder=new a.AudioRecorder(this._handleMicrophoneData.bind(this))),this._recorder.start(300,()=>{this._uniproxy.on("*",this._handleUniproxyEvent,this),this._uniproxy.on(r.EVENTS.ERROR,this._handleError,this),this._streamId=this._uniproxy.startStream(),this._uniproxy.ensureConnection(()=>{if(this._currentMessageId=this._uniproxy.sendRequest("ASR",c,{lang:e,streamId:this._streamId,format:a.AUDIO_FORMAT,timeoutInMilliseconds:this._timeout,punctuation:!1,topic:p[e]}),!this._currentMessageId)return this._throwNetworkError();this._onStart()})}))}_clean(){this._recorder.stop(),this._streamId=0,this._currentMessageId="",this._uniproxy.off("*",this._handleUniproxyEvent,this),this._uniproxy.off(r.EVENTS.ERROR,this._handleError,this),this._clearTimeout()}_handleMicrophoneData(e){this._streamId&&e.size&&(this._uniproxy.sendStreamData(this._streamId,e,a.AUDIO_FORMAT)||this._throwNetworkError())}_handleUniproxyEvent(e,t){switch(e){case r.EVENTS.MESSAGE:this._handleMessage(t.data);break;case r.EVENTS.STREAM_CONTROL:this._handleTransportStreamControl(t.data);break;case r.EVENTS.CLOSE:this._throwNetworkError()}}_handleTransportStreamControl(e){e._streamId===this._streamId&&e.action===r.STREAM_CONTROL_ACTIONS.CLOSE&&(this._clean(),this.emit(l.RECOGNITION_EVENTS.END))}_handleMessage(e){if(!e)return;const{header:t}=e;if("ASR"===t.namespace)switch(t.name){case d:this._handleASRResult(e)}}_handleASRResult({header:e,payload:t}){t.responseCode!==u?this._currentMessageId&&t.recognition.length&&this._onResult(t.recognition[0].normalized,t.endOfUtt||t.earlyEndOfUtt):this._handleError({data:{header:e,payload:t},error:l.RECOGNITION_ERRORS.NETWORK})}_handleError(e){if(e&&e.data&&e.data.header){const{header:t}=e.data;t&&t.refMessageId===this._currentMessageId&&(this._throwNetworkError(),(0,o.getGlobalEmitter)().emit("uniproxyAsrError",e.error,{format:a.AUDIO_FORMAT,sampleRate:a.SAMPLE_RATE,recorderSupported:a.MEDIA_RECORDER_SUPPORTED?1:0}))}}_throwNetworkError(){this._clean(),this.emit(l.RECOGNITION_EVENTS.END,l.RECOGNITION_ERRORS.NETWORK)}_playSound(e){const t=new Audio;try{t.src=e,t.play()}catch(e){}}_onAbort(e){return this._clearTimeout(),this.emit(l.RECOGNITION_EVENTS.END,e)}_onStart(){return this._resultIndex=0,this._setTimeout(),this.emit(l.RECOGNITION_EVENTS.START,"uniproxy")}_onResult(e,t){const s={text:e,final:t,resultIndex:this._resultIndex};return e&&this._setTimeout(),t&&(this._resultIndex+=1),this.emit(l.RECOGNITION_EVENTS.RECOGNIZE,s)}convertLanguage(e,t){t(h[e]||"")}prepareData({text:e,final:t,resultIndex:s},i){return{value:n.default.trim(e),final:t,index:i,resultIndex:s}}getVisualizer(){return this._recorder&&this._recorder.getAnalyserNode()}getPriority(e){return n.default.isOnline()&&e===h.ru?l.RECOGNITION_PRIORITIES.HIGH:l.RECOGNITION_PRIORITIES.LOW}}t.SpeechRecognizerUniproxy=g},function(e,t,s){"use strict";t.__esModule=!0,t.SAMPLE_RATE=t.MEDIA_RECORDER_SUPPORTED=t.MEDIA_RECORDER_STATES=t.AudioRecorder=t.AUDIO_FORMAT=void 0;var i=s(230),n=s(178);const o={INACTIVE:"inactive",RECORDING:"recording",PAUSED:"paused"};t.MEDIA_RECORDER_STATES=o;const r=window.AudioContext||window.webkitAudioContext||null,a=Boolean(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&(window.MediaRecorder||r));t.MEDIA_RECORDER_SUPPORTED=a;const l=!window.MediaRecorder;t.SAMPLE_RATE=16e3;const c=function(){if(l)return n.AUDIO_FORMATS.WAV_PCM+";rate=16000";const e=window.MediaRecorder.isTypeSupported||window.MediaRecorder.isMimeTypeSupported||window.MediaRecorder.canRecordMimeType||(()=>!1);if(e(n.AUDIO_FORMATS.OGG))return n.AUDIO_FORMATS.OGG;if(e(n.AUDIO_FORMATS.WEBM))return n.AUDIO_FORMATS.WEBM;return n.AUDIO_FORMATS.WAV_PCM}();t.AUDIO_FORMAT=c;t.AudioRecorder=class{constructor(e){this.dataHandler=e}start(e=1e3,t){navigator.mediaDevices.getUserMedia({audio:!0}).then(s=>{this.mediaRecorder=function(e){const t={mimeType:c,audioBitsPerSecond:16e3};return l?new i.MediaRecorder(e,t):new window.MediaRecorder(e,t)}(s),this.mediaRecorder.state===o.INACTIVE&&(this.mediaRecorder.addEventListener("dataavailable",this.handleDataAvailable.bind(this)),this.mediaRecorder.addEventListener("error",this.handleError.bind(this)),this.mediaRecorder.start(e)),this.stream=s,t()}).catch(e=>{this.handleError()})}stop(){this.stream&&this.stream.getTracks&&this.stream.getTracks().forEach((function(e){e.stop()})),this.mediaRecorder&&(this.mediaRecorder.removeEventListener("dataavailable",this.handleDataAvailable.bind(this)),this.mediaRecorder.removeEventListener("error",this.handleError.bind(this)),this.mediaRecorder.state!==o.INACTIVE&&this.mediaRecorder.stop(),this.mediaRecorder=null,this.stream=null)}handleDataAvailable(e){this.dataHandler(e.data)}handleError(){this.stop()}getAnalyserNode(){return r&&this.stream?(this.audiocontext||(this.audiocontext=new r),this.analyserNode&&this.analyserNode.disconnect(),this.analyserNode=this.audiocontext.createAnalyser(),this.analyserNode.fftSize=2048,this.audioInput&&this.audioInput.disconnect(),this.audioInput=this.audiocontext.createMediaStreamSource(this.stream),this.audioInput.connect(this.analyserNode),this.analyserNode):null}}},function(e,t,s){"use strict";t.__esModule=!0,t.RECORDER_STATES=t.MediaRecorder=void 0;var i=s(231);const n=window.AudioContext||window.webkitAudioContext,o={INACTIVE:"inactive",RECORDING:"recording",PAUSED:"paused"};let r;t.RECORDER_STATES=o;let a=null;t.MediaRecorder=class{static isTypeSupported(e){return/audio\/x-pcm?/.test(e)||/audio\/x-raw?/.test(e)||/audio\/wave?/.test(e)}constructor(e,t){this.state=o.INACTIVE,this.mimeType="audio/x-pcm;bit=16",this.outSampleRate=16e3,this.em=document.createDocumentFragment(),this.stream=e,this.mimeType=t&&t.mimeType||this.mimeType,this.outSampleRate=t&&t.audioBitsPerSecond||this.outSampleRate,this.encoder=a||(a=new i.PcmEncoder),this.encoder.onDataReadyCallback=this._onEncoderResult.bind(this)}start(e){this.state===o.INACTIVE&&(this.state=o.RECORDING,r||(r=new n),this._initEncoder(),this.input=r.createMediaStreamSource(this.stream),this.processor=r.createScriptProcessor(2048,2,2),this.input.connect(this.processor),this.processor.connect(r.destination),this.processor.onaudioprocess=this._onAudioProcess.bind(this),this.dispatchEvent(new Event("start")),e&&(this.slicing=window.setInterval(this._onTimeSliceInterval.bind(this),e)))}_initEncoder(){this.encoder.init&&this.encoder.init({sampleRate:r.sampleRate,outSampleRate:this.outSampleRate})}_requestData(){this.state!==o.INACTIVE&&this.encoder.requestData()}_onEncoderResult(e){const t=new Blob([e],{type:this.mimeType}),s=new MessageEvent("dataavailable",{data:t});this.dispatchEvent(s),this.state===o.INACTIVE&&this.dispatchEvent(new Event("stop"))}_onAudioProcess(e){this.state===o.RECORDING&&this.encoder.handleAudioInput(e.inputBuffer)}_onTimeSliceInterval(){this.state===o.RECORDING&&this._requestData()}stop(){this.state!==o.INACTIVE&&(this._requestData(),this.state=o.INACTIVE,clearInterval(this.slicing),this.stream.getAudioTracks().forEach(e=>{e.stop()}),this.input.disconnect(this.processor),this.processor.disconnect(r.destination),this.processor.onaudioprocess=null,delete this.processor,delete this.input)}pause(){this.state===o.RECORDING&&(this.state=o.PAUSED,this.dispatchEvent(new Event("pause")))}resume(){this.state===o.PAUSED&&(this.state=o.RECORDING,this.dispatchEvent(new Event("resume")))}addEventListener(...e){this.em.addEventListener.apply(this.em,e)}removeEventListener(...e){this.em.removeEventListener.apply(this.em,e)}dispatchEvent(...e){return this.em.dispatchEvent.apply(this.em,e)}}},function(e,t,s){"use strict";t.__esModule=!0,t.PcmEncoder=void 0;var i,n=(i=s(232))&&i.__esModule?i:{default:i};t.PcmEncoder=class{constructor(){this.worker=function(e){const t=e.toString().replace(/^function\s*\(\)\s*{/,"").replace(/}$/,""),s=new Blob([t]);return new Worker(URL.createObjectURL(s))}(n.default),this.worker.addEventListener("message",this.handleResultFromWorker.bind(this))}init(e){this.worker.postMessage(["init",{sampleRate:e.sampleRate,format:{sampleRate:e.outSampleRate,bufferSize:2048},channels:1}])}handleAudioInput(e){this.worker.postMessage(["encode",e.getChannelData(0)])}requestData(){this.worker.postMessage(["dump"])}handleResultFromWorker(e){this.onDataReadyCallback(e.data)}}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0;t.default="function() {\n    var recLength = 0;\n    var recBuffers = [];\n    var sampleRate;\n    var outSampleRate;\n    var needBufferSize = 4096;\n    var channels = 1;\n\n    function init(config) {\n        sampleRate = config.sampleRate;\n        outSampleRate = config.format.sampleRate || sampleRate;\n        needBufferSize = config.format.bufferSize || needBufferSize;\n    }\n\n    var resample = (inbuf) => {\n        var speed = Number(sampleRate) / outSampleRate;\n        var l = Math.ceil(inbuf.length / speed);\n        var result = new Float32Array(l);\n        var indexIn = 0;\n        var indexOut = 0;\n        for (indexOut = 1, indexIn = speed; indexOut < l - 1; indexIn += speed, indexOut++) {\n            var pos = Math.floor(indexIn);\n            var dt = indexIn - pos;\n            var second = (pos + 1 < inbuf.length) ? pos + 1 : inbuf.length - 1;\n            result[indexOut] = inbuf[pos] * (1 - dt) + inbuf[second] * dt;\n        }\n        result[0] = inbuf[0];\n        result[l - 1] = inbuf[inbuf.length - 1];\n        return result;\n    };\n\n    function record(inputBuffer) {\n        if (outSampleRate === sampleRate) {\n            recBuffers.push(inputBuffer);\n            recLength += inputBuffer.length;\n        } else {\n            var resin = resample(inputBuffer);\n            recBuffers.push(resin);\n            recLength += resin.length;\n        }\n    }\n\n    function exportWAV() {\n        var buffer = mergeBuffers(recBuffers, recLength);\n        var dataView = encodeWAV(buffer);\n        return dataView.buffer;\n    }\n\n    function clear() {\n        recLength = 0;\n        recBuffers = [];\n    }\n\n    function mergeBuffers(recBuffersArg, recLengthArg) {\n        var result = new Float32Array(recLengthArg);\n        var offset = 0;\n        for (var i = 0; i < recBuffersArg.length; i++) {\n            result.set(recBuffersArg[i], offset);\n            offset += recBuffersArg[i].length;\n        }\n        return result;\n    }\n\n    function floatTo16BitPCM(output, offset, input) {\n        for (var i = 0; i < input.length; i++, offset += 2) {\n            var s = Math.max(-1, Math.min(1, input[i]));\n            output.setInt16(offset, s < 0 ? s * 32768 : s * 32767, true);\n        }\n    }\n\n    function writeString(view, offset, string) {\n        for (var i = 0; i < string.length; i++) {\n            view.setUint8(offset + i, string.charCodeAt(i));\n        }\n    }\n\n    function encodeWAV(samples) {\n        var buffer = new ArrayBuffer(44 + samples.length * 2);\n        var view = new DataView(buffer);\n        /* RIFF identifier */\n        writeString(view, 0, 'RIFF');\n        /* file length */\n        view.setUint32(4, 32 + samples.length * 2, true);\n        /* RIFF type */\n        writeString(view, 8, 'WAVE');\n        /* format chunk identifier */\n        writeString(view, 12, 'fmt ');\n        /* format chunk length */\n        view.setUint32(16, 16, true);\n        /* sample format (raw) */\n        view.setUint16(20, 1, true);\n        /* channel count */\n        view.setUint16(22, channels, true);\n        /* sample rate */\n        view.setUint32(24, outSampleRate, true);\n        /* block align (channel count * bytes per sample) */\n        var blockAlign = channels * 2;\n        /* byte rate (sample rate * block align) */\n        view.setUint32(28, outSampleRate * blockAlign, true);\n        /* block align (channel count * bytes per sample) */\n        view.setUint16(32, blockAlign, true);\n        /* bits per sample */\n        view.setUint16(34, 16, true);\n        /* data chunk identifier */\n        writeString(view, 36, 'data');\n        /* data chunk length */\n        view.setUint32(40, samples.length * 2, true);\n        floatTo16BitPCM(view, 44, samples);\n        return view;\n    }\n\n    function dump() {\n        var result = exportWAV();\n        postMessage(result, [result]);\n        clear();\n    }\n\n    onmessage = (e) => {\n        var command = e.data[0];\n        var data = e.data[1];\n        switch (command) {\n            case 'init':\n                init(data);\n                break;\n            case 'encode':\n                record(data);\n                break;\n            case 'dump':\n                dump();\n                break;\n            default:\n                break;\n        }\n    };\n}"},function(e,t,s){"use strict";t.__esModule=!0,t.initPredictor=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(150),r=s(173),a=s(11),l=s(143),c=s(161);t.initPredictor=function(e){const t=this,s=this.getView(),i=this.getSettings(),d=this.getModel(),u=d.toJSON(),h=this.getMeasurerViewSrc(),p=this.getPredictorPresenter(),g=p.getView();return this.on([c.TEXTAREA_APP_EVENTS.BLUR,c.TEXTAREA_APP_EVENTS.TAP],n.default.debounce(()=>{g.setEnabled(!1)},150)).on(c.TEXTAREA_APP_EVENTS.FOCUS,e=>{e&&g.setEnabled(!1)}).on(c.TEXTAREA_APP_EVENTS.KEYDOWN,e=>{switch(e.keyCode){case a.InputView.keys.ENTER:if(e.shiftKey)break;i.isOptionEnabled(l.AVAILABLE_OPTIONS.ENTER)||n.default.preventEvent(e),g.isEnabled()&&(n.default.preventEvent(e),p.setValue(g.getValues()[0],{enter:!0})),this.updateTrText("enter");break;default:e.keyCode===a.InputView.keys.ESCAPE&&g.isEnabled()&&this.updateTrText("escape"),g.setEnabled(!1)}}),this.on("action:toggleAuto",()=>{p.toggleAuto()}),d.on("change",(t,s,i)=>{let n,o;switch(t){case"text":if("url"===i.sender&&e.DEFAULT_SRC_LANG)return;o=this.toJSON(),n=i.caret?i.caret+s.slice(i.caret).search(/\s|$/):0,p.setText(r.PredictorModel.extractWords(s.slice(0,n),"paste"===i.reason?e.MAX_PREDICTOR_WORDS:e.MIN_PREDICTOR_WORDS),i.sender||i.reason).setIndex(n).setSrcLanguage(o.srcLang).setDstLanguage(o.dstLang);break;case"srcLang":p.setSrcLanguage(s,{reason:"lang"});break;case"dstLang":p.setDstLanguage(s);break;case"textScrollY":g.setEnabled(!1)}}),p.prepareData=e=>({values:[{value:e[0]}],value:e[0]}),p.on("auto",e=>{s.setState("auto",e),i.setProperty("auto",e)}).on("ready",e=>{const s=d.getProperty("text");if("input"!==e.reason)return g.setEnabled(!1);const i=o.PredictorPresenter.createRange(s,e);if(!i)return g.setEnabled(!1);h.renderData({text:s.slice(i.start,i.end)||".",leftText:s.slice(0,i.start),rightText:s.slice(i.end)}).scrollTo(h.getScrollInfo().maxTop/100*d.getProperty("textScrollY"));const n=h.getContentElement("[data-measurer-target]");n&&g.setPosition(n.getBoundingClientRect(),!1,!0),t.emit("predictorShow",e)}).on("detect",(e,s)=>{s||t.setSrcLanguage(e)}).on("predict",(e,s)=>{const i=r.PredictorModel.prepareValue(d.getProperty("text"),e);d.setProperty("text",i.text,{caret:i.caret,sender:"predictor"}),t.emit("predictorApply",e,s.enter)}).on("endOfWord",()=>{t.emit("predictorEndOfWord").updateTrText()}),u.srcLang&&p.setSrcLanguage(u.srcLang),u.dstLang&&p.setDstLanguage(u.dstLang),p.toggleAuto(!i.hasProperty("auto")||i.getProperty("auto")),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initCollections=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(2),r=s(29),a=s(167),l=s(149),c=s(235),d=s(132),u=s(11),h=s(138),p=s(236),g=s(139),m=s(72),E=s(237),_=s(24),T=s(179),f=s(180),S=s(181),C=s(4),y=s(182),A=s(45),v=s(183),L=s(186);t.initCollections=function(e){let t;const s=this,i=this.getView(),R=this._settings,P=this.getModel(),O=(0,v.getCollectionsEmitter)(),I=new o.TouchView({element:e.ELEMENTS.favButton}),b=new o.TouchView({element:e.ELEMENTS.collectionsView,hideAfterTransition:!0}),x=new r.ListboxView({element:e.ELEMENTS.collectionList,template:e.TEMPLATES.collections,contentElement:e.ELEMENTS.collectionListContent,debounceRendering:!0}),N=new a.CollectionModel({srv:e.SRV,uid:e.UID,url:e.COLLECTIONS_URL,limit:e.MAX_COLLECTIONS,recordsLimit:e.MAX_FAV_ITEMS2,xtoken:e.CSRF_TOKEN,shouldSyncHistory:e.ENABLE_HISTORY_SYNC},{defaultFavName:e.DEFAULT_FAV_NAME,defaultHistoryName:e.DEFAULT_HISTORY_NAME,validators:{items(){return this.getItems()},text:t=>t&&t.length<=e.MAX_FAV_TEXT_LENGTH&&!n.default.isUrl(t),srcLang:e=>e,dstLang:e=>e,translation:t=>t&&t.length<=e.MAX_FAV_TEXT_LENGTH,activeId(e){const t=this.getItems();return t&&t.filter((function(t){return t.id===e&&l.CollectionServerModel.isNotDeleted(t)&&!l.CollectionServerModel.isSubscription(t)})).length}}}),M=new c.CollectionPresenter({view:x,model:N}),w=new d.InputPresenter({view:new u.InputView({element:e.ELEMENTS.collectionSearch,activateFocus:!0,contentElement:e.ELEMENTS.collectionSearchInput}),model:new h.InputModel}),D=w.getView(),V=new u.InputView({element:e.ELEMENTS.collectionName,activateFocus:!0,contentElement:e.ELEMENTS.collectionNameInput}),k=new p.CollectionNameInputPresenter({view:V,model:new h.InputModel}),H=new o.TouchView({element:e.ELEMENTS.addCollectionButton}),U=new o.TouchView({element:e.ELEMENTS.createCollectionButton}),$=new u.InputView({element:e.ELEMENTS.collectionAddPopup,activateFocus:!0,contentElement:e.ELEMENTS.collectionNameInput2}),B=new p.CollectionNameInputPresenter({view:$,model:new h.InputModel}),G=new u.InputView({element:e.ELEMENTS.collectionsNameEditPopup,activateFocus:!0,contentElement:e.ELEMENTS.collectionNameInput3}),F=new p.CollectionNameInputPresenter({view:G,model:new h.InputModel}),Y=new r.ListboxView({element:e.ELEMENTS.topList,template:e.TEMPLATES.collections,debounceRendering:!0}),W=new g.ListboxPresenter({view:Y,model:new m.ListboxModel}),K=new r.ListboxView({element:e.ELEMENTS.recordsList,template:e.TEMPLATES.records,contentElement:e.ELEMENTS.recordsListContent,debounceRendering:!0}),X=new E.ListboxMultiplePresenter({view:K,model:new m.ListboxModel}),j=new r.ListboxView({element:e.ELEMENTS.subscribeTooltip,template:e.TEMPLATES.empty}),q=new o.TouchView({element:e.ELEMENTS.collectionMenuButton,activateFocus:!0}),z=new g.ListboxPresenter({view:new r.ListboxView({element:e.ELEMENTS.collectionMenuListbox,template:e.TEMPLATES.menu,stopDefaultAction:!0}),model:new m.ListboxModel}),J=z.getView(),Q=new o.TouchView({element:e.ELEMENTS.recordMovePopup,activateFocus:!0}),Z=new r.ListboxView({element:e.ELEMENTS.recordMovePopupList,template:e.TEMPLATES.collectionsPopupList}),ee=new o.TouchView({element:e.ELEMENTS.recordCopyPopup,activateFocus:!0}),te=new r.ListboxView({element:e.ELEMENTS.recordCopyPopupList,template:e.TEMPLATES.collectionsPopupList}),se=new o.TouchView({element:e.ELEMENTS.collectionHeader,contentElement:e.ELEMENTS.collectionHeaderName}),ie=new r.ListboxView({element:e.ELEMENTS.collectionHeaderContent,template:e.TEMPLATES.collectionHeader}),ne=new o.TouchView({element:e.ELEMENTS.collectionTumbler}),oe=new _.TemplateView({element:e.ELEMENTS.collectionsToast,template:e.TEMPLATES.collectionsToast}),re=new o.TouchView({element:e.ELEMENTS.collectionNewAddPopup,activateFocus:!0}),ae=new r.ListboxView({element:e.ELEMENTS.collectionsPopupList,template:e.TEMPLATES.collectionsPopupList}),le=new o.TouchView({element:e.ELEMENTS.shareCollectionTumbler}),ce=new o.TouchView({element:e.ELEMENTS.shareCollectionInput,stopDefaultAction:!0}),de=new o.TouchView({element:e.ELEMENTS.shareCollectionCopy,activateFocus:!0}),ue=new T.SharePresenter({view:new r.ListboxView({element:e.ELEMENTS.shareCollection,template:e.TEMPLATES.listbox,contentElement:e.ELEMENTS.shareCollectionContent,stopDefaultAction:!0}),model:new f.ShareModel({url:e.SHARE_URL,title:document.title})}),he=ue.getView(),pe=new o.TouchView({element:e.ELEMENTS.selectAllButton}),ge=new S.TTSPresenter({view:new o.TouchView({stopDefaultAction:!0}),model:new C.Model}),me=function(){const e=this.toJSON();M.setText(e.trText).setSrcLanguage(e.srcLang).setDstLanguage(e.dstLang).setTranslation(e.translation).checkRecord(),oe.setVisible(!1)},Ee=function(e){let t=0;const s=X.getSelectedItems(),{recordsLimit:i}=N.getProps();return s.length?t=s.length:b.isVisible()||(t=1),{collections:e.filter((function(e){return!l.CollectionServerModel.isSubscription(e)&&l.CollectionServerModel.isNotDeleted(e)&&e.type!==l.COLLECTION_TYPES.HISTORY})).map((function(e){return{color:e.color,private:e.type!==l.COLLECTION_TYPES.FAVORITES&&!e.public,disabled:e.recordsCount+t>i,collectionId:e.id,collectionType:e.type,collectionName:e.name,collectionIcon:e.type===l.COLLECTION_TYPES.FAVORITES?"":e.name.charAt(0),collectionCount:e.recordsCount}}))}},_e=function(e,t){return{collectionId:e.id,collectionType:e.type,recordsCount:e.recordsCount||e.count||0,subscribersCount:e.subscribersCount,author:e.authorName,subscribed:t}},Te=function(t){const i=Date.now();b.hasState("sync")||(R.getProperty("syncedTimestamp")||0)+e.PRESYNC_TIMEOUT>i?M.getCollectionList():(e.UID&&(R.setProperty("syncedTimestamp",i),s.emit("collectionsSync",t)),b.setState("sync",!0),M.syncCollections())},fe=()=>{N.setProperty("shouldSyncHistory",e.ENABLE_HISTORY_SYNC&&P.getProperty("historyEnabled"))};return(0,L.getAvailablePlayers)(e,this._uniproxy).forEach(e=>{ge.addPlayer(e)}),I.on("tap",(function(){let t,i=M.getItems().filter((function(e){return e.id===M.getActiveId()}))[0];if(i.type===l.COLLECTION_TYPES.HISTORY){const e=M.getCollectionByType(l.COLLECTION_TYPES.FAVORITES);if(!e)return;M.setActiveId(e.id),i=e}this.hasState("favourite")?(oe.renderData({deleted:!0,message:n.default.parseString(e.COLLECTION_TOAST_MESSAGES.deleted,i.name)}),M.getActive(),s.emit("recordDelete",i.id)):(t=i.recordsCount>=N.getProperty("recordsLimit"),t||M.addRecords(),oe.renderData({message:n.default.parseString(e.COLLECTION_TOAST_MESSAGES[t?"limit":"added"],i.name)}),s.emit("recordAdd",t,i.id)),oe.setVisible(!0),re.setVisible(!1)})).on("stateChanged:favourite",(function(t){this.getElement().setAttribute("data-tooltip",t?e.TOOLTIPS.collections2:e.TOOLTIPS.collections)})),oe.on("tap",(function(){this.setVisible(!1)})).on("contentChanged",(function(){clearTimeout(t),t=setTimeout((function(){oe.setVisible(!1)}),e.POPUP_DELAY)})).on("stateChanged:hidden",(function(e){e&&clearTimeout(t)})),j.on("stateChanged:hidden",(function(e){e||setTimeout((function(){j.setVisible(!1)}),1200)})),this.on("toggleCollections",(function(e){b.setVisible(e)})).on("editorResult",(function(e){M.setTranslation(e).checkRecord()})).on("action",(function(t,o){let r,a,c,d,u,h;switch(t){case"toggleFav":if(i.hasState("db_inactive")){s.emit("collectionsInactiveTap"),i.setState({db_overlay:!0,db_blocked:R.getProperty("databaseBlocked")});break}b.setVisible(),s.emit("collectionsActivated",b.isVisible());break;case"closeDbOverlay":i.setState("db_overlay",!1);break;case"collectionsReturn":b.setState({add:!1,records:!1,select:!1,copy:!1}),w.setValue(""),M.setValue("").getCollectionList(),W.setValue("");break;case"closeAddPopup":$.setVisible(!1);break;case"closeRecordMovePopup":Q.setVisible(!1),ee.setVisible(!1),re.setVisible(!1);break;case"recordsReturn":b.setState({records:!0,select:!1,copy:!1,menu:!1});break;case"addCollection":if(b.hasState("limit"))return void j.setPosition(o.getBoundingClientRect(),!0).setVisible(!0);s.emit("newCollectionTap"),k.setValue(M.getDefaultName(e.DEFAULT_COLLECTION_NAME)),V.setSelection({start:0,end:k.getValue().length}),ne.setState("active",!0),b.setState("add",!0);break;case"addCollection2":re.setVisible(!1),ee.setVisible(!1),Q.setVisible(!1),B.setValue(""),$.setVisible(!0).setFocus(!0);break;case"createCollectionAndAdd":if(r=n.default.trim(B.getValue()),r){if(V.setFocus(!0),b.hasState("limit")){$.setState("limit",!0);break}if(a=M.getItems().filter((function(e){return e.name===r})),a.length){$.setState("alert",!0);break}M.createCollection({name:r,public:!1},!0),$.setVisible(!1),re.setVisible(!1),b.hasState("copy")||b.hasState("select")||(oe.renderData({message:n.default.parseString(e.COLLECTION_TOAST_MESSAGES.added,r)}),oe.setVisible(!0))}else $.setFocus(!0);break;case"deleteRecord":u=M.getValue(),c=M.getSelectedCollection(),o&&c&&!l.CollectionServerModel.isSubscription(c)&&(s.emit("recordDelete",u),M.deleteRecords(o.getAttribute("data-index")).setActiveId(u),c.recordsCount=c.recordsCount-1,ie.renderData(_e(c)));break;case"deleteRecords":a=X.getValue(),u=M.getValue(),s.emit("recordsDelete",{count:a.length,total:X.getItems().length}),M.deleteRecords(a).setActiveId(u),b.setState("select",!1);break;case"moveRecords":a=M.getItems(),u=M.getValue(),M.setActiveId(u),Z.renderData(Ee(a)),Q.setVisible(!0);break;case"changeCollection":a=M.getItems(),ae.renderData(Ee(a)),re.setVisible(!0),oe.setVisible(!1);break;case"closeCollectionPopup":oe.setVisible(!1),G.setVisible(!1),he.setVisible(!1);break;case"deleteCollection":if(!window.confirm(n.default.getAttribute(o,"data-confirm")))break;c=M.getSelectedCollection(),M.deleteCollection(M.getValue()),b.setState("records",!1),l.CollectionServerModel.isSubscription(c)?s.emit("collectionUnsubscribe",l.COLLECTION_TYPES.BROKEN_SUBSCRIPTION):s.emit("collectionDeleted");break;case"clearCollection":if(!window.confirm(n.default.getAttribute(o,"data-confirm")))break;a=X.getItems().map(e=>e.id),M.deleteRecords(a),M.setValue(""),b.setState("records",!1),s.emit("collectionCleared");break;case"disableHistory":b.setVisible(!1),s.emit("collectionsActivated",b.isVisible()),setTimeout(()=>{M.setValue(""),b.setState("records",!1),this.emit("interactiveSettingChange",{settingKey:"history",enabled:!1})},700);break;case"syncCollections":Te(!0);break;case"editRecords":b.setState("select",!0);break;case"editSubscriptionRecords":b.setState("copy",!0);break;case"editCollection":r=M.getSelectedCollection().name,F.setValue(r),G.setVisible(!0).setFocus(!0);break;case"renameCollection":if(r=n.default.trim(F.getValue()),u=M.getValue(),r){if(a=M.getItems().filter((function(e){return e.name===r})),a.length)return void G.setState("alert",!0);G.setVisible(!1),M.updateCollection(u,{name:r}).setValue(""),b.setState("records",!1),s.emit("collectionRenamed")}else G.setFocus(!0);break;case"subscribe":if(d=n.default.getAttribute(o,"data-subscribe-type"),!e.UID)return void s.emit("collectionSubscribed",d);if(b.hasState("limit"))return j.setPosition(o.getBoundingClientRect(),!0).setVisible(!0),void s.emit("collectionSubscribed",d,!0);u=W.getValue()?W.getValue():n.default.getAttribute(o,"data-index","0"),c=W.getItems().filter((function(e){return e.id===u}))[0],M.subscribeToCollection(c),b.setState("records",!1),W.setValue(""),s.emit("collectionSubscribed",d);break;case"unsubscribeFromCollection":window.confirm(n.default.getAttribute(o,"data-confirm"))&&(u=M.getValue()||n.default.getAttribute(o,"data-index","0"),u||(u=W.getValue(),u=M.getItems().filter((function(e){return e.sourceCollectionId===u}))[0].id),M.deleteCollection(u).setValue(""),b.setState("records",!1),W.setValue(""),s.emit("collectionUnsubscribed",l.COLLECTION_TYPES.SUBSCRIPTION));break;case"saveCollection":M.saveCollection(),s.emit("collectionSaved");break;case"shareCollection":c=M.getSelectedCollection(),h=c&&l.CollectionServerModel.isSubscription(c),c&&!h&&le.setState("active",c.public),he.setState({top:Boolean(W.getValue()),subscription:h}).setVisible(!0);break;case"copyRecords":a=M.getItems(),te.renderData(Ee(a)),ee.setVisible(!0);break;case"expandSearch":case"collapseSearch":b.setState("search"),w.setValue(""),D.setFocus("expandSearch"===t);break;case"soundCollection":ge.setText(n.default.trim(n.default.getAttribute(o,"data-text"))).setLanguage(n.default.getAttribute(o,"data-lang")).toggle();break;case"collectionMail":ue.write()}})).on(y.HISTORY_APP_EVENTS.OPEN_HISTORY,()=>{const e=M.getHistoryCollectionId();e&&(b.setState("prevent-animation",!0),M.setValue(e),b.setVisible(),s.emit("collectionsActivated",b.isVisible()),setTimeout(()=>b.setState("prevent-animation",!1),200))}).addHotKey(A.HOT_KEYS_MAP.FAV,{view:I,getActionName:()=>I.hasState("favourite")?"fav_record_delete":"fav_record_add"}).bindFocusActivation(I),i.on("stateChanged:edited",(function(e){e||M.setTranslation(P.getProperty("translation"))})).on("keydown",e=>{e.keyCode===u.InputView.keys.ESCAPE&&b.isVisible()&&(b.setVisible(!1),s.emit("collectionsActivated",!1))}),P.onSet("translation",me).onChange("historyEnabled",e=>{M.emit("updateView"),fe(),e&&Te()}),b.on("stateChanged",(function(e,t){let n;switch(e){case"hidden":n=!t,i.setState("favourite",n),s.emit("collectionsOpened",n),t?(this.setState({add:!1,menu:!1,select:!1,copy:!1}),W.setValue("")):(Te(),oe.setVisible(!1),re.setVisible(!1),W.getItems()||M.getTopCollectionsList());break;case"records":t||this.setState("search",!1);break;case"select":case"copy":t||(X.setValue([]),pe.setState("selected",!1))}})),M.prepareData=function(t){const s={collection:e.COLLECTION_TITLES.collection,subscription:e.COLLECTION_TITLES.subscription},i={blocks:[]};let o=[];const r=t.filter((function(e){return l.CollectionServerModel.isNotDeleted(e)}));if(n.default.isEmpty(r))return i;const{historyEnabled:a}=P.getProps();return i.blocks.push({header:s.collection,collections:r.filter((function(e){return!l.CollectionServerModel.isSubscription(e)&&(e.type!==l.COLLECTION_TYPES.HISTORY||a)})).map((function(e){return{color:e.color,isHistory:e.type===l.COLLECTION_TYPES.HISTORY,private:e.type!==l.COLLECTION_TYPES.FAVORITES&&e.type!==l.COLLECTION_TYPES.HISTORY&&!e.public,collectionId:e.id,collectionType:e.type,collectionName:e.name,collectionCount:e.recordsCount}}))}),o=r.filter((function(e){return l.CollectionServerModel.isSubscription(e)})),o.length&&i.blocks.push({header:s.subscription,collections:o.map((function(e){return{color:e.color,collectionId:e.id,collectionName:e.name,collectionIcon:e.name.charAt(0),collectionCount:e.count||e.recordsCount,collectionAuthor:e.authorName,broken:e.type===l.COLLECTION_TYPES.BROKEN_SUBSCRIPTION}}))}),i},M.on("itemsChanged",(function(t,i){const n=this.getItems();!R.hasProperty("usingCollections")&&n.length>1&&R.setProperty("usingCollections",Date.now()),i||(this.initializeActiveId(R.getProperty("activeId")),window.location.pathname===e.COLLECTIONS_PATHNAME&&b.setVisible(!0),s.emit("firstCollectionsChange"))})).on("valueChanged",(function(t){if(!t)return;const s=this.getSelectedCollection();if(X.setItems(""),b.setState("broken",!1),!s)return b.setState("records",!1),void M.setValue("");const i=se.getElement(),n=J.getElement();ie.renderData(_e(s)),se.setContent(s.name,{asText:!0}),K.getElement().setAttribute("data-collection-type",s.type),i.setAttribute("data-collection-type",s.type),i.setAttribute("data-color",s.color||""),n.setAttribute("data-collection-type",s.type),n.setAttribute("data-subscribed",""),M.getHistoryCollectionId()===s.id?z.setItems(e.HISTORY_MENU_ITEMS):l.CollectionServerModel.isSubscription(s)?s.type===l.COLLECTION_TYPES.BROKEN_SUBSCRIPTION?b.setState("broken"):z.setItems(e.SUBSCRIPTION_MENU_ITEMS):z.setItems(e.COLLECTION_MENU_ITEMS)})).on("addToNewCollection",(function(e){if(b.hasState("copy")||b.hasState("select")){const t=X.getSelectedItems();s.emit(b.hasState("select")?"recordsMoved":"recordsCopy",{count:t.length,sender:"list",new:1}),b.hasState("select")?(M.moveRecords(t,e),b.setState("select",!1)):(M.addRecords(t,e).setValue(e),b.setState("copy",!1))}else M.getValue()&&b.isVisible()?(M.addRecords(X.getItems(),e).deleteCollection(M.getValue()),b.setState("records",!1)):(this.addToNewCollection(e),s.emit("recordsMoved",{count:1,sender:"toast",new:1}))})).on("collectionsSynced",(function(){b.setState("sync",!1),Y.renderData(W.prepareData(W.getItems())),O.emit(v.COLLECTION_EVENTS.SYNCED,M)})).on("collectionsSet",(function(){O.emit(v.COLLECTION_EVENTS.COLLECTIONS_SET,M)})).on("noCollectionForActiveId",(function(){s.emit("noCollectionForActiveId")})).on("activeIdChanged",(function(e){R.setProperty("activeId",e)})).on("recordsReceived",(function(e){X.setItems(e),b.setState("records",!0);const t=M.getSelectedCollection()||W.getItems().find(e=>e.id===W.getValue());t.recordsCount=e.length,ie.renderData(_e(t))})).on("gotTopList",(function(e){W.setItems(e)})).on("checked",(function(e){!function(e){I.setState("favourite",e),I.setEnabled(I.hasState("favourite")||N.isValid())}(e)})).on("checkLimit",(function(e){b.setState("limit",e>=N.getProperty("limit")),H.setState("disabled",e>=N.getProperty("limit"))})).on("dbReady",(function(){i.setState("db_inactive",!1),Te(),O.emit(v.COLLECTION_EVENTS.DB_READY,M)})).on("resetedIds",(function(){s.emit("resetedIds")})).on("checkRecordError",(function(e){s.emit("checkRecordError",e)})).on("upgradeneeded",(function(){R.setProperty("databaseBlocked",!1)})).on("databaseError",(function(e){"blocked"===e.sender&&R.setProperty("databaseBlocked",!0),s.emit("databaseError",e)})),N.on("dbIndexNotFound",(function(e){s.emit("dbIndexNotFound",e)})).onChange("syncedUid",(function(e){R.setProperty("syncedUid",e)})),R.hasProperty("syncedUid")&&N.setProperty("syncedUid",R.getProperty("syncedUid")),P.hasProperty("historyEnabled")&&fe(),W.prepareData=function(t){const s={blocks:[]};let i=[];const o=M.getItems();return n.default.isEmpty(t)||(o&&(i=o.filter((function(e){return l.CollectionServerModel.isNotDeleted(e)&&e.type===l.COLLECTION_TYPES.SUBSCRIPTION}))),s.blocks.push({header:e.COLLECTION_TITLES.top,collections:t.map((function(e){const t=i.filter((function(t){return t.sourceCollectionId===e.id}));return{color:e.color,popular:!0,collectionId:e.id,collectionName:e.name,collectionCount:e.count,collectionAuthor:e.authorName,subscribeButton:!M.isMyCollection(e),subscribed:Boolean(t.length)}}))})),s},W.on("valueChanged",(function(t){let s=[];if(!t)return;const i=this.getItems().find((function(e){return e.id===t}));X.setItems(""),b.setState("broken",!1);const n=se.getElement(),o=J.getElement();M.isMyCollection(i)?o.setAttribute("data-subscribed",""):(s=M.getItems().filter((function(e){return e.sourceCollectionId===t&&e.type===l.COLLECTION_TYPES.SUBSCRIPTION&&l.CollectionServerModel.isNotDeleted(e)})),K.getElement().setAttribute("data-subscribed",Boolean(s.length)),n.setAttribute("data-subscribed",Boolean(s.length)),o.setAttribute("data-subscribed",Boolean(s.length))),ie.renderData(_e(i,Boolean(s.length))),o.setAttribute("data-collection-type","popular"),M.getTopCollection(t),se.setContent(i.name,{asText:!0}),n.setAttribute("data-color",i.color||""),n.setAttribute("data-collection-type","popular"),K.getElement().setAttribute("data-collection-type","popular"),z.setItems(e.SUBSCRIPTION_MENU_ITEMS)})),ae.on("itemSelected",(function(t){const i=s.toJSON(),o=M.getRecords(),r=M.getItems();if(!t)return;const a=r.filter((function(e){return e.id===t}))[0];if(t===M.getActiveId())return void re.setVisible(!1);const l=o.find((function(e){return i.text===e.text&&i.srcLang+"-"+i.dstLang===e.lang&&i.translation===e.translation}));l?M.moveRecords(l,t):M.addRecords(null,t),s.emit("recordsMoved",{count:1,sender:"toast",new:0}),M.setActiveId(t),oe.renderData({message:n.default.parseString(e.COLLECTION_TOAST_MESSAGES.added,a.name)}).setVisible(!0),re.setVisible(!1)})),K.on("stateChanged:empty",(function(e){q.setState("empty",e),D.setVisible(!e)})),X.prepareData=function(e){const t={},s=X.getValue();if(!e.length)return t;const i=e.filter((function(e){return!e.filtered}));return t.empty=!i.length,t.items=i.map((function(e){const t=e.lang.split("-");return{id:e.id,collectionId:e.collectionId,srcLang:t[0],dstLang:t[1],text:e.text,translation:e.translation,selected:s.indexOf(e.id)>=0,srcDir:n.default.isRTLLang(t[0])?"rtl":"ltr",dstDir:n.default.isRTLLang(t[1])?"rtl":"ltr"}})),t},X.on("itemSelected",(function(){let e;const t=this.getSelectedItems()[0];!t||b.hasState("select")||b.hasState("copy")||(e=t.lang.split("-"),M.setActiveId(t.collectionId),b.setVisible(!1),P.setProperty({text:t.text,srcLang:e[0],dstLang:e[1]},{sender:"collections"}),s.emit("recordInsert"),this.setValue([]))})),ne.on("tap",(function(){this.setState("active")})),U.on("tap",(function(){const e=n.default.trim(k.getValue());e?U.hasState("inactive")?V.setState(b.hasState("limit")?"limit":"alert",!0):(s.emit("collectionCreated",ne.hasState("active")),M.createCollection({name:e,public:ne.hasState("active")}),b.setState("add",!1)):V.setFocus(!0)})),k.getModel().on("change",(function(e,t){switch(e){case"value":const e=n.default.trim(t).toUpperCase();if(!e||b.hasState("limit"))U.setState("inactive",!0);else{const t=M.getItems().filter((function(t){return t.name.toUpperCase()===e&&l.CollectionServerModel.isNotDeleted(t)&&!l.CollectionServerModel.isSubscription(t)}));U.setState("inactive",t.length)}}})),Z.on("itemSelected",(function(e){if(!e)return;if(e===M.getActiveId())return void Q.setVisible(!1);const t=X.getSelectedItems();M.moveRecords(t,e).setActiveId(e),s.emit("recordsMoved",{count:t.length,sender:"list",new:0}),b.setState("select",!1),Q.setVisible(!1)})),te.on("itemSelected",(function(e){if(!e)return;const t=X.getSelectedItems();b.setState("copy",!1),M.addRecords(t,e).setValue(e).setActiveId(e),ee.setVisible(!1),s.emit("recordsCopy",{count:t.length,new:0})})),q.on("tap",(function(){J.isVisible()||s.emit("collectionMenuOpen"),J.setPosition(q.getRect(),!0).setVisible(),$.setVisible(!1),G.setVisible(!1),q.setFocus(!0),J.setState("empty",!X.getItems().length)})).on("stateChanged:focused",(function(e){e||J.setVisible(!1)})),z.prepareData=function(e){return e?{items:Object.keys(e).map((function(t){const s=e[t];return{text:s.title,iconType:s.icon,action:s.action,confirm:s.confirm,itemType:t}}))}:{}},J.on("itemSelected",(function(){this.setVisible(!1)})),pe.on("tap",(function(){const e=this.hasState("selected"),t=e?[]:K.getValues();X.setValue(t),this.setState("selected",!e)})),w.on("input",(function(e){const t=M.filter(e);X.setItems(t)})),D.on("stateChanged:focused",(function(e){e&&s.emit("collectionSearchActivate")})),ue.prepareData=function(t){const s={};return s.items=t.map((function(t){return{value:t,title:e.SOCIAL_SERVICES[t]}})),s},ue.on("share",(function(e){s.emit("collectionShareData",e)})).on("write",(function(e){s.emit("collectionWriteMail",e)})).setItems(Object.keys(e.SOCIAL_SERVICES)),he.on("stateChanged:hidden",(function(t){if(!t){const t=W.getValue()||M.getShareId();if(this.setState("links",t),!t)return;const s=M.getShareLink({utmSource:e.COLLECTION_UTM_SOURCE,collection_id:t});ce.setContent(s,{asText:!0}),ue.setLink(s).setDescription(s),ce.on("tap",(function(){n.default.selectElement(this.getElement())}))}})),de.on("tap",(function(){this.hasState("copy")&&n.default.copyText(ce.getElement().textContent)&&(P.setProperty("tooltip",e.TOOLTIPS.copyLink2),s.emit("collectionLinkCopied")),n.default.selectElement(ce.getElement())})).on("stateChanged:copy",(function(t){const s=this.getElement();s.setAttribute("data-tooltip-nohide",t),s.setAttribute("data-tooltip",e.TOOLTIPS.copyLink)})).setState("copy",n.default.copySupported),le.on("tap",(function(){const e=M.getSelectedCollection();le.hasState("active")&&e.serverId&&!window.confirm(n.default.getAttribute(this.getElement(),"data-confirm"))||(this.setState("active"),M.updateCollection(M.getValue(),{public:!e.public}))})).on("stateChanged:active",(function(e){s.emit("collectionChanged",e),he.setState("public",e)})),this.on("collectionsOpened",(function(e){e&&!R.getProperty("noCollectionAlert")&&R.setProperty("noCollectionAlert",!0)})),me.call(P),O.emit(v.COLLECTION_EVENTS.INIT,M),this}},function(e,t,s){"use strict";t.__esModule=!0,t.CollectionPresenter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(139),r=s(149);class a extends o.ListboxPresenter{constructor(e){super(e);const t=this,s=this.getModel(),i=s._database;this.syncCollections=n.default.debounce(a.prototype.syncCollections,1e3,!0),s.on("collectionsSynced",(function(){t.emit("collectionsSynced")})).on("collectionsSet",(function(){t.emit("collectionsSet")})).on("dbReady",(function(){t.emit("dbReady")})).on("error",(function(e){const s={code:e.code,message:e.message||e.body&&e.body.error||""};t.emit("error",s)})).on("checkRecordError",(function(e){t.emit("checkRecordError",e)})).on("databaseError",(function(e){t.emit("databaseError",e)})).on("checked",(function(e){t.emit("checked",e)})).on("addToNewCollection",(function(e){t.emit("addToNewCollection",e)})).on("updateTop",(function(){t.emit("updateTop")})).on("updateRecords",(function(e){t.emit("updateRecords",e)})).on("synced",(function(){this.setProperty("syncedUid",this.getProperty("uid")),t.emit("synced")})).on("recordsReceived",(function(e,s){t.emit("someRecordsReceived",e,s),e===t.getValue()&&t.emit("recordsReceived",t.getRecords())})).on("recordUpdated",(function(e=null){const s=e||t.getValue()||t.getActiveId();i.getRecordsByCollection(s)})).on("collections",(function(e){t.emit("gotTopList",e)})).on("collectionData",(function(e){this.setRecords(e.records),t.emit("recordsReceived",e.records,{top:!0}),t.emit("collectionReceived",e)})).on("mergeCollection",(function(e){this.mergeCollection(e)})).on("processCollections",(function(e){this.processCollections(e)})).on("resetedIds",(function(){t.emit("resetedIds")})).on("firstCollectionSync",()=>{this.getHistoryCollection()||i.createHistoryCollection()}).on("change",(function(e,s){let i;switch(e){case"items":i=this.getItems().filter((function(e){return r.CollectionServerModel.isNotDeleted(e)})),t.emit("checkLimit",i.length),t.initializeActiveId();break;case"value":const e=s.split(":");s&&-1===s.indexOf(":")?t.getCollection(s):"train"===e[0]&&t.emit("openTraining",e[1]);break;case"activeId":t.emit("activeIdChanged",s).checkRecord()}}))}initializeActiveId(e){let t=e;if(!this.getActiveId()){if(!e){let e=this.getItems().filter((function(e){return r.CollectionServerModel.isNotDeleted(e)}));const s=e.filter((function(e){return e.type===r.COLLECTION_TYPES.FAVORITES}))[0];s?t=s.id:(e=e.filter((function(e){return!r.CollectionServerModel.isSubscription(e)})),e.length?t=e[0].id:this.emit("noCollectionForActiveId"))}this.setActiveId(t).emit("activeIdInitialized")}}isMyCollection(e){return e&&e.authorUid===this.getModel().getProperty("uid")}checkRecord(e){return this.getModel().checkRecord(e),this}syncCollections(){return this.getModel().syncCollections(),this}getCollectionList(){return this.getModel().getCollectionList(),this}getTopCollectionsList(){return this.getModel()._getCollections(),this}getTopCollection(e){return this.getModel()._getCollection(e),this}getSelectedCollection(){const e=this;return this.getItems().filter((function(t){return t.id===e.getValue()}))[0]}getDefaultName(e){const t=this.getItems()||[];let s=t.filter((function(t){return-1!==t.name.toLowerCase().indexOf(e.toLowerCase())})),i=0;for(;s.length;)if(i){i++;const n=e.toLowerCase()+" "+i;s=t.filter((function(e){return e.name.toLowerCase()===n}))}else s=t.filter((function(t){return t.name.toLowerCase()===e.toLowerCase()})),s.length&&i++;return e+(i?" "+i:"")}getRecords(){return this.getModel().getRecords()}setRecords(e){return this.getModel().setRecords(e),this}getActiveId(){return this.getModel().getProperty("activeId")}setActiveId(e){return this.getModel().isValid("activeId",e)&&this.getModel().setProperty("activeId",e),this}getActive(){return this.getModel().getActive()}getCollection(e){return this.getModel().getCollection(e),this}updateCollection(e,t){return this.getModel().updateCollection(e,t),this}createCollection(e={},t){const s=this.getModel();return e.name?(t&&s.setProperty("addingRecord",!0),s.createCollection(e),this):this}saveCollection(){const e=this.getItemById(this.getValue(),!1);return this.createCollection({name:e.name,color:e.color,public:!1},!0),this}deleteCollection(e){return e&&this.getModel().deleteCollection(e),this}updateRecord(e,t){return this.getModel().updateRecord(e,t),this}moveRecords(e,t){const s=this.getItemById(t,!1),i=n.default.isArray(e)?e:[e];return this.getModel().moveRecords(i,s),this}addRecords(e,t){const s=this.getProps(),i=r.CollectionServerModel.getTimestamp(),n=t||s.activeId;let o=e;if(!o&&!s.text)return this;if(!n)return this;const a=this.getItemById(n,!1);return o||(o=[{text:s.text,lang:s.srcLang+"-"+s.dstLang,translation:s.translation}]),o=o.map((function(e){return{text:e.text,lang:e.lang,translation:e.translation,score:0,status:r.COLLECTION_STATUSES.ADDED,collectionId:a.id,creationTimestamp:i,modificationTimestamp:i}})),this.getModel().addRecords(o,a),this}addToNewCollection(e){const t=this.getProps(),s=this.getRecords().find((function(e){return t.text===e.text&&t.srcLang+"-"+t.dstLang===e.lang&&t.translation===e.translation}));s?this.moveRecords(s,e):this.addRecords(null,e)}deleteRecords(e){return this.getModel().deleteRecords(e),this}subscribeToCollection(e){return this.getModel().subscribe(e),this}getHistoryRecords(){const e=this.getHistoryCollectionId();return e&&this.getCollection(e),this}addHistoryRecord(e){const t=this.getHistoryCollectionId();return t&&this.addRecords([{text:e.text,translation:e.translation,lang:e.srcLang+"-"+e.dstLang}],t),this}updateHistoryRecord(e){const t=this.getHistoryCollectionId();return t&&this.getModel().updateHistoryRecord(t,e),this}deleteHistoryRecord(e){const t=this.getHistoryCollectionId();return t&&this.getModel().deleteRecordByProps(t,e),this}deleteRecordByProps(e,t){return e&&this.getModel().deleteRecordByProps(e,t),this}setText(e){return this.getModel().setProperty("text",e),this}setSrcLanguage(e){return this.getModel().setProperty("srcLang",e),this}setDstLanguage(e){return this.getModel().setProperty("dstLang",e),this}setTranslation(e){return this.getModel().setProperty("translation",e),this}filter(e){return this.getModel().filter(e,this.getValue())}resetRecordsScore(e){return this.getModel().resetRecordsScore(e),this}getShareId(){const e=this.getItemById(this.getValue(),!1);return e?e.sourceCollectionId||e.serverId:""}getShareLink(e={}){const t={},s=window.location.protocol+"//"+window.location.host+"/subscribe";return e.collection_id&&(t.collection_id=e.collection_id),e.utmSource&&(t.utm_source=e.utmSource),s+"?"+n.default.toQueryString(t)}openRecords(e){const t=this.getItems().find((function(t){return t.serverId===e||t.sourceCollectionId===e}));t?(this.setValue(t.id),this.getCollection(t.id)):this.getTopCollection(e)}getItemById(e,t=!0){return this.getItems().find((function(s){return s.id===e||t&&s.serverId&&s.serverId===e}))}getCollectionByType(e){return this.getItems().find(t=>t.type===e)}getHistoryCollection(){return this.getCollectionByType(r.COLLECTION_TYPES.HISTORY)}getHistoryCollectionId(){const e=this.getHistoryCollection();return e?e.id:null}getFavoritesCollectionId(){const e=this.getCollectionByType(r.COLLECTION_TYPES.FAVORITES);return e?e.id:null}}t.CollectionPresenter=a},function(e,t,s){"use strict";t.__esModule=!0,t.CollectionNameInputPresenter=void 0;var i=s(132);class n extends i.InputPresenter{constructor(e){super(e);this.getView().on("stateChanged",(function(e,t){switch(e){case"alert":case"limit":this.setFocus(!0);break;case"focused":t||this.setState({alert:!1,limit:!1})}}))}}t.CollectionNameInputPresenter=n},function(e,t,s){"use strict";t.__esModule=!0,t.ListboxMultiplePresenter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(139);class r extends o.ListboxPresenter{getValue(){const e=this.getModel().getProperty("value");return e?JSON.parse(e):[]}setValue(e,t){let s,i;return n.default.isArray(e)?s=e:(s=this.getValue(),i=s.indexOf(e),i<0?s.push(e):s.splice(i,1)),this.getModel().setProperty("value",JSON.stringify(s),t),this}getSelectedItems(){const e=this.getValue();let t=this.getItems()||[];return t=t.filter((function(t){return-1!==e.indexOf(t.id)})),t}}t.ListboxMultiplePresenter=r},function(e,t,s){"use strict";t.__esModule=!0,t.HistoryCollection=t.HISTORY_COLLECTION_METRIKAS=t.HISTORY_COLLECTION_EVENTS=void 0,t.compareRecords=p,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(9),r=s(4),a=s(183),l=s(3);const c={READY:"ready",UPDATED:"updated"};t.HISTORY_COLLECTION_EVENTS=c;const d={ADD_RECORD:"addRecord",UPDATE_RECORD:"updateRecord",REMOVE_RECORD:"removeRecord"};t.HISTORY_COLLECTION_METRIKAS=d;const{$track:u}=(0,l.getTrackerByNamespace)(d);class h extends r.Model{constructor(e,t){super(e,t),this.requestCollectionRecordsAsync=n.default.debounce(h.prototype.requestCollectionRecords,200),(0,a.getCollectionsEmitter)().on(a.COLLECTION_EVENTS.INIT,e=>{this.setCollectionsPresenter(e)}).on(a.COLLECTION_EVENTS.COLLECTIONS_SET,()=>{this.requestCollectionRecordsAsync()}).on(a.COLLECTION_EVENTS.SYNCED,()=>{this.requestCollectionRecordsAsync()}),this.onChange("records",()=>{this.setProperty({ready:!0,updating:!1}),this.emit(c.UPDATED)}).onChange("ready",()=>{this.emit(c.READY)})}isReady(){return this.getProperty("ready")}isUpdating(){return this.getProperty("updating")}onceReady(e){return this.once(c.READY,e)}onceUpdated(e){return this.once(c.UPDATED,e)}getRecords(){return this.getProperty("records")}getCollectionsPresenter(){return this.getProperty("collectionsPresenter")}getRecordPosition(e){return this.getRecords().findIndex(t=>p(e,t))}isRecordValid({text:e,translation:t,srcLang:s,dstLang:i}){const{maxTextLength:n}=this.getProps();return e&&t&&s&&i&&e.length<=n}processRecord(e){const{records:t,maxRecords:s}=this.getProps();if(this.prepareRecord(e),!this.isRecordValid(e))return!1;if(!this.isReady())return this.onceReady(()=>this.processRecord(e));if(this.isUpdating())return this.onceUpdated(()=>this.processRecord(e));const i=this.getRecordPosition(e);this.setProperty("updating",!0);try{if(-1===i)return t.length>=s&&this.removeRecord(t[t.length-1]),this.addRecord(e);if(i>0)return this.touchRecord(e)}catch(e){this.setProperty("updating",!1),(0,o.logError)(e)}return!1}touchRecord(e){return u(d.UPDATE_RECORD),this.getCollectionsPresenter().updateHistoryRecord(e),!0}addRecord(e){return u(d.ADD_RECORD),this.getCollectionsPresenter().addHistoryRecord(e),!0}removeRecord(e){return u(d.REMOVE_RECORD),this.getCollectionsPresenter().deleteHistoryRecord(e),!0}setRawRecords(e){const t=e.map(({text:e,translation:t,lang:s})=>{const[i,n]=s.split("-");return{text:e,translation:t,srcLang:i,dstLang:n}});this.setProperty({records:t})}requestCollectionRecords(){const e=this.getCollectionsPresenter();return!!e&&(e.getHistoryRecords(),!0)}setCollectionsPresenter(e){e.on("someRecordsReceived",(t,s)=>{const i=e.getHistoryCollectionId();t&&t===i&&this.setRawRecords(s)}),this.setProperty({collectionsPresenter:e})}prepareRecord(e){e.text=n.default.trim(e.text),e.translation=n.default.trim(e.translation)}}function p(e,t){return e.text.toLowerCase()===t.text.toLowerCase()&&e.translation.toLowerCase()===t.translation.toLowerCase()&&e.srcLang===t.srcLang&&e.dstLang===t.dstLang}t.HistoryCollection=h,h.defaults={records:[],ready:!1,updating:!1,collectionsPresenter:null,maxRecords:1e3,maxTextLength:300}},function(e,t,s){"use strict";t.__esModule=!0,t.TTSNativePlayer=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(140);class r extends o.TTSPlayer{static isAvailable(){return"speechSynthesis"in window&&"SpeechSynthesisUtterance"in window}static getVoice(e){return n.default.isNumber(e)?this.getVoiceByIndex(e):n.default.isString(e)?this.getVoiceByLanguage(e):null}static getVoiceByIndex(e){return window.speechSynthesis.getVoices()[e]||null}static getVoiceByLanguage(e){const t=this.langRegions[e];let s=[],i=window.speechSynthesis.getVoices();return i=i.filter((function(t){return 0===t.lang.indexOf(e)})),t&&(s=i.filter((function(e){const s=e.lang.replace(/_/g,"-").split("-")[1];return s&&s.toUpperCase()===t}))),s[0]||i[0]||null}constructor(e={}){super();const t=this;this.on("action",(function(e){t.emit("actionStarted",{action:e,playerType:r.TYPE})})),"addEventListener"in window.speechSynthesis&&window.speechSynthesis.addEventListener("voiceschanged",(function(){t.emit("playerUpdated")}),!1),this._rate=n.default.isNumber(e.rate)?e.rate:1,this._pitch=n.default.isNumber(e.pitch)?e.pitch:1,this._volume=n.default.isNumber(e.volume)?e.volume:1,this._maxTextLength=e.maxTextLength,this._utterances=[]}play(e,t,s,i){this.isValid(e,t,r=>{r?(this._active=!0,this.emit("action",o.PLAYER_ACTIONS.LOAD),n.default.iOS?setTimeout(()=>this._startSynthesis(t,e,s,i),100):this._startSynthesis(t,e,s,i)):i(!1)})}stop(){this.isActive()&&(window.speechSynthesis.cancel(),this._active=!1)}isActive(){return this._active}createUtterance(e,t,s){const i=new SpeechSynthesisUtterance;return i.rate=s?this._rate/2:this._rate,i.pitch=this._pitch,i.volume=this._volume,i.text=e,i.lang=t?t.lang:"",i.voice=t,i.addEventListener("end",this._onStop.bind(this)),i.addEventListener("error",this._onError.bind(this)),i.addEventListener("start",this._onStart.bind(this)),i}_startSynthesis(e,t,s,i){const n=r.getVoice(e),o=this.createUtterance(t,n,s);this._utterances.splice(0,1,o);try{window.speechSynthesis.speak(o),i(!0)}catch(e){this._onError(),i(!1)}}_onStop(){this._active=!1,this.emit("action",o.PLAYER_ACTIONS.STOP)}_onError(){this._active=!1,this.emit("action",o.PLAYER_ACTIONS.ERROR)}_onStart(){this._active=!0,this.emit("action",o.PLAYER_ACTIONS.PLAY)}isLangSupported(e,t){t(r.getVoice(e))}isTextSupported(e){return n.default.hasAlphaOrDigit(e)&&!n.default.isUrl(e)}isTextSizeBelowLimit(e){return e&&e.length<=this._maxTextLength}getPriority(){return o.PLAYER_PRIORITIES.NORMAL}}t.TTSNativePlayer=r,r.TYPE="native",r.langRegions={de:"DE",en:"GB",es:"ES",fr:"FR",it:"IT",nl:"NL",pt:"PT",ru:"RU",zh:"CN"}},function(e,t,s){"use strict";t.__esModule=!0,t.VOICES_MAP=t.TTSOnlinePlayer=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(140);const r={ru:"oksana.gpu",tr:"selay.gpu",en:"oksana",uk:"oksana"};t.VOICES_MAP=r;class a extends o.TTSPlayer{static isAvailable(e){return e&&this.codecs[e.toUpperCase()]}constructor(e={}){super();const t=new window.Audio;this._audio=t,this._currentSrc="",this._url=e.speakerUrl,this._langs=e.speakerLangs,this._maxTextLength=e.maxTextLength,this._cacheEnabled=Boolean(e.cacheEnabled),this._params=e.params,this.on("action",e=>{this.emit("actionStarted",{action:e,playerType:a.TYPE})}),t.mozPreservesPitch=!0,t.webkitPreservesPitch=!0,t.preservesPitch=!0,t.addEventListener("error",()=>{this._clearLoadingTimeout(),this.emit("action",o.PLAYER_ACTIONS.ERROR)},!1),t.addEventListener("ended",()=>{this.emit("action",o.PLAYER_ACTIONS.STOP)},!1),t.addEventListener("pause",()=>{this.emit("action",o.PLAYER_ACTIONS.STOP)},!1),t.addEventListener("playing",()=>{this._clearLoadingTimeout(),this.emit("action",o.PLAYER_ACTIONS.PLAY)},!1)}getSrc(e,t){const s={...this._params,lang:this._langs[t],text:e};return t in r&&(s.voice=r[t]),this._url+"?"+n.default.toQueryString(s)}play(e,t,s,i){const n=this,r=this._audio;this.isValid(e,t,(function(a){a||i(!1);const l=n.getSrc(e,t);n.emit("action",o.PLAYER_ACTIONS.LOAD),n._currentSrc===l&&n._cacheEnabled&&r.readyState?r.currentTime=0:(r.src=l,n._currentSrc=l),r.playbackRate=s?.5:1,r.play(),n._ttsLoadingTimeout=setTimeout((function(){n.emit("action",o.PLAYER_ACTIONS.ERROR)}),2e3),i(!0)}))}stop(){this.isActive()&&(this._clearLoadingTimeout(),this._audio.pause())}isActive(){return!this._audio.paused}isLangSupported(e,t){t(this._langs[e])}isTextSupported(e){return n.default.hasAlphaOrDigit(e)&&!n.default.isUrl(e)}isTextSizeBelowLimit(e){return e&&e.length<=this._maxTextLength}getPriority(){return n.default.isOnline()?o.PLAYER_PRIORITIES.NORMAL:o.PLAYER_PRIORITIES.LOW}_clearLoadingTimeout(){clearTimeout(this._ttsLoadingTimeout),this._ttsLoadingTimeout=0}}t.TTSOnlinePlayer=a,a.TYPE="yandex",a.backendSupportedFormats=[{format:"mp3",quality:"hi"},{format:"wav",quality:"lo"}],a.codecs=function(){const e=/^no$/,t=document.createElement("audio");return t.canPlayType?{AAC:t.canPlayType("audio/aac").replace(e,""),MP3:t.canPlayType("audio/mpeg").replace(e,""),WAV:t.canPlayType('audio/wav; codecs="1"').replace(e,""),OGG:t.canPlayType('audio/ogg; codecs="vorbis"').replace(e,"")}:{}}()},function(e,t,s){"use strict";t.__esModule=!0,t.UNIPROXY_VOICES=t.TTS_AUDIO_FORMAT=t.TTSUniproxyPlayer=t.PLAYER_TYPE=t.PLAYER_ERRORS=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(10),r=s(140),a=s(178),l=s(242),c=s(244),d=s(160);const u="Generate",h="Speak",p=[a.AUDIO_FORMATS.OGG,a.AUDIO_FORMATS.WEBM,a.AUDIO_FORMATS.WAV_PCM,a.AUDIO_FORMATS.WAV].filter(e=>(new Audio).canPlayType(e))[0];t.TTS_AUDIO_FORMAT=p;t.PLAYER_TYPE="Uniproxy";const g={en:"oksana",ru:"oksana.gpu",tr:"selay.gpu",uk:"oksana"};t.UNIPROXY_VOICES=g;const m={STREAM_ID_EMPTY:"stream_id_empty",SERVER_ERROR:"server_error",PLAYER_ERROR:"player_error"};t.PLAYER_ERRORS=m;const E=["ru","tr","uk"];class _ extends r.TTSPlayer{static isAvailable(){return Boolean(p)&&(!n.default.chromeVersion||n.default.chromeVersion>60)&&(window.AudioContext||window.webkitAudioContext)}constructor(e={}){super(),this._player=new a.StreamPlayer(T),this._currentMessageId="",this._currentStreamId=-1,this._uniproxy=e.uniproxy,this._maxTextLength=e.maxTextLength,this._uniproxy.on("*",(e,t)=>{switch(e){case d.EVENTS.ERROR:this._handleUniproxyError(t.data,t.error);break;case d.EVENTS.MESSAGE:this._handleMessage(t.data);break;case d.EVENTS.STREAM:this._handleStream(t);break;case d.EVENTS.STREAM_CONTROL:this._handleStreamControl(t.data)}}),this.on("action",e=>{this.emit("actionStarted",{action:e,playerType:"Uniproxy"})})}isValid(e,t,s){r.TTSPlayer.prototype.isValid.call(this,e,t,e=>{if(!e)return s(e);this._uniproxy.ensureConnection(()=>{s(!0)})})}_freeAudioContext(){this._audioContext&&this._audioContext.close&&this._audioContext.state&&("closed"!==this._audioContext.state&&this._audioContext.close(),this._audioContext=null)}play(e,t,s,i){this._freeAudioContext(),this._audioContext=this._audioContext||new(window.AudioContext||window.webkitAudioContext),this._audioContext.createScriptProcessor(256,1,1).disconnect(),this.isValid(e,t,n=>{n||i(!1);const o=s?'<speaker speed="0.5">'+e:e,l=g[t],c=p===a.AUDIO_FORMATS.WAV?a.AUDIO_FORMATS.WAV_PCM:p;this._lang=t,this.emit("action",r.PLAYER_ACTIONS.LOAD),this._player.setAudioContext(this._audioContext),this._currentMessageId=this._uniproxy.sendRequest("TTS",u,{text:o,lang:t,voice:l,format:c}),i(!0)})}stop(){this.isActive()&&(this._freeAudioContext(),-1!==this._currentStreamId&&this._uniproxy.closeStream(this._currentStreamId,this._currentMessageId),this._currentStreamId=-1,this._currentMessageId="",this._player.stop())}isActive(){return!this._player.stopped}isLangSupported(e,t){t(g[e])}isTextSupported(e){return n.default.hasAlphaOrDigit(e)&&!n.default.isUrl(e)}isTextSizeBelowLimit(e){return e&&e.length<=this._maxTextLength}getPriority(e,t){return n.default.isOnline()?E.includes(t)||n.default.isLinux?r.PLAYER_PRIORITIES.HIGH:r.PLAYER_PRIORITIES.NORMAL:r.PLAYER_PRIORITIES.LOW}_handleStream(e){this._currentStreamId===e.streamId&&this._player.onPackage(e.data)}_handleStreamControl({action:e,streamId:t}){e===d.STREAM_CONTROL_ACTIONS.CLOSE&&t===this._currentStreamId&&(this._player.onStreamFinished(),this._currentStreamId=-1,this._currentMessageId="")}_handleUniproxyError({header:e,payload:t},s=null){if(e&&e.refMessageId===this._currentMessageId){const e=t&&t.error&&t.error.message;this._handleError(s||m.SERVER_ERROR,e)}}_handleError(e,t=null){this.stop(),this.emit("action",r.PLAYER_ACTIONS.ERROR),(0,o.getGlobalEmitter)().emit("uniproxyTtsError",e,t,{format:p,lang:this._lang})}_handleStart(){this.emit("action",r.PLAYER_ACTIONS.PLAY)}_handleFinished(){this.emit("action",r.PLAYER_ACTIONS.STOP)}_handleSpeak({header:e,payload:t}){void 0!==e.streamId?e.refMessageId===this._currentMessageId&&(this._currentStreamId=e.streamId,this._player.start({onStart:this._handleStart.bind(this),onError:this._handleError.bind(this),onFinished:this._handleFinished.bind(this),format:t.format})):this._handleError(m.STREAM_ID_EMPTY)}_handleMessage(e){const{header:t}=e;if(t&&"TTS"===t.namespace)switch(t.name){case h:this._handleSpeak(e)}}_clearLoadingTimeout(){clearTimeout(this._ttsLoadingTimeout),this._ttsLoadingTimeout=0}}function T(e){return l.OggOpusStream.isOggOpus(e.format)?new l.OggOpusStream(e):c.PcmStream.isPCM(e.format)?new c.PcmStream(e):void 0}t.TTSUniproxyPlayer=_,_.TYPE="Uniproxy"},function(e,t,s){"use strict";t.__esModule=!0,t.OggOpusStream=void 0,t.parseStreamPackage=r,s(1);var i=s(187);class n extends i.AbstractStream{static isOggOpus(e=""){return"audio/opus"===e}constructor(e){super(e),this.currentHeader=null,this.preloadBufferSize=2e4,this.bufferSize=4e4}add(e){const t=r(e);let s=-1,i=-1;for(const n of t){const{segments:t,size:r,offset:a}=n;t.length&&("head"===t[0].type?(-1!==s&&this.currentHeader?(this.insert(e.slice(s,i),this.currentHeader),s=-1,i=-1):this.pendingBuffer&&this.pendingBuffer.offset&&this.ready(),this.currentHeader=e.slice(a,r+a)):"tag"===t[0].type?this.currentHeader&&(this.currentHeader=o(this.currentHeader,e.slice(a,r+a))):-1===s?(s=a,i=a+r):i+=r)}-1!==s&&this.currentHeader&&this.insert(e.slice(s,i),this.currentHeader)}getChunk(e){return e}}function o(e,t){const s=new Uint8Array(e.byteLength+t.byteLength);return s.set(new Uint8Array(e),0),s.set(new Uint8Array(t),e.byteLength),s.buffer}function r(e){const t=[];let s=0;const i=new DataView(e);for(;s<e.byteLength;){const n=s;if(1332176723!==i.getUint32(s))break;const o=i.getUint8(s+26);let r=s+26+1;const l=r+o;s+=26+o+1;const c=[];for(;r<l;r++){const t=i.getUint8(r);c.push(a(e,s,t)),s+=t}t.push({offset:n,size:s-n,segments:c})}return t}function a(e,t,s){const i=e.slice(t,t+s),n=new DataView(i);let o="data";return i.byteLength>=4&&1332770163===n.getUint32(0)&&(1214603620===n.getUint32(4)?o="head":1415669619===n.getUint32(4)&&(o="tag")),{offset:t,type:o,size:s}}t.OggOpusStream=n},function(e,t,s){"use strict";t.__esModule=!0,t.PackageBuffer=void 0;t.PackageBuffer=class{constructor(e){this.offset=0,this.buffer=new ArrayBuffer(e)}add(e,t){const s=t?t.byteLength:0,i=0===this.offset;if(e.byteLength+(i?s:0)+this.offset>this.buffer.byteLength)return!1;const n=new Uint8Array(this.buffer);return 0===this.offset&&t&&(n.set(new Uint8Array(t),this.offset),this.offset+=t.byteLength),n.set(new Uint8Array(e),this.offset),this.offset+=e.byteLength,!0}relax(){return this.buffer=this.buffer.slice(0,this.offset)}}},function(e,t,s){"use strict";t.__esModule=!0,t.PcmStream=void 0,s(1);var i=s(187);const n=/audio\/x-pcm;bit=(\d*);rate=(\d*)/;class o extends i.AbstractStream{static isPCM(e=""){return n.test(e)}constructor(e){super(e),this.preloadBufferSize=2e4,this.bufferSize=4e4,this.bit=15,this.rate=16e3,this.channelCount=1;const[,t="",s=""]=(e.format||"").match(n)||[],i=parseInt(t,10),o=parseInt(s,10);this.bit=isNaN(i)?void 0:i,this.rate=isNaN(o)?void 0:o}add(e){this.insert(e)}getChunk(e){return function(e,t=1,s=15,i=16e3){const n=e.byteLength,o=new Uint8Array(44+n),r=new DataView(o.buffer);let a=0;return o.set(new Uint8Array(e),44),r.setInt32(a,1380533830),a+=4,r.setInt32(a,n+36,!0),a+=4,r.setInt32(a,1463899717),a+=4,r.setInt32(a,1718449184),a+=4,r.setInt32(a,16,!0),a+=4,r.setInt16(a,1,!0),a+=2,r.setInt16(a,t,!0),a+=2,r.setInt32(a,i,!0),a+=4,r.setInt32(a,i*t*s/8,!0),a+=4,r.setInt16(a,t*s/8,!0),a+=2,r.setInt16(a,s,!0),a+=2,r.setInt32(a,1684108385),a+=4,r.setInt32(a,n,!0),r.buffer}(e,this.channelCount,this.bit,this.rate)}}t.PcmStream=o},function(e,t,s){"use strict";t.__esModule=!0,t.initCopying=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(2),r=s(45);t.initCopying=function(e){const t=this,s=this.getModel();let i="";const a=new o.TouchView({element:e.ELEMENTS.copyButton});return s.on("change",(function(e,t){switch(e){case"dstLang":a.setState("download","sjn"===t&&a.hasState("copy"));break;case"translation":case"userTranslation":i=t,a.setEnabled(t)}})),a.on("tap",(function(){let o;if(this.hasState("download"))return t.emit("textDownload");this.hasState("copy")&&n.default.copyText(i)&&(o=!0,s.setProperty("tooltip",e.TOOLTIPS.copy2,{view:a})),t.emit("textCopy",o)})).on("stateChanged",(function(t,s){const i=this.getElement();switch(t){case"copy":i.setAttribute("data-tooltip-nohide",s),i.setAttribute("data-tooltip",e.TOOLTIPS.copy);break;case"download":i.setAttribute("data-tooltip",s?e.TOOLTIPS.download:e.TOOLTIPS.copy)}})).setState("copy",n.default.copySupported),this.addHotKey(r.HOT_KEYS_MAP.COPY,{view:a,getActionName:()=>"copy_translation"}).bindFocusActivation(a),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initAlignment=void 0;var i=s(24);t.initAlignment=function(e){const t=this,s=this._settings,n=this.getModel(),o=this.getView(),r=new i.TemplateView({element:e.ELEMENTS.alignment,template:e.TEMPLATES.alignment});return this.on("trAlign",(function(e,i={}){if(o.hasState("editing")&&"editor"!==i.sender)return;if(!e)return r.setVisible(!1);const a=n.getProperty("text"),l=function(e){const i=n.getProperty("spellerData");return i&&s.getProperty("autospeller")?(JSON.parse(i).forEach((function(s){if(!s.s.length||t.hasSpellerSavedWord(s.word))return;const i=s.s[0].length,n=s.len-i;e.forEach((function(t,o){o%2==0&&(s.pos+s.len<=t?(e[o]+=n,e[o+1]+=n):s.pos<=e[o+1]&&(i!==e[o+1]-t?(e[o]=s.pos,e[o+1]=s.pos+s.len):e[o+1]+=n))}))})),e):e}(e);let c=l.map((function(e,t){if(t%2==0)return{text:a.slice(e,l[t+1]),gap:a.slice(l[t+1],l[t+2])}}));c=c.filter((function(e){return e})),r.renderData({items:c,leftText:a.slice(0,l[0]),rightText:a.slice(l[l.length-1])}).setVisible(!0).scrollTo(r.getScrollInfo().maxTop/100*n.getProperty("textScrollY"))})),n.on("change",(function(e){switch(e){case"text":case"textScrollY":case"translation":r.setVisible(!1)}})),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initAlternatives=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(11),r=s(29),a=s(248),l=s(249),c=s(156),d=s(16);t.initAlternatives=function(e){const t=this.getView(),s=this.getModel(),i=new r.ListboxView({element:e.ELEMENTS.alternativesListbox,template:e.TEMPLATES.listbox,partials:{extras:(0,d.getIcnHtml)("enter",16)},stopDefaultAction:!0}),u=new a.TranslationAlternativesPresenter({view:i,model:new l.TranslationAlternativesModel({srv:e.SRV,url:e.ALTERNATIVES_URL},{validators:{word(e){return e&&1===n.default.getValueTokens(e).length&&"sjn"!==this.getProperty("dstLang")&&!n.default.isUrl(n.default.trim(e))},translation:t=>t.length<e.MAX_PREDICTOR_QUERY,text:t=>t.length<e.MAX_PREDICTOR_QUERY,srcLang(t){const s=this.getProperty("dstLang");return t&&t!==s&&n.default.hasProperty(e.ALTERNATIVES_LANGS,t+"-"+s)},dstLang(t){const s=this.getProperty("srcLang");return t&&s!==t&&n.default.hasProperty(e.ALTERNATIVES_LANGS,s+"-"+t)}}})}),h=new r.ListboxView({element:e.ELEMENTS.alternativesTooltip,template:e.TEMPLATES.predictor});let p;return this.on("trTextInput",()=>{i.setState("waiting",!1)}).on("trTextMouseDown",()=>{i.setVisible(!1).setState("waiting",!1)}).on("trTextClick",(e,t,o)=>{if(e===t.length||s.getProperty("complaint"))return i.setVisible(!1);const r=s.getProperty("activeSentenceAlign"),a=t.lastIndexOf(" ",e)<0?0:t.lastIndexOf(" ",e-1)+1;let l=o.target.textContent,c=s.getProperty("text");u.setWord(""),i.setVisible(!1).setState("waiting",!0),n.default.hasAlphaOrDigit(l[l.length-1])||(l=l.slice(0,-1));let d=t.slice(0,a);r&&r[1]&&(d=d.slice(r[1][0])),r&&r[0]&&(c=c.slice(r[0][0],r[0][0]+r[0][1])),u.setText(c).setTranslation(n.default.trim(d)).setWord(l)}).on("trTextFocus",e=>{e||i.setVisible(!1)}).on("trTextKeydown",e=>{if(!i.isVisible())return;let t=s.getProperty("chosenAlternative");switch(e.keyCode){case o.KEYBOARD_KEYS.UP:const s=i.getElement().lastElementChild;if(n.default.preventEvent(e),t)for(;t&&(t=t.previousElementSibling||s,!n.default.getDataAttr(t,"value")););else t=s;i.emit("itemHovered",t);break;case o.KEYBOARD_KEYS.DOWN:const r=i.getElement().firstElementChild;if(n.default.preventEvent(e),t)for(;t&&(t=t.nextElementSibling||r,!n.default.getDataAttr(t,"value")););else t=r;i.emit("itemHovered",t);break;case o.KEYBOARD_KEYS.ENTER:i.emit("itemSelected",n.default.getDataAttr(t,"value"));break;default:return i.setVisible(!1)}}).on("showTooltip",e=>{i.isVisible()&&h.renderData({value:e,values:[{value:e}]}).setEnabled(!0).setVisible(!0)}).on("hideAlternatives",()=>i.setVisible(!1)),s.on("change",(e,t)=>{switch(e){case"srcLang":u.setSrcLanguage(t);break;case"dstLang":u.setDstLanguage(t);break;case"translation":s.setProperty("userTranslation","",{silent:!0})}}),window.addEventListener("scroll",(function(){i.isVisible()&&i.setVisible(!1)})),u.prepareData=e=>{const s={},i=u.getWord();return t.hasState("select")||e&&(e.filter(e=>e.toUpperCase()!==i.toUpperCase()),s.items=e.map((function(e){return{text:e,value:e}}))),s},u.on("ready",()=>{if(t.hasState("editing")&&i.hasState("waiting")){const e=window.getSelection();if(e&&e.focusNode&&!e.toString()){let t=e.focusNode.parentNode;t=n.default.trim(t.textContent)?t:t.nextSibling,t&&i.setPosition(t.getBoundingClientRect(),!0,!0)}i.setVisible(!0).setEnabled(!0)}}).on("itemSelected",e=>{this.emit(c.IDIOMS_EVENTS.CLEAR_IDIOMS),clearTimeout(p),this.emit("alternativeChosen",e,u.getTranslation())}),i.on("stateChanged:hidden",e=>{e&&h.setVisible(!1)}).on("itemHovered",e=>{clearTimeout(p),h.setVisible(!1),n.default.toggleClass(e,"state-selected"),s.getProperty("chosenAlternative")&&n.default.toggleClass(s.getProperty("chosenAlternative"),"state-selected"),s.setProperty("chosenAlternative",e),p=setTimeout(()=>{const t=n.default.getDataAttr(e,"value");h.setPosition(e.getBoundingClientRect(),!1,!0),i.isVisible()&&h.renderData({spinner:!0}).setEnabled(!0).setVisible(!0),this.emit("requestAlternative",t,u.getTranslation())},200)}).on("alternativesMouseOut",()=>h.setVisible(!1)),this}},function(e,t,s){"use strict";t.__esModule=!0,t.TranslationAlternativesPresenter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(2),r=s(17),a=s(150);class l extends r.Presenter{constructor(e){super(e);const t=this.getView(),s=this.getModel(),i=()=>{t.setVisible(!1).setEnabled(!1)};this.requestSuggestion=n.default.debounce(a.PredictorPresenter.prototype.requestSuggestion,200),s.on("error",i).on("invalid",()=>s.setProperty("data","",{invalid:!0})).on("set:items",e=>{if(!e)return i();const n=s.toJSON();n.items=s.getItems()||[],t.renderData(this.prepareData(n.items)),this.emit("ready",n)}).on("change",(e,i,n)=>{switch(e){case"srcLang":case"dstLang":case"word":return t.setEnabled(!1),n.reason&&s.setProperty("reason",n.reason),this.requestSuggestion()}}),t.on("tap",n.default.preventEvent).on("itemSelected",e=>{e&&this.setValue(e).emit("itemSelected",this.getValue()),t.setVisible(!1)}).on(o.TouchView.eventTypes.OUT,e=>{n.default.preventEvent(e),t.emit("alternativesMouseOut")}).bindDOMEvents([o.TouchView.eventTypes.OVER,o.TouchView.eventTypes.OUT])}setText(e,t){return this.getModel().setProperty("text",e,{reason:t}),this}setTranslation(e,t){return this.getModel().setProperty("translation",e,t),this}getTranslation(){return this.getModel().getProperty("translation")}setWord(e,t){return this.getModel().setProperty("word",e,t),this}getWord(){return this.getModel().getProperty("word")}setValue(e,t){return this.getModel().setProperty("value",e,t),this}getValue(){return this.getModel().getProperty("value")}setSrcLanguage(e,t){return this.getModel().setProperty("srcLang",e,t),this}setDstLanguage(e,t){return this.getModel().setProperty("dstLang",e,t),this}requestSuggestion(){return this.getModel().requestSuggestion(),this}}t.TranslationAlternativesPresenter=l},function(e,t,s){"use strict";t.__esModule=!0,t.TranslationAlternativesModel=void 0;var i=s(44),n=s(72),o=s(69),r=s(19);class a extends n.ListboxModel{constructor(e,t){super(e,t),this.on("invalid",this.abort)}abort(){o.SyncModel.prototype.abort.call(this)}setRequest(e){o.SyncModel.prototype.setRequest.call(this,e)}getData(){const e=this.getProps();return{word:e.word,src:e.text,dst:e.translation}}getParams(){const e=this.getProps();return{id:[e.sid,e.counter,0].join("-"),srv:e.srv,lang:e.srcLang+"-"+e.dstLang}}getDefaults(){return{srv:"",url:"/",word:"",src:"",dst:"",srcLang:"",dstLang:"",index:0,sid:this.getId()}}runRequest(){const e=new r.HTTPRequest(this.getProperty("url"));if(this.abort(),!this.isValid())return this;const t=this.getData(),s=this.getParams();return this.emit("query",s),this._isCachedArrayValid(t.word,t.dst)?(this.handleResponse(this._cachedResponseArray),this):this.setRequest(e.setType(r.HTTPRequest.types.FORM).setData(t).setParams(s).setMethod(r.HTTPRequest.methods.POST).send((e,s)=>{if(e)return this.emit("error",e);this._cachedDst=t.dst,this._cachedWord=t.word,this._cachedResponseArray=s.body.alternatives,this.handleResponse(this._cachedResponseArray)}))}requestSuggestion(){return i.sessionManager.getSid().then(e=>{this.setProperty({sid:e}).runRequest()}),this}handleResponse(e){e&&0!==e.length&&this.setItems(e)}_isCachedArrayValid(e,t){return this._cachedWord&&this._cachedResponseArray&&this._cachedDst===t&&this._cachedWord===e}}t.TranslationAlternativesModel=a},function(e,t,s){"use strict";t.__esModule=!0,t.initSourceTranslit=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(188),r=s(189);t.initSourceTranslit=function(e){const t=this,s=this.getView(),i=this.getModel(),a=new o.TranslitModel({srv:e.SRV,url:e.TRANSLIT_URL},{validators:{lang:t=>n.default.hasProperty(e.TRANSLIT_LANGS,t),text:t=>t&&t.length<=e.MAX_TRANSLIT_TEXTLENGTH}}),l=new r.TranslitPresenter({model:a});return s.onStateChanged("translit_source",(function(){t.emit("containerHeightChanged"),l.setLang(i.getProperty("srcLang")).setText(i.getProperty("text"))})).setState("translit_source",!0),i.onChange("srcLang",(function(e){s.hasState("translit_source")&&l.setLang(e).setText("")})).onSet("translation",(function(){s.hasState("translit_source")?l.setLang(this.getProperty("srcLang")).setText(this.getProperty("text")):l.setText("")})),l.on("error",(function(){t.emit("translitError","source")})).on("result",(function(e){i.setProperty("sourceTranslit",e)})),this}},function(e,t,s){"use strict";t.__esModule=!0,t.TranslitApiError=void 0;class i extends Error{constructor(...e){super(...e),this.message="Translit Api Error"}}t.TranslitApiError=i},function(e,t,s){"use strict";t.__esModule=!0,t.initTargetTranslit=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(188),r=s(189);t.initTargetTranslit=function(e){const t=this,s=this.getView(),i=this.getModel(),a=new o.TranslitModel({srv:e.SRV,url:e.TRANSLIT_URL},{validators:{lang:t=>n.default.hasProperty(e.TRANSLIT_LANGS,t),text:t=>t&&t.length<=e.MAX_TRANSLIT_TEXTLENGTH}}),l=new r.TranslitPresenter({model:a});return s.onStateChanged("translit_target",(function(){t.emit("containerHeightChanged"),l.setLang(i.getProperty("dstLang")).setText(i.getProperty("translation"))})).setState("translit_target",!0),i.onChange("dstLang",(function(e){s.hasState("translit_target")&&l.setLang(e).setText("")})).onSet("translation",(function(e){s.hasState("translit_target")?l.setLang(this.getProperty("dstLang")).setText(e):l.setText("")})),l.on("error",(function(){t.emit("translitError","target")})).on("result",(function(e){i.setProperty("targetTranslit",e)})),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initTranslator=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(29),r=s(254),a=s(255),l=s(256),c=s(11),d=s(2),u=s(156),h=s(45),p=s(143);function g(e){const t=e.indexOf("")<0?e.replace(/\ufe0f/g,""):e;return n.default.getEmojiCodes(t).join("-")}t.initTranslator=function(e){const t=this;let s,i,m=0;const E=this.getView(),_=this.getModel(),T=this._settings,f=_.toJSON(),S=new o.ListboxView({element:e.ELEMENTS.selectTooltip,template:e.TEMPLATES.empty}),C=this.getTranslatorView(),y=this.getTranslatorModel(),A=new r.TranslatorPresenter({view:C,model:y}),v=this.getMeasurerViewDst(),L=new o.ListboxView({element:e.ELEMENTS.predictorDst,template:e.TEMPLATES.predictor}),R=new l.TranslationPredictorModel({srv:e.SRV,url:e.TRANSLATE_PREDICTOR_URL,options:l.TranslationPredictorModel.options.ALIGN},{validators:{text(t){return t&&t.length<=e.MAX_PREDICTOR_QUERY&&"sjn"!==this.getProperty("srcLang")&&!n.default.isUrl(n.default.trim(t))},prefix:t=>t&&t.length<=e.MAX_PREDICTOR_QUERY,srcLang(e){return e&&e!==this.getProperty("dstLang")},dstLang(e){return e&&e!==this.getProperty("srcLang")}}}),P=new a.TranslationPredictorPresenter({view:L,model:R}),O=new d.TouchView({element:e.ELEMENTS.targetTranslit}),I=new d.TouchView({element:e.ELEMENTS.translation}),b=new d.TouchView({element:e.ELEMENTS.swapButton});return I.on("mousedown",e=>{2!==e.button&&C.getContentElement().setSelectionRange(0,0)}).bindDOMEvents("mousedown"),O.onTap(e=>{e.stopImmediatePropagation()}),this.on("trTextTap",(function(){E.hasState("editing")&&L.setEnabled(!1)})).on("trTextClick",(e,t)=>{E.hasState("editing")&&(P.prepareActiveSentence(e,y.getProperty("sentencesAlign")),_.setProperty("userTranslation",t),R.setProperty("caret",e))}).on("trTextFocus",n.default.debounce(()=>{L.setEnabled(!1)},250)).on("textFocus",(function(e){e&&E.hasState("allowed_editing")&&t.emit("action","saveEditing")})).on("trTextKeydown",(function(e,s){switch(e.keyCode){case c.InputView.keys.ENTER:if(e.shiftKey)break;if(T.isOptionEnabled(p.AVAILABLE_OPTIONS.ENTER)||n.default.preventEvent(e),L.isEnabled())n.default.preventEvent(e),P.setValue(L.getValues()[0],{enter:!0});else if(e.ctrlKey&&s.sender){const e=s.sender.getSelection().start,t=s.sender.getValue().slice(0,e);P.setFullword(0).setPrefix(t,"predictor").setIndex(e)}break;default:t.emit(u.IDIOMS_EVENTS.CLEAR_IDIOMS),L.setEnabled(!1)}})).on("trTextKeyup",(function(e,t){switch(e.keyCode){case c.InputView.keys.UP:case c.InputView.keys.DOWN:case c.InputView.keys.LEFT:case c.InputView.keys.RIGHT:P.prepareActiveSentence(t.caret,y.getProperty("sentencesAlign"))}})).on("trTextInput",(function(e,t){let s={},i=y.getProperty("sentencesAlign");const o=R.getProperty("sentenceIndex");if("predictor"===t.sender||n.default.isEmpty(i)||n.default.isEmpty(i[o]))return;s.total=e.length-t.oldValue.length;const r=i[o][1];s.total<0&&Math.abs(s.total)>r[1]+r[0]-t.caret&&(s=a.TranslationPredictorPresenter.calculateDifference(s,o,i,t.caret));const l=a.TranslationPredictorPresenter.updateAlign("",y.getProperty("align"),s,o);y.setProperty("align",l),i=a.TranslationPredictorPresenter.getSentenceAlignFromAlign(l),y.setProperty("sentencesAlign",i)})).on("editorToggle",(function(){L.setEnabled(!1)})).on("requestAlternative",(e,t)=>{const s=n.default.trim(t+" "+e);if(R.wasRequested(s))return;const i=_.getProperty("activeSentenceAlign");let o=_.getProperty("text"),r=s.length;i&&i[0]&&(o=o.slice(i[0][0],i[0][0]+i[0][1])),i&&i[1]&&(r+=i[1][0]),R.setProperty("alternative",e),P.setText(o).setFullword(1).setIndex(r).setPrefix(s,"alternatives")}).on("alternativeChosen",(e,t)=>{const i=(t?t+" ":"")+e;if(R.isCachedPrefixValid(i)){const t=_.getProperty("activeSentenceAlign");let s=i.length;t&&t[1]&&(s+=t[1][0]),P.setIndex(s),R.setProperty("pos",e.length).showCashedResult(i),P.setValue(R.getCashedResult(i))}else{R.wasRequested(i)||this.emit("requestAlternative",e,t);const n=_.getProperty("userTranslation")||_.getProperty("translation"),o=R.getProperty("caret");let r=n.slice(0,o);r=r.slice(0,r.lastIndexOf(" ")+1),r+=e,C.renderData(A.prepareData(r,{noAlign:!0})),clearTimeout(s),s=setTimeout(()=>P.emit("error"),8e3),R.setProperty("alternative",e),C.setState("waitingAlternative",!0)}}).addHotKey(h.HOT_KEYS_MAP.SWAP_LANGS,{view:b,getActionName:()=>"swap_langs"}),this.on("action:retry",()=>A.requestTranslation()),_.on("change",(function(s,i,o){const{srcLang:r,dstLang:a}=_.getProps();switch(s){case"srcLang":_.setProperty("supportExamples",e.EXAMPLE_LANGS[r+"-"+a]),P.setSrcLanguage(i,{reason:"lang"}),A.setSrcLanguage(i),y.setProperty("align","");break;case"dstLang":_.setProperty("supportExamples",e.EXAMPLE_LANGS[r+"-"+a]),P.setDstLanguage(i,{reason:"lang"}),A.setDstLanguage(i),C.setLanguage(i),y.setProperty("align",""),O.setState("chinese","zh"===i);break;case"text":P.setPrefix("").setText(i);break;case"leadSpacingsCount":y.getProperty("align")&&C.renderData(A.prepareData(y.getProperty("translation"),{align:y.getProperty("align")}));break;case"textScrollY":L.setEnabled(!1),o.userScroll&&C.scrollTo(C.getScrollInfo().maxTop/100*i);break;case"trText":const s=0===y.getProperty("counter")&&e.TRANSLATION;y.setProperty("align",""),y.setProperty("sentencesAlign",""),A.setText(n.default.truncateText(i,e.MAX_TRANSLATOR_QUERY),o.reason,s),s&&y.setProperty("counter",e.TRANSLATION_COUNTER);break;case"targetTranslit":O.setContent(i),t.emit("containerHeightChanged");break;case"complaint":const l=this.getProperty("selText"),c=!l||l===this.getProperty("trText");C.setState("complaint",i&&c),C.getContentElement("[data-complaint-target]").setAttribute("data-complaint-target",c);break;case"translation":E.setState("has_translation",Boolean(i))}})).on("set",(function(t,s,i){let o,r,l,c,d=_.getProperty("translation"),u=_.getProperty("text"),h=0;const p=R.getProperty("sentenceIndex");switch(t){case"userTranslation":if(!E.hasState("editing"))return;if(l=y.getProperty("sentencesAlign"),l){if(l=l[p],c=a.TranslationPredictorPresenter.getSentenceAlignFromAlign(y.getProperty("oldAlign"))[p],!c)return;if(d=d.slice(c[1][0],c[1][0]+c[1][1]),s.slice(l[1][0],l[1][0]+l[1][1])===d)return;r=this.toJSON(),o=i.caret||0,l&&(h=l[1][0],u=u.slice(l[0][0],l[0][0]+l[0][1])),P.setFullword(0).setPrefix(s.slice(h,o),i.sender||i.reason).setText(u).setIndex(o).setSrcLanguage(r.srcLang).setDstLanguage(r.dstLang)}break;case"trText":"enter"===i.reason&&A.setText(n.default.truncateText(s,e.MAX_TRANSLATOR_QUERY),i.reason)}})),A.on("error",(function(e){t.emit("translationError",e),t.toggleTranslatorExpandState(!0)})).on("query",(function(){const{id:e}=y.getParams();t.emit("translateQuery",e),t.toggleTranslatorExpandState(!0)})).on("result",(function(e){_.setProperty("translation",e),t.emit("changeEditorValue",e)})).on("expired",(function(e){t.emit("refreshAlertShow",e)})),A.prepareData=function(e,t={}){const s=[],i={},o=[],r=_.getProperty("leadSpacingsCount")||0,a=y.getProperty("sentencesAlign");let l=t.align||y.getProperty("align");!t.noAlign&&l||(l=""),l.split(";").forEach((function(e,t){if(!e||e.length<2)return;let s=e.split(",")[0].split("-").map((function(e){return e.split(":").map(Number)}));1===s.length&&a&&(s=a[t]),o.push(s),e.split(",").slice(1).forEach((function(e){const t=e.split("-"),s=t[0].split(":").map(Number),o=t[1];s[0]+=r,n.default.hasProperty(i,o)?i[o].push(s):i[o]=[s]}))})),!t.noAlign&&l&&y.setProperty({sentencesAlign:o.length?o:"",align:l,oldAlign:l});const c=Object.keys(i).map(e=>e.split(":").map(Number));let d=0,u=0;return e.split(/\r?\n/).forEach((function(e,t,o){const r=[];(function(e){let t=0;const s=[];n.default.getEmoji(e).forEach((function(i){t!==i.index&&s.push({value:e.slice(t,i.index)}),t=i.index+i.value.length,s.push({value:i.value,emojiCode:g(i.value)})}),this),t<e.length&&n.default.getValueTokens(e.slice(t)).forEach((e,t,i)=>{s.push({value:e+(t!==i.length-1?" ":"")})});return s})(e).forEach((e,t,s)=>{let o;for(;c[u]&&d>=c[u][0];){if(d===c[u][0]){const e=c[u].join(":");i[e].forEach((function(e){o=o?[o,e[0],e[0]+e[1]].join(":"):[e[0],e[0]+e[1]].join(":")}))}u++}r.push({value:n.default.trim(e.value),align:o||""}),s.length-1!==t&&r.push({value:" "}),d+=n.default.trim(e.value).length+1}),s.push({values:r,needLineBreak:null!=o[t+1]})})),{chunks:s}},y.on("change:sentencesAlign",e=>{const t=R.getProperty("sentenceIndex"),s=e&&e[t];_.setProperty("activeSentenceAlign",s)}),C.on("tap",(function(e){(!e.target||e.target.className&&e.target.className.indexOf&&-1===e.target.className.indexOf("idiom"))&&S.setState("visible",!1)})).on("scroll",(function(e){if(e.target!==this.getContentElement())return;const t=this.getScrollInfo();_.setProperty("translationScrollY",100/t.maxTop*t.top,{userScroll:this.userScroll}),this.userScroll||(this.userScroll=!0)})).on("keydown",(function(e){const t=this.getContentElement();n.default.hasCtrlKey(e)&&e.target===t&&e.keyCode===c.InputView.keys.A&&(n.default.preventEvent(e),n.default.selectElement(t))})).on("contentChanged",(function(){this.scrollTo(this.getScrollInfo().maxTop/100*_.getProperty("textScrollY"))})).on(d.TouchView.eventTypes.START,(function(e){(!e.target||e.target.className&&e.target.className.indexOf&&-1===e.target.className.indexOf("idioms-info"))&&E.setState("manualselect",e.pressure&&!E.hasState("editing"))})).on(d.TouchView.eventTypes.OUT,(function(){t.emit("trAlign",null),t.emit("trSelect",null),clearTimeout(i),S.setState("visible",!1)})).on(d.TouchView.eventTypes.OVER,(function(e){const s=this.getClosest(e.target,(function(e){return e.hasAttribute("data-align")}),!0);E.setState("manualselect",e.pressure&&!E.hasState("editing"));const n=s&&s.getAttribute("data-align");n&&!this.hasState("complaint")&&(t.emit("trAlign",n.split(":").map(Number)),!t._showedExamples&&m<2&&_.getProperty("supportExamples")&&!E.hasState("editing")&&(S.setPosition(e.target.getBoundingClientRect(),!0,!0),i=setTimeout((function(){t.emit("selectTooltipShown"),m++,S.setState("visible",!0)}),50)))})).bindDOMEvents("scroll",!0).bindDOMEvents(["keydown",d.TouchView.eventTypes.OUT,d.TouchView.eventTypes.OVER,d.TouchView.eventTypes.START]),P.prepareData=function(e){const t=P.toJSON(),s=t.index+t.pos,i=y.getProperty("sentencesAlign"),o=i[t.sentenceIndex]&&i[t.sentenceIndex][1];let r=_.getProperty("translation"),l=r.length;n.default.isEmpty(o)||(l=o[1]+o[0]+1),r=r.slice(s,l);return{values:a.TranslationPredictorPresenter.compareTranslations(r,e[0]).map((function(e,t){return{value:e,highlighted:t%2!=0}})),value:e[0]}},P.on("sentenceAlign",(e,t)=>this.emit("trAlign",e,t)).on("activeSentenceChanged",e=>{const t=y.getProperty("sentencesAlign"),s=t&&t[e];_.setProperty("activeSentenceAlign",s)}).on("error",()=>{C.hasState("waitingAlternative")&&(C.renderData(A.prepareData(_.getProperty("userTranslation"),{align:y.getProperty("align")})),C.setState({waitingAlternative:!1,alternative_error:!0}),this.emit("hideAlternatives"),setTimeout(()=>C.setState("alternative_error",!1),4e3))}).on("alternativesEndingReady",e=>{const t=R.getProperty("alternative"),s=n.default.getValueTokens(e[0])[0];!n.default.startsWith(s,t)||s.length>t.length&&n.default.isAlphaOrDigit(s[t.length])||(C.hasState("waitingAlternative")?(C.setState("waitingAlternative",!1),P.setValue(e[0])):this.emit("showTooltip",e[0]))}).on("ready",e=>{const t=_.getProperty("userTranslation");if("input"!==e.reason&&"predictor"!==e.reason)return L.setEnabled(!1);const s=a.TranslationPredictorPresenter.createRange(t,e);if(!s)return L.setEnabled(!1);v.renderData({text:t.slice(s.start,s.end)||".",leftText:t.slice(0,s.start),rightText:t.slice(s.end)}).scrollTo(v.getScrollInfo().maxTop/100*_.getProperty("textScrollY"));const i=v.getContentElement("[data-measurer-target]");i&&L.setPosition(i.getBoundingClientRect(),!1,!0),this.emit("dstPredictorShow",e)}).on("predictDst",(e,t)=>{const s=R.getProperty("sentenceIndex"),i=_.getProperty("userTranslation")||_.getProperty("translation");e.oldAlign=y.getProperty("sentencesAlign");const n=a.TranslationPredictorPresenter.prepareValue(e,i);let o=a.TranslationPredictorPresenter.updateAlign(n.modifiedAlign,y.getProperty("align"),{total:n.alignDifference},s);n.align[s+1]&&0===n.align[s+1][1][1]&&(o=a.TranslationPredictorPresenter.updateAlign("",o,{total:1},s+1),n.text=n.text.slice(0,n.caret)+" "+n.text.slice(n.caret),n.align=a.TranslationPredictorPresenter.getSentenceAlignFromAlign(o),n.caret++,P.prepareActiveSentence(n.caret,n.align)),y.setProperty("align",o),C.renderData(A.prepareData(n.text)),_.setProperty("translation",n.text),y.setProperty("sentencesAlign",n.align),L.setEnabled(!1),e.caret=n.caret,this.emit("dstPredictorApply",e,t.enter)}),f.trText&&A.setText(n.default.truncateText(f.trText,e.MAX_TRANSLATOR_QUERY),"auto"),e.TRANSLATION&&y.setProperty("translation",e.TRANSLATION,{align:e.ALIGN}),f.srcLang&&(A.setSrcLanguage(f.srcLang),P.setSrcLanguage(f.srcLang)),f.dstLang&&(A.setDstLanguage(f.dstLang),C.setLanguage(f.dstLang),P.setDstLanguage(f.dstLang)),this}},function(e,t,s){"use strict";t.__esModule=!0,t.TranslatorPresenter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(10),r=s(17);class a extends r.Presenter{constructor(e){super(e);const t=this,s=this.getView(),i=this.getModel();this.requestTranslation=n.default.debounce(a.prototype.requestTranslation),this.requestTranslationNow=this.requestTranslation.callNow,i.on("error",(function(e){const i=e.body&&e.body.code;if(s.setState("fetching",!1),i===this.constructor.errorMap.INVALID_SESSION||i===this.constructor.errorMap.EXPIRED_SESSION)return t.emit("expired",i);s.setState("offline",!n.default.isOnline()).setState("error",!0).setVisible(!1),t.emit("error",e)})).on("query",(function(e){s.setState("fetching",!0),t.emit("query",e)})).onChange(["text","srcLang","dstLang"],(e,t,s)=>{s.reason&&i.setProperty("reason",s.reason),"text"===e&&"paste"===s.reason?this.requestTranslationNow():this.requestTranslation()}).onInvalid("text",(function(){this.reset().setProperty("translation","")})).onSet("translation",(function(e,i){if(s.setState({error:!1,fetching:!1,offline:!1}),t.emit("result",e),!e)return s.setVisible(!1);s.renderData(t.prepareData(e,{align:i.align||""})).setVisible(!0),(0,o.getGlobalEmitter)().emit("translationRendered")}))}setText(e,t,s){let i=e;return i&&!n.default.isArray(i)&&(i=[i]),this.getModel().setText(i,{reason:t,silent:s}),this}setFormat(e){return this.getModel().setProperty("format",e),this}setSrcLanguage(e){return this.getModel().setProperty("srcLang",e),this}setDstLanguage(e){return this.getView().setLanguage(e),this.getModel().setProperty("dstLang",e),this}requestTranslation(){return this.getModel().requestTranslation(),this}}t.TranslatorPresenter=a},function(e,t,s){"use strict";t.__esModule=!0,t.TranslationPredictorPresenter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(17),r=s(150);class a extends o.Presenter{static createRange(e,t){const s={};return s.end=t.index,s.start=s.end+t.pos,s}static getSentenceIndex(e,t){let s=e.length-1;return 0===t?s=0:e&&e.forEach((function(e,i){const n=e[1][0],o=e[1][0]+e[1][1];t>=n&&t<=o&&(s=i)})),s}static getSentenceAlignFromAlign(e){if(e)return e.split(";").map((function(e){return e.split(",")[0].split("-").map((function(e){return e.split(":").map((function(e){return Number(e)}))}))}))}static calculateDifference(e,t,s,i){let o,r,a=t+1;const l=s[t][1];let c=i-l[0],d=e.total-c+l[1];for(e[t]=c-l[1];d<0&&!n.default.isEmpty(s[a]);){const t=s[a-1][1];r=s[a][1],o=r[0]-(t[1]+t[0]),d+=o,c=Math.abs(d)>r[1]?0:r[1]+d,d+=r[1]-c,e[a]={},e[a].difference=c-r[1],e[a].gap=o,a++}return e}static compareTranslations(e,t){const s=[];let i,n=[];const o=e.split(" "),r=t.split(" ");for(let e=0;e<r.length;e++){const t=r[e];o.indexOf(t)<0?(i||(s.push(n.join(" ")+" "),n=[]),n.push(t),i=!0):(i&&(s.push(n.join(" ")+" "),n=[]),n.push(t),i=!1)}return n.length&&s.push(n.join(" ")),s}static updateAlign(e,t,s,i){const n=[];let o,r=e;return t.split(";").forEach((function(e,t){let a;if(t===i){if(o=s[t]||s.total,!r){if(e.length<2)return;r=e.split(",")[0].split("-"),r[1]=r[1].split(":"),r[1][1]=Number(r[1][1])+o,r[1][1]<0&&(r[1][1]=0),r[1]=r[1].join(":"),r=r.join("-")}n.push(r)}else t>i?(a=e.split(","),s[t]?(a=a[0].split("-"),a[1]=a[1].split(":"),a[1][0]=Number(a[1][0])+o,a[1][1]=Number(a[1][1])+s[t].difference,a[1]=a[1].join(":"),n.push(a.join("-")),o+=s[t].difference-s[t].gap):(a=a.map((function(e){const t=e.split("-");return t[1]=t[1].split(":"),t[1][0]=Number(t[1][0])+o,t[1]=t[1].join(":"),t.join("-")})),n.push(a.join(",")))):n.push(e)})),n.join(";")}static prepareValue(e,t){const s=e.pos;let i=e.value;const o=e.sentenceIndex,r=e.oldAlign||[],a=r[o],l=a&&a[1][0]+a[1][1];let c=e.index,d=e.align.split(",");const u=d[0].split("-").map((function(e){return e.split(":").map(Number)}));s<0?c+=s:i=new Array(s+1).join(" ")+i;const h=a&&a[1][1],p=u[1][1]-h;return r.forEach((function(e,t){t>o?e[1][0]+=p:t===o&&(e[1][1]+=p,0!==o&&(d=d.map((function(t){let s=t.split("-");return s=s.map((function(t,s){const i=t.split(":");return i[0]=Number(i[0])+e[s][0],i.join(":")})),s.join("-")}))))})),{text:t.slice(0,c)+i+t.slice(l),caret:c+i.length,start:c+n.default.getValueTokens(i)[0].length,alignDifference:p,modifiedAlign:d.join(","),align:e.oldAlign}}constructor(e){super(e);const t=this,s=this.getView(),i=this.getModel(),o=function(){s.setVisible(!1).setEnabled(!1)};this.requestSuggestion=n.default.debounce(r.PredictorPresenter.prototype.requestSuggestion,200),s.on("tap",n.default.preventEvent).on("itemSelected",(function(e){e&&t.setValue(e)})),i.on("set",(function(e,i,n){let r;switch(e){case"items":return i?(r=this.toJSON(),r.items=this.getItems()||[],"alternatives"===r.reason?t.emit("alternativesEndingReady",r.items):(s.renderData(t.prepareData(r.items)).setEnabled(!0).setVisible(!0),t.emit("ready",r))):o();case"value":if(!i)return;return r=this.toJSON(),r.items=this.getItems()||[],r.align=this.getProperty("align"),t.emit("predictDst",r,n);case"prefix":if(s.setEnabled(!1),n.reason&&this.setProperty("reason",n.reason),this.isValid()&&this.isCachedPrefixValid())return this.showCashedResult()}})).on("error",()=>{o(),this.emit("error")}).on("change",(function(e,i,n){switch(e){case"text":case"limit":case"prefix":case"srcLang":case"dstLang":s.setEnabled(!1),n.reason&&this.setProperty("reason",n.reason),"prefix"!==e&&this.clearCash(),this.isCachedPrefixValid()?s.setEnabled(!0):t.requestSuggestion();break;case"sentenceIndex":t.emit("activeSentenceChanged",i),this.clearCash()}})).on("invalid",o)}prepareActiveSentence(e,t){const s=[];if(!t||!t.length)return;const i=a.getSentenceIndex(t,e);this.getModel().setProperty("sentenceIndex",i),s.push(t[i][0][0]),s.push(t[i][0][1]+t[i][0][0]),this.emit("sentenceAlign",s,{sender:"editor"})}setText(e,t){return this.getModel().setProperty("text",e,{reason:t}),this}setPrefix(e,t){return this.getModel().setProperty("prefix",e,{reason:t}),this}setIndex(e){return this.getModel().setProperty("index",e),this}setValue(e,t){return this.getModel().setProperty("value",e,t),this}setFullword(e,t){return this.getModel().setProperty("fullwordPrefix",e,t),this}setSrcLanguage(e,t){return this.getModel().setProperty("srcLang",e,t),this}setDstLanguage(e,t){return this.getModel().setProperty("dstLang",e,t),this}requestSuggestion(){return this.getModel().requestSuggestion(),this}}t.TranslationPredictorPresenter=a},function(e,t,s){"use strict";t.__esModule=!0,t.TranslationPredictorModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(44),r=s(72),a=s(69),l=s(19);class c extends r.ListboxModel{constructor(e,t){super(e,t),this.on("invalid",this.abort),this._cashedResults={},this._requestedPrefix=[]}abort(){"alternatives"!==this.getProperty("reason")&&a.SyncModel.prototype.abort.call(this)}setRequest(e){a.SyncModel.prototype.setRequest.call(this,e)}incrementCounter(){return this.setProperty("counter",this.getProperty("counter")+1)}getData(){const e=this.toJSON();return{text:e.text,prefix:e.prefix,options:e.options}}getParams(){const e=this.toJSON();return{id:[e.sid,e.counter,0].join("-"),srv:e.srv,lang:e.srcLang+"-"+e.dstLang,fullword_prefix:e.fullwordPrefix}}getDefaults(){return{pos:0,srv:"",url:"/",text:"",prefix:"",reason:"",srcLang:"",dstLang:"",align:"",index:0,counter:0,options:0,sentenceIndex:0,fullwordPrefix:0,sid:this.getId()}}runRequest(){const e=this,t=new l.HTTPRequest(this.getProperty("url"));if(this.abort(),!this.isValid())return this;const s=this.getData(),i=this.getParams();return this.incrementCounter(),this._requestedPrefix.push(s.prefix),this.emit("query",i),this.setRequest(t.setType(l.HTTPRequest.types.FORM).setData(s).setParams(i).setMethod(l.HTTPRequest.methods.POST).send((function(t,i){const n=e._requestedPrefix.indexOf(s.prefix);if(n>=0&&e._requestedPrefix.splice(n,1),t)return e.emit("error",t);e._cashResult(s.prefix,i.body.text[0],i.body.align[0]),e.setProperty("align",i.body.align[0]),e.handleResponse(i.body.text[0],s.prefix)})))}requestSuggestion(){o.sessionManager.getSid().then(e=>{this.setProperty({sid:e}).runRequest()})}handleResponse(e,t){const s=n.default.getValueTokens(t),i=t.trim().length-s[s.length-1].length,o=t.length-t.trim().length,r=e.slice(i);!r||t===e&&"alternatives"!==this.getProperty("reason")||this.setProperty({pos:-s[s.length-1].length-o}).setItems([r])}clearCash(){this._cashedResults={}}showCashedResult(e=this.getProperty("prefix")){const t=this._cashedResults[e];this.setProperty("align",t.align),this.handleResponse(t.text,e)}getCashedResult(e=this.getProperty("prefix")){const t=this._cashedResults[e],s=n.default.getValueTokens(e),i=e.trim().length-s[s.length-1].length;return this.setProperty("align",t.align),t.text.slice(i)}isCachedPrefixValid(e=this.getProperty("prefix")){const t=this._cashedResults[e]&&this._cashedResults[e].text;return t&&n.default.startsWith(t,e)}wasRequested(e=this.getProperty("prefix")){return this._requestedPrefix.includes(e)}_cashResult(e,t,s){this._cashedResults[e]={text:t,align:s}}}t.TranslationPredictorModel=c,c.options={ALIGN:4}},function(e,t,s){"use strict";t.__esModule=!0,t.initComplaintPopup=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(29),r=s(132),a=s(11),l=s(138),c=s(2);const d="complaint",u="error",h="success";t.initComplaintPopup=function(e){const t=this,s=t.getView(),i=t.getModel(),p=new c.TouchView({element:e.ELEMENTS.complaintInfoPopup,hideAfterTransition:!0}),g=new o.ListboxView({element:e.ELEMENTS.complaintPopup,template:e.TEMPLATES.empty,contentElement:e.ELEMENTS.dropContent,hideAfterTransition:!0}),m={isInitial:!0,top:0,left:0};let E;const _=this.getComplaintCommentInput(),T=new r.InputPresenter({view:new a.InputView({element:e.ELEMENTS.complaintPopupProposal,activateFocus:!0,contentElement:e.ELEMENTS.complaintPopupProposalInput}),model:new l.InputModel});let f;const S=e=>{g.getElement().setAttribute("data-status",e)},C=()=>{E&&E.removeAttribute("data-highlighted")},y=()=>{g.setVisible(!1)},A=()=>{let e=n.default.getAttribute(E,"data-group-index","0");return e&&(e=Number(e)+1),this.emit("dictComplaint",{type:n.default.getAttribute(E,"data-complaint-type"),name:n.default.getAttribute(E,"data-dict-type"),title:(n.default.getAttribute(E,"data-title")||"").replace("\n","").trim(),value:(E.textContent||"").trim(),comment:_.getValue(),proposal:T.getView().getValue(),groupNumber:e,partOfSpeech:n.default.getAttribute(E,"data-part-of-speech")})},v=()=>{this.emit("exampleComplaint",{id:n.default.getDataAttr(E,"id"),text:n.default.getDataAttr(E,"text"),translation:n.default.getDataAttr(E,"translation"),src:i.getProperty("text"),comment:_.getValue(),isIdiom:"idiom"===n.default.getDataAttr(E.querySelector(".example_ref"),"type")}),setTimeout(()=>{this.emit("complaintStatus")},50)},L=()=>{this.emit("relatedWordsComplaint",{comment:_.getValue(),dir:this.getLangsPair(),src:i.getProperty("text"),wordType:n.default.getDataAttr(E,"word-type"),wordValue:n.default.getDataAttr(E,"value")}),this.emit("complaintStatus",!1)},R=()=>{if(g.setState("error",!1),!i.getProperty("complaint"))return;switch(n.default.getDataAttr(E,"complaint-type")){case"example":v();break;case"relatedWord":L();break;case"declensions":setTimeout(()=>{this.emit("complaintStatus")},50);break;default:A()}},P=function(e,o){if(i.getProperty("complaint"))if(o&&o===E)E=null,t.setComplaintTarget(null),i.setProperty("complaint",!1),s.setState("complaint",!1);else if(o!==E){const e=g.getElement(),t=e.style,s=n.default.getAttribute(E,"data-complaint-type"),i=n.default.toObject(E.getBoundingClientRect()),o=()=>{("fullTextTranslation"===s?T:_).getView().setFocus(!0)};E.setAttribute("data-highlighted",!0),e.setAttribute("data-complaint-type",s),clearTimeout(f),g.on("stateSet:transitionEnded",e=>{e&&o()}).setPosition(i,!1,!0).setVisible(!0),(({top:e,left:t})=>m.top!==e||m.left!==t)(t)&&((({top:e,left:t})=>{m.isInitial=!1,m.top=e,m.left=t})(t),m.isInitial||o())}};return t.on("showComplaintPopup",(function(e,t){S(t),clearTimeout(f),setTimeout(()=>{g.setVisible(!0).setPosition(e.getBoundingClientRect(),!1,!0)},0)})).on("closeComplaintPopup",(function(){y()})).on("complaintStatus",(function(e){f=setTimeout(()=>{y(),C()},4e3),S(e?u:h)})).on("action",(function(e){switch(e){case"sendComplaint":case"retryComplaint":R();break;case"cancelComplaintMode":case"toggleComplaintMode":(()=>{const e=s.hasState("complaint");i.setProperty("complaint",!e,{type:"auto",sender:"dict"}),s.setState("complaint",!e)})()}})),g.onVisibilityChanged((function(e){const s=e?"once":"off";t[s]("resize",y),t[s]("dictScrolled",y)})),s.onStateChanged("complaint",e=>{p.setVisible(e)}).on("tap",(function(s,o=null){if(!i.getProperty("complaint")&&!g.isVisible())return;const r=o||s.target;if(!((t,s=null)=>{const i=s||t.target,n=g.getElement().contains(i),o=e.ELEMENTS.keyboard.contains(i);return!n&&!o})(s,o))return;C();const a=E;if(E=this.getClosest(r,(function(e){return"true"===n.default.getDataAttr(e,"complaint-target")||e.hasAttribute("data-complaint-type")})),t.setComplaintTarget(E),!E)return void y();n.default.getDataAttr(E,"complaint-type")?(S(d),P(0,a)):y()})),i.on("change",(function(e,t){switch(e){case"trText":case"selText":case"srcLang":case"dstLang":this.getProperty("complaint")&&this.setProperty("complaint",!1,{type:"change"});break;case"complaint":t||y()}})),g.on("stateChanged:hidden",(function(e){e?(C(),E=null,t.setComplaintTarget(null),i.setProperty("complaint",!1),s.setState("complaint",!1)):(p.setVisible(!1),_.setValue(""),T.setValue(""))})),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initShareButton=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(2),r=s(179),a=s(29),l=s(180);t.initShareButton=function(e){const t=this,s=this.getModel(),i=new o.TouchView({element:e.ELEMENTS.shareInput,stopDefaultAction:!0}),c=new o.TouchView({element:e.ELEMENTS.shareButton,activateFocus:!0,ignorePreventFocus:!0}),d=new o.TouchView({element:e.ELEMENTS.shareCopyLink,stopDefaultAction:!0}),u=new r.SharePresenter({view:new a.ListboxView({element:e.ELEMENTS.share,template:e.TEMPLATES.listbox,contentElement:e.ELEMENTS.shareContent,stopDefaultAction:!0,ignoreSelection:!0,hideAfterTransition:!0}),model:new l.ShareModel({url:e.SHARE_URL,title:document.title})}),h=u.getView(),p=function(s){if(c.setEnabled(s&&s.length<=e.MAX_SHARE_TEXT_LENGTH),!s)return;const n=t.getLink({absolute:!0});i.setContent(n,{asText:!0}),u.setLink(n).setDescription(s)};return this.on("action",(function(t){switch(t){case"mailTo":u.write();break;case"openSearch":this.emit("textSearch"),window.open(e.SEARCH_URL+"?"+n.default.toQueryString({text:'"'+s.getProperty("translation")+'"'}))}})).bindFocusActivation(c),s.on("set:translation",p),i.on("tap",(function(){n.default.selectElement(this.getElement()),c.setFocus(!0),t.emit("shareInputClick")})),c.on("tap",(function(){c.setFocus(!0),t.emit("sharingOpen"),h.setVisible()})).on("stateChanged:focused",(function(e){e||h.setVisible(!1)})),u.prepareData=function(t){const s={};return s.items=t.map((function(t){return{value:t,title:e.SOCIAL_SERVICES[t]}})),s},u.on("share",(function(e){t.emit("shareData",e)})).on("write",(function(e){t.emit("writeMail",e)})).setItems(Object.keys(e.SOCIAL_SERVICES)),d.on("tap",(function(){this.hasState("copy")&&n.default.copyText(t.getLink({absolute:!0}))&&s.setProperty("tooltip",e.TOOLTIPS.copyLink2),n.default.selectElement(i.getElement()),c.setFocus(!0),t.emit("shareButtonClick")})).on("stateChanged:copy",(function(t){const s=this.getElement();s.setAttribute("data-tooltip-nohide",t),s.setAttribute("data-tooltip",e.TOOLTIPS.copyLink)})).setState("copy",n.default.copySupported),h.on("stateChanged:hidden",(function(e){e||this.setPosition(c.getRect(),!0,!0)})),p(s.getProperty("translation")),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initExternalView=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(24);t.initExternalView=function(e){const t=this.getModel(),s=new o.TemplateView({element:e.ELEMENTS.external,template:e.TEMPLATES.external,contentElement:e.ELEMENTS.externalContent}),i=function(t){let i;t&&(i=this.toJSON(),s.renderData({items:Object.keys(e.EXTERNAL_SERVICES).map((function(t){const s={},o=e.EXTERNAL_SERVICES[t];return s[o.textParam]=i.trText,s[o.srcLangParam]=i.srcLang,s[o.dstLangParam]=n.default.normalizeExternalLang(i.dstLang,o),{text:t,name:t,href:o.href+"?"+n.default.toQueryString(s)}}))})),s.setVisible(t&&t.length<=e.MAX_SHARE_TEXT_LENGTH)};return t.on("set:translation",i),i.call(t,t.getProperty("translation")),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initTranslationVote=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(2),r=s(11),a=s(132),l=s(138);const c="feedback",d="success_like",u="success_dislike";t.initTranslationVote=function(e){const t=this,s=this.getView(),i=this.getModel(),h=new o.TouchView({element:e.ELEMENTS.goodVoteButton}),p=new o.TouchView({element:e.ELEMENTS.badVoteButton}),g=new r.InputView({element:r.InputView.makeFakeArea(e.ELEMENTS.translation),activateFocus:!0}),m=new a.InputPresenter({view:g,model:new l.InputModel}),E=m.getModel(),_=new o.TouchView({element:e.ELEMENTS.feedbackPopup,hideAfterTransition:!0}),T=new a.InputPresenter({view:new r.InputView({element:e.ELEMENTS.feedbackInput,activateFocus:!0}),model:new l.InputModel});let f=!1;const S=e=>{setTimeout(()=>{f=!0,_.getElement().setAttribute("data-status",e),_.setVisible(!0)},0)},C=()=>{f=!1,_.setVisible(!1)};let y;return s.on("tap",(function(t){if(!f)return;if(e.ELEMENTS.keyboard.contains(t.target))return;n.default.getClosest(t.target,e=>e===_.getElement())||C()})),this.on("action",e=>{if("saveEditing"===e){const e=n.default.trim(g.getValue()),t=i.getProperty("translation");e!==t&&(this.emit("editorResult",e,t),s.setState({edited:!0,editing:!1}))}else if("sendFeedback"===e){const e=i.getProperty("translation");this.emit("editorResult",T.getValue(),e),S(u)}else"cancelFeedback"===e&&C()}),this.on("changeEditorValue",(function(e){E.setProperty("value",e)})).on("dstPredictorApply",e=>{E.setProperty("value",g.getValue(),{silent:!0}),m.setCaret(e.caret)}).bindFocusActivation(h).bindFocusActivation(p),s.on("stateChanged",(function(e,s){switch(e){case"editing":s||t.emit("trAlign",null),t.emit("containerHeightChanged")}})),i.on("change",(function(i,o,r){switch(i){case"trText":case"srcLang":case"dstLang":s.hasState("editing")&&t.emit("editorToggle",{type:"change",value:g.getValue()}),s.setState({edited:!1,editing:!1});break;case"translation":o&&t.toggleTranslatorExpandState(!0);const i=o&&o.length<=e.MAX_EDITOR_TEXTLENGTH&&!n.default.isUrl(o);p.setState("voted",!1).setEnabled(i),h.setState("voted",!1).setEnabled(i);break;case"userTranslation":g.setValue(o,r),r.caret&&m.setCaret(r.caret)}})),g.on("tap",()=>{this.emit("trTextTap")}).on("click",e=>{-1===e.target.className.indexOf("translit")&&this.emit("trTextClick",g.getSelection().start,g.getValue(),e)}).on("mousedown",()=>{this.emit("trTextMouseDown")}).on("keydown",e=>{this.emit("trTextKeydown",e,{sender:g})}).on("keyup",e=>{this.emit("trTextKeyup",e,{caret:g.getSelection().start})}).on("enterPressed",()=>{this.getSettings().isOptionEnabled("enter")&&this.emit("input")}).on("stateChanged:focused",e=>{this.emit("trTextFocus",e),e||this.emit("action","saveEditing"),s.setState("editing",e)}).bindDOMEvents("click mousedown keydown keyup enterPressed"),p.on("tap",()=>{s.hasState("complaint")&&this.emit("action","toggleComplaintMode"),C(),y&&clearTimeout(y),p.hasState("voted")?(p.setState("voted",!1),h.setEnabled(!0)):(p.setState("voted",!0),h.setEnabled(!1),t.emit("translationVoted",i.getProperty("translation")),T.setValue(""),S(c))}),h.on("tap",()=>{s.hasState("complaint")&&this.emit("action","toggleComplaintMode"),C(),y&&clearTimeout(y),h.hasState("voted")?(h.setState("voted",!1),p.setEnabled(!0)):(h.setState("voted",!0),p.setEnabled(!1),t.emit("translationVoted",i.getProperty("translation"),!0),S(d),y=setTimeout(C,5e3))}),m.on("input",(function(e,n={}){s.hasState("editing")&&(n.caret=n.caret||this.getCaret(),n.reason=n.reason||"input",t.emit("trTextInput",e,n),i.setProperty("userTranslation",e,n))})),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initTextCounter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(2);t.initTextCounter=function(e){const t=this.getModel(),s=new o.TouchView({element:e.ELEMENTS.textCounter,contentElement:e.ELEMENTS.textCounterContent}),i=new o.TouchView({element:e.ELEMENTS.textCounter,contentElement:e.ELEMENTS.textCounterLimit}),r=()=>{const{srcLang:o,text:r}=t.getProps(),a="emj"===o,l=a?(()=>{const{text:e}=t.getProps(),s=n.default.getEmoji(e),i=s.reduce((e,{value:t})=>t.length+e,0);return s.length+e.length-i})():r.length,c=a?500:e.MAX_TRANSLATOR_QUERY;s.setState("warning",l>c).setContent(l,{asText:!0}),i.setContent(c,{asText:!0})};return t.onChange("text",()=>{r()}).onChange("srcLang",()=>{r()}),r(t.getProperty("text")),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initDescription=void 0;var i=s(2);t.initDescription=function(e){const t=this.getView(),s=this.getModel(),n=new i.TouchView({element:e.ELEMENTS.serviceDescription});return s.on("change",(function(e,s,i){switch(e){case"trText":s&&n.setVisible(!1);break;case"srcLang":case"dstLang":i.oldValue&&t.setState("hidden_service-description",!0)}})),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initDescriptionDict=void 0;var i=s(2);t.initDescriptionDict=function(e){const t=this.getView(),s=this.getModel(),n=new i.TouchView({element:e.ELEMENTS.serviceDescription});return s.on("change",(function(e,s,i){switch(e){case"trText":case"srcLang":case"dstLang":i.oldValue&&(t.setState("hidden_service-description",!0),n.setVisible(!1))}})),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initMetrikas=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(10),r=s(2),a=s(19),l=s(43),c=s(3),d=s(136),u=s(137),h=s(141),p=s(131),g=s(190),m=s(191);t.initMetrikas=function(e){const t={},s={},i=this.getModel(),E=this.getStatisticsModel(),_={ids:{"app/image":{},"app/sms":{},"app/stores":{},"app/stores/android":{},"app/stores/ios":{},badVoteButton:{},clearButton:{},collectionsButton:{},copyButton:{},dict:{sendRender:!0},"dict/article":{},"dict/article/hideExamples":{},"dict/article/meaning":{},"dict/article/meaning/example":{},"dict/article/showExamples":{},"dict/collapse":{},"dict/expand":{},dstLangButton:{},dstTextbox:{},examples:{sendRender:!0},"examples/article":{},"examples/article/example":{},"examples/article/example/badVote":{},"examples/article/example/dst":{},"examples/article/example/dst/speaker":{},"examples/article/example/goodVote":{},"examples/article/example/ref":{},"examples/article/example/src":{},"examples/article/example/src/speaker":{},"examples/root":{},"examples/tabs":{},"examples/tabs/tab":{},externalTranslate:{},"externalTranslate/Google":{},"externalTranslate/Bing":{},favButton:{},"footer/about":{},"footer/blog":{},"footer/dev":{},"footer/help":{},"footer/langSwitch":{},"footer/legal":{},"footer/mobile":{},"footer/usability":{},"footer/yandex":{},"footerline/close":{},goodVoteButton:{},keyboardButton:{},microphone:{},options:{},"options/button":{},"options/listbox":{},popup:{sendRender:!0},"popup/dict":{sendRender:!0},"popup/dict/article":{},"popup/dict/article/meaning":{},"popup/examples":{sendRender:!0},"popup/examples/article/example":{},"popup/examples/article/example/dst":{},"popup/examples/article/example/ref":{},"popup/examples/article/example/src":{},shareButton:{},spellerButton:{},srcLangButton:{},srcTextbox:{},swapLang:{},syns:{sendRender:!0},"syns/article":{},tabs:{},"tabs/image":{},"tabs/url":{},targetTranslitButton:{},textSpeaker:{},translatorSpeaker:{},"user/button":{},"user/listbox":{},"user/listbox/addUser":{},"user/listbox/logout":{},"user/listbox/name":{},"user/listbox/passport":{},"user/listbox/secondary":{},yandex:{},yandexTranslate:{}},defaults:{minHoverDuration:300,sendRender:!1}},T=function(e){const t=E.getTrackingDomLeafData(e).id;return n.default.hasProperty(_.ids,t)?n.default.extend({},_.defaults,_.ids[t]):n.default.clone(_.defaults)};let f=null,S=null;const C=[],y=this.getRouter();return c.$tracker.onMetricSend((e,t={})=>{E.send(e,t)}),e.ENABLE_DOM_TRACKING&&(this.getView().on(r.TouchView.eventTypes.OVER,(function(e){const t=n.default.getEventPath(e);for(;C.length>0;){const s=C.pop(),i=e.timeStamp-s.timeStamp;if(C.length<t.length&&s.element===t[C.length]){C.push(s);break}E.isTrackingDom(s.element)&&i>=T(s.element).minHoverDuration&&E.sendSingleTrackingDom(s.element,"hover",{duration:Math.floor(i)})}t.slice(C.length).forEach((function(t){C.push({element:t,timeStamp:e.timeStamp})}))})).on(r.TouchView.eventTypes.END,(function(e){const t=function(){const e=n.default.getSelectedElement(),t=n.default.getSelectedText(),s=t!==f||e!==S;return f=t,S=e,""!==t&&s?t:null}();null!==t&&E.sendNestedTrackingDom(e,"select_text_fragment",{text:t})})).on("tap",(function(e){E.sendNestedTrackingDom(e,"tap",null)})).bindDOMEvents(["copy",r.TouchView.eventTypes.OVER,r.TouchView.eventTypes.END],!0),(0,o.getGlobalEmitter)().on("viewContentChanged",(function(e){const t=[e.getElement()];let s,i;for(;t.length>0;){for(s=[],i=t.pop();i||t.length>0;i=t.pop())E.isTrackingDom(i)&&T(i).sendRender&&E.sendSingleTrackingDom(i,"render",{}),s.push.apply(s,i.childNodes||[]);t.push.apply(t,s)}}))),this.getView().on("copy",(function(e){E.sendNestedTrackingDom(e,"copy_text_selection",{text:n.default.getSelectedText()})})),this.on("track",(function(e){E.sendMetrika(e)})).on("pageReady",(function(){const e=this.getProps();E.send("page_load",{text:e.trText||"",src_lang:e.srcLang||"",dst_lang:e.dstLang||"",referrer:document.referrer||""})})).on("pageLoaded",(function(){const e=this.getView(),t=this.getSettings();e.hasState("faked")&&E.send("yata_init"),E.send("settings_onload",{auto:t.getProperty("auto")?1:0,enter:t.isOptionEnabled("enter")?1:0,autospeller:t.getProperty("autospeller")?1:0,history:t.isOptionEnabled("history")?1:0,theme:t.getProperty("theme")||"",preferDarkMode:n.default.preferDarkMode()?1:0})})).on("optionsOpen",(function(){E.send("settings_open")})).on("optionsChanged",(function(e,t){const s="settings_"+e+"_click";E.send(s,{name:e,enabled:t?1:0})})).on("action:closePromoFooter",(function(){E.send("footer_promo_close")})).on("textDelete",(function(){E.send("text_delete")})).on("textSearch",(function(){E.send("text_search")})).on("textCopy",(function(e){const t="text_"+(e?"copy":"select"),s=this.getProps();E.send(t,{src_length:s.text.length,dst_length:s.translation.length})})).on("textDownload",(function(){const e=this.getProps();E.send("text_download",{src_length:e.text.length,dst_length:e.translation.length})})).on("resizerResize",(function(e){E.send("resizer_resize",{old_height:e.oldHeight,new_height:e.newHeight,main_height:e.mainHeight})})).on("translateQuery",e=>{E.send("text_translate",{id:e})}).on("translatePage",(function(){const e=this.getProps();E.send("url_translate",{url:e.text})})).on("translationVoted",(function(t,s){E.getSid().then(i=>{const n=this.getProps(),o=n.srcLang+"-"+n.dstLang,r=new a.HTTPRequest(e.VOTES_URL);E.send("translation_vote_"+(s?"good":"bad"),{src:n.text,dst:n.translation,vote:s?1:0,translation_id:this.getTranslatorModel().getLastTranslationId()}),r.setType(a.HTTPRequest.types.JSON).setData({uid:e.UID,srv:e.SRV,sid:i,lang:o,text:n.trText,upvote:Boolean(s),translation:t}).setParams({uid:e.UID}).setHeader("X-CSRF-Token",e.CSRF_TOKEN).setMethod("POST").send()})})).on("editorResult",(function(t,s){E.getSid().then(i=>{const n=this.getProps(),o=new a.HTTPRequest(e.VOTES_URL);E.send("translation_edit",{value:t,oldValue:s}),o.setType(a.HTTPRequest.types.JSON).setData({uid:e.UID,srv:e.SRV,sid:i,lang:n.srcLang+"-"+n.dstLang,text:n.trText,proposal:t,translation:s}).setParams({uid:e.UID}).setHeader("X-CSRF-Token",e.CSRF_TOKEN).setMethod("POST").send()})})).on("editorToggle",(function(e){const t=this.getProps(),s={type:e.type},i="translation_edit_"+(e.open?"open":"close");e.open||e.value===t.translation||(s.src=t.trText,s.dst=t.translation),s.edit=e.value!==t.translation?e.value:"",E.send(i,s)})).on("translationError",(function(e){if(window.navigator.onLine){const t=e.body||e;E.send("translation_error",{error:t.code,message:t.message})}})).on("textPaste",n.default.debounce((function(e,t){E.send("text_paste",{old_text_length:t.length,new_text_length:e.length,old_text:t,new_text:e})}),300)).on("rubberScrolled",n.default.throttle((function(){E.send("rubber_scrolled",{throttleDuration:1e3})}),1e3)),this.on("predictorApply",(function(e,t){let s;const i=e.items,n=this.getProps();e.pos<0&&(s=e.text.slice(e.pos)!==i[0].substr(0,Math.abs(e.pos))),E.send("predictor_apply",{src:e.text,pos:e.pos,eow:e.endOfWord?1:0,lang:n.srcLang,type:t?"enter":"click",error:s?1:0,reason:e.reason,suggest:i})})).on("predictorShow",(function(e){let t;const s=e.items,i=this.getProps();e.pos<0&&(t=e.text.slice(e.pos)!==s[0].substr(0,Math.abs(e.pos))),E.send("predictor_show",{src:e.text,pos:e.pos,eow:e.endOfWord?1:0,lang:i.srcLang,error:t?1:0,reason:e.reason,suggest:s})})).on("dstPredictorApply",(function(e,t){E.send("dst_predictor_apply",{src:e.text,pos:e.index,lang:e.dstLang,type:t?"enter":"click",reason:e.reason,suggest:e.items[0]})})).on("dstPredictorShow",(function(e){E.send("dst_predictor_show",{src:e.text,pos:e.index,lang:e.dstLang,reason:e.reason,suggest:e.items[0]})})).on("autocorrect",(function(){E.send("speller_autocorrect")})).on("spellerClick",(function(e,t){const s=this.getProps();E.send("speller_click",{word:e.word,lang:s.srcLang,text_length:n.default.trim(s.text).length,replacements:e.s.length,autocorrected:t?1:0})})).on("spellerApply",(function(e){const t=this.getProps(),s="speller_"+(e.accept?"accept":"apply");E.send(s,{word:e.item.word,lang:t.srcLang,text_length:n.default.trim(t.text).length,replacement:e.replacement})})).on("spellerDecline",(function(e){const t=this.getProps(),s=e.s||[];E.send("speller_decline",{word:e.word,lang:t.srcLang,text_length:n.default.trim(t.text).length,replacements:s.length,replacement:s[0]})})).on("autoSpellerClick",(function(e){const t=this.getProps(),s="speller_switch_"+(e?"on":"off");E.send(s,{lang:t.srcLang,enabled:e?1:0,text_length:n.default.trim(t.text).length})})),this.on("speakerAction",(function(e){const t=this.getProps();let s,i="",n="";t.srcLang===e.lang?(i=t.srcLang,n="source",s="tts_play_src"):t.dstLang===e.lang&&(i=t.dstLang,n="target",s="tts_play_dst"),s=e.error?"tts_error":s,E.send(s,{lang:i,engine:e.playerType||"yandex",text:e.text,type:n})})).on("asrStart",(function(e){const t=this.getProps();E.send("asr_start",{lang:t.srcLang,engine:e})})).on("asrEnd",(function(e,t){E.getSid().then(s=>{const i={lang:this.getProps().srcLang,asr_id:[s,e.index].join("-"),engine:t};e.error&&(i.error=e.error.replace(/-/g,"_")),E.send(e.error?"asr_error":"asr_stop",i)})})).on("asrResult",(function(e,t){E.getSid().then(s=>{const i=this.getProps();E.send("asr_recognize",{lang:i.srcLang,asr_id:[s,e.index,e.resultIndex].join("-"),engine:t,text:e.value})})})).on("exampleVoted",(function(e){E.send("example_vote_"+(e.vote?"good":"bad"),e)})),this.on("synonymsInsert",(function(e,t){const s=this.getProps();E.send("syns_insert",{src:t.oldValue,lang:s.srcLang,type:t.type||"",synonym:e})})).on("dictLinkClick",(function(e,t){E.send("dict_link_click",{type:t.type,value:e})})).on("dictComplaint",t=>{E.getSid().then(s=>{const i=this.getProps(),n=i.srcLang+"-"+(t.name?i.srcLang:i.dstLang),o=t.name?"syn":"dict",r=new a.HTTPRequest(e.VOTES_URL);if("fullTextTranslation"===t.type){E.send("translation_complain",{translation:t.value,comment:t.proposal,src:i.text});const o={uid:e.UID,srv:e.SRV,sid:s,lang:n,text:i.trText,upvote:!1,comment:t.comment,proposal:t.proposal,translation:t.value};return r.setType(a.HTTPRequest.types.JSON).setData(o).setParams({uid:e.UID}).setHeader("X-CSRF-Token",e.CSRF_TOKEN).setMethod("POST").send(),this.emit("complaintStatus")}E.send("dict_complain",{src:i.selText||i.trText,dict:n+(t.name?"-"+t.name:""),block:o,value:t.value,comment:t.comment}),this.emit("complaintStatus",!1)})}).on("dictComplaintToggle",(function(e,t){let s="";const i=t.type;let n="";const o=this.getProps(),r="dict_complain_"+(e?"open":"close");switch(i){case"send":case"cancel":t.name?(n="syn",s=o.srcLang+"-"+o.srcLang+"-"+t.name):(n="dict",s=o.srcLang+"-"+o.dstLang);break;case"toggle":n=t.sender;break;case"auto":n="syn"===t.sender?"dict":"syn"}E.send(r,{dict:s,type:i,open:e?1:0,block:n})})).on("exampleComplaint",(function(e){E.send("examples_complaint",{example_id:e.id,text:e.text,translation:e.translation,src:e.src,comment:e.comment,isIdiom:e.isIdiom})})).on("dictRendered",(function(e){const t=this.getProps(),i=s.trText!==t.trText||s.selText!==t.selText||s.srcLang!==t.srcLang||s.dstLang!==t.dstLang||s.text!==e.text;if(t.trText!==t.selText&&i){const i={src:e.text||t.selText||t.trText,popup:e.popup?1:0,text_length:n.default.trim(t.text).length};e.popup||(i.selection=t.selText||e.text&&e.text!==t.trText?1:0,i.definition=e.definition?1:0,i.has_examples=e.noExamples?0:1,i.examples_shown=e.expanded&&!e.noExamples?1:0),E.send(e.popup?"dict_popup_show":"dict_show",i),s.text=e.text,s.trText=t.trText,s.selText=t.selText,s.srcLang=t.srcLang,s.dstLang=t.dstLang}})).on("examplesRendered",(function(e){const s=this.getProps();if(s.trText!==s.selText&&(t.trText!==s.trText||t.selText!==s.selText||t.srcLang!==s.srcLang||t.dstLang!==s.dstLang||t.text!==e.text)){const i=e.popup?"examples_popup_rendered":"examples_rendered";E.send(i,{src:e.text||s.selText||s.trText,popup:e.popup?1:0,selection:s.selText||e.text&&e.text!==s.trText?1:0}),t.text=e.text,t.trText=s.trText,t.selText=s.selText,t.srcLang=s.srcLang,t.dstLang=s.dstLang}})),this.on("collectionsSync",(function(e){E.send("cols_sync",{type:e?"manual":"auto"})})).on("recordAdd",(function(e,t){e||E.send("cols_record_add",{auto:0,col_id:t,location:"translation"})})).on("recordDelete",(function(e){E.send("cols_record_delete",{col_id:e,location:"translation"})})).on("recordsDelete",(function(e){E.send("cols_records_delete",{total:e.total,count:e.count})})).on("recordsMoved",(function(e){E.send("cols_records_move",{new:e.new?1:0,count:e.count,sender:e.sender})})).on("recordsCopy",(function(e){E.send("cols_records_copy",{new:e.new?1:0,count:e.count})})).on("recordInsert",(function(){E.send("cols_record_insert")})).on("collectionsOpened",(function(e){e&&E.send("cols_open")})).on("newCollectionTap",(function(){E.send("cols_create_tap")})).on("collectionCreated",(function(e){E.send("cols_create",{public:e?1:0})})).on("collectionRenamed",(function(){E.send("cols_rename")})).on("collectionDeleted",(function(){E.send("cols_delete")})).on("collectionChanged",(function(e){E.send("cols_public_change",{public:e?1:0})})).on("collectionSubscribed",(function(e,t){E.send(t?"cols_subscribe_limit":"cols_subscribe",{type:e||"collection_menu",limit:t?1:0})})).on("collectionUnsubscribed",(function(e){E.send("cols_unsubscribe",{type:e})})).on("collectionSaved",(function(){E.send("cols_save")})).on("collectionSearchActivate",(function(){E.send("cols_search_activate")})).on("collectionMenuOpen",(function(){E.send("cols_menu_open")})).on("collectionLinkCopied",(function(){E.send("cols_link_copy")})).on("collectionShareData",(function(e){E.send("cols_link_share",{type:e.service})})).on("collectionWriteMail",(function(){E.send("cols_link_share",{type:"email"})})).on("collectionsInactiveTap",(function(){E.send("cols_db_inactive_tap")})).on("resetedIds",(function(){E.send("cols_reseted_ids")})).on("checkRecordError",(function(e){E.send("cols_db_error_excp",{message:e})})).on("databaseError",(function(e){const t={sender:e.sender,err_name:e.name||"",message:e.message||""};e.trace&&(t.db_open_trace=e.trace),E.send("cols_db_error",t)})).on("noCollectionForActiveId",(function(){E.send("cols_no_col_for_active_id")})).on("dbIndexNotFound",(function({indexName:e,version:t}){E.send("cols_db_index_not_found",{index_name:e,version:t})})),this.on("popupShown",(function(e){const t=this.getProps(),s=t.selTr||t.selText,i="popup_"+(e.empty?"empty_":"")+(e.show?"show":"close");E.send(i,{text:e.invalid?"":s,text_length:s.length,invalid:e.invalid?1:0,empty:e.empty?1:0,show:e.show?1:0})})).on("enableCustomMode",()=>{const e=this.getProps(),t=e.selTr||e.selText;E.send("more_examples_click",{text:t,text_length:t.length})}).on("toggleMoreExamples",(function(e){E.send("examples_"+(e.show?"show_more":"hide"),{src:e.text,dst:e.translation,example_count:e.count,show:e.show?1:0})})).on("exampleSoundTap",(function(e){E.send("example_sound",{engine:e.type,ref:e.ref,lang:e.lang,src:e.text,dst:e.title})})).on("originTooltipShown",(function(e){E.send("example_origin_show",{type:e.type,src:e.text,origin:e.origin})})).on("selectTooltipShown",(function(){E.send("select_tooltip_show")})).on("exampleTabTap",(function(e){E.send("example_tab_click",{src:e.text,dst:e.translation})})).onAction("disableCustomMode",()=>{E.send("custom_examples_close")}),this.on("sharingOpen",(function(){E.send("sharing_open")})).on("shareButtonClick",(function(){E.send("sharing_copy_click",{type:"icon"})})).on("shareInputClick",(function(){E.send("sharing_input_click",{type:"input"})})).on("shareData",(function(e){const t=this.getProps(),s="sharing_share_"+e.service;E.send(s,{type:e.service,src:t.text,dst:t.translation})})).on("writeMail",(function(){const e=this.getProps();E.send("sharing_share_mail",{type:"email",src:e.text,dst:e.translation})})).on("keyboardOpen",(function(e){const t=this.getProps(),s="keyboard_"+(e.open?"open":"close"),i={lang:t.srcLang};e.open||(i.type=e.type),E.send(s,i)})).on("action:expiredRefresh",(function(){E.send("refresh_alert_click")})).on("refreshAlertShow",(function(e){E.send("refresh_alert_show",{error_code:e})})).on("sessionResumed",(function(e){E.send("session_resume",{idle_time:e})})).on("externalClick",(function(e){const t=this.getProps();E.send("alt_translate_"+e.toLowerCase(),{name:e.toLowerCase(),src:t.text,dst:t.translation})})).on("translitToggle",(function(e,t){E.send("translit_"+(t?"hide":"show"),{type:e,show:t?0:1})})).on("translitTogglerShown",(function(e){E.send("translit_button_show",{type:e})})).on("translitError",(function(e){E.send("translit_error",{type:e})})).on("distBannerAutoHide",(function(){E.send("dist_banner_hide")})).on([l.A11Y_EVENTS.SELECT_ACTIVATION,l.A11Y_EVENTS.ACTIVATION],(e,t)=>{E.send("focused_element_activation",{el:n.default.elementToString(t,35,["id","class","data-action"]),source:e===l.A11Y_EVENTS.SELECT_ACTIVATION?"space":"enter"})}).on("historySettingToggle",(function(e){E.send(e?"history_setting_enabled":"history_setting_disabled")})),y.on("historyMove",(function(e){E.send("history_move",e)})),(0,o.getGlobalEmitter)().on("uniproxyAsrError",(function(e,t={}){E.send("uniproxy_asr_error",{error:e,...t})})).on("uniproxyTtsError",(function(e,t,s={}){E.send("uniproxy_tts_error",{error:e,payload:t,...s})})),(0,c.getTrackerByNamespace)(g.SUGGESTIONS_METRIKAS).on(g.SUGGESTIONS_METRIKAS.SHOW,()=>{E.send("suggestions_show")}).on(g.SUGGESTIONS_METRIKAS.APPLY,({index:e,type:t,source:s,len:i})=>{E.send("suggestions_apply",{index:e,type:t,source:s,len:i})}).on(g.SUGGESTIONS_METRIKAS.ITEM_NAVIGATE,({index:e,type:t})=>{E.send("suggestions_item_navigate",{index:e,type:t})}).on(g.SUGGESTIONS_METRIKAS.ITEM_HOVER,({index:e,type:t})=>{E.send("suggestions_item_hover",{index:e,type:t})}),(0,c.getTrackerByNamespace)(m.HISTORY_METRIKAS).on(m.HISTORY_METRIKAS.APPLY_ITEM,({index:e})=>{E.send("history_select",{index:e})}).on(m.HISTORY_METRIKAS.OPEN_HISTORY,({source:e=null})=>{E.send("history_open",{source:e})}),(0,c.getTrackerByNamespace)(d.RELATED_WORDS_METRIKAS).on(d.RELATED_WORDS_METRIKAS.RENDER,({items:e})=>{const{text:t}=this.getProps();E.send(d.RELATED_WORDS_METRIKAS.RENDER,{src:t,items:e}),E.send("render",{id:"syns"})}).on(d.RELATED_WORDS_METRIKAS.WORDS_CLICK,({wordType:e,wordValue:t})=>{const{text:s}=this.getProps();E.send("syns_insert",{type:e,synonym:t,src:s,lang:i.getProperty("srcLang")}),E.send("tap",{id:"syns/article",tab:e})}).on(d.RELATED_WORDS_METRIKAS.WORDS_EXPAND,({type:e})=>{const{text:t}=this.getProps();E.send(d.RELATED_WORDS_METRIKAS.WORDS_EXPAND,{type:e,src:t})}),(0,c.getTrackerByNamespace)(u.DICTIONARY_METRIKAS).on(u.DICTIONARY_METRIKAS.DICT_RENDERED,({text:e,hasExamples:t,items:s})=>{E.send("dict_show",{src:e,has_examples:t,popup:0,selection:0,items:s})}).on(u.DICTIONARY_METRIKAS.EXPAND_DICTIONARY,({text:e,hasExamples:t})=>{E.send("tap",{id:"dict/expand",text:e,has_examples:t})}).on(u.DICTIONARY_METRIKAS.DICT_LINK_CLICK,()=>{E.send("tap",{id:"dict/article/meaning"})}),(0,c.getTrackerByNamespace)(h.EXAMPLE_METRIKAS).on(h.EXAMPLE_METRIKAS.HIGHLIGHTED_CLICK,({value:e,text:t,hasDict:s})=>{E.send(h.EXAMPLE_METRIKAS.HIGHLIGHTED_CLICK,{value:e,text:t,hasDict:s})}).on(h.EXAMPLE_METRIKAS.TAB_WORD_CLICK,({value:e,text:t,hasDict:s})=>{E.send(h.EXAMPLE_METRIKAS.TAB_WORD_CLICK,{value:e,text:t,hasDict:s})}).on(h.EXAMPLE_METRIKAS.EXAMPLES_RENDERED,({text:e,items:t})=>{E.send("examples_rendered",{src:e,popup:0,selection:0,items:JSON.stringify(t||[])})}).on(h.EXAMPLE_METRIKAS.EXPAND_EXAMPLES,()=>{E.send("render",{id:"examples"}),E.send("tap",{id:"examples/expand"})}).on(h.EXAMPLE_METRIKAS.EXAMPLE_SCROLL_CONTROL_CLICK,()=>{E.send(h.EXAMPLE_METRIKAS.EXAMPLE_SCROLL_CONTROL_CLICK,{src:i.getProperty("text"),dir:this.getLangsPair()})}),(0,c.getTrackerByNamespace)(p.DEFINITION_METRIKAS).on(p.DEFINITION_METRIKAS.DEF_RENDERED,()=>{const{trText:e}=this.getProps();E.send(p.DEFINITION_METRIKAS.DEFINITION_RENDERED,{text:e,type:p.DEFINITION_TYPES.WIKI})}).on(p.DEFINITION_METRIKAS.ABBR_RENDERED,()=>{const{trText:e}=this.getProps();E.send(p.DEFINITION_METRIKAS.DEFINITION_RENDERED,{text:e,type:p.DEFINITION_TYPES.ABBR})}),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initUniproxy=void 0;var i=s(160);t.initUniproxy=function(e){return this._uniproxy=new i.Uniproxy({apiKey:e.SPEECHKIT_KEY,url:e.UNIPROXY_URL}),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initDistBanner=void 0;var i=s(267);t.initDistBanner=i.initDistBanner},function(e,t,s){"use strict";t.__esModule=!0,t.initDistBanner=function(e){if(e.DISABLE_DIST_BANNER)return this;const t=this.getView(),s=this.getModel(),o=new n.View({element:e.ELEMENTS.distContainer}),r=()=>{(()=>{const e=o.getElement().querySelector("div");return e&&e.childNodes.length&&o.isVisible()})()&&o.setVisible(!1)};t.onStateChanged("training",e=>{e&&o.isVisible()&&o.setVisible(!1)}),e.SRV===i.TOUCH?s.onChange("textAreaFocused",e=>{e&&r()}):s.onChange("text",(e,t)=>{"input"===t.reason&&r()});return o.onHide(()=>this.emit("distBannerAutoHide")),this};var i=s(21),n=s(15)},function(e,t,s){"use strict";t.__esModule=!0,t.initSuggestions=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(269),r=s(11),a=s(270),l=s(143),c=s(190);function d(){const e=window.config.SUGGESTIONS_CONF||{},t=e.ruOverride||e,s=(e,t,s=0)=>t in e?e[t]:s;return{limitPredict:s(e,"predicts"),limitSuggest:s(e,"suggests"),limitOnlyPredict:s(e,"fallbackPredicts",s(e,"predicts")),ruOverride:{limitPredict:s(t,"predicts"),limitSuggest:s(t,"suggests"),limitOnlyPredict:s(t,"fallbackPredicts",s(t,"predicts"))}}}t.initSuggestions=function(e){const t=this.getView(),s=this.getSettings(),i=this.getModel(),{srcLang:u,dstLang:h}=i.getProps(),p=this.getMeasurerViewSrc(),g=new o.SuggestionsModel({...d(),srcLang:u,dstLang:h,srv:e.SRV,detectOptions:a.DETECTING_OPTIONS.KBD,enableRuOverriding:"ru"===e.UI_LANG},{url:e.SUGGESTIONS_URL,detectUrl:e.DETECTOR_URL,validators:{text(e){return e&&!n.default.isUrl(n.default.trim(e))&&"sjn"!==this.getProperty("srcLang")},srcLang:t=>n.default.hasProperty(e.PREDICTOR_LANGS,t)}}),m=new c.Suggestions({model:g},{container:e.ELEMENTS.suggestions}),E=()=>{const{textScrollY:e}=i.getProps();p.scrollTo(p.getScrollInfo().maxTop/100*e)},_=()=>{m.handlePosition(p.getContentElement("[data-measurer-target]").getBoundingClientRect())};return this.on("textTap",(e,t)=>{t&&t.target&&n.default.getClosest(t.target,e=>e===m.getContainer())||m.setVisible(!1)}).on("textFocus",e=>{t.hasState("select")||m.setEnabled(e),e||m.setVisible(!1)}).on("resize",()=>{m.setVisible(!1)}).on("textKeydown",e=>{if(e.keyCode===r.KEYBOARD_KEYS.ENTER&&!s.isOptionEnabled(l.AVAILABLE_OPTIONS.ENTER)){if(e.shiftKey)return void m.setVisible(!1);n.default.preventEvent(e)}if(m.isVisible()&&m.isEnabled())switch(e.keyCode){case r.KEYBOARD_KEYS.ENTER:if(e.shiftKey)break;n.default.preventEvent(e),m.applyActiveItem(c.SUGGESTIONS_APPLYING_SOURCES.ENTER),m.setVisible(!1),this.updateTrText("enter");break;case r.KEYBOARD_KEYS.TAB:n.default.preventEvent(e),m.applyActiveItem(c.SUGGESTIONS_APPLYING_SOURCES.TAB),m.setVisible(!1);break;case r.KEYBOARD_KEYS.UP:n.default.preventEvent(e),m.updateActiveIndex(-1);break;case r.KEYBOARD_KEYS.DOWN:n.default.preventEvent(e),m.updateActiveIndex(1);break;case r.KEYBOARD_KEYS.LEFT:case r.KEYBOARD_KEYS.RIGHT:m.setEnabled(!1);break;case r.KEYBOARD_KEYS.ESCAPE:m.isEnabled()&&this.updateTrText("escape"),m.setEnabled(!1)}}).onAction("toggleAuto",()=>{g.toggleAuto()}),i.onChange("text",(t,s)=>{if(!n.default.trim(t))return g.setText("",s.sender||s.reason),m.setVisible(!1);if("url"===s.sender&&e.DEFAULT_SRC_LANG)return;const{srcLang:i,dstLang:o}=this.getProps(),r=s.caret?s.caret+t.slice(s.caret).search(/\s|$/):0,l=(0,a.extractTextWords)(t.slice(0,r),20);g.setText(l,s.sender||s.reason).setProperty({index:r,srcLang:i,dstLang:o})}).onChange(["srcLang","dstLang"],(e,t)=>{m.setEnabled(!1),g.setProperty(e,t)}).onChange("textScrollY",()=>{m.setEnabled(!1)}),g.on("detect",(e,t)=>{t||this.setSrcLanguage(e)}).on("auto",e=>{t.setState({auto:e}),s.setProperty({auto:e})}).on(["error","invalid"],()=>{m.setEnabled(!1)}).on("endOfWord",()=>{this.emit("predictorEndOfWord").updateTrText()}),m.on(c.SUGGESTIONS_EVENTS.ITEMS_UPDATED,()=>{const{reason:e}=g.getProps();let{text:s}=i.getProps();if(!["input","predictor"].includes(e)||t.hasState("select"))return m.setEnabled(!1);m.setVisible(!0),m.setEnabled(!0);const n=(0,a.createInsertingRange)(s,g.getIndex(),g.getPos());if(!n)return m.setEnabled(!1);n.appendSpace&&(s+=" "),p.renderData({text:s.slice(n.start,n.end)||".",leftText:s.slice(0,n.start),rightText:s.slice(n.end)}),E();const o=p.getScrollInfo();if(o.maxTop){const e=(e=>{const t=p.getContentElement("[data-measurer-target]").getBoundingClientRect(),s=p.getContentElement().getBoundingClientRect(),i=t.top-s.top-e.clientHeight;return i>0?e.top+i+t.height:null})(o);if(e)return i.emit("translationViewScrollY",e),void setTimeout(()=>{m.setEnabled(!0),E(),_()},100)}_()}).on(c.SUGGESTIONS_EVENTS.APPLY,(e,t)=>{const{text:s}=i.getProps(),n=g.getIndex(),o=t===c.SUGGESTIONS_TYPES.SUGGEST?g.getSuggestionsPos():g.getPredictionsPos(),r=(0,a.insertTextFragment)(s,e.src,n,o);i.setProperty("text",r.text,{caret:r.caret,sender:"predictor",suggestType:t}),setTimeout(()=>i.emit("moveTextAreaCaret",r.caret),30)}),t.onStateChanged("select",e=>{e&&(m.setEnabled(!1),m.setVisible(!1))}).onStateChanged("empty",e=>{e&&(m.setEnabled(!1),m.setVisible(!1))}),g.toggleAuto(!s.hasProperty("auto")||s.getProperty("auto")),this}},function(e,t,s){"use strict";t.__esModule=!0,t.SuggestionsModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(31),r=s(19),a=s(28);class l extends o.SessionModel{constructor(e,t={}){super(e,t),this._url=t.url,this._counter=0,this._detectUrl=t.detectUrl,this._detectCounter=0,this._currentLimitPredict=this.getLimitParams().limitPredict,this.onChange("auto",e=>{this.detectLanguage(),this.emit("auto",e)}).onChange("text",(e,t)=>{t.reason&&this.setProperty("reason",t.reason),this.requestSuggestion(),this.detectLanguage()}).onChange("srcLang",(e,t)=>{t.detected&&this.emit("detect",e,t.kbd),this.requestSuggestion()}).onChange("suggestions",e=>{const{limitPredict:t,limitOnlyPredict:s}=this.getLimitParams();let i;i=e&&e.predictions&&e.predictions.length?t:s,i!==this._currentLimitPredict&&(this._currentLimitPredict=i,this.requestSuggestion())}).onChange("predictions",e=>{e&&e.endOfWord&&this.emit("endOfWord")})}getLimitParams(){const e=this.getProps(),t={limitPredict:e.limitPredict,limitSuggest:e.limitSuggest,limitOnlyPredict:e.limitOnlyPredict};return"ru"===e.srcLang&&e.enableRuOverriding&&e.ruOverride||t}getParams(){const e=this.getProps(),{limitSuggest:t}=this.getLimitParams();return{q:e.text,srv:e.srv,sid:e.sid,lang:this.getLangPair(),limitPredict:this._currentLimitPredict,limitSuggest:t}}getDefaults(){return{auto:!1,srv:"",text:"",limitPredict:3,limitSuggest:2,srcLang:"",dstLang:"",reason:"",sid:this.getId(),predictions:[],suggestions:[],enableRuOverriding:!1}}getLangPair(){const{srcLang:e,dstLang:t}=this.getProps();return e+"-"+t}getPredictionsPos(){const{predictions:e}=this.getProps();return e&&e.predictions.length?e.pos:null}getSuggestionsPos(){const{suggestions:e}=this.getProps();return e&&e.predictions.length?e.pos:null}getPos(){return Math.min.apply(Math,[this.getPredictionsPos(),this.getSuggestionsPos()].filter(e=>null!==e))}arePosesEqual(){return this.getPredictionsPos()===this.getSuggestionsPos()}getIndex(){return this.getProperty("index")}setText(e,t){return this.setProperty("text",e,{reason:t})}isAuto(){return this.getProperty("auto")}toggleAuto(e=null){return this.setProperty("auto",null!==e?Boolean(e):!this.isAuto())}getDetectParams(){const e=this.getProps();return{sid:e.sid,srv:e.srv,text:n.default.trim(e.text),hint:[e.srcLang,e.dstLang].join(","),options:e.detectOptions}}canDetectLanguage(){return this.isValid("text")}canRequestSuggestion(){return this.isValid()}runDetectRequest(){const e=this.getDetectParams(),t=++this._detectCounter;r.HTTPRequest.get(this._detectUrl,e,(s,i)=>{if(t!==this._detectCounter||JSON.stringify(e)!==JSON.stringify(this.getDetectParams()))return;const n=s?s.code:i.body.code;if(n!==r.HTTPRequest.codes.OK)return this.emit("detectError",s||new a.HTTPError(n,i.body.message));i.body.lang&&this.setProperty("srcLang",i.body.lang,{kbd:Boolean(i.body.kbd),detected:!0})})}detectLanguage(){return this.canDetectLanguage()&&this.getProperty("auto")?(this.getSid().then(()=>this.runDetectRequest()),this):this}runRequest(){const e=this.getParams(),t=++this._counter;this.emit("query",e),r.HTTPRequest.get(this._url,e,(s,i)=>{if(t===this._counter&&JSON.stringify(e)===JSON.stringify(this.getParams()))return s?this.emit("error",s):void("endOfWord"in i.body&&!("predictions"in i.body)?i.body.text?this.setProperty({suggestions:null,predictions:{endOfWord:i.body.endOfWord,pos:i.body.pos,predictions:i.body.text.map(e=>({src:e}))}}):i.body.endOfWord&&this.emit("endOfWord"):this.setProperty({predictions:i.body.predict,suggestions:i.body.suggest}))})}requestSuggestion(){return this.canRequestSuggestion()?(this.getSid().then(()=>this.runRequest()),this):this}}t.SuggestionsModel=l},function(e,t,s){"use strict";t.__esModule=!0,t.DETECTING_OPTIONS=void 0,t.createInsertingRange=function(e,t,s){const i={};if(s<0)i.end=t,i.start=t+s;else if(1===s&&t===e.length)i.appendSpace=!0,i.end=t+s,i.start=t+s;else{if(t!==e.length||" "!==e.charAt(t-1))return null;i.end=t,i.start=t}return i},t.extractTextWords=function(e,t){if(!n.default.trim(e))return"";const s=e.match(/(\S+\s*)/g),i=t?-t:0;return s?s.slice(i).join(""):""},t.insertTextFragment=function(e,t,s,i){let n=s,o=t;i<0?n+=i:o=new Array(i+1).join(" ")+t;return{text:e.slice(0,n)+o+e.slice(s),caret:n+o.length}};var i,n=(i=s(0))&&i.__esModule?i:{default:i};t.DETECTING_OPTIONS={KBD:1}},function(e,t,s){"use strict";t.__esModule=!0,t.TooltipModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(133);class r extends o.TooltipModule{constructor(e,t){super(e,t),this.app.on("bodyScroll",n.default.throttle(()=>{this.tooltipView.setVisible(!1)},500))}}t.TooltipModule=r},function(e,t,s){"use strict";t.__esModule=!0,t.HistoryModule=void 0;var i=s(182),n=s(140),o=s(161),r=s(192),a=s(191);class l extends i.AbstractHistoryModule{constructor(e,t){super(e,t),this.listenSettings(),(this.appConfig.LANDING_TYPE||this.appConfig.DEFAULT_TEXT)&&this.history.setVisible(!1)}isHistorySettingEnabled(){return this.appSettings.isOptionEnabled("history")}makeHistoryComponent(){return new a.History({storageModel:this.historyCache},{container:this.appConfig.ELEMENTS.historyRecent})}listenSettings(){this.appSettings.onChange(()=>this.updateHistorySettingState())}listenAppModel(){super.listenAppModel();let e=!1;this.appModel.onChange("historyEnabled",(e,{oldValue:t})=>{"boolean"==typeof t&&this.app.emit("historySettingToggle",e)}).onChange("selText",t=>{e=t===this.appModel.getProperty("text")}).onBeforeSet("text",t=>{!t&&e&&this.updateHistory(),e=!1})}listenApp(){super.listenApp(),this.app.on(o.TEXTAREA_APP_EVENTS.CLEAR,()=>{this.updateHistory()}).on(r.TTS_APP_EVENTS.SPEAKER_ACTION,({action:e=null})=>{e===n.PLAYER_ACTIONS.PLAY&&this.updateHistory()}).on(["synRendered","dictRendered","examplesRendered"],()=>{this.appModel.getProperty("translation")&&this.history.setVisible(!1)}).on("exampleTabTap",()=>{this.updateHistory()}).on("rubberScrolled",()=>{this.updateHistoryAsync()})}listenHistoryComponent(){super.listenHistoryComponent(),this.history.on(a.HISTORY_EVENTS.APPLY_ITEM,()=>{this.history.setVisible(!1)})}}t.HistoryModule=l},function(e,t,s){"use strict";t.__esModule=!0,t.CardsCarouselModule=t.APP_EVENTS=void 0;var i=s(274),n=s(162),o=s(275);t.APP_EVENTS={};class r extends i.AbstractCardsCarouselModule{constructor(e,t){super(e,t),this.app.on("resize",()=>{this.cardsCarousel.updateCarouselPosition()}).on(n.CARDS_CAROUSEL_EVENTS.APPLY_ACTIVE_PHRASE,()=>{this.cardsCarousel.applyActiveItem()}),this.appView.onStateChanged("translatorExpanded",e=>{this.appConfig.ELEMENTS.cardsCarousel.tabIndex=e?-1:0,this.cardsCarousel.setAccessibility(!e)}),this.cardsCarousel.setAccessibility(!this.appView.hasState("translatorExpanded"))}makeCarousel(){const e=this.appConfig.DAILY_PHRASES||[];return new o.CardsCarousel({phrases:this.appConfig.ENABLE_STORIES?e.slice(0,1):e,stories:this.appConfig.ENABLE_STORIES?this.appConfig.stories:[]},{container:document.getElementById("cardsCarousel")})}}t.CardsCarouselModule=r},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractCardsCarouselModule=void 0;var i=s(5),n=s(162);class o extends i.AppModule{constructor(e,t){super(e,t),this.moduleName="cardsCarousel",this.cardsCarousel=this.makeCarousel(),this.cardsCarousel.on(n.CARDS_CAROUSEL_EVENTS.OPEN_STORY,e=>{this.app.emit("stories:open",e)}).on(n.CARDS_CAROUSEL_EVENTS.APPLY_PHRASE,e=>{this.appModel.setProperty({srcLang:e.lang,text:e.text},{sender:"dailyPhrase"})})}makeCarousel(){}}t.AbstractCardsCarouselModule=o},function(e,t,s){"use strict";t.__esModule=!0,t.CardsCarousel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(3),r=s(162),a=s(16);class l extends r.AbstractCardsCarousel{constructor(e,t){super(e,t),this.onChange("activeCard",()=>{this.updateCarouselPosition()}),this.updateCarouselPosition()}updateActiveClass(){const{activeCard:e}=this.getProps(),t=this.getRef(this.refs.carousel),s=t.querySelector(".state-active-bg"),i=t.children[e];s&&n.default.activateClass(s,"state-active-bg",!1),i&&n.default.activateClass(i,"state-active-bg",!0)}moveCarousel(e){const{activeCard:t,stories:s}=this.getProps(),i=t+e;i>this.getCardsCount()||i<0||(i<s.length&&o.$tracker.sendMetric("stories_desktop_preview_move",{index:i,preview:s[i].id}),this.setProperty("activeCard",i))}setAccessibility(e){const t=this.getRef(this.refs.backButton),s=this.getRef(this.refs.forwardButton);if(t&&s){const i=e?0:-1;t.tabIndex=i,s.tabIndex=i}}applyActiveItem(){const{activeCard:e,phrases:t}=this.getProps(),s=t[e];s&&this.applyPhrase(s)}updateCarouselPosition(){const{activeCard:e}=this.getProps(),t=this.getRef(this.refs.carousel),s=this.getContainer().clientWidth;t.style.transform=`translateX(${-s*e}px)`,clearTimeout(this.activeClassTimeout),this.activeClassTimeout=setTimeout(()=>{this.updateActiveClass()},350),this.setState({hasPrev:e>0,hasNext:e<this.getCardsCount()-1})}template({html:e,cn:t}){const s=t("cardsCarousel");return e`
            <button
                class=${s("button",{prev:!0})}
                @click=${this.moveCarousel.bind(this,-1)}
                tabIndex="0"
                data-default-enter-action="true"
            >
                ${(0,a.icn)("arrow-short-back")}
            </button>
            <button
                class=${s("button",{next:!0})}
                @click=${this.moveCarousel.bind(this,1)}
                tabIndex="0"
                data-default-enter-action="true"
            >
                ${(0,a.icn)("arrow-short-forward")}
            </button>
            <div class=${s("carousel")} data-ref-id=${this.refs.carousel}>
                ${this.itemsTemplate()}
            </div>
        `}}t.CardsCarousel=l},function(e,t,s){"use strict";t.__esModule=!0,t.DictionaryModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(277),r=s(279);class a extends o.AbstractDictionaryModule{constructor(e,t){super(e,t),this.app.onAction("enableCustomMode",()=>this.enableCustomMode()).onAction("disableCustomMode",()=>this.disableCustomMode())}enableCustomMode(){const{selTr:e,selText:t,srcLang:s,dstLang:i}=this.appModel.getProps(),o=t||e;this.dictionaryModel.setProperty("text",n.default.trim(o),{silent:!0}),e?this.dictionaryModel.setProperty({dirReversed:!0,srcLang:i,dstLang:s},{silent:!0}):this.dictionaryModel.setProperty({dirReversed:!1,srcLang:s,dstLang:i},{silent:!0}),this.updateDictionaryModel(this.dictionaryModel.getProps()),this.dictionaryModel.requestData()}disableCustomMode(){this.setupDictionaryModel(),this.dictionary.reset(),this.dictionaryModel.setProperty({data:"",dirReversed:!1},{silent:!0}).requestData()}makeDictionaryComponent(){return new r.DictionaryComponent({},{container:this.appConfig.ELEMENTS.dictionary,hideAfterTransition:!0,skipFadeoutTransition:!0})}}t.DictionaryModule=a},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractDictionaryModule=t.APP_EVENTS=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(5),r=s(3),a=s(137),l=s(278);const{$track:c}=(0,r.getTrackerByNamespace)(a.DICTIONARY_METRIKAS);t.APP_EVENTS={};class d extends o.AppModule{constructor(e,t){super(e,t),this.moduleName="dict",this.dictionaryModel=this.app.getDictionaryModel(),this.dictionary=this.makeDictionaryComponent(),this.listenApp(),this.listenAppModel(),this.listenDictionary(),this.listenDictionaryModel(),this.setupDictionaryModel(),this.dictionary.setEnabled(!0)}setupDictionaryModel(){(0,l.setupDictionaryModel)(this.dictionaryModel,this.appModel.getProps(),this.appConfig),this.updateDictionaryModel()}updateDictionaryModel(e=null){(0,l.updateDictionaryModel)(this.dictionaryModel,e||this.appModel.getProps(),this.appConfig)}onDictionaryItemApply(){}listenDictionaryModel(){this.dictionaryModel.on(a.DICTIONARY_EVENTS.DICT_FETCHED,e=>{this.dictionary.setSourceText(this.appModel.getProperty("text")).setItems(e).setVisible(e&&e.length)}).on("error",()=>this.dictionary.reset())}listenDictionary(){this.dictionary.onVisibilityChanged(e=>{this.appView.setState("has_dict",e)}).on(a.DICTIONARY_EVENTS.APPLY_ITEM,(e,t)=>{this.appView.hasState("complaint")||(this.appModel.setProperty("text",e,{type:t,sender:"dictionary"}),c(a.DICTIONARY_METRIKAS.DICT_LINK_CLICK))}).on(a.DICTIONARY_EVENTS.SEND_METRIC,(e,t={})=>{const{text:s}=this.appModel.getProps();c(e,{text:s,dir:this.app.getLangsPair(),hasExamples:this.appView.hasState("has_examples")?1:0,...t})})}listenAppModel(){const e=n.default.debounce(()=>{this.updateDictionaryModel(),this.dictionary.setVisible(this.dictionaryModel.isValid()&&this.dictionary.hasItems()),this.dictionaryModel.requestData()}),t=(t,s)=>{this.dictionaryModel.setProperty(t,s),e()};this.appModel.onChange("trText",e=>{e||this.dictionary.setItems([]),t("text",e)}).onChange(["srcLang","dstLang"],(e,s)=>{t(e,s)})}listenApp(){this.app.onAction("retry",()=>{this.dictionaryModel.requestData()}).on("translationError",()=>this.dictionary.reset())}makeDictionaryComponent(){}}t.AbstractDictionaryModule=d},function(e,t,s){"use strict";t.__esModule=!0,t.updateDictionaryModel=t.setupDictionaryModel=void 0;var i=s(70);t.setupDictionaryModel=(e,t,s)=>{const{trText:n,srcLang:o,dstLang:r}=t,{areNewDeclensions:a}=e.getProps();n&&e.setProperty("text",n),o&&e.setProperty({srcLang:o}),r&&e.setProperty({dstLang:r}),e.setFlag(i.DICT_FLAGS.MORPHO,!0).setFlag(i.DICT_FLAGS.FAMILY,s.FAMILY).setFlag(i.DICT_FLAGS.SHORT_POS,!0).setFlag(i.DICT_FLAGS.TOOLTIPS,!0).setFlag(i.DICT_FLAGS.IDIOMS,!0).setFlag(i.DICT_FLAGS.ABBR,!0).setFlag(i.DICT_FLAGS.DICT_AND_DEF,!0),a&&e.setFlag(i.DICT_FLAGS.NEW_DECLENSIONS,!0)};t.updateDictionaryModel=(e,t,s)=>{const{srcLang:n,dstLang:o}=t,r=`${n}-${o}`,a=`${n}-${n}`,l="en"===n;e.setType(i.DICT_TYPES.REGULAR,s.DICTIONARY_LANGS[r]).setFlag(i.DICT_FLAGS.DEFINITIONS,o===s.UI_LANG).setFlag(i.DICT_FLAGS.DECLENSIONS,l).setType(i.DICT_TYPES.SYN,s.DICTIONARY_LANGS[a]).setType(i.DICT_TYPES.ANT,s.ANT_LANGS[n]).setType(i.DICT_TYPES.DERIV,s.DERIV_LANGS[n])}},function(e,t,s){"use strict";t.__esModule=!0,t.DictionaryComponent=void 0;var i=s(280),n=s(146);class o extends i.AbstractDictionaryComponent{getArticleLabel(){const{html:e,cn:t}=this.getRenderHelpers();return e`
            <div
                class="${t("block")("label")}"
                tabindex="0"
            >${n.i18n.dictionary}</div>`}}t.DictionaryComponent=o},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractDictionaryComponent=void 0;var i=s(6),n=s(46),o=s(137);class r extends i.Component{constructor(e,t){super(e,t),this.meaningTrsLimit=10,this.unExpandableLimit=4,this.expandableLimit=3,this.onChange(()=>{this.updateAsync()}).onChange("items",e=>{e&&e.length&&this.emitMetric(o.DICTIONARY_METRIKAS.DICT_RENDERED,{items:e.map(({tr:e})=>e.length)}),this.setProperty("expandable",this.isExpandable()).setProperty("expanded",!1)})}reset(){return this.setItems([]).setVisible(!1)}emitMetric(e,...t){return this.emit(o.DICTIONARY_EVENTS.SEND_METRIC,e,...t)}setItems(e){return this.setProperty({items:e})}setSourceText(e){return this.setProperty("sourceText",e)}hasItems(){const{items:e}=this.getProps();return e&&e.length}getItemsLimit(){const{expanded:e,expandable:t}=this.getProps();return e||!t?Number.MAX_VALUE:this.expandableLimit}isExpandable(){const{items:e}=this.getProps();return!!e&&e.some(({tr:e})=>e&&e.length>this.unExpandableLimit)}expandDictionary(){return this.emitMetric(o.DICTIONARY_METRIKAS.EXPAND_DICTIONARY),this.setProperty("expanded",!0)}onMeaningTap(e){this.emit(o.DICTIONARY_EVENTS.APPLY_ITEM,e,"mean")}onDictItemTap(e){this.emit(o.DICTIONARY_EVENTS.APPLY_ITEM,e,"tr")}getTitlePostfix(e){return[e.pos&&e.pos.text,e.gen&&e.gen.tooltip,e.num&&e.num.code,e.dia&&e.dia.code].filter(e=>e).join(" ")}getGroupTitle(e,t){const{html:s,nothing:i}=this.getRenderHelpers();return s`
            <div class=${t("title")}>
                <span
                    class=${t("title-part",{type:"word"})}
                    tabindex="0"
                >
                    ${e.text}
                </span>

                ${e.ts?s`
                <span
                    class=${t("title-part",{type:"transcription"})}
                    data-complaint-type="ts"
                    data-title="[${e.ts}]"
                    data-complaint-target="true"
                    tabindex="0"
                >
                    [${e.ts}]
                </span>
                `:i}

                <span
                    class=${t("title-part",{type:"postfix"})}
                    tabindex="0"
                >
                    ${this.getTitlePostfix(e)}
                </span>

                ${e.fl?s`
                <span
                    class=${t("title-part",{type:"fl"})}
                    tabindex="0"
                >
                    ${e.fl}
                </span>
                `:i}
            </div>
        `}getTrTexts(e,t){const{html:s,nothing:i}=this.getRenderHelpers(),n=this.getProperty("sourceText"),o=(e.syn||[]).slice(0);return o.unshift(e),o.length?s`
            <div class=${t("meanings-value")}>
                ${o.map((e,o)=>s`
                    <span
                        class=${t("meaning",["tag"])}
                        data-complaint-type="tr"
                        data-complaint-target="true"
                        data-value=${"tr:"+e.text}
                        data-title=${n}
                        data-part-of-speech=${e.pos&&e.pos.code}
                        data-active-target="true"
                        data-group-index="${o}"
                        @click=${t=>this.onDictItemTap(e.text)}
                        tabindex="0"
                    >
                        ${e.text}
                        ${e.gen&&e.gen.text?s`
                            <span class=${t("meaning-gen")}>${e.gen.text}</span>
                        `:i}
                    </span>
                `)}
            </div>
        `:i}getTrMeanings(e,t){const{html:s,nothing:i}=this.getRenderHelpers(),{expanded:n}=this.getProps(),o=(e.mean||[]).slice(0,n?void 0:this.meaningTrsLimit);return o.length?s`
            <div class=${t("meanings-trs")}>
                ${o.map(({text:i},n)=>s`
                    <span
                        class=${t("meaning-tr")}
                        data-complaint-type="mean"
                        data-complaint-target="true"
                        data-value=${"mean:"+i}
                        data-title=${i}
                        data-part-of-speech=${e.pos&&e.pos.code}
                        data-group-index="${n}"
                        @click=${e=>this.onMeaningTap(i)}
                        tabindex="0"
                    >
                        ${i}${n!==o.length-1?",":""}
                    </span>
                `)}
            </div>
        `:i}getGroupMeanings(e,t){const{html:s,nothing:i}=this.getRenderHelpers();return s`
            <ol class=${t("meanings",{order:"meaning"})}>
            ${e.tr?e.tr.slice(0,this.getItemsLimit()).map((e,i)=>s`
                    <li class=${t("meanings-item")} data-index=${i+1}>
                        ${this.getTrTexts(e,t)}
                        ${this.getTrMeanings(e,t)}
                    </li>
            `):i}
            </ol>
        `}getExpandButton(){const{html:e,nothing:t,cn:s}=this.getRenderHelpers(),{expanded:i,expandable:o}=this.getProps(),r=s("button-items-expand");return o&&!i?e`
            <div class=${r({type:"dict"})}
                 @click=${()=>this.expandDictionary()}
                 role="button"
                 tabindex="0"
                 data-default-enter-action="true"
            >
                ${n.locales.labels.expandDictionary}
            </div>
        `:t}getArticleLabel(){return this.getRenderHelpers().nothing}template({html:e,nothing:t,cn:s}){const{items:i}=this.getProps();if(!i)return t;const n=s("dict");return e`
            ${this.getArticleLabel()}
            ${i.map(t=>e`
                <li class=${n("group")}>
                    ${this.getGroupTitle(t,n)}
                    ${this.getGroupMeanings(t,n)}
                </li>
            `)}

            ${this.getExpandButton()}
        `}}t.AbstractDictionaryComponent=r,r.defaults={items:[],sourceText:"",expanded:!1,expandable:!1}},function(e,t,s){"use strict";t.__esModule=!0,t.ExamplesModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(282),r=s(141),a=s(284);class l extends o.AbstractExamplesModule{constructor(e,t){super(e,t),this.examplesComponent.setProperty("bannedExamples",this.app.getBannedExamplesStorage().getProperty("ids")),this.app.getContainerView().onStateChanged("rightEmpty",e=>{this.examplesComponent.setProperty("twoColumnsRender",e).updateAsync()}),this.appView.onStateChanged("rightEmpty",e=>{this.examplesComponent.setProperty("twoColumnsRender",e).updateAsync()}),this.app.onAction("enableCustomMode",()=>this.enableCustomMode()).onAction("disableCustomMode",()=>this.disableCustomMode())}listenApp(){super.listenApp(),this.app.getBannedExamplesStorage().onChange("ids",e=>{this.examplesComponent.setProperty("bannedExamples",e).update()})}listenExamplesComponent(){super.listenExamplesComponent(),this.examplesComponent.on(r.EXAMPLES_EVENTS.WORD_SELECTED,()=>this.app.swapDirection())}enableCustomMode(){const{selTr:e,selText:t,srcLang:s,dstLang:i}=this.appModel.getProps(),o=t||e;this.examplesModel.setProperty("text",n.default.trim(o),{silent:!0}),e?this.examplesModel.setProperty("srcLang",i,{silent:!0}).setProperty("dstLang",s,{silent:!0}):this.examplesModel.setProperty("srcLang",s,{silent:!0}).setProperty("dstLang",i,{silent:!0}),this.examplesModel.requestData()}disableCustomMode(){this.examplesComponent.reset(),this.setupExamplesModel(),this.examplesModel.requestData()}makeExamplesComponent(){return new a.ExamplesComponent({},{container:this.appConfig.ELEMENTS.examples,hideAfterTransition:!0,skipFadeoutTransition:!0})}}t.ExamplesModule=l},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractExamplesModule=t.$track=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(3),r=s(5),a=s(141),l=s(283);const{$track:c}=(0,o.getTrackerByNamespace)(a.EXAMPLE_METRIKAS);t.$track=c;class d extends r.AppModule{constructor(e,t){super(e,t),this.moduleName="examples",this.examplesModel=this.app.getExamplesModel(),this.examplesComponent=this.makeExamplesComponent(),this.listenExamplesComponent(),this.listenAppModel(),this.listenApp(),this.setupExamplesModel(),this.listenExamplesModel()}listenExamplesComponent(){this.examplesComponent.on(a.EXAMPLES_EVENTS.WORD_SELECTED,e=>{if(this.appView.hasState("complaint"))return;const t=e.split(":");this.examplesComponent.setProperty("ignoreNextEmptyResponse",!0),this.appModel.setProperty("text",t[1],{type:t[0],sender:"example"})}).on(a.EXAMPLES_EVENTS.SEND_METRIC,(e,t)=>this.sendMetric(e,t)).on(a.EXAMPLES_EVENTS.OPEN_IDIOM_POPUP,(e,t,s)=>this.app.emit(a.EXAMPLES_EVENTS.OPEN_IDIOM_POPUP,e,t,s)).onVisibilityChanged(e=>{this.appView.setState("has_examples",e)})}listenAppModel(){const e=n.default.debounce(()=>{this.examplesModel.requestData()}),t=(t,s)=>{this.examplesModel.setProperty(t,s),e()};this.appModel.onChange("text",e=>{e||this.examplesComponent.setVisible(!1)}).onChange("trText",e=>t("text",e)).onChange(["srcLang","dstLang"],(e,s)=>t(e,s))}listenApp(){this.app.on("action:retry",()=>{this.examplesModel.requestData()}).on("translationError",()=>this.examplesComponent.reset())}listenExamplesModel(){this.examplesModel.onSet("data",(e,t)=>this.handleFetchedData(e,t)).on(["error","invalid"],()=>this.examplesComponent.reset())}handleFetchedData(e,t={}){if("selection"===t.reason)return;const{exampleTabs:s,allExamples:i}=this.examplesModel.prepareExamples(e),n=i.length>0,{ignoreNextEmptyResponse:o}=this.examplesModel.getProps();return n?(n&&this.sendMetric(a.EXAMPLE_METRIKAS.EXAMPLES_RENDERED,{items:s.map(({examples:e})=>({ids:(e||[]).map(({id:e})=>e)}))}),this.examplesComponent.setProperty("currentExamples",i).setProperty("allExamples",i).setProperty("exampleTabs",s).setProperty("activeTabIndex",null).setProperty("currentMaxExamplesCount",this.examplesComponent.defaultExampleCount).setProperty("amountOfExpands",0).setProperty("text",this.examplesModel.getProperty("text")).setVisible(n),this.examplesComponent.onceRendered(()=>this.examplesComponent.resetWordCarouselScroll()),this.examplesComponent.updateAsync(),n):o?this.examplesComponent.setProperty("ignoreNextEmptyResponse",!1):this.examplesComponent.reset()}sendMetric(e,t={}){const{text:s}=this.appModel.getProps(),i={text:s,hasDict:this.appView.hasState("has_dict")?1:0,dir:this.app.getLangsPair(),...t};c(e,i)}setupExamplesModel(){(0,l.setupExamplesModel)(this.examplesModel,this.appModel.getProps(),this.appConfig)}makeExamplesComponent(){return{}}}t.AbstractExamplesModule=d},function(e,t,s){"use strict";t.__esModule=!0,t.setupExamplesModel=void 0;var i=s(70),n=s(157);t.setupExamplesModel=(e,t,s)=>{e.setFlag(i.DictionaryPresenter.flags.MORPHO,!0).setFlag(i.DictionaryPresenter.flags.FAMILY,s.FAMILY).setFlag(i.DictionaryPresenter.flags.SHORT_POS,!0).setFlag(i.DictionaryPresenter.flags.IDIOMS,!0).setFlag(i.DictionaryPresenter.flags.TOOLTIPS,!0),s.ENABLE_NEW_EXAMPLES&&e.setOption(n.EXAMPLES_OPTIONS.CHUNKS,!0).setOption(n.EXAMPLES_OPTIONS.MONOLING,!0),t.trText&&e.setProperty("text",t.trText),t.srcLang&&e.setProperty("srcLang",t.srcLang),t.dstLang&&e.setProperty("dstLang",t.dstLang)}},function(e,t,s){"use strict";t.__esModule=!0,t.ExamplesComponent=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(16),r=s(175),a=s(141),l=s(285),c=s(146);function d(e,t,s){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}class h extends l.AbstractExamplesComponent{constructor(e,t){super(e,t),this.expandStep=12,this.scrollStep=300,this.defaultExampleCount=10,this.onRendered(()=>{const e=this.getRef(this.refs.wordsCarousel);e&&(e.onscroll=n.default.throttleWithCallGuarantee(()=>{this.updateCarouselControls()},100),this.updateCarouselControls())}).onceRendered(()=>{const e=this.getRef(this.refs.wordsCarousel);e&&(e.scrollLeft=0)}).onSet("twoColumnsRender",e=>{this.defaultExampleCount=e?16:10})}getLocalizations(){return{i18n:{...c.i18n,EXAMPLE_TABS:c.EXAMPLE_TABS}}}updateCarouselControls(){const e=this.getRef(this.refs.wordsCarousel);if(!e)return;const t=e.scrollWidth-e.clientWidth;this.setScrollControlVisibility(e.scrollLeft>0,"left"),this.setScrollControlVisibility(e.scrollLeft<t,"right")}setScrollControlVisibility(e,t="right"){const s=this.getRef(this.refs[t+"ScrollControl"]);s&&(s.style.display=e?"block":"none")}onRightScrollClick(){this.scrollWordsCarousel(this.scrollStep)}onLeftScrollClick(){this.scrollWordsCarousel(-this.scrollStep)}scrollWordsCarousel(e){const t=this.getRef(this.refs.wordsCarousel);t&&(n.default.smoothScrollTo(t,0,t.scrollLeft+e),this.emit(a.EXAMPLES_EVENTS.SEND_METRIC,a.EXAMPLE_METRIKAS.EXAMPLE_SCROLL_CONTROL_CLICK))}filterExamples(e){const{bannedExamples:t=[]}=this.getProps();return!t.includes(e.id)}renderExampleIcon(e){return(0,o.icn)("expl-"+e)}renderWordsCarousel(){const{html:e,cn:t,nothing:s}=this.getRenderHelpers(),{exampleTabs:i,activeTabIndex:n}=this.getProps();if(!i.length)return s;const r=t("tabs"),a=t("tab"),l=t("button")({view:"clear",size:"l",icn:!0,round:!0}),{i18n:c}=this.getLocalizations(),d=(t,s,i)=>e`
            <div class=${r("control",{direction:t})} data-ref-id=${s}>
                <button tabindex="-1" class=${r("controlButton",[l])} @click=${i}>
                    ${(0,o.icn)("left"===t?"arrow-short-back":"arrow-short-forward")}
                </button>
                <div class=${r("controlShadow")}></div>
            </div>
        `;return e`
            <div class=${r({view:"primary"})}>
                <div class=${r("container")}
                     data-ref-id=${this.refs.wordsCarousel}>
                    ${d("left",this.refs.leftScrollControl,()=>this.onLeftScrollClick())}

                    <button
                        class=${a({type:"common",selected:this.isTabWithAllExamplesActive()})}
                        @click=${()=>this.setActiveTab(null)}
                        tabindex="0"
                        data-default-enter-action="true">
                        ${c.EXAMPLE_TABS.all}
                    </button>

                    ${i.map((t,i)=>t&&!t.translation.hide?e`
                        <button
                            class=${a({selected:i===n})}
                            @click=${()=>this.setActiveTab(i)}
                            tabindex="0"
                            data-default-enter-action="true">
                            ${this.getTabTranslation(t)}
                        </button>
                    `:s)}

                    ${d("right",this.refs.rightScrollControl,()=>this.onRightScrollClick())}
                </div>
            </div>
        `}renderExampleMeta(e){const{html:t}=this.getRenderHelpers();return t`
            <div class="example_meta">
                <div class="example_ref_wrapper"
                     data-tooltip-onclick="true"
                     data-tooltip-position="top-right"
                     data-tooltip="${r.DictionaryPresenter2.getTooltipMessage(e)}"
                     data-tracking-data='{"id": "example/ref"}'>
                    <div class="example_ref"
                         data-type="${e.refType}">
                        ${this.renderExampleIcon(e.refType)}
                    </div>
                </div>
            </div>
        `}renderIdiomExample(e){const{html:t}=this.getRenderHelpers(),{i18n:s}=this.getLocalizations();return t`
            <div
                class="example_item example_item_type_${e.refType}"
                data-tracking-data='{"id": "example", "exampleId": "${e.id}"}'
                data-complaint-type="example"
                data-id="${e.id}"
                data-text="${e.originalVal}"
                data-translation="${e.originalTrs}">
                <div class="example_meta">
                    <div class="example_ref_wrapper"
                         data-tooltip-onclick="true"
                         data-tooltip-position="top-right"
                         data-tooltip="${s.idiomExampleExplanation}">
                        ${this.renderExampleIcon("idiom")}
                    </div>
                </div>
                <div class="example_wrapper">
                    <div class="example_source">
                        ${this.getIdiomTitle(e)}
                    </div>
                    <div class="example_target">
                        ${e.originalTrs}
                    </div>
                </div>
            </div>
      `}}t.ExamplesComponent=h,h.defaults={...d(u(h),"defaults",h),twoColumnsRender:!1}},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractExamplesComponent=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(6),r=s(29),a=s(141);class l extends o.Component{constructor(...e){super(...e),this.refs={wordsCarousel:"examplesWordCarousel",leftScrollControl:"leftScrollControl",rightScrollControl:"rightScrollControl"},this.expandStep=24,this.defaultExampleCount=12}reset(){this.setVisible(!1).setProperty("currentExamples",[]).setProperty("allExamples",[]).setProperty("exampleTabs",[]).setProperty("currentMaxExamplesCount",this.defaultExampleCount).setProperty("activeTabIndex",null).setProperty("amountOfExpands",0).setProperty("ignoreNextEmptyResponse",!1)}resetWordCarouselScroll(){const e=this.getRef(this.refs.wordsCarousel);e&&e.scrollLeft&&setTimeout(()=>e.scrollLeft=0,100)}expandExamples(){this.emit(a.EXAMPLES_EVENTS.SEND_METRIC,a.EXAMPLE_METRIKAS.EXPAND_EXAMPLES,{amountOfExpands:this.amountOfExpands});const{currentMaxExamplesCount:e}=this.getProps();this.setProperty("currentMaxExamplesCount",e+this.expandStep).updateNow()}setActiveTab(e){const{exampleTabs:t,allExamples:s}=this.getProps(),i=!n.default.isNumber(e),o=i?s:t[e].examples,r=i?null:this.getTabTranslation(t[e]);this.setProperty("currentExamples",o).setProperty("activeTabIndex",e).setProperty("currentMaxExamplesCount",this.defaultExampleCount).setProperty("amountOfExpands",0).updateNow(),this.emit(a.EXAMPLES_EVENTS.SEND_METRIC,a.EXAMPLE_METRIKAS.TAB_WORD_CLICK,{value:r})}onHighlightedTextClick(e){const t=n.default.getClosest(e.target,e=>e.hasAttribute(r.VALUE_ATTR),!0);if(t){const s=t.getAttribute(r.VALUE_ATTR);this.emit(a.EXAMPLES_EVENTS.SEND_METRIC,a.EXAMPLE_METRIKAS.HIGHLIGHTED_CLICK,{value:s}),n.default.preventEvent(e),this.emit(a.EXAMPLES_EVENTS.WORD_SELECTED,s,t)}}onInfoClick(e,t){const s=e.target;s&&this.emit(a.EXAMPLES_EVENTS.OPEN_IDIOM_POPUP,s.getBoundingClientRect(),s.getAttribute("data-example-id"),t)}onLeftScrollClick(){}onRightScrollClick(){}handleCarouselScroll(){}getLocalizations(){return{}}getIdiomTitle(e){const{html:t,cn:s,nothing:i}=this.getRenderHelpers(),o=n.default.isArray(e.exampleVal)&&e.exampleVal[0]&&e.exampleVal[0].text;if(!o)return i;const{text:r}=this.getProps(),a=r.length,l=o.toLowerCase().indexOf(r.toLowerCase());if(-1===l)return o;const c=s("idiom"),d=o.slice(0,l),u=o.slice(l,l+a),h=o.slice(l+a);return t`${d}<span class="${c("highlighted")}">${u}</span>${h}`}filterExamples(e){return Boolean(e)}getExampleGroups(){const{currentExamples:e,twoColumnsRender:t,currentMaxExamplesCount:s}=this.getProps(),i=(e||[]).filter(e=>this.filterExamples(e)).slice(0,s);if(!t)return[i];const n=[],o=[];return i.forEach((e,t)=>{t%2?o.push(e):n.push(e)}),[n,o]}renderIdiomExample(e,t){return this.getRenderHelpers().nothing}renderExampleIcon(e){return this.getRenderHelpers().nothing}onRefMouseOver(e){const{onRefMouseOver:t}=this.getProps();t&&t(e)}onRefMouseOut(e){const{onRefMouseOut:t}=this.getProps();t&&t(e)}getTabTranslation(e){const{i18n:t}=this.getLocalizations();let s=e.translation.text;return e.translation.other?s=t.EXAMPLE_TABS.other:e.translation.idiom&&(s=t.EXAMPLE_TABS.idioms),s}isTabWithAllExamplesActive(){const{activeTabIndex:e}=this.getProps();return!n.default.isNumber(e)}renderWordsCarousel(){const{html:e,cn:t,nothing:s}=this.getRenderHelpers(),{exampleTabs:i,activeTabIndex:o}=this.getProps();if(!((i||[]).length>1))return s;const{i18n:r}=this.getLocalizations(),a=t("examples"),l=t("examples-category-word"),c=t("examples__carousel");return e`
            <div class=${a("words-list")}>
                <div
                    class="${c("control",{direction:"left"})}"
                    data-ref-id="${this.refs.leftScrollControl}"
                >
                    <div
                        class="${c("button")}"
                        @click=${()=>this.onLeftScrollClick()}
                    ></div>
                    <div class="${c("shadow")}"></div>
                </div>
                <div class="${c({type:"words"})} invisible-horizontal-scrollbar" data-ref-id="${this.refs.wordsCarousel}">
                    <span
                        class=${l({type:"source",selected:this.isTabWithAllExamplesActive()})}
                        @click=${n.default.debounce(()=>this.setActiveTab(null),100)}>
                        ${r.EXAMPLE_TABS.all}
                    </span>
                    ${i.map((t,i)=>t&&!t.translation.hide?e`
                        <span
                            class=${l({type:"target",selected:i===o})}
                            @click=${n.default.debounce(()=>this.setActiveTab(i),100)}>
                            ${this.getTabTranslation(t)}
                        </span>
                    `:s)}
                </div>
                <div
                    class="${c("control",{direction:"right"})}"
                    data-ref-id="${this.refs.rightScrollControl}"
                >
                    <div class="${c("shadow")}"></div>
                    <div
                        class="${c("button")}"
                        @click=${()=>this.onRightScrollClick()}
                    ></div>
                </div>
            </div>
        `}renderExampleMeta(e,t){const{html:s}=this.getRenderHelpers();return s`
            <div class="example_meta">
                <div class="example_ref_wrapper"
                     data-type="${e.refType}"
                     data-ref="${e.ref}"
                     data-message="${e.message}"
                     @mouseover=${e=>this.onRefMouseOver(e)}
                     @mouseout=${e=>this.onRefMouseOut(e)}>
                    <div class="example_ref"
                         data-type="${e.refType}"
                         data-message="${e.message}"
                         data-tracking-data='{"id": "example/ref"}'>
                        ${this.renderExampleIcon(e.refType)}
                    </div>
                </div>
                <div class="example_ref-info">
                    <div class="example_name">${e.ref}</div>
                    <div class=${t("author")}>${e.message}</div>
                </div>
            </div>
        `}renderExampleContent(e,t){const{html:s}=this.getRenderHelpers();return s`
            <div class="example_source">
                ${e.exampleVal&&e.exampleVal.map(({highlighted:e,text:i})=>e?s`
                        <span class=${t("highlighted")}>${i}</span>`:i)}
            </div>

            <div class="example_target">
                ${e.exampleTrs&&e.exampleTrs.map(({highlighted:e,text:i})=>e?s`
                        <span
                            @click=${e=>this.onHighlightedTextClick(e)}
                            data-value=${"tr:"+i}
                            data-active-target="true"
                            class=${t("highlighted")}>${i}</span>`:i)}
            </div>
        `}renderExample(e){const{html:t,cn:s}=this.getRenderHelpers(),i=s("example");return t`
            <div
                class="example_item example_item_type_${e.refType}"
                data-tracking-data='{"id": "example", "exampleId": "${e.id}"}'
                data-complaint-type="example"
                data-complaint-target="true"
                data-id=${e.id}
                data-text=${e.originalVal}
                data-translation=${e.originalTrs}
                tabindex="0"
            >
                ${this.renderExampleMeta(e,i)}
                <div class="example_wrapper" data-tracking-data='{"id": "example/src"}'>
                    ${this.renderExampleContent(e,i)}
                </div>
            </div>
        `}template({html:e,nothing:t,cn:s}){const{currentExamples:i,exampleTabs:n,currentMaxExamplesCount:o}=this.getProps(),r=(n||[]).length>1,a=(i||[]).length>o,l=s("block-separator"),c=s("button-items-expand"),d=s("block-label"),{i18n:u}=this.getLocalizations(),h=this.getExampleGroups();return e`
            <div class=${l()}></div>
            <p class=${d({target:"examples"})} tabindex="0">${u.examples}</p>
            ${this.renderWordsCarousel()}
            <div class=${"example_list "+(r?"example_list_wordsCarousel":"")}>
                ${h.map(t=>e`
                    <div class="example_group">
                        ${t.map((e,t)=>e.isIdiom?this.renderIdiomExample(e,t):this.renderExample(e))}
                    </div>
                `)}
            </div>
            ${a?e`
                <div
                    class=${c()}
                    @click=${()=>this.expandExamples()}
                    tabindex="0"
                    data-default-enter-action="true"
                    role="button"
                >
                    ${u.expandExamples}
                </div>
            `:t}
        `}}t.AbstractExamplesComponent=l,l.defaults={currentExamples:[],allExamples:[],exampleTabs:[],currentMaxExamplesCount:12,activeTabIndex:null,amountOfExpands:0,ignoreNextEmptyResponse:!1,bannedExamples:[],twoColumnsRender:!1,onRefMouseOver:()=>{},onRefMouseOut:()=>{}}},function(e,t,s){"use strict";t.__esModule=!0,t.DefinitionModule=void 0;var i=s(287),n=s(288);class o extends i.AbstractDefinitionModule{makeDefinitionComponent(){return new n.DefinitionComponent({onCardClick:e=>this.onCardClick(e)},{container:this.appConfig.ELEMENTS.definition,hideAfterTransition:!0,skipFadeoutTransition:!0})}}t.DefinitionModule=o},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractDefinitionModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(5),r=s(3),a=s(131),l=s(193);const{$track:c}=(0,r.getTrackerByNamespace)(a.DEFINITION_METRIKAS);class d extends o.AppModule{constructor(e,t){super(e,t),this.moduleName="definitions",this.definitionComponent=this.makeDefinitionComponent(),this.dictModel=this.app.getDictionaryModel(),this.definitionComponent.setEnabled(!0),this.meaningText="",this.cardType=null,this.listenDictModel(),this.listenAppModel(),this.listenApp()}reset(){this.definitionComponent.setProperty({def:null,abbreviations:[],activeAbbrIndex:0,text:""}).setVisible(!1).updateAsync()}onCardClick(e){this.app.isComplaintModeEnabled()&&(this.meaningText=e)}listenApp(){this.app.on("translationError",()=>this.reset()).onComplaintSend(()=>{const e=this.app.getComplaintTarget(),t="abbreviation"===n.default.getAttribute(e,"data-complaint-type"),s=this.app.getComplaintCommentInput().getView();t&&r.$tracker.sendMetric("definition_complaint_send",{text:this.meaningText,src:this.appModel.getProperty("text"),comment:s.getValue(),lang:this.app.getLangsPair(),type:this.cardType})})}listenDictModel(){this.dictModel.on(a.DEFINITION_EVENTS.DEF_FETCHED,({definition:e,abbreviations:t})=>{const{hasDefinition:s,hasAbbreviations:i,hasDefinitionOrAbbreviations:n}=(0,l.getDefinitionAndAbbreviationsInfo)({definition:e,abbreviations:t});this.definitionComponent.setProperty({def:e,abbreviations:t,activeAbbrIndex:0,text:this.appModel.getProperty("trText")}).updateAsync().setVisible(n),s&&(this.cardType="definition",c(a.DEFINITION_METRIKAS.DEF_RENDERED)),i&&(this.cardType="abbreviation",c(a.DEFINITION_METRIKAS.ABBR_RENDERED))}).onChange(n.default.debounce(()=>{this.dictModel.isValid()||this.reset()}))}listenAppModel(){this.appModel.onChange("text",e=>{e||this.reset()})}makeDefinitionComponent(){return{}}}t.AbstractDefinitionModule=d},function(e,t,s){"use strict";t.__esModule=!0,t.DefinitionComponent=void 0;var i=s(16),n=s(289),o=s(193),r=s(3),a=s(131),l=s(146);class c extends n.AbstractDefinitionComponent{getLocalizations(){return{i18n:l.i18n}}switchAbbreviation(e){const{abbreviations:t,activeAbbrIndex:s,text:i}=this.getProps(),n=t.length;if(!n)return;let o=s+e;-1===e&&0===s?o=n-1:1===e&&s===n-1&&(o=0),r.$tracker.sendMetric(a.DEFINITION_METRIKAS.ABBR_SWITCHED,{text:i,prev:t[s].abbrText,current:t[o].abbrText}),this.setProperty("activeAbbrIndex",o).updateAsync()}trackSourceLinkClick(e,t,s){r.$tracker.sendMetric(a.DEFINITION_METRIKAS.DEFINITION_SOURCE_CLICK,{type:e?a.DEFINITION_TYPES.ABBR:a.DEFINITION_TYPES.WIKI,text:t,source:s})}template({html:e,cn:t,nothing:s}){const{def:n,abbreviations:r,activeAbbrIndex:a,text:l,onCardClick:c}=this.getProps(),{hasAbbreviations:d,hasDefinitionOrAbbreviations:u}=(0,o.getDefinitionAndAbbreviationsInfo)({definition:n,abbreviations:r});if(!u)return s;const h=t("definition"),p=t("button")({view:"clear",size:"m",icn:!0,round:!0}),g=d&&r.length>1,m=d?r[a]:n,{i18n:E}=this.getLocalizations(),_=m.isAbbreviation?`${l.toUpperCase()}  ${m.abbrText}`:l,T=m.textVal.reduce((e,{text:t})=>e+t,""),f=Boolean(m.imgUrl),S=E[m.isAbbreviation?"definitionAbbrLabel":"definitionLabel"],C=m.sourceUrl?e`
            <a class="${h("sourceLink")}"
               href=${m.sourceUrl}
               @click=${()=>this.trackSourceLinkClick(d,l,m.sourceUrl)}
               rel="nofollow"
               target="_blank">
                ${E.definitionSourceWiki}
            </a>
        `:E.definitionSourceRobot,y=g?e`
            <div class="${h("switcher")}">
                <button class="${p}" @click=${()=>this.switchAbbreviation(-1)}>
                    ${(0,i.icn)("arrow-left",16)}
                </button>

                <span class="${h("switcherCurrentDefinition")}">${a+1} / ${r.length}</span>

                <button class="${p}" @click=${()=>this.switchAbbreviation(1)}>
                    ${(0,i.icn)("arrow-right",16)}
                </button>
            </div>
        `:s;return e`
            <div class="${h()}">
                ${y}
                <div
                    class=${h("card")}
                    data-title="${T}"
                    data-complaint-type="abbreviation"
                    data-complaint-target="true"
                    @click=${()=>c(T)}
                >
                    ${f?e`
                        <a
                            class=${h("img")}
                            style="background-image: url('${m.imgUrl}')"
                            href=${m.origUrl}
                            rel="nofollow"
                            target="_blank"></a>
                    `:s}
                    <div class=${h("content",{"has-img":f})}>
                        <p class=${h("label")}>${S}</p>
                        <p class=${h("text")}>${_}</p>
                        <p class=${h("source")}>${C}</p>
                        <p class=${h("meaning")}>${T}</p>
                    </div>
                </div>
            </div>
        `}}t.DefinitionComponent=c},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractDefinitionComponent=void 0;var i=s(6);class n extends i.Component{getLocalizations(){return{}}}t.AbstractDefinitionComponent=n,n.defaults={def:null,abbreviations:[],activeAbbrIndex:0,text:""}},function(e,t,s){"use strict";t.__esModule=!0,t.DeclensionsModule=void 0;var i=s(291),n=s(130),o=s(3),r=s(292);const{$track:a}=(0,o.getTrackerByNamespace)(n.DECLENSIONS_METRIKAS);class l extends i.AbstractDeclensionsModule{constructor(e,t){super(e,t),this.listenAppView(),this.listenAppModel()}listenAppView(){this.appView.onStateChanged("select",e=>{this.ignoreDict=e})}listenAppModel(){this.appModel.onChange("text",e=>{e||this.reset()})}makeDeclensionsComponent(){return new r.DeclensionsComponent({},{container:this.appConfig.ELEMENTS.declensions,hideAfterTransition:!0,skipFadeoutTransition:!0})}handleFetchedDeclensions(e){if(this.appConfig.ENABLE_NEW_DECLENSIONS)super.handleFetchedDeclensions(e);else if(!this.ignoreDict){const t=this.parseDeclensionsData(e),s=Boolean(t.length);if(s){const e=t.map(({wordDeclensions:e})=>e.length);o.$tracker.sendMetric(n.DECLENSIONS_METRIKAS.RENDER,{src:this.appModel.getProperty("text"),items:e}),a(n.DECLENSIONS_METRIKAS.RENDER,e)}return this.declensionsComponent.setProperty("declensions",t).setProperty("expanded",t.length<=n.MAX_NON_EXPANDED_DECLENSIONS_LENGTH).updateAsync().setVisible(s),s}}parseDeclensionTable(e,t=[]){return t.map(e=>({title:e[0],values:e.slice(1)}))}}t.DeclensionsModule=l},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractDeclensionsModule=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(5),r=s(3),a=s(70),l=s(130);class c extends o.AppModule{constructor(e,t){super(e,t),this.moduleName="declensions",this.declensionsComponent=this.makeDeclensionsComponent(),this.declensionsComponent.setEnabled(!0),this.listenApp(),this.listenDictModel(),this.listenDeclensionsComponent()}reset(){this.declensionsComponent.setVisible(!1).setProperty("declensions",[]).setProperty("activeTabIndexes",[]).updateAsync()}parseDeclensionsData(e){const t=[];return e.forEach(e=>{e.data&&e.data.forEach(({tables:s})=>{s&&s.forEach(({headers:s,rows:i})=>{t.push({word:e.text,ts:e.ts,headers:s?s.slice(1):[],partOfSpeech:e.partOfSpeech,wordDeclensions:this.parseDeclensionTable(s,i)})})})}),t}parseDeclensionTable(e,t){if(!e)return(t||[]).map(e=>({title:e[0],value:e[1]}));const s=[];for(let i=1;i<e.length;i+=1){const n=e[i];for(const e of t)s.push({title:`${n}, ${e[0]}`,value:e[i]})}return s}handleFetchedDeclensions(e){const t=e.length,s=t>0,i=e.map(({partOfSpeech:e})=>e===a.POS.VERB?1:0);s&&r.$tracker.sendMetric(l.DECLENSIONS_METRIKAS.RENDER,{src:this.appModel.getProperty("text"),items:[t]}),this.declensionsComponent.setProperty({declensions:e,activeTabIndexes:i}).updateAsync().setVisible(s)}listenApp(){this.app.on("translationError",()=>this.reset()).onComplaintSend(()=>{const e=this.app.getComplaintTarget(),t="declensions"===n.default.getAttribute(e,"data-complaint-type"),s=this.app.getComplaintCommentInput().getView();t&&r.$tracker.sendMetric("declensions_complaint_send",{src:this.appModel.getProperty("text"),comment:s.getValue(),lang:this.app.getLangsPair(),dir:this.app.getLangsPair(),wordValue:n.default.getDataAttr(e,"value"),partOfSpeech:n.default.getDataAttr(e,"part-of-speech")})})}listenDictModel(){this.app.getDictionaryModel().on(l.DECLENSIONS_EVENTS.DECLENSIONS_FETCHED,e=>this.handleFetchedDeclensions(e)).onInvalid(()=>this.reset())}listenDeclensionsComponent(){this.declensionsComponent.on(l.DECLENSIONS_EVENTS.WORD_CLICK,({wordValue:e})=>{this.appView.hasState("complaint")||this.appModel.setProperty("text",e,{type:"mean",sender:"declensions"})})}makeDeclensionsComponent(){return{}}}t.AbstractDeclensionsModule=c},function(e,t,s){"use strict";t.__esModule=!0,t.DeclensionsComponent=void 0,s(1);var i=s(16),n=s(293),o=s(3),r=s(18),a=s(130);const{$track:l}=(0,o.getTrackerByNamespace)(a.DECLENSIONS_METRIKAS);class c extends n.AbstractDeclensionsComponent{onExpandClick(){this.setProperty("expanded",!0).updateAsync(),l(a.DECLENSIONS_METRIKAS.EXPAND)}getExpandButton(){const{html:e,nothing:t,cn:s}=this.getRenderHelpers(),{expanded:i}=this.getProps(),n=s("button-items-expand");return i?t:e`
            <div
                 class="${n()}"
                 @click=${()=>this.onExpandClick()}
            >${r.desktopLocales.labels.expandDictionary}</div>`}getDeclensionRow(e,t,s){const{html:i,cn:n}=this.getRenderHelpers(),o=n("declensions");return i`
            <div class="${o("row")}">
                <div class="${o("title")}">${e}</div>

                ${t.map(e=>i`
                    <div class="${o("value")}">
                        <a data-value="${e}"
                           data-part-of-speech="${s}"
                           data-complaint-type="declensions"
                           data-complaint-target="true"
                           data-default-enter-action="true"
                           tabindex="0"
                           @click=${e=>this.onDeclensionWordClick(e)}>${e}</a>
                    </div>
                `)}
            </div>
        `}switchAbbreviation(e){const{declensions:t,activeCardIndex:s}=this.getProps(),i=t.length;if(!i)return;let n=s+e;-1===e&&0===s?n=i-1:1===e&&s===i-1&&(n=0);const o=this.getRef(this.refs.list);o.scrollLeft=Math.abs(n*o.querySelector(".declension").offsetWidth*e)}renderHeader({shouldRenderSwitcher:e}){const{activeCardIndex:t,declensions:s}=this.getProps(),{html:n,cn:o,nothing:a}=this.getRenderHelpers(),l=o("declensionHeader"),c=o("button")({view:"clear",size:"m",icn:!0,round:!0}),d=e?n`
            <div class="${l("switcher")}">
                <button class="${c}" @click=${()=>this.switchAbbreviation(-1)}>
                    ${(0,i.icn)("arrow-left",16)}
                </button>

                <span class="${l("switcherCurrentDefinition")}">${t+1} / ${s.length}</span>

                <button class="${c}" @click=${()=>this.switchAbbreviation(1)}>
                    ${(0,i.icn)("arrow-right",16)}
                </button>
            </div>`:a;return n`<div class=${l()}>
            <div class=${l("title")}>${r.desktopLocales.TAB_LABELS.declensions}</div>
            ${d}
        </div>`}template({html:e,cn:t,nothing:s}){if(window.config.ENABLE_NEW_DECLENSIONS)return super.template({html:e,cn:t,nothing:s});const{declensions:i,expanded:n}=this.getProps(),o=t("article-label"),l=t("dict-title"),c=t("declensions");return e`
            <div
                class=${o({target:"declensions"})}
                tabindex="0"
            >${r.desktopLocales.TAB_LABELS.declensions}</div>

            ${i.slice(0,n?void 0:a.MAX_NON_EXPANDED_DECLENSIONS_LENGTH).map(({word:t,partOfSpeech:i,ts:n,wordDeclensions:o,headers:r})=>e`
                    <div class=${c("group",{with_headers:r.length>0})}>
                        <div class=${c("head")}>
                            <div class=${l()}>
                                <span
                                    class=${l("part",{type:"word"})}
                                    tabindex="0"
                                >${t}</span>
                            ${n?e`
                                <span
                                    class=${l("part",{type:"transcription"})}
                                    tabindex="0"
                                >[${n}]</span>
                            `:s}
                            ${i?e`
                                <span
                                    class=${l("part",{type:"postfix"})}
                                    tabindex="0"
                                >${i}</span>
                            `:s}
                            </div>

                            ${r.map(t=>e`
                                <div class=${c("headLabel")}>${t}</div>
                            `)}
                        </div>

                        ${o.map(({title:e,values:t})=>this.getDeclensionRow(e,t,i))}
                    </div>
            `)}

            ${this.getExpandButton()}
        `}}t.DeclensionsComponent=c},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractDeclensionsComponent=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(6),r=s(70),a=s(46),l=s(3),c=s(130);class d extends o.Component{constructor(...e){super(...e),this.refs={list:"list"}}onDeclensionWordClick(e){const t=e.target.getAttribute("data-value"),s=e.target.getAttribute("data-part-of-speech");l.$tracker.sendMetric(c.DECLENSIONS_METRIKAS.CLICK,{wordValue:t,wordPartOfSpeech:s}),this.emit(c.DECLENSIONS_EVENTS.WORD_CLICK,{wordValue:t})}onTabClick({declensionIndex:e,activeTabIndex:t,text:s,header:i}){const{activeTabIndexes:n}=this.getProps();l.$tracker.sendMetric(c.DECLENSIONS_METRIKAS.TAB_CLICK,{src:s,tab:i}),n[e]!==t&&(n[e]=t,this.setProperty({activeTabIndexes:n}).updateAsync())}renderTimeline({ticks:e=[],highlight:t}){const{html:s,cn:i,nothing:n}=this.getRenderHelpers(),o=i("declensionTimeline");return s`<div class="${o()}">
            <div class="${o("axis")}"></div>
            <div class="${o("arrow")}"></div>
            ${e.map(({text:e,left:t})=>s`
                <div class="${o("tick")}" style="left: ${t};"></div>
                <div class="${o("text")}" style="left: ${t};">${e}</div>
            `)}
            ${t?s`<div class="${o("highlight")}" style="left: ${t.left}; width: ${t.width};"></div>`:n}
        </div>`}renderTablesInActiveTab({tables:e,partOfSpeech:t,isEnglish:s}){const{html:i,cn:n,nothing:o}=this.getRenderHelpers(),a=n("declension"),l=n("declensionTable"),c={},d=s&&t===r.POS.ADJECTIVE;return d&&(c.comparativeAdjective=!0),i`<ul class="${a("tables")}">${e.map(({header:e,comment:s,cells:n,timeline:r})=>i`
            <li class="${l("",{withoutHeader:!e})}">
                ${e?i`<p class="${l("header")}">${e}</p>`:o}
                ${s?i`<p class="${l("comment")}">${s}</p>`:o}
                <ul class="${l("cells",c)}">${n.map(({value:e,comment:s})=>{const r={};return!1===d&&n.length>1&&(r.multiple=!0),i`
                        <li class="${l("cell",r)}">
                            <p class="${l("cellValue")}">
                                ${e.optional?i`<span class="${l("cellValueOptional")}">${e.optional}</span>`:o}
                                <span
                                    class="${l("cellValueMain")}"
                                    data-value="${e.main}"
                                    data-part-of-speech="${t}"
                                    data-complaint-type="declensions"
                                    @click=${e=>this.onDeclensionWordClick(e)}
                                >${e.main}</span>
                            </p>
                            ${s?i`<p class="${l("cellComment")}">${s}</p>`:o}
                        </li>`})}
                </ul>
                ${r?this.renderTimeline(r):o}
            </li>
        `)}</ul>`}renderTabs({text:e,declensionIndex:t,activeTabIndex:s,tabs:i}){const{html:n,cn:o,nothing:r}=this.getRenderHelpers();if(!i)return r;if(i.length<2)return r;const a=o("declension");return n`<ul class="${a("tabs")}">${i.map(({header:i},o)=>n`
            <li class="${a("tab",{active:o===s})}"
                @click=${()=>this.onTabClick({declensionIndex:t,activeTabIndex:o,text:e,header:i})}>${i}</li>
        `)}</ul>`}renderHeader(){const{nothing:e}=this.getRenderHelpers();return e}onListScroll(){const{declensions:e,activeCardIndex:t}=this.getProps(),s=this.getRef(this.refs.list),i=s.querySelector(".declension"),n=Math.floor(s.scrollLeft/i.offsetWidth);l.$tracker.sendMetric(c.DECLENSIONS_METRIKAS.LIST_SCROLL,{prev:{text:e[t].text,partOfSpeech:e[t].partOfSpeech},current:{text:e[n].text,partOfSpeech:e[n].partOfSpeech}}),this.setProperty("activeCardIndex",n).updateAsync()}template({html:e,cn:t}){const{declensions:s,activeTabIndexes:i}=this.getProps(),o=t("scrollableCards"),r=t("scrollableCard"),l=t("declensions"),c=t("declension"),d=s.length>1;return e`
            ${this.renderHeader({shouldRenderSwitcher:s.length>1})}
            <ul class="${l()} ${o("",{multiple:d})}" data-ref-id="${this.refs.list}" @scroll=${n.default.debounce(this.onListScroll.bind(this),50)}>
                ${s.map(({isEnglish:t,text:s,partOfSpeech:n,tabs:o},l)=>{const d=a.locales.declensions.labels[t?n:n+"_forms"];return e`<li class="${c()} ${r()}">
                        <p class="${c("label")}">${d}</p>
                        ${this.renderTabs({text:s,declensionIndex:l,activeTabIndex:i[l],tabs:o})}
                        ${this.renderTablesInActiveTab({tables:o[i[l]].tables,isEnglish:t,partOfSpeech:n})}
                    </li>`})}
            </ul>
        `}}t.AbstractDeclensionsComponent=d,d.defaults={declensions:[],activeCardIndex:0,activeTabIndexes:[],expanded:!0}},function(e,t,s){"use strict";t.__esModule=!0,t.RelatedWordsModule=void 0;var i=s(295),n=s(296);class o extends i.AbstractRelatedWordsModule{constructor(e,t){super(e,t),this.listenAppModel()}listenAppModel(){this.appModel.onChange("text",e=>{e||this.reset()})}makeRelatedWordsComponent(){return new n.RelatedWordsComponent({},{container:this.appConfig.ELEMENTS.relatedWords,hideAfterTransition:!0,skipFadeoutTransition:!0})}onRelatedWordClick(e){this.appModel.getProperty("complaint")||super.onRelatedWordClick(e)}}t.RelatedWordsModule=o},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractRelatedWordsModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(5),r=s(3),a=s(136);const l=e=>e.reduce((e,{tr:t})=>e+t.reduce((e,{syn:t})=>e+(t?t.length+1:1),0),0),{$track:c}=(0,r.getTrackerByNamespace)(a.RELATED_WORDS_METRIKAS);class d extends o.AppModule{constructor(e,t){super(e,t),this.moduleName="relatedWords",this.relatedWordsComponent=this.makeRelatedWordsComponent(),this.dictModel=this.app.getDictionaryModel(),this.relatedWordsComponent.setEnabled(!0),this.app.on("translationError",()=>this.reset()),this.listenDictModel(),this.listenComponent()}reset(){this.relatedWordsComponent.setVisible(!1).setProperty({synWords:[],antWords:[],derivedWords:[]}).updateAsync()}listenDictModel(){this.dictModel.on(a.RELATED_WORDS_EVENTS.WORDS_FETCHED,({relatedWords:e,visible:t})=>this.setWords(e,t)).onChange(n.default.debounce(()=>{this.dictModel.isValid()||this.reset()})).on("error",()=>this.reset())}listenComponent(){this.relatedWordsComponent.on(a.RELATED_WORDS_EVENTS.WORD_CLICK,e=>this.onRelatedWordClick(e))}onRelatedWordClick({wordType:e,wordValue:t}){this.appModel.getProperty("complaint")||(c(a.RELATED_WORDS_METRIKAS.WORDS_CLICK,{wordType:e,wordValue:t}),this.appModel.setProperty("text",t,{type:"mean",sender:"relatedWords"}))}setWords(e,t){if(!e)return;const{synWords:s,antWords:i,derivedWords:n}=e;if(this.relatedWordsComponent.setProperty({synWords:s,antWords:i,derivedWords:n}).updateAsync().setVisible(t),t){const e=[];s.length&&e.push({tab:"syn",itemsCount:l(s)}),i.length&&e.push({tab:"ant",itemsCount:l(i)}),n.length&&e.push({tab:"deriv",itemsCount:l(n)}),c(a.RELATED_WORDS_METRIKAS.RENDER,{items:e})}}}t.AbstractRelatedWordsModule=d},function(e,t,s){"use strict";t.__esModule=!0,t.RelatedWordsComponent=void 0;var i=s(297),n=s(146);class o extends i.AbstractRelatedWordsComponent{getLocalizations(){return n.synTitles}getArticleLabel(){const{html:e,cn:t}=this.getRenderHelpers(),s=this.getLocalizations();return e`<div
            class="${t("block")("label")}"
            tabindex="0"
        >${s.relatedWords}</div>`}}t.RelatedWordsComponent=o},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractRelatedWordsComponent=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(3),r=s(6),a=s(29),l=s(136),c=s(298);const{$track:d}=(0,o.getTrackerByNamespace)(l.RELATED_WORDS_METRIKAS);class u extends r.Component{reset(){this.setProperty({wordListLength:l.DEFAULT_ITEMS_AMOUNT})}onExpandClick(){const{type:e}=this.getProps();this.setProperty({wordListLength:1/0}).updateAsync(),d(l.RELATED_WORDS_METRIKAS.WORDS_EXPAND,{type:e})}template({html:e,cn:t,nothing:s},{words:i}){const{title:n,type:o,onWordClick:r}=this.getProps(),a=this.getProperty("wordListLength"),l=a<i.length,c=t("related"),d=t("article");if(!i||!i.length)return s;return e`
            <p
                class="${d("label",{target:"relatedWords"})}"
                tabindex="0"
            >${n}</p>
            <div class="${c("words")}">
                ${i.slice(0,a).map(t=>e`
            <div
                data-value="${t}"
                data-word-type="${o}"
                data-complaint-type="relatedWord"
                data-complaint-target="true"
                class="${c("word",["tag"])}"
                @click=${e=>r(e)}
                tabindex="0"
                data-default-enter-action="true"
            >
              ${t}
          </div>
        `)}
                ${l?e`<div
                        class="${c("word",{expand:!0},["tag"])}"
                        @click=${()=>this.onExpandClick()}
                        role="button"
                        tabindex="0"
                        data-default-enter-action="true"
                    >...</div>`:s}
            </div>
        `}}u.defaults={wordListLength:l.DEFAULT_ITEMS_AMOUNT};class h extends r.Component{constructor(e,t){super(e,t);const s=this.getLocalizations();this.onSet(n.default.debounce(()=>this.onWordsSet(),0)),this.childComponents={Synonyms:new u({type:"synonyms",title:s.syn,onWordClick:e=>this.onWordClick(e,"synonyms")}),Antonyms:new u({type:"antonyms",title:s.ant,onWordClick:e=>this.onWordClick(e,"antonyms")}),Derivatives:new u({type:"derivatives",title:s.deriv,onWordClick:e=>this.onWordClick(e,"derivatives")})}}getLocalizations(){return{}}onWordsSet(){}onWordClick(e,t){const s=e.target.getAttribute(a.VALUE_ATTR);this.emit(l.RELATED_WORDS_EVENTS.WORD_CLICK,{wordValue:s,wordType:t})}parseRelatedWordsArray(e,t){(0,c.parseRelatedWordsArray)(e,t)}getRelatedWords(){const{synWords:e,antWords:t,derivedWords:s}=this.getProps(),i=[],o=[],r=[];return[{source:e,accum:i},{source:t,accum:o},{source:s,accum:r}].forEach(({source:e,accum:t})=>{n.default.isArray(e)&&e.forEach(({tr:e})=>{n.default.isArray(e)&&e.forEach(e=>this.parseRelatedWordsArray(e,t))})}),{synonyms:i,derivatives:o,antonyms:r}}getArticleLabel(){return this.getRenderHelpers().nothing}template({html:e,cn:t}){const{synonyms:s,derivatives:i,antonyms:n}=this.getRelatedWords(),{Synonyms:o,Antonyms:r,Derivatives:a}=this.childComponents,l=t("block-separator")({target:"related"});return e`
            ${this.getArticleLabel()}
            <div class="${l}"></div>
            ${o.getMemoizedDirective({words:s})}
            ${r.getMemoizedDirective({words:i})}
            ${a.getMemoizedDirective({words:n})}
        `}}t.AbstractRelatedWordsComponent=h,h.defaults={synWords:[],antWords:[],derivedWords:[]}},function(e,t,s){"use strict";t.__esModule=!0,t.parseRelatedWordsArray=void 0;const i=(e,t)=>{e.text&&t.push(e.text),e.syn&&e.syn.forEach(({text:e,syn:s})=>{e&&t.push(e),s&&i(s,t)})};t.parseRelatedWordsArray=i},function(e,t,s){"use strict";t.__esModule=!0,t.RelatedContentModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(5),r=s(136),a=s(137),l=s(131),c=s(3),d=s(130),u=s(15),h=s(2);class p extends o.AppModule{constructor(e,t){super(e,t),this.relatedContentView=new u.View({element:this.appConfig.ELEMENTS.relatedContent}),this.relatedHeaderView=new h.TouchView({element:this.appConfig.ELEMENTS.dictionaryHeader}),this.hasDict=!1,this.hasRelatedWords=!1,this.hasDefinition=!1,this.hasDeclesions=!1,this.listenApp(),this.listenAppModel(),this.listenDictModel(),this.listenComponents()}reset(){this.hasDict=!1,this.hasRelatedWords=!1,this.hasDefinition=!1,this.hasDeclesions=!1}updateContainerState(){this.appView.setState("rightEmpty",!(this.hasRelatedWords||this.hasDict||this.hasDeclesions))}listenAppModel(){this.appModel.onChange(["text","srcLang","dstLang"],n.default.debounce(()=>{this.relatedHeaderView.isVisible()&&this.app.emit("action:disableCustomMode")}))}listenApp(){this.app.onAction("enableCustomMode",()=>{const{selTr:e,selText:t}=this.appModel.getProps(),s=e||t;this.relatedHeaderView.setContent(`${this.appConfig.LOCALIZATIONS.disableCustomMode} ${s}`).setVisible(!0)}).onAction("disableCustomMode",()=>this.relatedHeaderView.setVisible(!1))}listenComponents(){(0,c.getTrackerByNamespace)(d.DECLENSIONS_METRIKAS).on(d.DECLENSIONS_METRIKAS.RENDER,()=>{this.hasDeclesions=!0,this.updateContainerState()})}listenDictModel(){this.app.getDictionaryModel().on(a.DICTIONARY_EVENTS.DICT_FETCHED,e=>{this.hasDict=e&&e.length,this.updateContainerState()}).on(r.RELATED_WORDS_EVENTS.WORDS_FETCHED,({visible:e})=>{this.hasRelatedWords=e,this.updateContainerState()}).on(l.DEFINITION_EVENTS.DEF_FETCHED,({definition:e})=>{this.hasDefinition=Boolean(e),this.updateContainerState()}).onChange(["srcLang","dstLang","text"],n.default.debounce(()=>this.reset()))}}t.RelatedContentModule=p},function(e,t,s){"use strict";t.__esModule=!0,t.RelatedContentWithMiniNavModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(5),r=s(136),a=s(137),l=s(131),c=s(3),d=s(130),u=s(141),h=s(15),p=s(2),g=s(301);class m extends o.AppModule{constructor(e,t){super(e,t),this.relatedContentView=new h.View({element:this.appConfig.ELEMENTS.relatedContent}),this.miniNavView=new p.TouchView({element:this.appConfig.ELEMENTS.miniNav,hideAfterTransition:!0}),this.miniNavItemsView=new h.View({element:this.appConfig.ELEMENTS.miniNavItems}),this.relatedHeaderView=new p.TouchView({element:this.appConfig.ELEMENTS.dictionaryHeader}),this.hasDict=!1,this.hasRelatedWords=!1,this.hasDefinition=!1,this.hasDeclesions=!1,this.hasExamples=!1,this.savedViewportWidth=window.innerWidth,this.isMiniNavShrunk=!1,this.listenApp(),this.listenAppModel(),this.listenDictModel(),this.listenComponents(),this.listenMiniNav(),this.listenScroll()}reset(){this.hasDict=!1,this.hasRelatedWords=!1,this.hasDefinition=!1,this.hasDeclesions=!1,this.hasExamples=!1,this.isMiniNavShrunk=!1,this.hideMiniNav()}handleStateChange(){this.canShowMiniNav()?this.showMiniNav():this.hideMiniNav(),this.appView.setState("rightEmpty",!(this.hasRelatedWords||this.hasDict||this.hasDeclesions))}listenAppModel(){this.appModel.onChange(["text","srcLang","dstLang"],n.default.debounce(()=>{this.relatedHeaderView.isVisible()&&this.app.emit("action:disableCustomMode")}))}listenApp(){this.app.on("resize",()=>{this.handleResize()}).onAction("enableCustomMode",()=>{const{selTr:e,selText:t}=this.appModel.getProps(),s=e||t;this.relatedHeaderView.setContent(`${this.appConfig.LOCALIZATIONS.disableCustomMode} ${s}`).setVisible(!0)}).onAction("disableCustomMode",()=>this.relatedHeaderView.setVisible(!1))}listenComponents(){(0,c.getTrackerByNamespace)(d.DECLENSIONS_METRIKAS).on(d.DECLENSIONS_METRIKAS.RENDER,()=>{this.hasDeclesions=!0,this.handleStateChange()}),(0,c.getTrackerByNamespace)(u.EXAMPLE_METRIKAS).on(u.EXAMPLE_METRIKAS.EXAMPLES_RENDERED,()=>{this.hasExamples=!0,this.handleStateChange()})}listenDictModel(){this.app.getDictionaryModel().on(a.DICTIONARY_EVENTS.DICT_FETCHED,e=>{this.hasDict=e&&e.length,this.handleStateChange()}).on(r.RELATED_WORDS_EVENTS.WORDS_FETCHED,({visible:e})=>{this.hasRelatedWords=e,this.handleStateChange()}).on(l.DEFINITION_EVENTS.DEF_FETCHED,({definition:e})=>{this.hasDefinition=Boolean(e),this.handleStateChange()}).onChange(["srcLang","dstLang","text"],n.default.debounce(()=>this.reset()))}listenMiniNav(){this.miniNavView.onTap(e=>{const t=n.default.getDataAttr(e.target,"mini-nav-target"),s=n.default.getDataAttr(e.target,"mini-nav-scroll");if(t)return this.scrollToMiniNavTarget(t),void this.trackMiniNavItemClick(t);s&&(this.scrollMiniNav("left"===s?-200:200),this.trackMiniNavControlClick(s))}).on("mouseover",()=>{this.isMiniNavShrunk&&this.growMiniNav()}).bindDOMEvents("mouseover"),this.miniNavItemsView.on("scroll",n.default.throttleWithCallGuarantee(()=>{this.updateMiniNavControls()},100)).bindDOMEvents("scroll")}listenScroll(){window.addEventListener("scroll",n.default.throttleWithCallGuarantee(()=>{if(this.isMiniNavVisible())if(this.isMiniNavShrunk){this.appConfig.ENABLE_MINI_NAV_TOP_GROW&&0===document.documentElement.scrollTop&&this.growMiniNav()}else this.shrinkMiniNav()},500))}handleResize(){const e=window.innerWidth;e!==this.savedViewportWidth&&(this.savedViewportWidth=e,this.updateMiniNavWidth(),this.updateMiniNavControls())}setMiniNavControlVisibility({elem:e,isVisible:t}){e.style.display=t?"flex":"none"}scrollMiniNav(e){const t=this.appConfig.ELEMENTS.miniNavItems;n.default.smoothScrollTo(t,0,t.scrollLeft+e)}updateMiniNavControls(){const e=this.appConfig.ELEMENTS.miniNavItems,t=e.scrollWidth-e.clientWidth;this.setMiniNavControlVisibility({elem:this.appConfig.ELEMENTS.miniNavControlLeft,isVisible:e.scrollLeft>0}),this.setMiniNavControlVisibility({elem:this.appConfig.ELEMENTS.miniNavControlRight,isVisible:e.scrollLeft<t})}updateMiniNavWidth(){const e={maxWidth:this.calcMiniNavWidth()+"px"};this.miniNavView.setStyle(e)}scrollToMiniNavTarget(e){const t=this.appConfig.ELEMENTS[e];t&&n.default.smoothScrollTo(document.documentElement,t.offsetTop)}isMiniNavVisible(){return this.miniNavView.isVisible()}hideMiniNav(){this.miniNavView.setVisible(!1)}showMiniNav(){this.growMiniNav(),this.updateMiniNavWidth(),this.miniNavView.setVisible(!0),this.updateMiniNavControls()}shrinkMiniNav(){this.miniNavView.setState("shrunk",!0),this.isMiniNavShrunk=!0}growMiniNav(){this.miniNavView.setState("shrunk",!1),this.isMiniNavShrunk=!1}canShowMiniNav(){return this.hasDict&&this.hasRelatedWords&&this.hasDeclesions&&this.hasExamples}calcMiniNavWidth(){const{width:e}=this.appConfig.ELEMENTS.miniNavMeasurer.getBoundingClientRect();return e}trackMiniNavItemClick(e){c.$tracker.sendMetric(g.MINI_NAV_METRIKAS.ITEM_CLICK,{src:this.appModel.getProperty("text"),target:e})}trackMiniNavControlClick(e){c.$tracker.sendMetric(g.MINI_NAV_METRIKAS.CONTROL_CLICK,{src:this.appModel.getProperty("text"),direction:e})}}t.RelatedContentWithMiniNavModule=m},function(e,t,s){"use strict";t.__esModule=!0,t.MINI_NAV_METRIKAS=void 0;t.MINI_NAV_METRIKAS={ITEM_CLICK:"mini_nav_item_click",CONTROL_CLICK:"mini_nav_control_click"}},function(e,t,s){"use strict";t.__esModule=!0,t.IdiomDefinitionModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(5),r=s(3),a=s(131),l=s(303);class c extends o.AppModule{constructor(e,t){super(e,t),this.idiomComponent=new l.IdiomDefinitionComponent({},{container:this.appConfig.ELEMENTS.idiomDefinition,hideAfterTransition:!0,skipFadeoutTransition:!0}),this.listenApp(),this.listenAppModel(),this.listenDictionaryModel()}reset(){this.idiomComponent.setProperty({text:null,inputText:null}).setVisible(!1)}listenDictionaryModel(){this.app.getDictionaryModel().on("idiomFetched",e=>{const t=this.appModel.getProperty("trText");this.idiomComponent.setProperty({text:e,inputText:t}).setVisible(!0),r.$tracker.sendMetric("idioms_rendered",{idiomText:e,src:this.appModel.getProperty("text")}),r.$tracker.sendMetric(a.DEFINITION_METRIKAS.DEFINITION_RENDERED,{text:t,type:a.DEFINITION_TYPES.IDIOM})})}listenApp(){this.app.on("translationError",()=>this.reset()).onComplaintSend(()=>{const e=this.app.getComplaintTarget(),t="idiom"===n.default.getAttribute(e,"data-complaint-type"),s=this.app.getComplaintCommentInput().getView();t&&r.$tracker.sendMetric("idioms_complaint_send",{idiomsText:this.idiomComponent.getProperty("text"),src:this.appModel.getProperty("text"),comment:s.getValue(),lang:this.app.getLangsPair()})})}listenAppModel(){this.appModel.onChange(["trText","srcLang","dstLang"],()=>this.reset())}}t.IdiomDefinitionModule=c},function(e,t,s){"use strict";t.__esModule=!0,t.IdiomDefinitionComponent=void 0;var i=s(6),n=s(146);class o extends i.Component{constructor(e,t){super(e,t),this.onChange(()=>this.update())}template({html:e,cn:t,nothing:s}){const{text:i,inputText:o}=this.getProps(),r=t("definition");return i?e`
             <div class="${r()}">
                <div class=${r("card")}>
                    <div class=${r("content")}>
                        <p class=${r("label")}>${n.i18n.definitionIdiomLabel}</p>
                        <p class=${r("text")}>${o}</p>
                        <p class=${r("source")}>${n.i18n.definitionSourceRobot}</p>
                        <p
                            class=${r("meaning")}
                            data-prevent-focus="true"
                            data-complaint-type="idiom"
                            data-complaint-target="true"
                            data-title="${i}">${i}</p>
                    </div>
                </div>
            </div>
        `:s}}t.IdiomDefinitionComponent=o,o.defaults={text:null,inputText:null}},function(e,t,s){"use strict";t.__esModule=!0,t.FileDropModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(147);class r extends o.FileDropModule{constructor(e,t){super(e,t),this.dropOverlay.on("formatError",()=>{this.appModel.setProperty("toast",n.default.parseString(this.appConfig.TOAST_MESSAGES.unsupportedFormat,this.appConfig.ALLOWED_FORMATS))}).on("sizeError",()=>{this.appModel.setProperty("toast",n.default.parseString(this.appConfig.TOAST_MESSAGES.maxSize,this.appConfig.MAX_FILE_SIZE_MB))})}}t.FileDropModule=r},function(e,t,s){"use strict";t.__esModule=!0,t.StoriesModule=t.APP_EVENTS=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(11),r=s(306),a=s(145),l=s(307);t.APP_EVENTS={};class c extends r.AbstractStoriesModule{constructor(e,t){super(e,t),this.appConfig.DISABLE_STORIES_VIEWER&&this.$collapseEmojiStory(),this.listenAppView()}makeViewer(){return new l.StoriesViewer({stories:this.appConfig.stories},{container:document.getElementById("storiesViewer"),hideAfterTransition:!0})}handleActionOcr(e){this.redirectToAction("/ocr?"+n.default.toQueryString({ocr_image_url:e}))}handleActionUrl(e){this.redirectToAction("/translate?"+n.default.toQueryString({url:e}))}redirectToAction(e){window.open(e,"_blank")}listenAppView(){this.appView.on("keydown",({keyCode:e})=>{if(this.viewer.isVisible())switch(e){case o.KEYBOARD_KEYS.RIGHT:this.viewer.updateActiveCard(1,a.STORY_MOVE_TYPES.KEYBOARD);break;case o.KEYBOARD_KEYS.LEFT:this.viewer.updateActiveCard(-1,a.STORY_MOVE_TYPES.KEYBOARD);break;case o.KEYBOARD_KEYS.ESCAPE:this.viewer.closeViewer(a.STORY_CLOSE_TYPES.ESC)}})}}t.StoriesModule=c},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractStoriesModule=t.APP_EVENTS=void 0;var i=s(10),n=s(5),o=s(3),r=s(152),a=s(145);t.APP_EVENTS={};class l extends n.AppModule{constructor(e,t){super(e,t),this.moduleName="stories",this.appConfig.COLLAPSE_EMOJI_STORY&&this.$collapseEmojiStory(),this.viewer=this.makeViewer(),(0,i.getGlobalEmitter)().on(r.STORY_GLOBAL_EVENTS.RUN_ACTION,e=>this.handleStoryAction(e)),this.listenApp()}$collapseEmojiStory(){this.appConfig.stories.forEach(e=>{if("emoji"===e.type&&2===e.stories.length){const t=e.stories.pop();e.stories[0].controls=t.controls}})}handleActionEmoji(e){this.appModel.setProperty({srcLang:"emj",dstLang:this.appConfig.UI_LANG,text:e},{sender:"story"})}handleActionOcr(e){}handleActionUrl(e){}handleStoryAction(e){this.viewer.closeViewer(a.STORY_CLOSE_TYPES.ACTIVATION);const t=e.stories[e.stories.length-1].controls;switch(o.$tracker.sendMetric("stories_activate",{action:t.type,story:e.id}),t.type){case"emoji":this.handleActionEmoji(t.meta.text);break;case"ocr":this.handleActionOcr(t.meta.imageUrl);break;case"url":this.handleActionUrl(t.meta.url)}}openStory(e){if(this.appConfig.DISABLE_STORIES_VIEWER)return this.handleStoryAction(e);this.viewer.setActive(this.appConfig.stories.indexOf(e)).setVisible(!0)}listenApp(){this.app.on("stories:open",e=>this.openStory(e))}}t.AbstractStoriesModule=l},function(e,t,s){"use strict";t.__esModule=!0,t.StoriesViewer=void 0;var i=s(308),n=s(309),o=s(152),r=s(16),a=s(145);class l extends n.AbstractStoriesViewer{template({html:e,cn:t,nothing:s}){const{stories:l,active:c,prevActive:d,storyCardIndex:u}=this.getProps(),h=l[c],p=l.slice(0,c),g=l.slice(c+1),m=p.length>0,E=g.length>0,_=t("storiesViewer"),T=t("storyPreview"),f=t("button")({size:"l",view:"clear",round:!0,icn:!0}),S=f+" button_close",C=(e,t)=>this.getStoryCard(e).getDirective({view:o.STORY_CARD_VIEWS.STORY,storyIndex:0,clickHandler:t}),y=t=>{const s=l.indexOf(t);return e`
                <div class=${T({prevActive:d===s})}>
                    ${C(t,e=>{e.stopPropagation(),this.setActive(s,!0)})}
                </div>
            `};return e`
            <div class=${_("prev")}>
                ${(0,i.repeat)(p,e=>e.id,y)}
            </div>

            <div class=${_("active")}
                 @click=${e=>e.stopPropagation()}
                 data-ref-id=${this.refs.activeStory}
                 data-move-dir=${n.moveDirs.center}>
                <div class=${_("controls",{left:!0})}>
                    ${m?e`
                        <button
                            @click=${()=>this.updateActiveCard(-1,a.STORY_MOVE_TYPES.ARROW_TAP)}
                            class=${f}>${(0,r.icn)("arrow-short-back")}</button>
                    `:s}
                </div>

                ${this.storyCardTemplate(h,u,_)}

                <div class=${_("controls",{right:!0})}>
                    <button
                        @click=${()=>this.closeViewer(a.STORY_CLOSE_TYPES.BUTTON_TAP)}
                        class=${S}>${(0,r.icn)("clear")}</button>
                    ${E?e`
                        <button
                            @click=${()=>this.updateActiveCard(1,a.STORY_MOVE_TYPES.ARROW_TAP)}
                            class=${f}>${(0,r.icn)("arrow-short-forward")}</button>
                    `:s}
                </div>
            </div>

            <div class=${_("next")}>
                ${(0,i.repeat)(g,e=>e.id,y)}
            </div>
        `}}t.StoriesViewer=l},function(e,t,s){"use strict";t.__esModule=!0,t.repeat=void 0,s(1);var i=s(47);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const n=(e,t)=>{const s=e.startNode.parentNode,n=void 0===t?e.endNode:t.startNode,o=s.insertBefore((0,i.createMarker)(),n);s.insertBefore((0,i.createMarker)(),n);const r=new i.NodePart(e.options);return r.insertAfterNode(o),r},o=(e,t)=>(e.setValue(t),e.commit(),e),r=(e,t,s)=>{const n=e.startNode.parentNode,o=s?s.startNode:e.endNode,r=t.endNode.nextSibling;r!==o&&(0,i.reparentNodes)(n,t.startNode,r,o)},a=e=>{(0,i.removeNodes)(e.startNode.parentNode,e.startNode,e.endNode.nextSibling)},l=(e,t,s)=>{const i=new Map;for(let n=t;n<=s;n++)i.set(e[n],n);return i},c=new WeakMap,d=new WeakMap,u=(0,i.directive)((e,t,s)=>{let u;return void 0===s?s=t:void 0!==t&&(u=t),t=>{if(!(t instanceof i.NodePart))throw new Error("repeat can only be used in text bindings");const h=c.get(t)||[],p=d.get(t)||[],g=[],m=[],E=[];let _,T,f=0;for(const t of e)E[f]=u?u(t,f):f,m[f]=s(t,f),f++;let S=0,C=h.length-1,y=0,A=m.length-1;for(;S<=C&&y<=A;)if(null===h[S])S++;else if(null===h[C])C--;else if(p[S]===E[y])g[y]=o(h[S],m[y]),S++,y++;else if(p[C]===E[A])g[A]=o(h[C],m[A]),C--,A--;else if(p[S]===E[A])g[A]=o(h[S],m[A]),r(t,h[S],g[A+1]),S++,A--;else if(p[C]===E[y])g[y]=o(h[C],m[y]),r(t,h[C],h[S]),C--,y++;else if(void 0===_&&(_=l(E,y,A),T=l(p,S,C)),_.has(p[S]))if(_.has(p[C])){const e=T.get(E[y]),s=void 0!==e?h[e]:null;if(null===s){const e=n(t,h[S]);o(e,m[y]),g[y]=e}else g[y]=o(s,m[y]),r(t,s,h[S]),h[e]=null;y++}else a(h[C]),C--;else a(h[S]),S++;for(;y<=A;){const e=n(t,g[A+1]);o(e,m[y]),g[y++]=e}for(;S<=C;){const e=h[S++];null!==e&&a(e)}c.set(t,g),d.set(t,E)}});t.repeat=u},function(e,t,s){"use strict";t.__esModule=!0,t.moveDirs=t.AbstractStoriesViewer=void 0;var i=s(10),n=s(6),o=s(152),r=s(3),a=s(145);const l={left:"left",right:"right",center:"center",self:"self"};t.moveDirs=l;class c extends n.Component{constructor(e,t){super(e,t),this.progressTs=null,this.progressTotalMs=0,this.progressPaused=!1,this.nextCardTimeout=null,this.refs={activeStory:"activeStory",activeProgress:"activeProgress"},this.onRendered(()=>{this.runMoveAnimation(),this.resetProgress()}).onVisibilityChanged(e=>{e?(r.$tracker.sendMetric("stories_open",{index:this.getProperty("active"),story:this.getActiveStory().id}),this.resetMoveAnimation(),this.updateNow()):clearTimeout(this.nextCardTimeout)}),this.on("click",()=>{this.closeViewer(a.STORY_CLOSE_TYPES.BG_TAP)}).bindDOMEvents("click"),this.onChange(()=>{this.isVisible()&&this.updateAsync()})}getActiveStory(){const{active:e,stories:t}=this.getProps();return t[e]}runMoveAnimation(){let e;const{active:t,prevActive:s,storyChanged:i}=this.getProps();e=i?isNaN(s)?l.center:s>t?l.left:l.right:l.self,this.updateStoryMoveDir(e)}resetMoveAnimation(){this.updateStoryMoveDir(null)}updateStoryMoveDir(e){const t=this.getRef(this.refs.activeStory);if(t)if(e){this.getRef(this.refs.activeStory).setAttribute("data-move-dir",e)}else t.removeAttribute("data-move-dir"),t.clientHeight}resetProgress(){this.progressTotalMs=0,this.runProgressTimer(this.getProperty("storyDuration")),this.resetVisualProgress()}runProgressTimer(e){clearTimeout(this.nextCardTimeout),this.progressTs=Date.now(),this.nextCardTimeout=setTimeout(()=>{this.updateActiveCard(1,a.STORY_MOVE_TYPES.TIME)},e)}resetVisualProgress(){const e=this.getRef(this.refs.activeProgress);e&&(e.removeAttribute("data-progress-active"),e.clientHeight,e.setAttribute("data-progress-active",""))}runActiveStoryAction(){(0,i.getGlobalEmitter)().emit(o.STORY_GLOBAL_EVENTS.RUN_ACTION,this.getActiveStory())}setActive(e,t=!1){const{active:s}=this.getProps();return this.setProperty({active:e,prevActive:t?s:null,storyChanged:!0,storyCardIndex:0})}updateActiveCard(e,t){const{storyCardIndex:s}=this.getProps(),i=this.getActiveStory().stories;if(s+e>=0&&i[s+e])return this.resetMoveAnimation(),this.setProperty({storyChanged:!1,storyCardIndex:s+e});this.updateActiveStory(e,t)}updateActiveStory(e,t){const{active:s,stories:i}=this.getProps(),n=s+e;if(!(n<0)){if(!(n>=i.length))return r.$tracker.sendMetric("stories_move",{type:t,index:n,story:i[n].id}),this.resetMoveAnimation(),this.setProperty({active:n,prevActive:s,storyCardIndex:0,storyChanged:!0});this.closeViewer(a.STORY_CLOSE_TYPES.END)}}closeViewer(e){if(!this.isVisible())return;const{active:t,stories:s}=this.getProps();r.$tracker.sendMetric("stories_close",{type:e,index:t,story:s[t].id}),this.setVisible(!1)}toggleProgressState(e){const t=this.getRef(this.refs.activeProgress);t&&t.firstElementChild&&(t.firstElementChild.style.animationPlayState=e?"running":"paused"),e?this.runProgressTimer(this.getProperty("storyDuration")-this.progressTotalMs):(clearTimeout(this.nextCardTimeout),this.progressTotalMs+=Date.now()-this.progressTs),this.progressPaused=!e}handleMouseleave(){this.progressPaused&&this.toggleProgressState(!0)}getStoryCard(e){return o.StoryCard.getCachedInstance("story"+e.id,{story:e})}getStoryDirective(e,t){return this.getStoryCard(e).getDirective({storyIndex:t,view:o.STORY_CARD_VIEWS.STORY})}progressTemplate(e,t){const{cn:s,html:i}=this.getRenderHelpers(),n=s("storyProgress"),o=Array(e.stories.length).fill(0);return i`
            <div class=${n()}>
                ${o.map((e,s)=>i`
                    <div data-ref-id=${s===t?this.refs.activeProgress:""}
                         ?data-progress-active=${s===t}
                         ?data-progress-done=${t>s}
                         class=${n("part")}>
                        <div class=${n("part-inner")}></div>
                    </div>
                `)}
            </div>
        `}storyCardTemplate(e,t,s,i=null){const{html:n}=this.getRenderHelpers();return n`
            <div class=${s("card")}
                 @mouseleave=${()=>this.handleMouseleave()}
                 @mouseup=${()=>this.toggleProgressState(!0)}
                 @mousedown=${()=>this.toggleProgressState(!1)}>
                <div class=${s("card-back")}
                     @click=${()=>this.updateActiveCard(-1,a.STORY_MOVE_TYPES.STORY_TAP)}></div>
                <div class=${s("card-forward")}
                     @click=${()=>this.updateActiveCard(1,a.STORY_MOVE_TYPES.STORY_TAP)}></div>
                ${this.progressTemplate(e,t)}
                ${this.getStoryDirective(e,t)}
                ${i}
            </div>
        `}}t.AbstractStoriesViewer=c,c.defaults={stories:[],active:0,prevActive:null,storyCardIndex:0,storyChanged:!1,storyDuration:4e3}},function(e,t,s){"use strict";t.__esModule=!0,t.SpellerModule=void 0;var i=s(11),n=s(311),o=s(315),r=s(318);class a extends n.AbstractSpellerModule{listenTextArea(){super.listenTextArea(),this.textareaView.onTap(e=>{e.target===this.textareaView.getContentElement()&&setTimeout(()=>{const e=this.textareaPresenter.getCaret();this.spellerComponent.onChunkClick(e)},100)})}listenAppView(){const e=this.textareaView.getContentElement();this.appView.onTap(t=>{const s=e.contains(t.target),i=this.$elements.spellerDialog.contains(t.target);s||i||this.closeSpellerDialog()}).on("keydown",({keyCode:e})=>{this.spellerDialog.isVisible()&&e===i.KEYBOARD_KEYS.ESCAPE&&this.closeSpellerDialog()}).onStateChanged("select",e=>{e&&this.closeSpellerDialog()})}handleChunkSelection(e,t,s){super.handleChunkSelection(e,t,s);const i=e.misspellValue||e.value;this.spellerDialog.setAutoCorrectedMode(e.autoCorrected).setErroneousValue(i).handlePosition(s)}makeSpellerDialog(){return new r.SpellerDialog({},{container:this.$elements.spellerDialog,hideAfterTransition:!0})}makeSpellerComponent(){return new o.SpellerComponent({isWordNonCorrectable:e=>this.spellerStorage.containsWord(e,this.spellerModel.getProperty("lang"))},{container:this.$elements.speller})}}t.SpellerModule=a},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractSpellerModule=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(5),r=s(312),a=s(3),l=s(314),c=s(153);class d extends o.AppModule{$log(e,t={}){const{text:s,srcLang:i}=this.appModel.getProps();a.$tracker.sendMetric(e,{...t,srcLang:i,src:s})}constructor(e,t){super(e,t),this.moduleName="speller",this.$elements={speller:document.getElementById("speller"),spellerDialog:document.getElementById("spellerDialog")},this.spellerComponent=this.makeSpellerComponent(),this.spellerModel=this.makeSpellerModel(),this.spellerStorage=this.makeSpellerStorage(),this.spellerDialog=this.makeSpellerDialog(),this.textareaPresenter=this.app.getTextareaPresenter(),this.textareaView=this.app.getTextareaPresenter().getView(),this.checkSourceText=this.debounceMethod(()=>this.spellerModel.requestData(),200),this.listenAppModel(),this.listenAppView(),this.listenSpellerModel(),this.listenSpellerComponent(),this.listenSpellerDialog(),this.listenTextArea(),this.listenSettings(),this.setupSpellerModel(),this.chunkShowTimeout=null}closeSpellerDialog(){this.spellerComponent.resetHighlights(),this.spellerDialog.setEnabled(!1).setVisible(!1)}saveUserWords(e=[]){e.forEach(e=>{const{lang:t}=this.spellerModel.getProps();this.spellerStorage.saveUserWord(e,t)})}handleCorrectionDecline(e,t,s){isNaN(s)||(this.activeChunkIndex=s);const i=this.textareaPresenter.getCaret();this.saveUserWords([e]),this.spellerComponent.declineChunkCorrection(this.activeChunkIndex,i),this.$log("speller_decline",{word:e,replacement:t,source:isNaN(s)?"manual":"backspace"})}setCorrectedSourceText(e=!1,t=0,s){this.closeSpellerDialog();const i=this.spellerComponent.getCorrectedText(),n=this.spellerModel.getProperty("text");n!==i&&(e&&this.$log("speller_autocorrect",{oldText:n,newText:i}),this.textareaPresenter.setValue(i,{sender:"speller"}),s||(this.textareaView.getContentElement().click(),this.textareaView.setSelection({start:t||i.length}).setFocus(!0)))}listenAppView(){}listenAppModel(){this.appModel.onChange("text",(e,t={})=>{const s=t.oldValue;if(this.spellerModel.setProperty("text",e).setProperty("textPasted","paste"===t.reason&&!s).abort(),"speller"===t.sender)return;const i=this.textareaPresenter.getCaret();this.spellerComponent.moveMisspellsPositions(e,i),this.checkSourceText(),this.closeSpellerDialog(),clearTimeout(this.chunkShowTimeout),this.chunkShowTimeout=setTimeout(()=>this.spellerComponent.showCurrentMisspell(),c.CHUNK_SHOW_TIMEOUT)}).onChange("srcLang",e=>{this.spellerModel.setProperty("lang",e),this.checkSourceText(),this.spellerComponent.resetChunks()})}listenTextArea(){this.app.getTextInputView().on("scroll",()=>{this.spellerComponent.hasUnderlinedChunks()&&this.spellerComponent.setScrollTop(this.app.getTextInputView().getScrollTop())}),this.textareaView.onTap(n.default.debounce(()=>{const e=this.textareaPresenter.getCaret(),[t,s,i]=this.spellerComponent.findChunkByCaret(e);i?s!==this.activeChunkIndex&&this.spellerComponent.resetHighlights():this.closeSpellerDialog()}))}listenSpellerDialog(){this.spellerDialog.onManualCorrection(e=>{const t=this.spellerComponent.getChunk(this.activeChunkIndex);if(!t)return;let s=t.value===e?"speller_accept":"speller_apply";this.$log(s,{word:t.value,pos:t.pos,replacement:e}),this.spellerComponent.correctChunkByPos(t.pos,e)}).onCorrectionDecline((e,t)=>this.handleCorrectionDecline(e,t))}listenSpellerComponent(){this.spellerComponent.onTextCorrect((e,t,s)=>this.setCorrectedSourceText(e,t,s)).onCorrectionDecline((e,t,s)=>this.handleCorrectionDecline(e,t,s)).onChunkSelect((e,t,s)=>this.handleChunkSelection(e,t,s)).onWordSaved(e=>this.saveUserWords(e))}listenSpellerModel(){this.spellerModel.on("response",e=>{const t=n.default.safeParseJSON(e),s=this.spellerModel.getProperty("textPasted");this.spellerComponent.setMisspells(t),s&&this.app.autoSpellerEnabled()&&this.spellerComponent.correctAllChunks();const i=this.textareaPresenter.getCaret(),o=this.app.autoSpellerEnabled();this.spellerComponent.checkAndCorrect(i,o)})}listenSettings(){this.app.onToggleSpellerOption(e=>{if(e)return this.spellerComponent.correctAllChunks(!0),void this.$log("speller_switch_on");this.$log("speller_switch_off")})}setupSpellerModel(){const{text:e,srcLang:t}=this.appModel.getProps();e&&this.spellerModel.setProperty("text",e),t&&this.spellerModel.setProperty("lang",t)}makeSpellerStorage(){return new l.SpellerStorage({},{name:"touchSpeller"})}handleChunkSelection(e,t){this.$log("speller_click",{word:e.value,pos:e.pos,isAutocorrected:Boolean(e.autoCorrected)}),this.activeChunkIndex=t,this.spellerComponent.highlightChunk(t,!0),this.spellerDialog.setCorrections(e.corrections)}makeSpellerModel(){return new r.SpellerModel({srv:this.appConfig.SRV,url:this.appConfig.SPELLER_URL,options:r.SpellerModel.options.IGNORE_URLS+r.SpellerModel.options.IGNORE_CAPITALIZATION},{validators:{text:e=>e&&n.default.trim(e)&&e.length<=this.appConfig.MAX_SPELLER_LENGTH,lang:e=>n.default.hasProperty(this.appConfig.SPELLER_LANGS,e)}})}}t.AbstractSpellerModule=d},function(e,t,s){"use strict";t.__esModule=!0,t.SpellerModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(9),r=s(28),a=s(69),l=s(19),c=s(313);class d extends a.SyncModel{getData(){const e=this.toJSON();return{text:e.text,lang:e.lang,options:e.options}}getParams(){const e=this.toJSON();return{sid:e.sid,srv:e.srv}}getDefaults(){return{url:"/",srv:"",sid:this.getId(),text:"",oldText:"",lang:"",data:"",lastCaret:0,options:0}}validateResponse(e){const t=e&&e.body;return n.default.isArray(t)&&t.every(e=>"number"==typeof e.pos&&"number"==typeof e.code&&"number"==typeof e.len&&"string"==typeof e.word&&n.default.isArray(e.s))}runRequest(){const e=new l.HTTPRequest(this.getProperty("url")),t=this.getData();return this.setRequest(e.setType(l.HTTPRequest.types.FORM).setData(t).setParams(this.getParams()).setMethod(l.HTTPRequest.methods.POST).send((e,t)=>{const s=e&&e.code===r.HTTPError.ABORT;if(!(t&&t.code===l.HTTPRequest.codes.OK)||s||this.validateResponse(t)||(0,o.logError)(new c.SpellerApiError),e)return this.emit("error",e);this.emit("response",t.text)}))}requestData(){if(this.abort(),!this.isValid())return this;this.getSid().then(()=>this.runRequest())}}t.SpellerModel=d,d.options={IGNORE_UPPERCASE:1,IGNORE_DIGITS:2,IGNORE_URLS:4,FIND_REPEAT_WORDS:8,IGNORE_LATIN:16,NO_SUGGEST:32,FLAG_LATIN:128,BY_WORDS:256,IGNORE_CAPITALIZATION:512,IGNORE_ROMAN_NUMERALS:2048,ONLY_AUTOCORRECTIONS:4096}},function(e,t,s){"use strict";t.__esModule=!0,t.SpellerApiError=void 0;class i extends Error{constructor(...e){super(...e),this.message="Speller Api Error"}}t.SpellerApiError=i},function(e,t,s){"use strict";t.__esModule=!0,t.SpellerStorage=void 0;var i=s(63);class n extends i.Storage{wasSpellerPopupShown(){return"true"!==this.getProperty("spellerPromoShown")}setSpellerPopupShown(e){return this.setProperty("spellerPromoShown",e.toString())}saveUserWord(e,t){const s=this.getProperty("wordsMap")||{};return s[t]||(s[t]={}),s[t][e]=!0,this.setProperty("wordsMap",{}).setProperty("wordsMap",s)}containsWord(e,t){const s=this.getProperty("wordsMap")||{};return s[t]&&s[t][e]}deleteUserWord(e,t){const s=this.getProperty("wordsMap")||{};return s[t]||(s[t]={}),delete s[t][e],this.setProperty("wordsMap",{}).setProperty("wordsMap",s)}}t.SpellerStorage=n},function(e,t,s){"use strict";t.__esModule=!0,t.SpellerComponent=void 0,s(1);var i=s(316),n=s(153);class o extends i.AbstractSpellerComponent{onChunkClick(e){const[t,s,i]=this.findChunkByCaret(e);i&&this.emit(n.SPELLER_EVENTS.CHUNK_SELECTED,t,s,i)}}t.SpellerComponent=o},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractSpellerComponent=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(6),r=s(317),a=s(153);class l extends o.Component{constructor(e,t){super(e,t),this.refs={chunk:"chunk"},this.onChange("chunks",()=>this.updateAsync())}getCorrectedText(){return this.getProperty("chunks").reduce((e,{value:t})=>e+t,"")}getChunk(e){return(this.getProperty("chunks")||[])[e]}markNonCorrectableMisspells(e){const{isWordNonCorrectable:t}=this.getProps();return e.map(e=>({...e,shouldKeepOldValue:t(e.word)}))}findChunkByCaret(e){const{chunks:t}=this.getProps(),[s,i]=(0,r.findChunkByCaret)(e,t),n=this.getRef(`${this.refs.chunk}${i}`);if(!n)return[s,i,null];const o="true"===n.getAttribute("data-erroneous"),a="true"===n.getAttribute("data-auto-corrected");return o||a?[s,i,n]:[null,i,null]}findChunkBySelectedText(e,t){const{chunks:s}=this.getProps();return(0,r.findChunkBySelectedText)(e,t,s)}correctChunkByPos(e,t){const{misspells:s,text:i}=this.getProps(),[n,o]=(0,r.correctExactMisspell)(e,s,t,i);this.setProperty("misspells",n).setText(o).setProperty("chunks",this.makeChunks());const l=e+t.length;this.emit(a.SPELLER_EVENTS.CORRECTED_TEXT_READY,!1,l)}correctAllChunks(e=!1){const{misspells:t,text:s}=this.getProps(),[i,n]=(0,r.autoReplaceAllMisspells)(t,s);this.setProperty("misspells",i).setText(n).setProperty("chunks",this.makeChunks()).emit(a.SPELLER_EVENTS.CORRECTED_TEXT_READY,!0,0,e)}showCurrentMisspell(){const{misspells:e}=this.getProps();this.setProperty("misspells",(0,r.showCurrentMisspell)(e)).setProperty("chunks",this.makeChunks())}checkAndCorrect(e,t){const{text:s,misspells:i}=this.getProps(),[n,o,l]=(0,r.autoCorrectFinishedWords)(s,i,e,t);this.setProperty("misspells",n).setText(l).setProperty("chunks",this.makeChunks()).emit(a.SPELLER_EVENTS.CORRECTED_TEXT_READY,!0,o)}declineChunkCorrection(e,t){const{text:s,chunks:i,misspells:n}=this.getProps(),o=i[e];if(!o)return;const[l,c]=(0,r.declineChunkCorrection)(o.pos,n,s),d=c.length-s.length+t+1;this.setProperty("misspells",l).setText(c).setProperty("chunks",this.makeChunks()).emit(a.SPELLER_EVENTS.CORRECTED_TEXT_READY,!1,d)}makeChunks(){const{misspells:e,text:t}=this.getProps();return(0,r.makeChunks)(t,e)}moveMisspellsPositions(e,t){const{text:s,chunks:i}=this.getProps(),o=this.getProperty("misspells")||[],l=(0,r.getWordsToSave)(e,s,t,o);if(this.emit(a.SPELLER_EVENTS.SAVE_WORD,l),e.length-s.length<0){const e=o.find(({pos:e,len:s})=>e+s===t),s=n.default.findIndex(i,({pos:e,value:s})=>e+s.length===t);if((0,r.canAutoDeclineCorrection)(e,i,s))return this.emit(a.SPELLER_EVENTS.DECLINE_CORRECTION,i[s].misspellValue,i[s].value,s),this}const c=(0,r.moveMisspellsPositions)(e,s,t,o);return this.setText(e).setProperty("misspells",c).setProperty("chunks",this.makeChunks())}setScrollTop(e){this.getContainer().scrollTop=e}setText(e){return this.setVisible(Boolean(e)).setProperty("text",e)}setMisspells(e){const t=this.markNonCorrectableMisspells(e||[]),{misspells:s}=this.getProps(),i=(0,r.mergeMisspells)(t,s.filter(({autoCorrected:e})=>e));this.setProperty("misspells",i).setProperty("chunks",this.makeChunks())}highlightChunk(e,t=!1){t&&this.resetHighlights();const s=this.getRef(`${this.refs.chunk}${e}`);s&&s.setAttribute("data-selected",t.toString())}resetHighlights(){this.getProperty("chunks").forEach((e,t)=>{this.highlightChunk(t,!1)})}resetChunks(){this.setProperty({misspells:[],chunks:[]})}getFirstErroneousChunk(){return n.default.findIndex(this.getProperty("chunks"),e=>e.erroneous)}getFirstAutoCorrectedChunk(){return n.default.findIndex(this.getProperty("chunks"),e=>e.autoCorrected)}getErroneousChunkRect(){let e=this.getFirstErroneousChunk();-1===e&&(e=this.getFirstAutoCorrectedChunk());const t=this.getRef(`${this.refs.chunk}${e}`);return t?t.getBoundingClientRect():null}hasUnderlinedChunks(){const{misspells:e}=this.getProps();return e&&e.length}onTextCorrect(e){return this.on(a.SPELLER_EVENTS.CORRECTED_TEXT_READY,e)}onCorrectionDecline(e){return this.on(a.SPELLER_EVENTS.DECLINE_CORRECTION,e)}onChunkSelect(e){return this.on(a.SPELLER_EVENTS.CHUNK_SELECTED,e)}onWordSaved(e){return this.on(a.SPELLER_EVENTS.SAVE_WORD,e)}template({html:e,cn:t}){const{chunks:s}=this.getProps(),i=t("speller");return e`
            ${s.map(({value:t,erroneous:s,autoCorrected:n,current:o},r)=>e`<span
                    data-chunk-index="${r}"
                    data-current="${Boolean(o)}"
                    data-erroneous="${Boolean(s)}"
                    data-auto-corrected="${Boolean(n)}"
                    data-ref-id="${this.refs.chunk}${r}"
                    class="${i("chunk")}"
                >${t}</span>`)}`}}t.AbstractSpellerComponent=l,l.defaults={text:"",chunks:[],misspells:[],lastClickedChunk:null,isWordNonCorrectable:()=>!1}},function(e,t,s){"use strict";t.__esModule=!0,t.showCurrentMisspell=t.moveMisspellsPositions=t.mergeMisspells=t.makeChunks=t.getWordsToSave=t.findChunkBySelectedText=t.findChunkByCaret=t.declineChunkCorrection=t.correctExactMisspell=t.canAutoDeclineCorrection=t.autoReplaceAllMisspells=t.autoCorrectFinishedWords=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i};t.autoReplaceAllMisspells=(e=[],t="")=>{let s=0,i=t;return[e.map(e=>{const{autoCorrected:t,shouldKeepOldValue:n,s:o,word:r,pos:a,len:l}=e;if(t||n)return{...e,pos:a+s};const c=o&&o[0]&&o[0].trim()||r,d={...e,word:c,len:c.length,pos:a+s,autoCorrected:!0,misspellValue:e.misspellValue||e.word};return i=i.slice(0,a+s)+c+i.slice(a+s+l),s+=c.length-l,d}),i]};t.correctExactMisspell=(e,t,s,i)=>{const o=n.default.findIndex(t,({pos:t})=>t===e),r=t[o];if(!r)return[t,i];const a=s.length-r.word.length,l=[...t.slice(0,o)];t.slice(o+1).forEach(e=>{l.push({...e,pos:e.pos+a})});const c=i.slice(0,e)+s+i.slice(e+r.len);return[l,c]};t.moveMisspellsPositions=(e="",t="",s,i=[])=>{const n=e.length-t.length,o=s-n;return i.filter(({pos:e,len:t})=>e>o&&e+t>s||e<o&&e+t<s).map(e=>{let{pos:t,len:s,word:i}=e;return t>o&&(t+=n),{...e,pos:t,len:s,word:i,new:!1}})};t.mergeMisspells=(e,t)=>{let s=0,i=0;const n=[];if(!e||!e.length)return t;if(!t||!t.length)return e;for(;s<e.length&&i<t.length;)t[i].pos<e[s].pos?(t[i].pos+t[i].len<e[s].pos&&n.push(t[i]),i++):e[s]&&(n.push(e[s]),e[s].pos===t[i].pos&&i++,s++);if(s<e.length)n.push(...e.slice(s));else if(i<t.length){const s=e[e.length-1];t.slice(i).forEach(e=>{t[i].pos+t[i].len>s.pos&&n.push(e),i++})}return n};t.makeChunks=(e="",t=[])=>{const s=[];if(!t||!t.length)return[{value:e,pos:0,erroneous:!1}];const i=t&&t[0].pos;return i>0&&s.push({pos:0,value:e.slice(0,i),erroneous:!1}),t.forEach((i,n)=>{const{pos:o,s:r,word:a,len:l,shouldKeepOldValue:c,autoCorrected:d,misspellValue:u,current:h}=i,p=o+l,g=e.slice(o,p);if(s.push({pos:o,value:g,erroneous:g===a&&!d&&!c,autoCorrected:d,corrections:r,shouldKeepOldValue:c,misspellValue:u,current:h}),p<e.length){const i=n<t.length-1?t[n+1].pos:e.length;s.push({pos:p,value:e.slice(p,i),erroneous:!1,current:h})}}),s};t.findChunkByCaret=(e,t=[])=>{let s={},i=-1;return(t||[]).forEach((t,n)=>{t.pos<=e&&e<t.pos+t.value.length&&(s=t,i=n)}),!s.value||s.value||s.autoCorrected?[s,i]:[null,null]};t.findChunkBySelectedText=(e,t,s=[])=>{let i,n=-1;return(s||[]).forEach((s,o)=>{e>=s.pos&&t<=s.pos+s.value.length&&(i=s,n=o)}),i&&i.value&&!i.erroneous&&!i.autoCorrected?[null,null]:[i,n]};t.declineChunkCorrection=(e,t=[],s)=>{const i=n.default.findIndex(t,({pos:t})=>t===e),o=t[i];if(!o)return[t,s];const r=t[i].misspellValue.length-o.word.length,a=[...t.slice(0,i)];t.slice(i+1).forEach(e=>{a.push({...e,pos:e.pos+r})});const l=s.slice(0,e)+o.misspellValue+s.slice(e+t[i].len);return[a,l]};t.autoCorrectFinishedWords=(e,t,s,i)=>{const n=[];let o=0,r=s,a=e;return t.forEach(({pos:t,len:l,word:c,s:d,shouldKeepOldValue:u,misspellValue:h,autoCorrected:p})=>{const g=t+o,m=e.slice(g,g+l)===c,E=/[\s.,!;?()]/.test(e[g+l]),_=s>g&&s<=g+l,T=d||[""];m&&E&&!_&&!u&&!p&&i?(o+=T[0].trim().length-l,s>g+l&&(r=s+o),a=a.slice(0,g)+T[0].trim()+a.slice(g+l),n.push({s:d,pos:g,len:T[0].trim().length,word:T[0].trim(),autoCorrected:!0,misspellValue:h||c,new:!0,current:_})):n.push({pos:g,len:l,word:c,s:d,shouldKeepOldValue:u,misspellValue:h,autoCorrected:p,current:_})}),[n,r,a]};t.canAutoDeclineCorrection=(e,t,s)=>e&&e.autoCorrected&&e.new&&t[s]&&t[s].misspellValue;t.getWordsToSave=(e,t,s,i)=>{const n=e.length-t.length,o=s-n;return i.filter(e=>{const t=n<0&&e.pos+e.len<=o&&e.pos>=s;return(n>0?o>=e.pos&&o<=e.pos+e.len:o>e.pos&&o<=e.pos+e.len)&&e.new&&e.misspellValue&&e.autoCorrected&&!t}).map(({misspellValue:e})=>e)};t.showCurrentMisspell=e=>e.map(e=>({...e,current:!1}))},function(e,t,s){"use strict";t.__esModule=!0,t.SpellerDialog=void 0,s(1);var i=s(319);function n(e,t,s){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}class r extends i.AbstractSpellerDialog{constructor(e,t){super(e,t),this.titlePrefix="",this.titlePostfix="",[this.titlePrefix,this.titlePostfix]=this.locales.spellerExplanation.split("{}")}handlePosition(e){const t=e.getBoundingClientRect();this.setPosition(t,!0)}declineCorrection(){const{autoCorrectedMode:e}=this.getProps();e&&super.declineCorrection()}setAutoCorrectedMode(e){return this.setProperty({autoCorrectedMode:e})}getExplanationLabel(){const{html:e,cn:t}=this.getRenderHelpers(),{erroneousValue:s}=this.getProps(),i=t("spellerDialog");return e`
            <div class="${i("explanation")}">
                ${this.titlePrefix}
                <span
                    @click=${()=>this.declineCorrection()}
                    class="${i("highlighted")}"
                >${s}</span>${this.titlePostfix}
            </div>
        `}template({html:e,cn:t}){const s=t("spellerDialog"),{corrections:i}=this.getProps();return e`
            <div class="${s()}">
                ${this.getExplanationLabel()}
                ${i.map(t=>e`
                    <div
                        class="${s("item")}"
                        @click=${()=>this.correctMisspell(t)}
                    >${t}</div>
                `)}
            </div>
        `}}t.SpellerDialog=r,r.defaults={...n(o(r),"defaults",r),autoCorrectedMode:!1}},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractSpellerDialog=void 0;var i=s(6),n=s(46),o=s(153);class r extends i.Component{constructor(e,t){let s;super(e,t),this.locales=n.locales.speller,this.onVisibilityChanged(e=>{clearTimeout(s),e||(s=setTimeout(()=>{this.setErroneousValue(null).setCorrections([])},200))}).onRendered(()=>{const{corrections:e}=this.getProps();e&&e.length&&this.setEnabled(!0).setVisible(!0)}).onChange(()=>this.updateAsync())}setCorrections(e=[]){return this.setProperty({corrections:e})}setErroneousValue(e){return this.setProperty({erroneousValue:e})}correctMisspell(e){this.setVisible(!1).emit(o.SPELLER_EVENTS.CORRECT_TEXT,e)}declineCorrection(){const{erroneousValue:e,corrections:t}=this.getProps();this.setVisible(!1).emit(o.SPELLER_EVENTS.DECLINE_CORRECTION,e,t[0])}onManualCorrection(e){return this.on(o.SPELLER_EVENTS.CORRECT_TEXT,e)}onCorrectionDecline(e){return this.on(o.SPELLER_EVENTS.DECLINE_CORRECTION,e)}template(){return this.getRenderHelpers().nothing}}t.AbstractSpellerDialog=r,r.defaults={corrections:[],erroneousValue:""}},function(e,t,s){"use strict";t.__esModule=!0,t.FeedbackModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(5),r=s(3),a=s(321),l=s(322);class c extends o.AppModule{constructor(e,t){super(e,t),this.moduleName="feedback",this.feedbackStorage=this.makeFeedbackStorage(),this.shouldShowFeedback()&&(this.feedbackComponent=this.makeFeedbackComponent(),this.isShown=!1,this.listenAppModel())}shouldShowFeedback(){return!!this.appConfig.ENABLE_FORCED_FEEDBACK||!!this.feedbackStorage.canShowFeedback()&&n.default.getRandomBoolean()}listenAppModel(){this.appModel.onChange("translation",e=>{!this.isShown&&e&&(this.isShown=!0,this.feedbackStorage.saveShownTime(),this.feedbackComponent.setVisible(!0),r.$tracker.sendMetric("feedback_show",{votes:(this.feedbackComponent.votes||[]).map(({id:e})=>e).join(" ")}))})}makeFeedbackStorage(){return new l.FeedbackStorage({},{name:"feedback"})}makeFeedbackComponent(){return new a.FeedbackComponent({},{container:this.appConfig.ELEMENTS.feedback,hideAfterTransition:!0,skipFadeoutTransition:!0})}}t.FeedbackModule=c},function(e,t,s){"use strict";t.__esModule=!0,t.FeedbackComponent=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(6),r=s(3),a=s(16),l=s(18);class c extends o.Component{constructor(e,t){super(e,t),this.locales=l.desktopLocales.feedback,this.refs={commentInput:"commentInput"},this.votes=this.getRandomVotes(),this.debouncedReset=n.default.debounce(()=>this.reset(),200),this.hideTimeout=null;this.onChange(["vote","isSent"],()=>{this.update()}).onStateChanged("hidden",e=>{clearTimeout(this.hideTimeout),e&&this.getProperty("isSent")&&this.debouncedReset()}),this.update()}getRandomVotes(){const e=[{id:"bad",text:l.desktopLocales.feedback.badVote},{id:"neutral",text:l.desktopLocales.feedback.neutralVote},{id:"good",text:l.desktopLocales.feedback.goodVote}];return n.default.getRandomBoolean()?e.reverse():e}reset(){this.setState("voted",!1).setProperty({isVoted:!1,isSent:!1,vote:0})}getComment(){const e=this.getRef(this.refs.commentInput);return e&&e.value||""}applyVote(e){r.$tracker.sendMetric("feedback_vote_click",{vote:e}),this.setState("voted",!0).setProperty({isVoted:!0,vote:e})}sendFeedback(){const{vote:e}=this.getProps(),t=this.getComment();r.$tracker.sendMetric("feedback_send",{comment:t,vote:e}),this.setState("voted",!1).setProperty("isSent",!0),this.hideTimeout=setTimeout(()=>this.close(),3e3)}trackInputFocus(){r.$tracker.sendMetric("feedback_input_focus")}close(e){e&&r.$tracker.sendMetric("feedback_close"),this.setVisible(!1).debouncedReset()}cancel(e){const t=this.getComment();r.$tracker.sendMetric("feedback_cancel",{element:e,comment:t}),this.close()}template({html:e,cn:t,nothing:s}){const{vote:i,isVoted:n,isSent:o}=this.getProps(),r=t("feedback"),l=t("button"),c=t("emoji"),d=t("button")({size:"m",round:!0,icn:!0,view:"clear",close:!0});return e`
            ${o?e`
                <div class=${r("cancel")}>
                    <button
                        @click=${()=>this.close(!0)}
                        class=${d}>${(0,a.icn)("clear")}</button>
                </div>
                <div class=${r("icon_love")}></div>
                <div class=${r("title")}>${this.locales.completeTitle}</div>
                <div class=${r("text")}>${this.locales.completeText}</div>
            `:e`
                <div class=${r("cancel")}>
                    <button
                        @click=${()=>this.cancel("cross")}
                        class=${d}>${(0,a.icn)("clear")}</button>
                </div>
                <div class=${r("title")}>${this.locales.title}</div>
                <div class=${r("votes")}>
                    ${this.votes.map(({id:t})=>e`
                        <button class=${c({type:t,inactive:n&&i!==t})} @click=${()=>this.applyVote(t)}>
                            <div class="${c("eyes")}"></div>
                            <div class="${c("leftEye")}"></div>
                            <div class="${c("rightEye")}"></div>
                        </button>
                    `)}
                </div>
                <div class="${r("vote-labels")}">
                    ${this.votes.map(({text:t})=>e`
                        <div class="${c("text")}">${t}</div>
                    `)}
                </div>
                ${n?e`
                    <div class=${r("title")}>${"good"===i?this.locales.goodText:this.locales.badText}</div>
                    <div class=${r("form")}>
                        <textarea class=${r("input")}
                            data-ref-id="${this.refs.commentInput}"
                            placeholder="${this.locales.input}"
                            autocorrect="off"
                            autocomplete="off"
                            autocapitalize="off"
                            spellcheck="false"
                            @focus=${()=>this.trackInputFocus()}
                        ></textarea>
                        <div class=${r("buttons")}>
                            <div class=${l({view:"ghost",size:"l"})}
                                 @click=${()=>this.cancel("button")}>
                                ${this.locales.buttonCancel}
                            </div>
                            <div class=${l({view:"primary",size:"l"})}
                                 @click=${()=>this.sendFeedback()}>
                                ${this.locales.buttonSend}
                            </div>
                        </div>
                    </div>
                `:s}
            `}
        `}}t.FeedbackComponent=c,c.defaults={vote:"",isVoted:!1,isSent:!1}},function(e,t,s){"use strict";t.__esModule=!0,t.FeedbackStorage=void 0;var i=s(63);class n extends i.Storage{saveShownTime(){return this.setProperty("shownTime",Date.now())}canShowFeedback(){const e=this.getProperty("shownTime");if(!e)return!0;return Date.now()-e>864e5}}t.FeedbackStorage=n},function(e,t,s){"use strict";t.__esModule=!0,t.BlocksVisibilityModule=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(5),r=s(3);class a extends o.AppModule{constructor(e,t){super(e,t),this.moduleName="blocksVisibility",n.default.isIntersectionObserverSupported()&&(this.blocks=[{id:"examples",threshold:.1},{id:"dictionary",threshold:.5},{id:"relatedWords",threshold:.5},{id:"declensions",threshold:.5},{id:"definition",threshold:.5},{id:"idiomDefinition",threshold:.5}].map(e=>({...e,elem:t.ELEMENTS[e.id]})),this.seenBlocks={},this.observeBlocks(),this.listenAppModel())}resetBlocksVisibility(){for(const{id:e}of this.blocks)this.seenBlocks[e]=!1}trackVisibility(e,t){const s=this.appModel.getProperty("text");s&&r.$tracker.sendMetric("block_visible",{block:e,threshold:t,src:s})}observeBlocks(){for(const{id:e,elem:t,threshold:s}of this.blocks){new IntersectionObserver(t=>{for(const s of t){if(!(s.boundingClientRect.height>0)||!s.isIntersecting||this.seenBlocks[e])return;this.trackVisibility(e,s.intersectionRatio.toFixed(1)),this.seenBlocks[e]=!0}},{root:null,rootMargin:"0px",threshold:s,trackVisibility:!0,delay:200}).observe(t)}}listenAppModel(){this.appModel.onChange("text",()=>{this.resetBlocksVisibility()})}}t.BlocksVisibilityModule=a},function(e,t,s){"use strict";t.__esModule=!0,t.ScrollHeaderModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},o=s(3),r=s(5),a=s(15),l=s(2);class c extends r.AppModule{constructor(e,t){super(e,t),this.$elements={header:document.getElementById("header"),headerSpacer:document.getElementById("headerSpacer"),headerNavMenuPopup:document.getElementById("headerNavMenuPopup"),headerNavMenuBtn:document.getElementById("headerNavMenuBtn"),headerTranslateText:document.getElementById("headerTranslateText")},this.handleAppScroll=()=>{const e=window.scrollY>0,t=this.headerView.hasState("active");if(!(!e&&!t||e&&t))if(e){const e=this.headerView.getElement().clientHeight;this.headerView.setState("active",!0),this.headerSpacerView.setStyle("marginTop",e+"px"),this.handleAppTextChange()}else this.headerView.setState("active",!1),this.headerNavMenuPopupView.setState("opened-menu",!1),this.headerSpacerView.setStyle("marginTop","")},this.handleAppTextChange=()=>{this.headerView.setState("large-text",this.isAppTextLarge())},this.headerView=new a.View({element:this.$elements.header}),this.headerSpacerView=new a.View({element:this.$elements.headerSpacer}),this.headerNavMenuBtnView=new l.TouchView({element:this.$elements.headerNavMenuBtn}),this.headerNavMenuPopupView=new l.TouchView({element:this.$elements.headerNavMenuPopup}),this.headerTranslateText=new l.TouchView({element:this.$elements.headerTranslateText}),this.listenAppScroll(),this.listenNavBtn(),this.listenNavPopup(),this.listenAppTextChange(),this.listenHeaderTranslateText()}listenAppScroll(){this.handleAppScroll(),document.addEventListener("scroll",this.handleAppScroll)}listenNavBtn(){this.headerNavMenuBtnView.onTap(()=>{this.headerNavMenuPopupView.setState("opened-menu",!0),o.$tracker.sendMetric("sticky_header_open_menu")})}listenNavPopup(){this.headerNavMenuPopupView.onTap(e=>{const t=this.headerNavMenuPopupView.hasState("opened-menu"),s=!n.default.getClosest(e.target,e=>e.classList.contains("header-nav-content"));t&&s&&this.headerNavMenuPopupView.setState("opened-menu",!1)})}listenAppTextChange(){this.appModel.onChange("text",e=>{this.headerTranslateText.setContent(e,{asText:!0}),this.handleAppTextChange()})}listenHeaderTranslateText(){this.headerTranslateText.onTap(()=>{n.default.smoothScrollTo(document.documentElement,0),o.$tracker.sendMetric("sticky_header_scroll_to_top")})}isAppTextLarge(){return(this.appModel.getProperty("text")||"").length>=20}}t.ScrollHeaderModule=c},function(e,t,s){"use strict";t.__esModule=!0,t.getTextTemplates=function(){return{empty:"{{}}",pin:i.tpl`
    <span class="button_icon button_icon_pin" title="{{?pinned}}${o.selectUnpinTooltip}{{/pinned}}{{^pinned}}${o.selectPinTooltip}{{/pinned}}" data-type="{{type}}" data-lang="{{value}}" data-value="" data-action="{{?pinned}}un{{/pinned}}pinLang"></span>
    `,url:i.tpl`
    <input type="hidden" name="ui" value="{{ui}}">
    <input type="hidden" name="url" value="{{url}}">
    <input type="hidden" name="lang" value="{{lang}}">
    <span class="page-url" data-action="translatePage">{{url}}</span>
    `,speller:i.tpl`
    {{@items}}<span class="speller-chunk"{{?type}} data-type="{{type}}" data-index="{{index}}"{{/type}}>{{value}}</span>{{/items}}{{^isFakeTextArea}}.{{/isFakeTextArea}}
    `,listbox:i.tpl`
    {{@items}}
        <div class="listbox-option{{?multiple}} listbox-option_checkbox{{/multiple}}{{?selected}} state-selected{{/selected}}{{?lead}} listbox-option_type_lead{{/lead}} state-unselectable" data-value="{{value}}" unselectable="on">{{text}}{{>extras}}</div>
    {{/items}}
    `,listboxDescription:i.tpl`
        <div class="switch"></div>
        {{?description}}
            <div class="listbox-option-description">{{ description }}</div>
        {{/description}}
    `,tablist:i.tpl`
    {{@items}}
    <a class="listbox-option{{?selected}} state-selected{{/selected}}{{?show}} state-show{{/show}} state-unselectable" data-value="{{value}}" unselectable="on">{{text}}</a>
    {{/items}}
    `,measurer:i.tpl`
    {{?leftText}}<span class="measurer-text measurer-text_left">{{leftText}}</span>{{/leftText}}<span class="measurer-text measurer-text_main" data-measurer-target="true">{{text}}</span>{{?rightText}}<span class="measurer-text measurer-text_right">{{rightText}}</span>{{/rightText}}<span class="measurer-text measurer-text_dot">.</span>
    `,alignment:i.tpl`
    {{?leftText}}<span class="measurer-text measurer-text_left">{{leftText}}</span>{{/leftText}}{{@items}}<span class="measurer-text measurer-text_main" data-measurer-target="true">{{text}}</span>{{?gap}}<span class="measurer-text measurer-text_right">{{gap}}</span>{{/gap}}{{/items}}{{?rightText}}<span class="measurer-text measurer-text_right">{{rightText}}</span>{{/rightText}}<span class="measurer-text measurer-text_dot">.</span>
    `,external:i.tpl`
    {{@items}}<a href="{{href}}" class="external-link" data-external-name="{{name}}" target="_blank" rel="nofollow" data-tracking-data='{"id": "externalTranslate/{{name}}"}' data-default-enter-action="true">{{text}}</a>{{/items}}
    `,predictor:i.tpl`
        {{?spinner}}<span class="spinnerBlock"></span>{{/spinner}}
        {{^spinner}}
        <div class="predictor-value" data-value="{{value}}" unselectable="on">
            {{@values}}{{value}}{{/values}}${(0,n.getIcnHtml)("enter",16)}
        </div>
        {{/spinner}}
    `,dictionary:i.tpl`
    <div class="synonyms-list tab-content" data-tab="syn" data-tracking-data='{"id": "syns"}'>
        {{*syn}}
        <div class="segment-title">{{title}}</div>
        <div class="tabs">
            {{@articles}}
            <div class="tab" data-tracking-data='{"id": "syns/article", "tab": "{{tab}}"}'>
                <div class="tab-title" title="{{tooltip}}">{{subtitle}}</div>
                <div class="tab-list synonyms-meanings" data-tab="{{tab}}">{{@items}}
                    <span class="synonyms-value" data-dict-type="{{name}}" data-complaint-type="tr" data-complaint-target="true" data-value="{{name}}:{{value}}" data-title="{{title}}" data-part-of-speech="{{partOfSpeech}}" data-group-index="{{{groupIndex}}">{{value}}</span>{{^isLast}}&nbsp;&middot; {{/isLast}}
                    {{/items}}</div>
            </div>
            {{/articles}}
        </div>
        {{/syn}}
    </div>
    <div class="dictionary-list tab-content" data-tab="regular" data-tracking-data='{"id": "dict"}'>
        {{*dict}}
        <div class="segment-title">{{title}}</div>
        <ul class="tab-list">
            {{@items}}
            <li class="dictionary-item{{^show}} state-invisible{{/show}}" data-tracking-data='{"id": "dict/article", "title": "{{title.title}}", "partOfSpeechCode": "{{title.partOfSpeechCode}}"}'>
                {{*title}}
                <div class="dictionary-title">
                    {{title}}
                    {{?transcription}}<span class="dictionary-transcription" data-title="{{{title}}}" data-part-of-speech="{{{partOfSpeechCode}}}" data-complaint-type="ts" data-complaint-target="true">[{{transcription}}]</span>{{/transcription}}
                    {{?partOfSpeech}}<span class="dictionary-pos" title="{{{tooltip}}}">{{partOfSpeech}}</span>{{/partOfSpeech}}
                    <span class="dictionary-marks">{{@marks}}<span class="dictionary-mark" title="{{title}}">{{value}}</span>{{/marks}}</span>
                    {{?fl}}<span class="dictionary-marks_fl">{{fl}}</span>{{/fl}}
                </div>
                {{?hasExamples}}<span class="example-toggler{{?showExampleToggle}} state-visible{{/showExampleToggle}}" data-text-show="${o.dictionaryExamplesShow}" data-text-hide="${o.dictionaryExamplesHide}" data-action="dictExamplesToggle" data-tracking-data='{"id": "dict/article/showExamples"}'></span>{{/hasExamples}}
                {{/title}}

                {{^definition}}
                <ol class="dictionary-meanings">
                    {{@meanings}}
                    <li class="dictionary-meanings-item{{^show}} state-invisible{{/show}}" data-tracking-data='{"id": "dict/article/meaning", "groupIndex": "{{{groupIndex}}}"}'>
                        <span class="dictionary-meanings-index"></span>
                        <div class="dictionary-meanings-value">{{@meaningVals}}<span class="dictionary-meaning" data-complaint-type="tr" data-complaint-target="true" data-value="tr:{{{value}}}" data-title="{{{title}}}" data-part-of-speech="{{{partOfSpeech}}" data-group-index="{{{groupIndex}}">{{value}}</span><span class="dictionary-marks">{{@marks}}<span class="dictionary-mark" title="{{title}}">{{value}}</span>{{/marks}}</span>{{^isLast}}, {{/isLast}}{{/meaningVals}}</div>

                        {{?hasTranslations}}<div class="dictionary-meanings-trs">({{@meaningTrs}}<span data-complaint-type="mean" data-complaint-target="true" data-value="mean:{{{value}}}" data-title="{{{title}}}" data-part-of-speech="{{{partOfSpeech}}" data-group-index="{{{groupIndex}}">{{value}}</span>{{^isLast}}, {{/isLast}}{{/meaningTrs}})</div>{{/hasTranslations}}

                        {{?hasExamples}}
                        <ul class="dictionary-examples">
                            {{@examples}}
                            <li><span data-complaint-type="ex" data-complaint-target="true" data-title="{{{title}}}" data-part-of-speech="{{{partOfSpeech}}" data-group-index="{{{groupIndex}}" data-tracking-data='{"id": "dict/article/meaning/example"}'>{{exampleVal}}{{?exampleTrs}} &ndash; {{exampleTrs}}{{/exampleTrs}}</span></li>
                            {{/examples}}
                        </ul>
                        {{/hasExamples}}
                    </li>
                    {{/meanings}}
                </ol>
                {{/definition}}

                {{*definition}}
                <div class="dictionary-definition">
                    {{?imgUrl}}
                    <a href="{{origUrl}}" class="dictionary-definition-img" rel="nofollow" target="_blank" data-tracker-goal="DICT_CARD_IMAGE_CLICK">
                        <img src="{{imgUrl}}" alt="{{altText}}">
                    </a>
                    {{/imgUrl}}
                    <div class="dictionary-definition-text">
                        {{@textVal}}{{?highlighted}}<strong>{{/highlighted}}{{text}}{{?highlighted}}</strong>{{/highlighted}}{{/textVal}}
                    </div>
                    <div class="dictionary-definition-link">
                        <a href="{{sourceUrl}}" rel="nofollow" target="_blank" data-tracker-goal="DICT_CARD_SOURCE_CLICK">{{sourceName}}</a>
                    </div>
                </div>
                {{/definition}}
            </li>
            {{/items}}
        </ul>
        {{?hasModernLabel}}<div class="label"><a class="label-link" href="https://yandex.ru/blog/company/hypeandvape" target="_blank" data-tracker-goal="DICT_BLOG_CLICK">${o.dictionaryLabelModern}</a></div>{{/hasModernLabel}}
        {{?showToggle}}<span class="toggler" data-text-show="{{moreMessage}}" data-text-hide="${o.dictHide}" data-action="toggleDictionary" data-tracking-data='{"id": "dict/expand"}'></span>{{/showToggle}}
        {{/dict}}
    </div>
    <span class="button button_complaint state-fadeaway" data-action="toggleComplaintMode">${o.reportError}</span>
    `,exampleListbox:i.tpl`
    {{@groups}}
        <div class="listbox-group">
        {{@items}}
            <div class="listbox-option{{?multiple}} listbox-option_checkbox{{/multiple}}{{?isPrimary}} listbox-option_primary{{/isPrimary}}{{?disabled}} listbox-option_disabled{{/disabled}}{{?selected}} state-selected{{/selected}} state-unselectable"
                data-tracking-data='{"id": "examlpes/tabs/tab", "title": "{{value}}", "partOfSpeechCode": "{{posCode}}", "disabled": "{{?disabled}}true{{/disabled}}{{^disabled}}false{{/disabled}}", "selected": "{{?selected}}true{{/selected}}{{^selected}}false{{/selected}}"}'
                data-value="{{value}}{{^disabled}}:{{posCode}}{{/disabled}}"
                unselectable="on" data-pos="{{posCode}}">{{text}}{{>extras}}</div>
            {{^others}}{{?isPrimary}}<div class="listbox-option_delimiter_arrow"></div>{{/isPrimary}}{{/others}}
        {{/items}}
        </div>
    {{/groups}}
    `,examples:i.tpl`
    <div class="tab-content" data-tab="examples" data-tracking-data='{"id": "examples"}'>
        <ul class="tab-list">
            {{@items}}
            <li class="dictionary-example_list{{?expanded}} state-expanded{{/expanded}}" data-translation="{{translation}}" data-tracking-data='{"id": "examples/article", "partOfSpeechCode": "{{ posCode }}", "index": "{{ index }}", "title": "{{ translation }}"}'>
                <div class="dictionary-example_group{{?showAll}} state-showall{{/showAll}}" data-pos="{{posCode}}">
                    <div class="dictionary-meanings-value"><span class="dictionary-meaning" data-pos="{{posCode}}">{{translation}}</span>{{?pos}}<span class="dictionary-marks" title="{{tooltip}}">{{pos}}</span>{{/pos}}</div>
                    {{@examples}}
                    <div class="dictionary-example" data-complaint-target="true" data-complaint-type="example" data-id="{{id}}" data-text="{{originalVal}}" data-translation="{{originalTrs}}" data-tracking-data='{"id": "examples/article/example", "exampleId": "{{id}}"}' data-role="dictionaryExample">
                        <div class="dictionary-example_wrapper" data-tracking-data='{"id": "examples/article/example/src"}'>
                            <div class="dictionary-example_source"><div role="button" class="button button_icon button_icon_speaker{{^speakerSrc}} state-disabled{{/speakerSrc}}" data-text="{{originalVal}}" data-lang="{{srcLang}}" data-tr="{{translation}}" data-ref="{{ref}}" data-action="soundExample" data-tracking-data='{"id": "examples/article/example/src/speaker"}'></div>{{@exampleVal}}{{?highlighted}}<span class="example-highlighted">{{/highlighted}}{{text}}{{?highlighted}}</span>{{/highlighted}}{{/exampleVal}}</div>
                        </div>
                        <div class="dictionary-example_wrapper" data-tracking-data='{"id": "examples/article/example/dst"}'>
                            <div class="dictionary-example_target"><div role="button" class="button button_icon button_icon_speaker{{^speakerDst}} state-disabled{{/speakerDst}}" data-text="{{originalTrs}}" data-lang="{{dstLang}}" data-tr="{{translation}}" data-ref="{{ref}}" data-action="soundExample" data-tracking-data='{"id": "examples/article/example/dst/speaker"}'></div>{{@exampleTrs}}{{?highlighted}}<span class="example-highlighted">{{/highlighted}}{{text}}{{?highlighted}}</span>{{/highlighted}}{{/exampleTrs}}</div>
                        </div>
                        <div class="dictionary-example_meta">
                            <span class="dictionary-example_meta__vote-buttons{{*voteResult}} state-voted{{/voteResult}}">
                                <div
                                    role="button"
                                    class="button button_icon button_icon_thumbsup{{*voteResult}}{{?isGood}} state-voted{{/isGood}}{{/voteResult}}"
                                    aria-label="${o.exampleValuedGoodTooltip}"
                                    data-tooltip="${o.exampleValuedGoodTooltip}"
                                    data-tooltip-position="top"
                                    data-action="voteExample"
                                    data-vote-type="good"
                                    data-voted="{{*voteResult}}true{{/voteResult}}"
                                    data-id="{{id}}"
                                    data-tracking-data='{"id": "examples/article/example/goodVote"}'
                                ></div>
                                <div
                                    role="button"
                                    class="button button_icon button_icon_thumbsdown{{*voteResult}}{{?isBad}} state-voted{{/isBad}}{{/voteResult}}"
                                    aria-label="${o.exampleValuedBadTooltip}"
                                    data-tooltip="${o.exampleValuedBadTooltip}"
                                    data-tooltip-position="top"
                                    data-action="voteExample"
                                    data-vote-type="bad"
                                    data-voted="{{*voteResult}}true{{/voteResult}}"
                                    data-id="{{id}}"
                                    data-tracking-data='{"id": "examples/article/example/badVote"}'
                                ></div>
                            </span>
                            {{?ref}}<div class="example_ref" data-type="{{refType}}" data-ref="{{ref}}" data-message="{{message}}" data-tracking-data='{"id": "examples/article/example/ref"}'></div>{{/ref}}
                        </div>
                    </div>
                    {{/examples}}
                </div>
                {{?moreCount}}{{^filtered}}{{^showAll}}<div class="dictionary-example_toggler" data-count="{{moreCount}}" data-index="{{index}}" data-text-show="{{moreMessage}}" data-text-hide="${o.examplesHide}" data-action="toggleLongExamples"></div>{{/showAll}}{{/filtered}}{{/moreCount}}
            </li>
            {{/items}}
        </ul>
    </div>
    `,examplePopup:i.tpl`
    {{?noExamples}}
        {{^template}}
            <div class="popup-empty_text"
                data-tracking-data='{"id": "popup", "type": "empty"}'>${o.popupEmpty}</div>
        {{/template}}
        {{?template}}
            <div class="popup-empty popup-empty_title"
                data-tracking-data='{"id": "popup", "type": "waiting"}'></div>
            <div class="popup-empty popup-empty_line"></div>
            <div class="popup-empty popup-empty_line popup-empty_line-short"></div>
            <div class="popup-empty popup-empty_line"></div>
            <div class="popup-empty popup-empty_line popup-empty_line-short"></div>
            <div class="popup-empty popup-empty_line"></div>
            <div class="popup-empty popup-empty_line popup-empty_line-short"></div>
        {{/template}}
    {{/noExamples}}

    {{^noExamples}}
    <div class="popup-content{{^hasExamples}} state-no_examples{{/hasExamples}}"
        data-tracking-data='{"id": "popup", "type": "full"}'>
        {{?hasWords}}
        <div class="popup-words" data-tracking-data='{"id": "popup/dict"}'>
            {{@words}}
            <div class="dict-group"
                data-tracking-data='{
                    "id": "popup/dict/article",
                    "title": "{{ title }}",
                    "partOfSpeechCode": "{{ partOfSpeechCode }}"
                }'>
                {{*title}}
                <div class="dict-title">
                    <span class="dict-title-part dict-title-part_type_word">{{title}}</span>
                    {{?transcription}}
                        <span
                            class="dict-title-part dict-title-part_type_transcription"
                            data-complaint-type="ts"
                            data-complaint-target="true">[{{transcription}}]</span>
                    {{/transcription}}
                    {{?partOfSpeech}}
                        <span class="dict-title-part dict-title-part_type_postfix">{{partOfSpeech}}</span>
                    {{/partOfSpeech}}
                    {{?gen}}
                        <span class="dict-title-part">{{gen}}</span>
                    {{/gen}}
                    {{?fl}}
                        <span class="dict-title-part">{{fl}}</span>
                    {{/fl}}
                </div>
                {{/title}}

                <ol class="dict-meanings dict-meanings_order_meaning">
                    {{@popupVals}}
                    <li class="dict-meanings-item"
                        data-index="{{ groupIndex1 }}"
                        data-tracking-data='{"id": "popup/dict/article/meaning", "groupIndex": "{{ groupIndex }}"}'>
                        <div class="dict-meanings-value">
                            {{@values}}
                            <span class="dict-meaning tag tag_size_m"
                                data-action="applyText"
                                data-sender="popupDict"
                                {{?needSwap}}data-swap-dir="true"{{/needSwap}}
                                data-text="{{value}}">{{value}}</span>
                            {{/values}}
                        </div>
                        {{?hasSyn}}
                        <div class="dict-meanings-trs">
                            {{@syn}}
                                <span class="dict-meaning-tr"
                                    data-action="applyText"
                                    data-sender="popupDict"
                                    {{?needSwap}}data-swap-dir="true"{{/needSwap}}
                                    data-text="{{value}}">{{value}}{{^isLast}}, {{/isLast}}</span>
                            {{/syn}}
                        </div>
                        {{/hasSyn}}
                    </li>
                    {{/popupVals}}
                </ol>
            </div>
            {{/words}}
        </div>
        {{/hasWords}}

        {{?hasExamples}}
        <div class="example_list" data-tracking-data='{"id": "popup/examples"}'>
            <div class="example_group">
            {{@items}}
            <div class="example_item example_item_type_{{refType}}"
                data-pos="{{posCode}}"
                data-tracking-data='{
                    "id": "popup/examples/article/example",
                    "partOfSpeechCode": "{{ posCode }}",
                    "text": "{{ text }}",
                    "exampleId": "{{ exampleId }}"
                }'>
                {{?text}}
                    <div class="popup-title">{{text}}</div>
                    {{?pos}}<span class="popup-tr"> {{pos}}</span>{{/pos}}
                {{/text}}

                <div class="popup-example">
                    {{?ref}}
                    <div class="example_meta"
                        data-tracking-data='{"id": "popup/examples/article/example/ref"}'>
                        <div class="example_ref_wrapper" data-type="{{refType}}">
                            <div class="example_ref"
                                data-type="{{refType}}"
                                data-ref="{{ref}}"
                                data-message="{{message}}">
                                ${(0,n.getIcnHtml)("expl-{{refType}}")}
                            </div>
                        </div>
                        <div class="example_ref-info">
                            <div class="example_name">{{ref}}</div>
                            <div class="example-author">{{message}}</div>
                        </div>
                    </div>
                    {{/ref}}

                    <div class="example_wrapper">
                        <div class="example_source"
                            data-tracking-data='{"id": "popup/examples/article/example/src"}'>
                            {{@srcExp}}
                                {{^highlighted}}
                                    <span>{{text}}</span>
                                {{/highlighted}}
                                {{?highlighted}}
                                    <span class="example-highlighted"
                                        data-action="applyText"
                                        data-sender="popupExample"
                                        {{?needSwap}} data-swap-dir="true" {{/needSwap}}
                                        data-text="{{text}}">{{text}}</span>
                                {{/highlighted}}
                            {{/srcExp}}
                        </div>
                        <div class="example_target"
                            data-tracking-data='{"id": "popup/examples/article/example/dst"}'>
                            {{@dstExp}}
                                {{^highlighted}}
                                    <span>{{text}}</span>
                                {{/highlighted}}
                                {{?highlighted}}
                                    <span class="example-highlighted"
                                        data-action="applyText"
                                        data-sender="popupExample"
                                        {{?needSwap}} data-swap-dir="true" {{/needSwap}}
                                        data-text="{{text}}">{{text}}</span>
                                {{/highlighted}}
                            {{/dstExp}}
                        </div>
                    </div>
                </div>
            </div>
            {{/items}}
            </div>
        </div>
        <div class="button-items-expand" data-action="enableCustomMode">${o.popupMoreExamples}</div>
        {{/hasExamples}}
    </div>
    {{/noExamples}}
    `,translator:i.tpl`
    <span data-complaint-type="fullTextTranslation" data-complaint-target="true">{{@chunks}}{{@values}}<span class="translation-word {{?align}}translation-chunk{{/align}}" {{?align}}data-align="{{align}}"{{/align}}>{{value}}</span>{{/values}}{{?needLineBreak}}<span>&#10;</span>{{/needLineBreak}}{{/chunks}}</span>
    `,emojiValue:i.tpl`
    {{?emojiCode}}<img src="https://twitter.github.io/twemoji/2/72x72/{{emojiCode}}.png" alt="{{/emojiCode}}{{value}}{{?emojiCode}}" class="translation-emoji" draggable="false">{{/emojiCode}}
    `,collections:r(),collectionHeader:i.tpl`
    <div class="collection-header_card">
        {{?author}}<div class="collection-header_author">{{author}}</div>{{/author}}
        <div class="collection-header_info">
            <div class="collection_info-section">${o.collectionsHeaderRecords}<div class="collection-header_count">{{recordsCount}}</div></div>
            {{?subscribersCount}}<div class="collection_info-section">${o.collectionsHeaderSubscribers}<div class="collection-header_count">{{subscribersCount}}</div></div>{{/subscribersCount}}
        </div>
    </div>
    `,records:i.tpl`
    {{^items}}
    <li class="collection-placeholder{{?empty}} collection-placeholder_empty{{/empty}}" data-text="${o.collectionsRecordsEmpty}" data-text-filtered="${o.favouritesFilterEmpty}"></li>
    {{/items}}
    {{@items}}
    <li class="record{{?selected}} state-selected{{/selected}}">
        <div class="button button_icon button_icon_favourites state-favourite" title="${o.collectionsFavButtonDeleteTooltip}" data-action="deleteRecord" data-index="{{id}}"></div>
        <div data-value="{{id}}">
            <span class="listbox-option_checkbox"></span>
            <div class="record-item">
                <div class="record-item_text">
                    <div class="record-line">
                        <div class="record-line_lang">{{srcLang}}</div>
                        <div role="button" class="record-line_speaker button button_icon button_icon_speaker" data-value data-text="{{text}}" data-lang="{{srcLang}}" data-action="soundCollection"></div>
                    </div>
                    <div lang="{{srcLang}}" dir="{{srcDir}}">{{text}}</div>
                </div>
                <div class="record-item_translation">
                    <div class="record-line record-line_tr">
                        <div class="record-line_lang">{{dstLang}}</div>
                        <div role="button" class="record-line_speaker record-line_speaker_tr button button_icon button_icon_speaker" data-value data-text="{{translation}}" data-lang="{{dstLang}}" data-action="soundCollection"></div>
                    </div>
                    <div lang="{{dstLang}}" dir="{{dstDir}}">{{translation}}</div>
                </div>
            </div>
        </div>
    </li>
    {{/items}}
    `,collectionsPopupList:i.tpl`
    <li class="collection-item" data-action="addCollection2">
        <div class="collection-icon icon_new">+</div>
        <div class="collection-name">${o.collectionsListItemCreate}</div>
    </li>
    {{@collections}}
    <li class="collection-item{{?disabled}} state-disabled{{/disabled}}" data-type="{{collectionType}}" data-value="{{^disabled}}{{collectionId}}{{/disabled}}">
        <div class="collection-icon collection-color" data-color="{{color}}"><span class="collection-icon-letter">{{collectionIcon}}</span></div>
        <div class="collection-name">{{collectionName}}</div>
        <div class="collection-info">
            {{?private}}<span class="button_icon button_icon_lock"></span>{{/private}}
            <span class="info-records-count">{{collectionCount}}</span>
        </div>
    </li>
    {{/collections}}
    `,menu:i.tpl`
    {{@items}}
    <div class="listbox-option listbox-option_{{itemType}} state-unselectable" unselectable="on" data-value="" data-action="{{action}}"{{?confirm}} data-confirm="{{confirm}}"{{/confirm}}>
        <span class="button button_icon{{?iconType}} button_icon_{{iconType}}{{/iconType}}"></span>
        {{text}}
    </div>
    {{/items}}
    `,collectionsToast:i.tpl`
    {{^deleted}}
    <span class="collection-toast_button" data-action="changeCollection">${o.collectionsChange}</span>
    {{/deleted}}
    <div class="collection-toast_text">{{message}}</div>
    `,dictionaryHeaderButton:i.tpl`
        <span class="dictionary-header_label-text">{{ customExamplesText }}</span><span class="dictionary-header_close-button" data-action="closeCustomExamples"><i class="sprite_icon sprite_icon_clear2"></i></span>
    `}};var i=s(66),n=s(16);const o=window.config.LOCALIZATIONS;function r(){const e=window.config.PASSPORT,t=window.config.RETPATH,s=window.config.UID?`\n        {{?subscribed}}\n        <span class="collection-info_icon button_icon button_icon_check_white" data-index="{{collectionId}}" data-tooltip="${o.collectionsSubscribed}" data-tooltip-position="left"></span>\n        {{/subscribed}}\n        {{?subscribeButton}}\n        {{^subscribed}}\n        <span class="collection-info_icon button_icon button_icon_plus_white" data-value data-index="{{collectionId}}" data-action="subscribe" data-subscribe-type="collection_list" data-tooltip="${o.collectionsButtonSubscribe}" data-tooltip-position="left"></span>\n        {{/subscribed}}\n        {{/subscribeButton}}\n    `:`\n        {{?popular}}\n        <span class="collection-info_icon button_icon button_icon_plus_white" data-value data-action="subscribe" data-subscribe-type="collection_list" data-tooltip="${o.collectionsButtonSubscribe}" data-tooltip-position="left">\n            <a href="https://passport.yandex.${e}/auth?origin=translate&amp;retpath=${t}"></a>\n        </span>\n        {{/popular}}\n    `;return i.tpl`
    {{@blocks}}
    <div class="collection-section-header">{{header}}</div>
    <ul class="collection-list">
        {{@collections}}
            <li class="collection-item collection-color" data-color="{{color}}" data-type="{{collectionType}}" data-value="{{collectionId}}">
                <div class="collection-name">
                    <div class="collection-title">{{collectionName}}</div>
                    {{?collectionAuthor}}<div class="collection-author">{{collectionAuthor}}</div>{{/collectionAuthor}}
                </div>
                <div class="collection-info">
                    <span class="collection-info_icons">
                        {{?broken}}<span class="collection-info_icon button_icon info-icon-error" data-tooltip="${o.collectionsBrokenSubscription}" data-tooltip-position="left"></span>{{/broken}}
                        {{?private}}<span class="collection-info_icon button_icon button_icon_lock_white" data-tooltip="${o.collectionsPrivateTooltip}" data-tooltip-position="left"></span>{{/private}}
                        ${s}
                    </span>
                    <span class="info-records-count">{{collectionCount}}</span>
                </div>
            </li>
            {{?isHistory}}<li class="collection-item-break"></li>{{/isHistory}}
        {{/collections}}
    </ul>
    {{/blocks}}
    `}},function(e,t,s){"use strict";t.__esModule=!0,t.getTextElements=function(){return{swapButton:i("swapButton"),url:i("urlForm"),share:i("share"),shareInput:i("shareInput"),shareButton:i("shareButton"),shareContent:i("shareContent"),shareCopyLink:i("shareCopyLink"),volume:i("volume"),interim:i("interim"),speller:i("speller"),tooltip:i("tooltip"),textbox:i("textbox"),textbox2:i("textbox2"),external:i("external"),externalContent:i("externalContent"),measurer:i("measurer"),measurerDst:i("measurerDst"),keyboard:i("keyboard"),keyboardLang:i("keyboardLang"),keyboardButton:i("keyboardButton"),keyboardLangSwap:i("keyboardLangSwap"),keyboardContainer:i("keyboardContainer"),fakeArea:i("fakeArea"),textarea:i("textarea"),favButton:i("favButton"),alignment:i("alignment"),predictor:i("predictor"),predictorDst:i("predictorDst"),suggestions:i("suggestions"),textLayer:i("textLayer"),dictionary:i("dictionary"),complaintPopup:i("complaintPopup"),complaintInfoPopup:i("complaintInfoPopup"),complaintPopupComment:i("complaintPopupComment"),complaintPopupCommentInput:i("complaintPopupCommentInput"),complaintPopupProposal:i("complaintPopupProposal"),complaintPopupProposalInput:i("complaintPopupProposalInput"),feedbackPopup:i("feedbackPopup"),feedbackInput:i("feedbackInput"),microphone:i("microphone"),copyButton:i("copyButton"),collectionMenuButton:i("collectionMenuButton"),collectionMenuListbox:i("collectionMenuListbox"),textCounter:i("textCounter"),textCounterLimit:i("textCounterLimit"),textCounterContent:i("textCounterContent"),clearButton:i("clearButton"),translation:i("translation"),textSpeaker:i("textSpeaker"),textNativeSpeaker:i("textNativeSpeaker"),translator:i("translator"),translatorSpeaker:i("translatorSpeaker"),translatorNativeSpeaker:i("translatorNativeSpeaker"),goodVoteButton:i("goodVoteButton"),badVoteButton:i("badVoteButton"),srcLangButton:i("srcLangButton"),dstLangButton:i("dstLangButton"),srcLangHistory:i("srcLangHistory"),srcLangHistoryContent:i("srcLangHistoryContent"),dstLangHistory:i("dstLangHistory"),dstLangHistoryContent:i("dstLangHistoryContent"),srcLangListbox:i("srcLangListbox"),srcLangListboxContent:i("srcLangListboxContent"),dstLangListbox:i("dstLangListbox"),dstLangListboxContent:i("dstLangListboxContent"),langSelect:i("langSelect"),spellerPopup:i("spellerPopup"),spellerPopupContent:i("spellerPopupContent"),spellerListbox:i("spellerListbox"),alternativesTooltip:i("alternativesTooltip"),alternativesListbox:i("alternativesListbox"),translationLayer:i("translationLayer"),serviceDescription:i("serviceDescription"),langSwitcherButton:i("langSwitcherButton"),langSwitcherListbox:i("langSwitcherListbox"),dropOverlay:i("dropOverlay"),dropContent:i("dropContent"),errorToast:i("errorToast"),errorToastContent:i("errorToastContent"),collectionsView:i("collectionsWrapper"),collectionList:i("collectionList"),collectionListContent:i("collectionListContent"),topList:i("topList"),subscribeTooltip:i("subscribeTooltip"),recordsList:i("recordsList"),recordsListContent:i("recordsListContent"),createCollectionButton:i("createCollectionButton"),collectionAddPopup:i("collectionAddPopup"),collectionName:i("collectionName"),collectionNameInput:i("collectionNameInput"),collectionNameInput2:i("collectionNameInput2"),collectionNameInput3:i("collectionNameInput3"),addCollectionButton:i("addCollectionButton"),collectionHeader:i("collectionHeader"),collectionHeaderContent:i("collectionHeaderContent"),collectionHeaderName:i("collectionHeaderName"),collectionTumbler:i("collectionTumbler"),collectionsToast:i("collectionsToast"),collectionsPopupList:i("collectionsPopupList"),collectionNewAddPopup:i("collectionNewAddPopup"),collectionSearch:i("collectionSearch"),collectionSearchInput:i("collectionSearchInput"),shareCollectionTumbler:i("shareCollectionTumbler"),collectionsNameEditPopup:i("collectionsNameEditPopup"),recordMovePopup:i("recordMovePopup"),recordMovePopupList:i("recordMovePopupList"),recordCopyPopup:i("recordCopyPopup"),recordCopyPopupList:i("recordCopyPopupList"),shareCollection:i("shareCollection"),shareCollectionContent:i("shareCollectionContent"),shareCollectionInput:i("shareCollectionInput"),shareCollectionCopy:i("shareCollectionCopy"),selectAllButton:i("selectAllButton"),examples:i("examples"),popunder:i("popunder"),popunderTooltip:i("popunderTooltip"),selectTooltip:i("selectTooltip"),historyRecent:i("historyRecent"),idiomDefinition:i("idiomDefinition"),feedback:i("feedback"),relatedContent:i("relatedContent"),miniNav:i("miniNav"),miniNavMeasurer:i("miniNavMeasurer"),miniNavItems:i("miniNav-items"),miniNavControlLeft:i("miniNav-control_left"),miniNavControlRight:i("miniNav-control_right"),cardsCarousel:i("cardsCarousel"),relatedWords:i("relatedWords"),declensions:i("declensions"),definition:i("definition"),dictionaryHeader:i("dictionaryHeader"),textlayerCustomStyles:i("textlayerCustomStyles"),sourceTranslit:i("sourceTranslit"),targetTranslit:i("targetTranslit"),micButtonChip:i("micButtonChip"),micNotificationChipTooltip:i("micNotificationChipTooltip"),micNotificationChipTooltipWrapper:i("micNotificationChipTooltip_wrapper"),micNotificationChipTooltipSpinner:i("micNotificationChipTooltip_spinner")}};const i=e=>document.getElementById(e)}]);